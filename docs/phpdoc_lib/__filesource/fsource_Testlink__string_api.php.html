<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>File Source for string_api.php</title>
	<link rel="stylesheet" type="text/css" href="../media/style.css">
	<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
</head>
<body>

<table border="0" cellspacing="0" cellpadding="0" height="48" width="100%">
  <tr>
	<td class="header-top-left"><img src="../media/logo.png" border="0" alt="phpDocumentor " /></td>
    <td class="header-top-right">Testlink<br /><div class="header-top-right-subpackage"></div></td>
  </tr>
  <tr><td colspan="2" class="header-line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
  <tr>
    <td colspan="2" class="header-menu">
      
                        
                      		[ <a href="../classtrees_Testlink.html" class="menu">class tree: Testlink</a> ]
		[ <a href="../elementindex_Testlink.html" class="menu">index: Testlink</a> ]
            [ <a href="../elementindex.html" class="menu">all elements</a> ]
    </td>
  </tr>
  <tr><td colspan="2" class="header-line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="195" class="menu">
		<div class="package-title">Testlink</div>
  <div class="package">
	<div id="todolist">
			<p><a href="../todolist.html">Todo List</a></p>
	</div>
	</div>
      <b>Packages:</b><br />
  <div class="package">
              <a href="../li_Testlink.html">Testlink</a><br />
      	</div>
      <br />
                        <br />
                      </td>
    <td>
      <table cellpadding="10" cellspacing="0" width="100%" border="0"><tr><td valign="top">

<h1 align="center">Source for file string_api.php</h1>
<p>Documentation is available at <a href="../Testlink/_string_api.php.html">string_api.php</a></p>
<div class="src-code"><span class="php">
<ol><li><div class="src-line"><a name="a1"></a><span class="src-php">&lt;?php</span></div></li>
<li><div class="src-line"><a name="a2"></a><span class="src-doc">/**&nbsp;</span></div></li>
<li><div class="src-line"><a name="a3"></a><span class="src-doc">&nbsp;*&nbsp;TestLink&nbsp;Open&nbsp;Source&nbsp;Project&nbsp;-&nbsp;http://testlink.sourceforge.net/</span></div></li>
<li><div class="src-line"><a name="a4"></a><span class="src-doc">&nbsp;*&nbsp;This&nbsp;script&nbsp;is&nbsp;distributed&nbsp;under&nbsp;the&nbsp;GNU&nbsp;General&nbsp;Public&nbsp;License&nbsp;2&nbsp;or&nbsp;later.</span></div></li>
<li><div class="src-line"><a name="a5"></a><span class="src-doc">&nbsp;*&nbsp;</span></div></li>
<li><div class="src-line"><a name="a6"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@filesource</span><span class="src-doc">&nbsp;$RCSfile: fsource_Testlink__string_api.php.html,v $</span></div></li>
<li><div class="src-line"><a name="a7"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@version</span><span class="src-doc">&nbsp;$Revision: 1.1.2.1 $</span></div></li>
<li><div class="src-line"><a name="a8"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-tag">@modified</span><span class="src-doc">&nbsp;$Date: 2009/04/04 23:31:08 $&nbsp;&nbsp;$Author: havlat $</span></div></li>
<li><div class="src-line"><a name="a9"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@author</span><span class="src-doc">&nbsp;franciscom</span></div></li>
<li><div class="src-line"><a name="a10"></a><span class="src-doc">&nbsp;*&nbsp;</span></div></li>
<li><div class="src-line"><a name="a11"></a><span class="src-doc">&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;String&nbsp;Processing&nbsp;functions&nbsp;###</span></div></li>
<li><div class="src-line"><a name="a12"></a><span class="src-doc">&nbsp;*&nbsp;</span></div></li>
<li><div class="src-line"><a name="a13"></a><span class="src-doc">&nbsp;*&nbsp;&nbsp;rev:</span></div></li>
<li><div class="src-line"><a name="a14"></a><span class="src-doc">&nbsp;*&nbsp;&nbsp;&nbsp;20080822&nbsp;-&nbsp;franciscom&nbsp;-&nbsp;restored&nbsp;missed&nbsp;string_email_links()</span></div></li>
<li><div class="src-line"><a name="a15"></a><span class="src-doc">&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20080606&nbsp;-&nbsp;havlatm&nbsp;-&nbsp;remove&nbsp;useles&nbsp;mantis&nbsp;related&nbsp;code</span></div></li>
<li><div class="src-line"><a name="a16"></a><span class="src-doc">&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20071104&nbsp;-&nbsp;franciscom&nbsp;-&nbsp;changes&nbsp;to&nbsp;string_email_links()</span></div></li>
<li><div class="src-line"><a name="a17"></a><span class="src-doc">&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div></li>
<li><div class="src-line"><a name="a18"></a><span class="src-doc">&nbsp;*&nbsp;&nbsp;-----------------------------------------------------------------------------------&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a19"></a>&nbsp;<span class="src-comm">//&nbsp;The&nbsp;original&nbsp;code&nbsp;was&nbsp;developed&nbsp;by:</span></div></li>
<li><div class="src-line"><a name="a20"></a>&nbsp;<span class="src-comm">//&nbsp;Mantis&nbsp;-&nbsp;a&nbsp;php&nbsp;based&nbsp;bugtracking&nbsp;system</span></div></li>
<li><div class="src-line"><a name="a21"></a>&nbsp;<span class="src-comm">//&nbsp;Copyright&nbsp;(C)&nbsp;2002&nbsp;-&nbsp;2004&nbsp;&nbsp;Mantis&nbsp;Team&nbsp;&nbsp;&nbsp;-&nbsp;mantisbt-dev@lists.sourceforge.net</span></div></li>
<li><div class="src-line"><a name="a22"></a>&nbsp;<span class="src-comm">//&nbsp;-------------------------------------------------------------------------------------</span></div></li>
<li><div class="src-line"><a name="a23"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a24"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a25"></a><span class="src-doc">/**&nbsp;Preserve&nbsp;spaces&nbsp;at&nbsp;beginning&nbsp;of&nbsp;lines.&nbsp;Lines&nbsp;must&nbsp;be&nbsp;separated&nbsp;by&nbsp;\n&nbsp;rather&nbsp;than&nbsp;&lt;br&nbsp;/&gt;&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a26"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_preserve_spaces_at_bol">string_preserve_spaces_at_bol</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a27"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a28"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$lines&nbsp;</span>=&nbsp;<a href="http://www.php.net/explode">explode</a><span class="src-sym">(&nbsp;</span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a29"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$line_count&nbsp;</span>=&nbsp;<a href="http://www.php.net/count">count</a><span class="src-sym">(&nbsp;</span><span class="src-var">$lines&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a30"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">for&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-var">$i&nbsp;</span>=&nbsp;<span class="src-num">0</span><span class="src-sym">;&nbsp;</span><span class="src-var">$i&nbsp;</span>&lt;&nbsp;<span class="src-var">$line_count</span><span class="src-sym">;&nbsp;</span><span class="src-var">$i</span>++&nbsp;<span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a31"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$count&nbsp;&nbsp;&nbsp;&nbsp;</span>=&nbsp;<span class="src-num">0</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a32"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$prefix&nbsp;&nbsp;&nbsp;&nbsp;</span>=&nbsp;<span class="src-str">''</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a33"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a34"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_char&nbsp;</span>=&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(&nbsp;</span><span class="src-var">$lines</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">,&nbsp;</span><span class="src-var">$count</span><span class="src-sym">,&nbsp;</span><span class="src-num">1&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a35"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$spaces&nbsp;</span>=&nbsp;<span class="src-num">0</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a36"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">while&nbsp;</span><span class="src-sym">(&nbsp;(&nbsp;</span><span class="src-var">$t_char&nbsp;&nbsp;</span>==&nbsp;<span class="src-str">'&nbsp;'&nbsp;</span><span class="src-sym">)&nbsp;</span>||&nbsp;<span class="src-sym">(&nbsp;</span><span class="src-var">$t_char&nbsp;</span>==&nbsp;<span class="src-str">&quot;\t&quot;&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a37"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_char&nbsp;</span>==&nbsp;<span class="src-str">'&nbsp;'&nbsp;</span><span class="src-sym">)</span></div></li>
<li><div class="src-line"><a name="a38"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$spaces</span>++<span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a39"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">else</span></div></li>
<li><div class="src-line"><a name="a40"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$spaces&nbsp;</span>+=&nbsp;<span class="src-num">4</span><span class="src-sym">;&nbsp;</span><span class="src-comm">//&nbsp;1&nbsp;tab&nbsp;=&nbsp;4&nbsp;spaces,&nbsp;can&nbsp;be&nbsp;configurable.</span></div></li>
<li><div class="src-line"><a name="a41"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a42"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$count</span>++<span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a43"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_char&nbsp;</span>=&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(&nbsp;</span><span class="src-var">$lines</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">,&nbsp;</span><span class="src-var">$count</span><span class="src-sym">,&nbsp;</span><span class="src-num">1&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a44"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a45"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a46"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">for&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-var">$j&nbsp;</span>=&nbsp;<span class="src-num">0</span><span class="src-sym">;&nbsp;</span><span class="src-var">$j&nbsp;</span>&lt;&nbsp;<span class="src-var">$spaces</span><span class="src-sym">;&nbsp;</span><span class="src-var">$j</span>++&nbsp;<span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a47"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$prefix&nbsp;</span>.=&nbsp;<span class="src-str">'&amp;nbsp;'</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a48"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a49"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a50"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$lines</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]&nbsp;</span>=&nbsp;<span class="src-var">$prefix&nbsp;</span>.&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(&nbsp;</span><span class="src-var">$lines</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">,&nbsp;</span><span class="src-var">$count&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a51"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a52"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><a href="http://www.php.net/implode">implode</a><span class="src-sym">(&nbsp;</span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$lines&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a53"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a54"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a55"></a><span class="src-doc">/**&nbsp;Prepare&nbsp;a&nbsp;string&nbsp;to&nbsp;be&nbsp;printed&nbsp;without&nbsp;being&nbsp;broken&nbsp;into&nbsp;multiple&nbsp;lines&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a56"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_no_break">string_no_break</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a57"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-str">'&nbsp;'&nbsp;</span><span class="src-sym">)&nbsp;</span>!==&nbsp;<span class="src-id">false&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a58"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-str">'&lt;span&nbsp;class=&quot;nowrap&quot;&gt;'&nbsp;</span>.&nbsp;<span class="src-var">$p_string&nbsp;</span>.&nbsp;<span class="src-str">&quot;&lt;/span&gt;&quot;</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a59"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">else&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a60"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a61"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a62"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a63"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a64"></a><span class="src-doc">/**&nbsp;</span></div></li>
<li><div class="src-line"><a name="a65"></a><span class="src-doc">&nbsp;*&nbsp;Similar&nbsp;to&nbsp;nl2br,&nbsp;but&nbsp;fixes&nbsp;up&nbsp;a&nbsp;problem&nbsp;where&nbsp;new&nbsp;lines&nbsp;are&nbsp;doubled&nbsp;between&nbsp;&lt;pre&gt;&nbsp;tags.</span></div></li>
<li><div class="src-line"><a name="a66"></a><span class="src-doc">&nbsp;*&nbsp;additionally,&nbsp;wrap&nbsp;the&nbsp;text&nbsp;an&nbsp;$p_wrap&nbsp;character&nbsp;intervals&nbsp;if&nbsp;the&nbsp;config&nbsp;is&nbsp;set</span></div></li>
<li><div class="src-line"><a name="a67"></a><span class="src-doc">&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a68"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_nl2br">string_nl2br</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_wrap&nbsp;</span>=&nbsp;<span class="src-num">100&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a69"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a70"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/nl2br">nl2br</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a71"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a72"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;fix&nbsp;up&nbsp;eols&nbsp;within&nbsp;&lt;pre&gt;&nbsp;tags&nbsp;(#1146)</span></div></li>
<li><div class="src-line"><a name="a73"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$pre2&nbsp;</span>=&nbsp;<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a74"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">&quot;/&lt;pre[^&gt;]*?&gt;(.|\n)*?&lt;\/pre&gt;/&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-var">$pre1</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a75"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">for&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-var">$x&nbsp;</span>=&nbsp;<span class="src-num">0</span><span class="src-sym">;&nbsp;</span><span class="src-var">$x&nbsp;</span>&lt;&nbsp;<a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$pre1</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;&nbsp;</span><span class="src-var">$x</span>++&nbsp;<span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a76"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a77"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$pre2</span><span class="src-sym">[</span><span class="src-var">$x</span><span class="src-sym">]&nbsp;</span>=&nbsp;<a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/&lt;br[^&gt;]*?&gt;/&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$pre1</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$x</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a78"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;@@@&nbsp;thraxisp&nbsp;-&nbsp;this&nbsp;may&nbsp;want&nbsp;to&nbsp;be&nbsp;replaced&nbsp;by&nbsp;html_entity_decode&nbsp;(or&nbsp;equivalent)</span></div></li>
<li><div class="src-line"><a name="a79"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;other&nbsp;encoded&nbsp;characters&nbsp;are&nbsp;a&nbsp;problem</span></div></li>
<li><div class="src-line"><a name="a80"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$pre2</span><span class="src-sym">[</span><span class="src-var">$x</span><span class="src-sym">]&nbsp;</span>=&nbsp;<a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/&amp;nbsp;/&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;&nbsp;&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$pre2</span><span class="src-sym">[</span><span class="src-var">$x</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a81"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-id">ON&nbsp;</span>==&nbsp;<a href="../Testlink/_common.php.html#functionconfig_get">config_get</a><span class="src-sym">(&nbsp;</span><span class="src-str">'wrap_in_preformatted_text'&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a82"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a83"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$pre2</span><span class="src-sym">[</span><span class="src-var">$x</span><span class="src-sym">]&nbsp;</span>=&nbsp;<a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/([^\n]{&quot;</span>.<span class="src-var">$p_wrap</span>.<span class="src-str">&quot;})(?!&lt;\/pre&gt;)/&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;$1\n&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$pre2</span><span class="src-sym">[</span><span class="src-var">$x</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a84"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a85"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$pre1</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$x</span><span class="src-sym">]&nbsp;</span>=&nbsp;<span class="src-str">&quot;/&quot;&nbsp;</span>.&nbsp;<a href="http://www.php.net/preg_quote">preg_quote</a><span class="src-sym">(</span><span class="src-var">$pre1</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$x</span><span class="src-sym">]</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">)&nbsp;</span>.&nbsp;<span class="src-str">&quot;/&quot;</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a86"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a87"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a88"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(&nbsp;</span><span class="src-var">$pre1</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">,&nbsp;</span><span class="src-var">$pre2</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a89"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a90"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a91"></a><span class="src-doc">/**&nbsp;Prepare&nbsp;a&nbsp;multiple&nbsp;line&nbsp;string&nbsp;for&nbsp;display&nbsp;to&nbsp;HTML&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a92"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_display">string_display</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a93"></a><span class="src-sym">{&nbsp;&nbsp;&nbsp;&nbsp;</span></div></li>
<li><div class="src-line"><a name="a94"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_strip_hrefs">string_strip_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a95"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_html_specialchars">string_html_specialchars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a96"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_restore_valid_html_tags">string_restore_valid_html_tags</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-comm">/*&nbsp;multiline&nbsp;=&nbsp;*/&nbsp;</span><span class="src-id">true&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a97"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_preserve_spaces_at_bol">string_preserve_spaces_at_bol</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a98"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_nl2br">string_nl2br</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a99"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a100"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a101"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a102"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a103"></a><span class="src-doc">/**&nbsp;Prepare&nbsp;a&nbsp;single&nbsp;line&nbsp;string&nbsp;for&nbsp;display&nbsp;to&nbsp;HTML&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a104"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_display_line">string_display_line</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a105"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a106"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_strip_hrefs">string_strip_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a107"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_html_specialchars">string_html_specialchars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a108"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_restore_valid_html_tags">string_restore_valid_html_tags</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-comm">/*&nbsp;multiline&nbsp;=&nbsp;*/&nbsp;</span><span class="src-id">false&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a109"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a110"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a111"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a112"></a><span class="src-doc">/**&nbsp;</span></div></li>
<li><div class="src-line"><a name="a113"></a><span class="src-doc">&nbsp;*&nbsp;Prepare&nbsp;a&nbsp;string&nbsp;for&nbsp;display&nbsp;to&nbsp;HTML&nbsp;and&nbsp;add&nbsp;href&nbsp;anchors&nbsp;for&nbsp;URLs,&nbsp;emails,</span></div></li>
<li><div class="src-line"><a name="a114"></a><span class="src-doc">&nbsp;*&nbsp;bug&nbsp;references,&nbsp;and&nbsp;cvs&nbsp;references</span></div></li>
<li><div class="src-line"><a name="a115"></a><span class="src-doc">&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a116"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_display_links">string_display_links</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a117"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a118"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_display">string_display</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a119"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_insert_hrefs">string_insert_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a120"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a121"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a122"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a123"></a><span class="src-doc">/**&nbsp;</span></div></li>
<li><div class="src-line"><a name="a124"></a><span class="src-doc">&nbsp;*&nbsp;Prepare&nbsp;a&nbsp;single&nbsp;line&nbsp;string&nbsp;for&nbsp;display&nbsp;to&nbsp;HTML&nbsp;and&nbsp;add&nbsp;href&nbsp;anchors&nbsp;for</span></div></li>
<li><div class="src-line"><a name="a125"></a><span class="src-doc">&nbsp;*&nbsp;URLs,&nbsp;emails,&nbsp;bug&nbsp;references,&nbsp;and&nbsp;cvs&nbsp;references</span></div></li>
<li><div class="src-line"><a name="a126"></a><span class="src-doc">&nbsp;*/&nbsp;</span></div></li>
<li><div class="src-line"><a name="a127"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_display_line_links">string_display_line_links</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a128"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a129"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_display_line">string_display_line</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a130"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_insert_hrefs">string_insert_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a131"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a132"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a133"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a134"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a135"></a><span class="src-doc">/**&nbsp;Prepare&nbsp;a&nbsp;string&nbsp;for&nbsp;display&nbsp;in&nbsp;rss&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a136"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_rss_links">string_rss_links</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a137"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a138"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;rss&nbsp;can&nbsp;not&nbsp;start&nbsp;with&nbsp;&amp;nbsp;&nbsp;which&nbsp;spaces&nbsp;will&nbsp;be&nbsp;replaced&nbsp;into&nbsp;by&nbsp;string_display().</span></div></li>
<li><div class="src-line"><a name="a139"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/trim">trim</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a140"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a141"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;same&nbsp;steps&nbsp;as&nbsp;string_display_links()&nbsp;without&nbsp;the&nbsp;preservation&nbsp;of&nbsp;spaces&nbsp;since&nbsp;&amp;nbsp;&nbsp;is&nbsp;undefined&nbsp;in&nbsp;XML.</span></div></li>
<li><div class="src-line"><a name="a142"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_strip_hrefs">string_strip_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a143"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_html_specialchars">string_html_specialchars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a144"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_restore_valid_html_tags">string_restore_valid_html_tags</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a145"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_nl2br">string_nl2br</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a146"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_insert_hrefs">string_insert_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a147"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<span class="src-id">string_process_bug_link</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string</span><span class="src-sym">,&nbsp;</span><span class="src-comm">/*&nbsp;anchor&nbsp;*/&nbsp;</span><span class="src-id">true</span><span class="src-sym">,&nbsp;</span><span class="src-comm">/*&nbsp;detailInfo&nbsp;*/&nbsp;</span><span class="src-id">false</span><span class="src-sym">,&nbsp;</span><span class="src-comm">/*&nbsp;fqdn&nbsp;*/&nbsp;</span><span class="src-id">true&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a148"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<span class="src-id">string_process_bugnote_link</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string</span><span class="src-sym">,&nbsp;</span><span class="src-comm">/*&nbsp;anchor&nbsp;*/&nbsp;</span><span class="src-id">true</span><span class="src-sym">,&nbsp;</span><span class="src-comm">/*&nbsp;detailInfo&nbsp;*/&nbsp;</span><span class="src-id">false</span><span class="src-sym">,&nbsp;</span><span class="src-comm">/*&nbsp;fqdn&nbsp;*/&nbsp;</span><span class="src-id">true&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a149"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<span class="src-id">string_process_cvs_link</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a150"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;another&nbsp;escaping&nbsp;to&nbsp;escape&nbsp;the&nbsp;special&nbsp;characters&nbsp;created&nbsp;by&nbsp;the&nbsp;generated&nbsp;links</span></div></li>
<li><div class="src-line"><a name="a151"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_html_specialchars">string_html_specialchars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a152"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a153"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$t_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a154"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a155"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a156"></a>&nbsp;&nbsp;&nbsp;</div></li>
<li><div class="src-line"><a name="a157"></a><span class="src-doc">/**&nbsp;Prepare&nbsp;a&nbsp;string&nbsp;for&nbsp;plain&nbsp;text&nbsp;display&nbsp;in&nbsp;email&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a158"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_email">string_email</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a159"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a160"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_strip_hrefs">string_strip_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a161"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a162"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a163"></a>&nbsp;&nbsp;</div></li>
<li><div class="src-line"><a name="a164"></a><span class="src-doc">/**&nbsp;&nbsp;Prepare&nbsp;a&nbsp;string&nbsp;for&nbsp;plain&nbsp;text&nbsp;display&nbsp;in&nbsp;email&nbsp;and&nbsp;add&nbsp;URLs&nbsp;for&nbsp;bug</span></div></li>
<li><div class="src-line"><a name="a165"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;links&nbsp;and&nbsp;cvs&nbsp;links</span></div></li>
<li><div class="src-line"><a name="a166"></a><span class="src-doc">*/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div></li>
<li><div class="src-line"><a name="a167"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_email_links">string_email_links</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a168"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_email">string_email</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a169"></a>&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a170"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a171"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a172"></a><span class="src-doc">/**&nbsp;Process&nbsp;a&nbsp;string&nbsp;for&nbsp;display&nbsp;in&nbsp;a&nbsp;textarea&nbsp;box&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a173"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_textarea">string_textarea</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a174"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a175"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_html_specialchars">string_html_specialchars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a176"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a177"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a178"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a179"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a180"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Process&nbsp;a&nbsp;string&nbsp;for&nbsp;display&nbsp;in&nbsp;a&nbsp;text&nbsp;box</span></div></li>
<li><div class="src-line"><a name="a181"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_attribute">string_attribute</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a182"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="../Testlink/_string_api.php.html#functionstring_html_specialchars">string_html_specialchars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a183"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a184"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a185"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a186"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a187"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a188"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Process&nbsp;a&nbsp;string&nbsp;for&nbsp;inclusion&nbsp;in&nbsp;a&nbsp;URL&nbsp;as&nbsp;a&nbsp;GET&nbsp;parameter</span></div></li>
<li><div class="src-line"><a name="a189"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_url">string_url</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a190"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/rawurlencode">rawurlencode</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a191"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a192"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a193"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a194"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a195"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a196"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;validate&nbsp;the&nbsp;url&nbsp;as&nbsp;part&nbsp;of&nbsp;this&nbsp;site&nbsp;before&nbsp;continuing</span></div></li>
<li><div class="src-line"><a name="a197"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_sanitize_url">string_sanitize_url</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_url&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a198"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a199"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_url&nbsp;</span>=&nbsp;<a href="http://www.php.net/strip_tags">strip_tags</a><span class="src-sym">(&nbsp;</span><a href="http://www.php.net/urldecode">urldecode</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_url&nbsp;</span><span class="src-sym">)&nbsp;)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a200"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(&nbsp;</span><span class="src-str">'?http(s)*://?'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_url&nbsp;</span><span class="src-sym">)&nbsp;</span>&gt;&nbsp;<span class="src-num">0&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{&nbsp;</span></div></li>
<li><div class="src-line"><a name="a201"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//&nbsp;no&nbsp;embedded&nbsp;addresses</span></div></li>
<li><div class="src-line"><a name="a202"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(&nbsp;</span><span class="src-str">'?^'&nbsp;</span>.&nbsp;<a href="../Testlink/_common.php.html#functionconfig_get">config_get</a><span class="src-sym">(&nbsp;</span><span class="src-str">'path'&nbsp;</span><span class="src-sym">)&nbsp;</span>.&nbsp;<span class="src-str">'?'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_url&nbsp;</span><span class="src-sym">)&nbsp;</span>==&nbsp;<span class="src-num">0&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{&nbsp;</span></div></li>
<li><div class="src-line"><a name="a203"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//&nbsp;url&nbsp;is&nbsp;ok&nbsp;if&nbsp;it&nbsp;begins&nbsp;with&nbsp;our&nbsp;path,&nbsp;if&nbsp;not,&nbsp;replace&nbsp;it</span></div></li>
<li><div class="src-line"><a name="a204"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_url&nbsp;</span>=&nbsp;<span class="src-str">'index.php'</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a205"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a206"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a207"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_url&nbsp;</span>==&nbsp;<span class="src-str">''&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a208"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_url&nbsp;</span>=&nbsp;<span class="src-str">'index.php'</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a209"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a210"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></li>
<li><div class="src-line"><a name="a211"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//&nbsp;split&nbsp;and&nbsp;encode&nbsp;parameters</span></div></li>
<li><div class="src-line"><a name="a212"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_url</span><span class="src-sym">,&nbsp;</span><span class="src-str">'?'&nbsp;</span><span class="src-sym">)&nbsp;</span>!==&nbsp;<span class="src-id">FALSE&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a213"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list<span class="src-sym">(&nbsp;</span><span class="src-var">$t_path</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_param&nbsp;</span><span class="src-sym">)&nbsp;</span>=&nbsp;<a href="http://www.php.net/split">split</a><span class="src-sym">(&nbsp;</span><span class="src-str">'\?'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_url</span><span class="src-sym">,&nbsp;</span><span class="src-num">2&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a214"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_param&nbsp;</span>!==&nbsp;<span class="src-str">&quot;&quot;&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a215"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_vals&nbsp;</span>=&nbsp;<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a216"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/parse_str">parse_str</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_param</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_vals&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a217"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_param&nbsp;</span>=&nbsp;<span class="src-str">''</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a218"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$t_vals&nbsp;</span><span class="src-key">as&nbsp;</span><span class="src-var">$k&nbsp;</span>=&gt;&nbsp;<span class="src-var">$v</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a219"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-var">$t_param&nbsp;</span>!=&nbsp;<span class="src-str">''</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a220"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_param&nbsp;</span>.=&nbsp;<span class="src-str">'&amp;'</span><span class="src-sym">;&nbsp;</span></div></li>
<li><div class="src-line"><a name="a221"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a222"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_param&nbsp;</span>.=&nbsp;<span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$k</span>=</span><span class="src-str">&quot;&nbsp;</span>.&nbsp;<a href="http://www.php.net/urlencode">urlencode</a><span class="src-sym">(&nbsp;</span><a href="http://www.php.net/strip_tags">strip_tags</a><span class="src-sym">(&nbsp;</span><a href="http://www.php.net/urldecode">urldecode</a><span class="src-sym">(&nbsp;</span><span class="src-var">$v&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a223"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a224"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$t_path&nbsp;</span>.&nbsp;<span class="src-str">'?'&nbsp;</span>.&nbsp;<span class="src-var">$t_param</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a225"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">else&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a226"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$t_path</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a227"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a228"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">else&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a229"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$t_url</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a230"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a231"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a232"></a>&nbsp;&nbsp;&nbsp;&nbsp;</div></li>
<li><div class="src-line"><a name="a233"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a234"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a235"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#===================================</span></div></li>
<li><div class="src-line"><a name="a236"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Tag&nbsp;Processing</span></div></li>
<li><div class="src-line"><a name="a237"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#===================================</span></div></li>
<li><div class="src-line"><a name="a238"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a239"></a><span class="src-doc">/**&nbsp;Detect&nbsp;URLs&nbsp;and&nbsp;email&nbsp;addresses&nbsp;in&nbsp;the&nbsp;string&nbsp;and&nbsp;replace&nbsp;them&nbsp;with&nbsp;href&nbsp;anchors&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a240"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_insert_hrefs">string_insert_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a241"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a242"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-sym">!</span><a href="../Testlink/_common.php.html#functionconfig_get">config_get</a><span class="src-sym">(</span><span class="src-str">'html_make_links'</span><span class="src-sym">)&nbsp;)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a243"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a244"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a245"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a246"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_change_quotes&nbsp;</span>=&nbsp;<span class="src-id">false</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a247"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if</span><span class="src-sym">(&nbsp;</span><a href="../Testlink/_common.php.html#functionini_get_bool">ini_get_bool</a><span class="src-sym">(&nbsp;</span><span class="src-str">'magic_quotes_sybase'&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a248"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_change_quotes&nbsp;</span>=&nbsp;<span class="src-id">true</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a249"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/ini_set">ini_set</a><span class="src-sym">(&nbsp;</span><span class="src-str">'magic_quotes_sybase'</span><span class="src-sym">,&nbsp;</span><span class="src-id">false&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a250"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a251"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a252"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Find&nbsp;any&nbsp;URL&nbsp;in&nbsp;a&nbsp;string&nbsp;and&nbsp;replace&nbsp;it&nbsp;by&nbsp;a&nbsp;clickable&nbsp;link</span></div></li>
<li><div class="src-line"><a name="a253"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(&nbsp;</span><span class="src-str">'/(([[:alpha:]][-+.[:alnum:]]*):\/\/(%[[:digit:]A-Fa-f]{2}|[-_.!~*\';\/?%^\\\\:@&amp;={\|}+$#\(\),\[\][:alnum:]])+)/se'</span><span class="src-sym">,</span></div></li>
<li><div class="src-line"><a name="a254"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">&quot;'&lt;a&nbsp;href=\&quot;'.rtrim('\\1','.').'\&quot;&gt;\\1&lt;/a&gt;&nbsp;[&lt;a&nbsp;href=\&quot;'.rtrim('\\1','.').'\&quot;&nbsp;target=\&quot;_blank\&quot;&gt;^&lt;/a&gt;]'&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a255"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></li>
<li><div class="src-line"><a name="a256"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_change_quotes&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a257"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/ini_set">ini_set</a><span class="src-sym">(&nbsp;</span><span class="src-str">'magic_quotes_sybase'</span><span class="src-sym">,&nbsp;</span><span class="src-id">true&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a258"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a259"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a260"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Set&nbsp;up&nbsp;a&nbsp;simple&nbsp;subset&nbsp;of&nbsp;RFC&nbsp;822&nbsp;email&nbsp;address&nbsp;parsing</span></div></li>
<li><div class="src-line"><a name="a261"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;We&nbsp;don't&nbsp;allow&nbsp;domain&nbsp;literals&nbsp;or&nbsp;quoted&nbsp;strings</span></div></li>
<li><div class="src-line"><a name="a262"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;We&nbsp;also&nbsp;don't&nbsp;allow&nbsp;the&nbsp;&amp;&nbsp;character&nbsp;in&nbsp;domains&nbsp;even&nbsp;though&nbsp;the&nbsp;RFC</span></div></li>
<li><div class="src-line"><a name="a263"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;appears&nbsp;to&nbsp;do&nbsp;so.&nbsp;&nbsp;This&nbsp;was&nbsp;to&nbsp;prevent&nbsp;&amp;gt;&nbsp;etc&nbsp;from&nbsp;being&nbsp;included.</span></div></li>
<li><div class="src-line"><a name="a264"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;Note:&nbsp;we&nbsp;could&nbsp;use&nbsp;email_get_rfc822_regex()&nbsp;but&nbsp;it&nbsp;doesn't&nbsp;work&nbsp;well</span></div></li>
<li><div class="src-line"><a name="a265"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;when&nbsp;applied&nbsp;to&nbsp;data&nbsp;that&nbsp;has&nbsp;already&nbsp;had&nbsp;entities&nbsp;inserted.</span></div></li>
<li><div class="src-line"><a name="a266"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#</span></div></li>
<li><div class="src-line"><a name="a267"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;bpfennig:&nbsp;'@'&nbsp;doesn't&nbsp;accepted&nbsp;anymore</span></div></li>
<li><div class="src-line"><a name="a268"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;achumakov:&nbsp;characters&nbsp;0x80-0xFF&nbsp;aren't&nbsp;acceptable,&nbsp;too</span></div></li>
<li><div class="src-line"><a name="a269"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_atom&nbsp;</span>=&nbsp;<span class="src-str">'[^\'@\'](?:[^()&lt;&gt;@,;:\\\&quot;.\[\]\000-\037\177-\377&nbsp;&amp;]+)'</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a270"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a271"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;In&nbsp;order&nbsp;to&nbsp;avoid&nbsp;selecting&nbsp;URLs&nbsp;containing&nbsp;@&nbsp;characters&nbsp;as&nbsp;email</span></div></li>
<li><div class="src-line"><a name="a272"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;addresses&nbsp;we&nbsp;limit&nbsp;our&nbsp;selection&nbsp;to&nbsp;addresses&nbsp;that&nbsp;are&nbsp;preceded&nbsp;by:</span></div></li>
<li><div class="src-line"><a name="a273"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;string</span></div></li>
<li><div class="src-line"><a name="a274"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;a&nbsp;&amp;lt;&nbsp;entity&nbsp;(allowing&nbsp;'&lt;foo@bar.baz&gt;')</span></div></li>
<li><div class="src-line"><a name="a275"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;whitespace</span></div></li>
<li><div class="src-line"><a name="a276"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;a&nbsp;:&nbsp;(allowing&nbsp;'send&nbsp;email&nbsp;to:foo@bar.baz')</span></div></li>
<li><div class="src-line"><a name="a277"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;a&nbsp;\n,&nbsp;\r,&nbsp;or&nbsp;&gt;&nbsp;(because&nbsp;newlines&nbsp;have&nbsp;been&nbsp;replaced&nbsp;with&nbsp;&lt;br&nbsp;/&gt;</span></div></li>
<li><div class="src-line"><a name="a278"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;&gt;&nbsp;isn't&nbsp;valid&nbsp;in&nbsp;URLs&nbsp;anyway</span></div></li>
<li><div class="src-line"><a name="a279"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#</span></div></li>
<li><div class="src-line"><a name="a280"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;At&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;string&nbsp;we&nbsp;allow&nbsp;the&nbsp;opposite:</span></div></li>
<li><div class="src-line"><a name="a281"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;string</span></div></li>
<li><div class="src-line"><a name="a282"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;a&nbsp;&amp;gt;&nbsp;entity</span></div></li>
<li><div class="src-line"><a name="a283"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;whitespace</span></div></li>
<li><div class="src-line"><a name="a284"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;a&nbsp;,&nbsp;character&nbsp;(allowing&nbsp;'email&nbsp;foo@bar.baz,&nbsp;or&nbsp;...')</span></div></li>
<li><div class="src-line"><a name="a285"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;*&nbsp;a&nbsp;\n,&nbsp;\r,&nbsp;or&nbsp;&lt;</span></div></li>
<li><div class="src-line"><a name="a286"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a287"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(&nbsp;</span><span class="src-str">'/(?&lt;=^|&amp;quot;|&amp;lt;|[\s\:\&gt;\n\r])('</span>.<span class="src-var">$t_atom</span>.<span class="src-str">'(?:\.'</span>.<span class="src-var">$t_atom</span>.<span class="src-str">')*\@'</span>.<span class="src-var">$t_atom</span>.<span class="src-str">'(?:\.'</span>.<span class="src-var">$t_atom</span>.<span class="src-str">')*)(?=$|&amp;quot;|&amp;gt;|[\s\,\&lt;\n\r])/s'</span><span class="src-sym">,</span></div></li>
<li><div class="src-line"><a name="a288"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">'&lt;a&nbsp;href=&quot;mailto:\1&quot;&gt;\1&lt;/a&gt;'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a289"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a290"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a291"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a292"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a293"></a><span class="src-doc">/**&nbsp;Detect&nbsp;href&nbsp;anchors&nbsp;in&nbsp;the&nbsp;string&nbsp;and&nbsp;replace&nbsp;them&nbsp;with&nbsp;URLs&nbsp;and&nbsp;email&nbsp;addresses&nbsp;*/</span></div></li>
<li><div class="src-line"><a name="a294"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_strip_hrefs">string_strip_hrefs</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a295"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a296"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;First&nbsp;grab&nbsp;mailto:&nbsp;hrefs.&nbsp;&nbsp;We&nbsp;don't&nbsp;care&nbsp;whether&nbsp;the&nbsp;URL&nbsp;is&nbsp;actually</span></div></li>
<li><div class="src-line"><a name="a297"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;correct&nbsp;-&nbsp;just&nbsp;that&nbsp;it's&nbsp;inside&nbsp;an&nbsp;href&nbsp;attribute.</span></div></li>
<li><div class="src-line"><a name="a298"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(&nbsp;</span><span class="src-str">'/&lt;a\s[^\&gt;]*href=&quot;mailto:([^\&quot;]+)&quot;[^\&gt;]*&gt;[^\&lt;]*&lt;\/a&gt;/si'</span><span class="src-sym">,</span></div></li>
<li><div class="src-line"><a name="a299"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">'\1'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a300"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a301"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Then&nbsp;grab&nbsp;any&nbsp;other&nbsp;href</span></div></li>
<li><div class="src-line"><a name="a302"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(&nbsp;</span><span class="src-str">'/&lt;a\s[^\&gt;]*href=&quot;([^\&quot;]+)&quot;[^\&gt;]*&gt;[^\&lt;]*&lt;\/a&gt;/si'</span><span class="src-sym">,</span></div></li>
<li><div class="src-line"><a name="a303"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">'\1'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a304"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a305"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a306"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a307"></a><span class="src-comm">#&nbsp;This&nbsp;function&nbsp;looks&nbsp;for&nbsp;text&nbsp;with&nbsp;htmlentities</span></div></li>
<li><div class="src-line"><a name="a308"></a><span class="src-comm">#&nbsp;like&nbsp;&amp;lt;b&amp;gt;&nbsp;and&nbsp;converts&nbsp;is&nbsp;into&nbsp;corresponding</span></div></li>
<li><div class="src-line"><a name="a309"></a><span class="src-comm">#&nbsp;html&nbsp;&lt;b&gt;&nbsp;based&nbsp;on&nbsp;the&nbsp;configuration&nbsp;presets</span></div></li>
<li><div class="src-line"><a name="a310"></a><span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_restore_valid_html_tags">string_restore_valid_html_tags</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_multiline&nbsp;</span>=&nbsp;<span class="src-id">true&nbsp;</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a311"></a><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a312"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_html_valid_tags&nbsp;</span>=&nbsp;<a href="../Testlink/_common.php.html#functionconfig_get">config_get</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_multiline&nbsp;</span>?&nbsp;<span class="src-str">'html_valid_tags'&nbsp;</span>:&nbsp;<span class="src-str">'html_valid_tags_single_line'&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a313"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a314"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-id">OFF&nbsp;</span>===&nbsp;<span class="src-var">$t_html_valid_tags&nbsp;</span>||&nbsp;<a href="../Testlink/_common.php.html#functionis_blank">is_blank</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_html_valid_tags&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a315"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a316"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a317"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a318"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$tags&nbsp;</span>=&nbsp;<a href="http://www.php.net/explode">explode</a><span class="src-sym">(&nbsp;</span><span class="src-str">','</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_html_valid_tags&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a319"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">foreach&nbsp;</span><span class="src-sym">(</span><span class="src-var">$tags&nbsp;</span><span class="src-key">as&nbsp;</span><span class="src-var">$key&nbsp;</span>=&gt;&nbsp;<span class="src-var">$value</span><span class="src-sym">)&nbsp;</span></div></li>
<li><div class="src-line"><a name="a320"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{&nbsp;</span></div></li>
<li><div class="src-line"><a name="a321"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-sym">!</span><a href="../Testlink/_common.php.html#functionis_blank">is_blank</a><span class="src-sym">(&nbsp;</span><span class="src-var">$value&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a322"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$tags</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]&nbsp;</span>=&nbsp;<a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;&nbsp;</span></div></li>
<li><div class="src-line"><a name="a323"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a324"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a325"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$tags&nbsp;</span>=&nbsp;<a href="http://www.php.net/implode">implode</a><span class="src-sym">(&nbsp;</span><span class="src-str">'|'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$tags</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a326"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a327"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/eregi_replace">eregi_replace</a><span class="src-sym">(&nbsp;</span><span class="src-str">'&amp;lt;('&nbsp;</span>.&nbsp;<span class="src-var">$tags&nbsp;</span>.&nbsp;<span class="src-str">')[[:space:]]*&amp;gt;'</span><span class="src-sym">,&nbsp;</span><span class="src-str">'&lt;\\1&gt;'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a328"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/eregi_replace">eregi_replace</a><span class="src-sym">(&nbsp;</span><span class="src-str">'&amp;lt;\/('&nbsp;</span>.<span class="src-var">$tags&nbsp;</span>.&nbsp;<span class="src-str">')[[:space:]]*&amp;gt;'</span><span class="src-sym">,&nbsp;</span><span class="src-str">'&lt;/\\1&gt;'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a329"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$p_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/eregi_replace">eregi_replace</a><span class="src-sym">(&nbsp;</span><span class="src-str">'&amp;lt;('&nbsp;</span>.&nbsp;<span class="src-var">$tags&nbsp;</span>.&nbsp;<span class="src-str">')[[:space:]]*\/&amp;gt;'</span><span class="src-sym">,&nbsp;</span><span class="src-str">'&lt;\\1&nbsp;/&gt;'</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a330"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a331"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a332"></a><span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a333"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a334"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a335"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a336"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Return&nbsp;a&nbsp;string&nbsp;with&nbsp;the&nbsp;$p_character&nbsp;pattern&nbsp;repeated&nbsp;N&nbsp;times.</span></div></li>
<li><div class="src-line"><a name="a337"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;$p_character&nbsp;-&nbsp;pattern&nbsp;to&nbsp;repeat</span></div></li>
<li><div class="src-line"><a name="a338"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;$p_repeats&nbsp;-&nbsp;number&nbsp;of&nbsp;times&nbsp;to&nbsp;repeat.</span></div></li>
<li><div class="src-line"><a name="a339"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_repeat_char">string_repeat_char</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_character</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_repeats&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a340"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><a href="http://www.php.net/str_pad">str_pad</a><span class="src-sym">(&nbsp;</span><span class="src-str">''</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_repeats</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_character&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a341"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a342"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a343"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a344"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Format&nbsp;date&nbsp;for&nbsp;display</span></div></li>
<li><div class="src-line"><a name="a345"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//&nbsp;martin:&nbsp;@todo&nbsp;update&nbsp;and&nbsp;integrate</span></div></li>
<li><div class="src-line"><a name="a346"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_format_complete_date">string_format_complete_date</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_date&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a347"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_timestamp&nbsp;</span>=&nbsp;<span class="src-id">db_unixtimestamp</span><span class="src-sym">(&nbsp;</span><span class="src-var">$p_date&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a348"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><a href="http://www.php.net/date">date</a><span class="src-sym">(&nbsp;</span><a href="../Testlink/_common.php.html#functionconfig_get">config_get</a><span class="src-sym">(&nbsp;</span><span class="src-str">'complete_date_format'&nbsp;</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_timestamp&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a349"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a350"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a351"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a352"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Shorten&nbsp;a&nbsp;string&nbsp;for&nbsp;display&nbsp;on&nbsp;a&nbsp;dropdown&nbsp;to&nbsp;prevent&nbsp;the&nbsp;page&nbsp;rendering&nbsp;too&nbsp;wide</span></div></li>
<li><div class="src-line"><a name="a353"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;&nbsp;ref&nbsp;issues&nbsp;#4630,&nbsp;#5072,&nbsp;#5131</span></div></li>
<li><div class="src-line"><a name="a354"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a355"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_shorten">string_shorten</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a356"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_max&nbsp;</span>=&nbsp;<a href="../Testlink/_common.php.html#functionconfig_get">config_get</a><span class="src-sym">(&nbsp;</span><span class="src-str">'max_dropdown_length'&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a357"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;(&nbsp;</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span>&gt;&nbsp;<span class="src-var">$t_max&nbsp;</span><span class="src-sym">)&nbsp;</span>&amp;&amp;&nbsp;<span class="src-sym">(&nbsp;</span><span class="src-var">$t_max&nbsp;</span>&gt;&nbsp;<span class="src-num">0&nbsp;</span><span class="src-sym">)&nbsp;)</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a358"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_pattern&nbsp;</span>=&nbsp;<span class="src-str">'/([\s|.|,|\-|_|\/|\?]+)/'</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a359"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_bits&nbsp;</span>=&nbsp;<a href="http://www.php.net/preg_split">preg_split</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_pattern</span><span class="src-sym">,&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span>-<span class="src-num">1</span><span class="src-sym">,&nbsp;</span><span class="src-id">PREG_SPLIT_DELIM_CAPTURE&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a360"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a361"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<span class="src-str">''</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a362"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_last&nbsp;</span>=&nbsp;<span class="src-var">$t_bits</span><span class="src-sym">[&nbsp;</span><a href="http://www.php.net/count">count</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_bits&nbsp;</span><span class="src-sym">)&nbsp;</span>-&nbsp;<span class="src-num">1&nbsp;</span><span class="src-sym">]</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a363"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_last_len&nbsp;</span>=&nbsp;<a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_last&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a364"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a365"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">foreach&nbsp;</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_bits&nbsp;</span><span class="src-key">as&nbsp;</span><span class="src-var">$t_bit&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a366"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;(&nbsp;</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)&nbsp;</span>+&nbsp;<a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_bit&nbsp;</span><span class="src-sym">)&nbsp;</span>+&nbsp;<span class="src-var">$t_last_len&nbsp;</span>+&nbsp;<span class="src-num">3&nbsp;</span>&lt;=&nbsp;<span class="src-var">$t_max&nbsp;</span><span class="src-sym">)</span></div></li>
<li><div class="src-line"><a name="a367"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;<span class="src-sym">(&nbsp;</span><a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(&nbsp;</span><span class="src-var">$t_bit</span><span class="src-sym">,&nbsp;</span><span class="src-str">'.,-/?'&nbsp;</span><span class="src-sym">)&nbsp;</span>&gt;&nbsp;<span class="src-num">0&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a368"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>.=&nbsp;<span class="src-var">$t_bit</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a369"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">else&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a370"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">break</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a371"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a372"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a373"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>.=&nbsp;<span class="src-str">'...'&nbsp;</span>.&nbsp;<span class="src-var">$t_last</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a374"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$t_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a375"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">else&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a376"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a377"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a378"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a379"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a380"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a381"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;remap&nbsp;a&nbsp;field&nbsp;name&nbsp;to&nbsp;a&nbsp;string&nbsp;name&nbsp;(for&nbsp;sort&nbsp;filter)</span></div></li>
<li><div class="src-line"><a name="a382"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a383"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_get_field_name">string_get_field_name</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a384"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a385"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_map&nbsp;</span>=&nbsp;<span class="src-key">array</span><span class="src-sym">(</span></div></li>
<li><div class="src-line"><a name="a386"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">'last_updated'&nbsp;</span>=&gt;&nbsp;<span class="src-str">'last_update'</span><span class="src-sym">,</span></div></li>
<li><div class="src-line"><a name="a387"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">'id'&nbsp;</span>=&gt;&nbsp;<span class="src-str">'email_bug'</span></div></li>
<li><div class="src-line"><a name="a388"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a389"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a390"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a391"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;</span>isset<span class="src-sym">(&nbsp;</span><span class="src-var">$t_map</span><span class="src-sym">[&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">]&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a392"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<span class="src-var">$t_map</span><span class="src-sym">[&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">]</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a393"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a394"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-id">lang_get_defaulted</span><span class="src-sym">(&nbsp;</span><span class="src-var">$t_string&nbsp;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a395"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a396"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a397"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a398"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Calls&nbsp;htmlentities&nbsp;on&nbsp;the&nbsp;specified&nbsp;string,&nbsp;passing&nbsp;along</span></div></li>
<li><div class="src-line"><a name="a399"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;the&nbsp;current&nbsp;charset.</span></div></li>
<li><div class="src-line"><a name="a400"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_html_entities">string_html_entities</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a401"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><a href="http://www.php.net/htmlentities">htmlentities</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-id">ENT_COMPAT</span><span class="src-sym">,&nbsp;</span><a href="../Testlink/_common.php.html#functionconfig_get">config_get</a><span class="src-sym">(</span><span class="src-str">'charset'</span><span class="src-sym">)&nbsp;)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a402"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a403"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a404"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a405"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Calls&nbsp;htmlspecialchars&nbsp;on&nbsp;the&nbsp;specified&nbsp;string,&nbsp;passing&nbsp;along</span></div></li>
<li><div class="src-line"><a name="a406"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;the&nbsp;current&nbsp;charset,&nbsp;if&nbsp;the&nbsp;current&nbsp;PHP&nbsp;version&nbsp;supports&nbsp;it.</span></div></li>
<li><div class="src-line"><a name="a407"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_html_specialchars">string_html_specialchars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a408"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;achumakov:&nbsp;@&nbsp;added&nbsp;to&nbsp;avoid&nbsp;warning&nbsp;output&nbsp;in&nbsp;unsupported&nbsp;codepages</span></div></li>
<li><div class="src-line"><a name="a409"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;e.g.&nbsp;8859-2,&nbsp;windows-1257,&nbsp;Korean,&nbsp;which&nbsp;are&nbsp;treated&nbsp;as&nbsp;8859-1.</span></div></li>
<li><div class="src-line"><a name="a410"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;This&nbsp;is&nbsp;VERY&nbsp;important&nbsp;for&nbsp;Eastern&nbsp;European,&nbsp;Baltic&nbsp;and&nbsp;Korean&nbsp;languages</span></div></li>
<li><div class="src-line"><a name="a411"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/&amp;amp;(#[0-9]+|[a-z]+);/i&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;&amp;$1;&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-sym">@</span><a href="http://www.php.net/htmlspecialchars">htmlspecialchars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-id">ENT_COMPAT</span><span class="src-sym">,&nbsp;</span><a href="../Testlink/_common.php.html#functionconfig_get">config_get</a><span class="src-sym">(</span><span class="src-str">'charset'</span><span class="src-sym">)&nbsp;)&nbsp;)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a412"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a413"></a>&nbsp;&nbsp;&nbsp;&nbsp;</div></li>
<li><div class="src-line"><a name="a414"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a415"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Prepares&nbsp;a&nbsp;string&nbsp;to&nbsp;be&nbsp;used&nbsp;as&nbsp;part&nbsp;of&nbsp;header().</span></div></li>
<li><div class="src-line"><a name="a416"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_prepare_header">string_prepare_header</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a417"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<span class="src-var">$p_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a418"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a419"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_truncate_pos&nbsp;</span>=&nbsp;<a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a420"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-var">$t_truncate_pos&nbsp;</span>!==&nbsp;<span class="src-id">false&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a421"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$t_string</span><span class="src-sym">,&nbsp;</span><span class="src-num">0</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_truncate_pos</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a422"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a423"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a424"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_truncate_pos&nbsp;</span>=&nbsp;<a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;\r&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a425"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-var">$t_truncate_pos&nbsp;</span>!==&nbsp;<span class="src-id">false&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a426"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$t_string&nbsp;</span>=&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$t_string</span><span class="src-sym">,&nbsp;</span><span class="src-num">0</span><span class="src-sym">,&nbsp;</span><span class="src-var">$t_truncate_pos</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a427"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a428"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a429"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-var">$t_string</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a430"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a431"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a432"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;--------------------</span></div></li>
<li><div class="src-line"><a name="a433"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">#&nbsp;Checks&nbsp;the&nbsp;supplied&nbsp;string&nbsp;for&nbsp;scripting&nbsp;characters,&nbsp;if&nbsp;it&nbsp;contains&nbsp;any,&nbsp;then&nbsp;return&nbsp;true,&nbsp;otherwise&nbsp;return&nbsp;false.</span></div></li>
<li><div class="src-line"><a name="a434"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../Testlink/_string_api.php.html#functionstring_contains_scripting_chars">string_contains_scripting_chars</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string&nbsp;</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a435"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(&nbsp;(&nbsp;</span><a href="http://www.php.net/strstr">strstr</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-str">'&lt;'&nbsp;</span><span class="src-sym">)&nbsp;</span>!==&nbsp;<span class="src-id">false&nbsp;</span><span class="src-sym">)&nbsp;</span>||&nbsp;<span class="src-sym">(&nbsp;</span><a href="http://www.php.net/strstr">strstr</a><span class="src-sym">(&nbsp;</span><span class="src-var">$p_string</span><span class="src-sym">,&nbsp;</span><span class="src-str">'&gt;'&nbsp;</span><span class="src-sym">)&nbsp;</span>!==&nbsp;<span class="src-id">false&nbsp;</span><span class="src-sym">)&nbsp;)&nbsp;</span><span class="src-sym">{</span></div></li>
<li><div class="src-line"><a name="a436"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-id">true</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a437"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a438"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a439"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return&nbsp;</span><span class="src-id">false</span><span class="src-sym">;</span></div></li>
<li><div class="src-line"><a name="a440"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li><div class="src-line"><a name="a441"></a><span class="src-php">?&gt;</span></div></li>
</ol>
</span></div>
        <div class="credit">
		    <hr class="separator" />
		    Documentation generated on Fri, 03 Apr 2009 14:13:50 +0200 by <a href="http://www.phpdoc.org">phpDocumentor 1.4.1</a>
	      </div>
      </td></tr></table>
    </td>
  </tr>
</table>

</body>
</html>