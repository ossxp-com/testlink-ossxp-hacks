From: Jiang <jiangxin@ossxp.com>
Subject: [PATCH] t/php5_thirdparty_upgrade

Upgrade thirdparty libs, such as adodb5.

Signed-off-by: Jiang <jiangxin@ossxp.com>

---
 third_party/adodb/adodb-active-record.inc.php      |  376 +-
 third_party/adodb/adodb-active-recordx.inc.php     | 1421 +++
 third_party/adodb/adodb-csvlib.inc.php             |    7 +-
 third_party/adodb/adodb-datadict.inc.php           |   21 +-
 third_party/adodb/adodb-error.inc.php              |    2 +-
 third_party/adodb/adodb-errorhandler.inc.php       |    2 +-
 third_party/adodb/adodb-errorpear.inc.php          |    2 +-
 third_party/adodb/adodb-exceptions.inc.php         |    2 +-
 third_party/adodb/adodb-iterator.inc.php           |    2 +-
 third_party/adodb/adodb-lib.inc.php                |   37 +-
 third_party/adodb/adodb-memcache.lib.inc.php       |  246 +-
 third_party/adodb/adodb-pager.inc.php              |    4 +-
 third_party/adodb/adodb-pear.inc.php               |    4 +-
 third_party/adodb/adodb-perf.inc.php               |   97 +-
 third_party/adodb/adodb-php4.inc.php               |    2 +-
 third_party/adodb/adodb-time.inc.php               |    3 +-
 third_party/adodb/adodb-xmlschema.inc.php          |   12 +-
 third_party/adodb/adodb-xmlschema03.inc.php        |   13 +-
 third_party/adodb/adodb.inc.php                    |  438 +-
 third_party/adodb/contrib/toxmlrpc.inc.php         |  364 +-
 third_party/adodb/datadict/datadict-access.inc.php |    7 +-
 third_party/adodb/datadict/datadict-db2.inc.php    |    5 +-
 .../adodb/datadict/datadict-firebird.inc.php       |    5 +-
 .../adodb/datadict/datadict-generic.inc.php        |    3 +-
 third_party/adodb/datadict/datadict-ibase.inc.php  |    3 +-
 .../adodb/datadict/datadict-informix.inc.php       |    5 +-
 third_party/adodb/datadict/datadict-mssql.inc.php  |    8 +-
 .../adodb/datadict/datadict-mssqlnative.inc.php    |  282 +
 third_party/adodb/datadict/datadict-mysql.inc.php  |    5 +-
 third_party/adodb/datadict/datadict-oci8.inc.php   |   27 +-
 .../adodb/datadict/datadict-postgres.inc.php       |    5 +-
 third_party/adodb/datadict/datadict-sapdb.inc.php  |    5 +-
 third_party/adodb/datadict/datadict-sybase.inc.php |    5 +-
 third_party/adodb/docs/docs-active-record.htm      |  626 +-
 third_party/adodb/docs/docs-adodb.htm              |11243 +++++++++++++-------
 third_party/adodb/docs/docs-datadict.htm           |   12 +-
 third_party/adodb/docs/docs-oracle.htm             | 1084 +-
 third_party/adodb/docs/docs-perf.htm               |    4 +-
 third_party/adodb/docs/docs-session.htm            |    6 +-
 third_party/adodb/docs/docs-session.old.htm        |    2 +-
 third_party/adodb/docs/old-changelog.htm           | 1642 ++--
 third_party/adodb/docs/readme.htm                  |  136 +-
 third_party/adodb/docs/tips_portable_sql.htm       |  734 +-
 third_party/adodb/docs/tute.htm                    |  580 +-
 third_party/adodb/drivers/adodb-access.inc.php     |    2 +-
 third_party/adodb/drivers/adodb-ado.inc.php        |   28 +-
 third_party/adodb/drivers/adodb-ado5.inc.php       |   46 +-
 third_party/adodb/drivers/adodb-ado_access.inc.php |    7 +-
 third_party/adodb/drivers/adodb-ado_mssql.inc.php  |    4 +-
 third_party/adodb/drivers/adodb-ads.inc.php        |  796 ++
 .../adodb/drivers/adodb-borland_ibase.inc.php      |    2 +-
 third_party/adodb/drivers/adodb-csv.inc.php        |    4 +-
 third_party/adodb/drivers/adodb-db2.inc.php        |   70 +-
 third_party/adodb/drivers/adodb-db2oci.inc.php     |  230 +
 third_party/adodb/drivers/adodb-fbsql.inc.php      |    6 +-
 third_party/adodb/drivers/adodb-firebird.inc.php   |    2 +-
 third_party/adodb/drivers/adodb-ibase.inc.php      |    6 +-
 third_party/adodb/drivers/adodb-informix.inc.php   |    2 +-
 third_party/adodb/drivers/adodb-informix72.inc.php |   12 +-
 third_party/adodb/drivers/adodb-ldap.inc.php       |   18 +-
 third_party/adodb/drivers/adodb-mssql.inc.php      |   95 +-
 third_party/adodb/drivers/adodb-mssql_n.inc.php    |    4 +-
 .../adodb/drivers/adodb-mssqlnative.inc.php        |  922 ++
 third_party/adodb/drivers/adodb-mssqlpo.inc.php    |    4 +-
 third_party/adodb/drivers/adodb-mysql.inc.php      |   25 +-
 third_party/adodb/drivers/adodb-mysqli.inc.php     |  109 +-
 third_party/adodb/drivers/adodb-mysqlpo.inc.php    |    6 +-
 third_party/adodb/drivers/adodb-mysqlt.inc.php     |   14 +-
 third_party/adodb/drivers/adodb-netezza.inc.php    |    2 +-
 third_party/adodb/drivers/adodb-oci8.inc.php       |  120 +-
 third_party/adodb/drivers/adodb-oci805.inc.php     |    2 +-
 third_party/adodb/drivers/adodb-oci8po.inc.php     |    7 +-
 third_party/adodb/drivers/adodb-odbc.inc.php       |    4 +-
 third_party/adodb/drivers/adodb-odbc_db2.inc.php   |    6 +-
 third_party/adodb/drivers/adodb-odbc_mssql.inc.php |    8 +-
 .../adodb/drivers/adodb-odbc_oracle.inc.php        |    4 +-
 third_party/adodb/drivers/adodb-odbtp.inc.php      |   97 +-
 .../adodb/drivers/adodb-odbtp_unicode.inc.php      |    2 +-
 third_party/adodb/drivers/adodb-oracle.inc.php     |   16 +-
 third_party/adodb/drivers/adodb-pdo.inc.php        |   57 +-
 third_party/adodb/drivers/adodb-pdo_mssql.inc.php  |    6 +-
 third_party/adodb/drivers/adodb-pdo_mysql.inc.php  |   18 +-
 third_party/adodb/drivers/adodb-pdo_oci.inc.php    |    4 +-
 third_party/adodb/drivers/adodb-pdo_pgsql.inc.php  |    2 +-
 third_party/adodb/drivers/adodb-pdo_sqlite.inc.php |  203 +
 third_party/adodb/drivers/adodb-postgres.inc.php   |    2 +-
 third_party/adodb/drivers/adodb-postgres64.inc.php |   23 +-
 third_party/adodb/drivers/adodb-postgres7.inc.php  |   57 +-
 third_party/adodb/drivers/adodb-postgres8.inc.php  |    2 +-
 third_party/adodb/drivers/adodb-proxy.inc.php      |    2 +-
 third_party/adodb/drivers/adodb-sapdb.inc.php      |    2 +-
 .../adodb/drivers/adodb-sqlanywhere.inc.php        |    2 +-
 third_party/adodb/drivers/adodb-sqlite.inc.php     |    6 +-
 third_party/adodb/drivers/adodb-sqlitepo.inc.php   |    2 +-
 third_party/adodb/drivers/adodb-sybase.inc.php     |   46 +-
 third_party/adodb/drivers/adodb-sybase_ase.inc.php |    2 +-
 third_party/adodb/drivers/adodb-vfp.inc.php        |    2 +-
 third_party/adodb/lang/adodb-cn.inc.php            |   68 +-
 third_party/adodb/lang/adodb-cz.inc.php            |   78 +-
 third_party/adodb/lang/adodb-de.inc.php            |   64 +-
 third_party/adodb/lang/adodb-fa.inc.php            |   35 +
 third_party/adodb/lang/adodb-fr.inc.php            |   64 +-
 third_party/adodb/lang/adodb-it.inc.php            |   66 +-
 third_party/adodb/lang/adodb-ru1251.inc.php        |   68 +-
 third_party/adodb/lang/adodb-sv.inc.php            |   64 +-
 third_party/adodb/license.txt                      |  362 +-
 third_party/adodb/pear/Auth/Container/ADOdb.php    |   32 +-
 third_party/adodb/pear/readme.Auth.txt             |   40 +-
 third_party/adodb/perf/perf-db2.inc.php            |    2 +-
 third_party/adodb/perf/perf-informix.inc.php       |    2 +-
 third_party/adodb/perf/perf-mssql.inc.php          |    2 +-
 third_party/adodb/perf/perf-mssqlnative.inc.php    |  164 +
 third_party/adodb/perf/perf-mysql.inc.php          |    2 +-
 third_party/adodb/perf/perf-oci8.inc.php           |   26 +-
 third_party/adodb/perf/perf-postgres.inc.php       |    2 +-
 third_party/adodb/pivottable.inc.php               |    2 +-
 third_party/adodb/readme.txt                       |  122 +-
 third_party/adodb/rsfilter.inc.php                 |    2 +-
 third_party/adodb/server.php                       |    2 +-
 third_party/adodb/session/adodb-compress-bzip2.php |    2 +-
 third_party/adodb/session/adodb-compress-gzip.php  |    2 +-
 third_party/adodb/session/adodb-cryptsession.php   |    2 +-
 third_party/adodb/session/adodb-cryptsession2.php  |    2 +-
 third_party/adodb/session/adodb-encrypt-mcrypt.php |    2 +-
 third_party/adodb/session/adodb-encrypt-md5.php    |    2 +-
 third_party/adodb/session/adodb-encrypt-secret.php |    2 +-
 third_party/adodb/session/adodb-encrypt-sha1.php   |   62 +-
 third_party/adodb/session/adodb-sess.txt           |  262 +-
 third_party/adodb/session/adodb-session-clob.php   |    2 +-
 third_party/adodb/session/adodb-session-clob2.php  |    2 +-
 third_party/adodb/session/adodb-session.php        |    6 +-
 third_party/adodb/session/adodb-session2.php       |   86 +-
 .../adodb/session/old/adodb-cryptsession.php       |    2 +-
 .../adodb/session/old/adodb-session-clob.php       |    2 +-
 third_party/adodb/session/old/adodb-session.php    |    2 +-
 third_party/adodb/tests/benchmark.php              |    2 +-
 third_party/adodb/tests/client.php                 |    2 +-
 third_party/adodb/tests/pdo.php                    |  186 +-
 third_party/adodb/tests/test-active-record.php     |   71 +-
 third_party/adodb/tests/test-active-relations.php  |   87 +
 third_party/adodb/tests/test-active-relationsx.php |  419 +
 third_party/adodb/tests/test-datadict.php          |   10 +-
 third_party/adodb/tests/test-perf.php              |  100 +-
 third_party/adodb/tests/test-php5.php              |    2 +-
 third_party/adodb/tests/test.php                   |   21 +-
 third_party/adodb/tests/test2.php                  |   50 +-
 third_party/adodb/tests/test3.php                  |    2 +-
 third_party/adodb/tests/test4.php                  |    2 +-
 third_party/adodb/tests/test5.php                  |    2 +-
 third_party/adodb/tests/testcache.php              |    2 +-
 third_party/adodb/tests/testdatabases.inc.php      |   52 +-
 third_party/adodb/tests/testgenid.php              |   70 +-
 third_party/adodb/tests/testmssql.php              |    2 +-
 third_party/adodb/tests/testoci8.php               |    4 +-
 third_party/adodb/tests/testoci8cursor.php         |    2 +-
 third_party/adodb/tests/testpaging.php             |    2 +-
 third_party/adodb/tests/testpear.php               |    2 +-
 third_party/adodb/tests/testsessions.php           |   18 +-
 third_party/adodb/tests/tmssql.php                 |  158 +-
 third_party/adodb/toexport.inc.php                 |    7 +-
 third_party/adodb/tohtml.inc.php                   |   22 +-
 third_party/adodb/xmlschema03.dtd                  |   84 +-
 162 files changed, 18015 insertions(+), 7684 deletions(-)

diff --git a/third_party/adodb/adodb-active-record.inc.php b/third_party/adodb/adodb-active-record.inc.php
index 328eaa8..55a89bb 100644
--- a/third_party/adodb/adodb-active-record.inc.php
+++ b/third_party/adodb/adodb-active-record.inc.php
@@ -1,7 +1,7 @@
 <?php
 /*
 
-@version V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+@version V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Latest version is available at http://adodb.sourceforge.net
  
   Released under both BSD license and Lesser GPL library license. 
@@ -10,12 +10,13 @@
   
   Active Record implementation. Superset of Zend Framework's.
   
-  Version 0.08
+  Version 0.92
   
   See http://www-128.ibm.com/developerworks/java/library/j-cb03076/?ca=dgr-lnxw01ActiveRecord 
   	for info on Ruby on Rails Active Record implementation
 */
 
+
 global $_ADODB_ACTIVE_DBS;
 global $ADODB_ACTIVE_CACHESECS; // set to true to enable caching of metadata such as field info
 global $ACTIVE_RECORD_SAFETY; // set to false to disable safety checks
@@ -25,6 +26,7 @@ global $ADODB_ACTIVE_DEFVALS; // use default values of table definition when cre
 $_ADODB_ACTIVE_DBS = array();
 $ACTIVE_RECORD_SAFETY = true;
 $ADODB_ACTIVE_DEFVALS = false;
+$ADODB_ACTIVE_CACHESECS = 0;
 
 class ADODB_Active_DB {
 	var $db; // ADOConnection
@@ -36,10 +38,15 @@ class ADODB_Active_Table {
 	var $flds; // assoc array of adofieldobjs, indexed by fieldname
 	var $keys; // assoc array of primary keys, indexed by fieldname
 	var $_created; // only used when stored as a cached file
+	var $_belongsTo = array();
+	var $_hasMany = array();
 }
 
+// $db = database connection
+// $index = name of index - can be associative, for an example see
+//    http://phplens.com/lens/lensforum/msgs.php?id=17790 
 // returns index into $_ADODB_ACTIVE_DBS
-function ADODB_SetDatabaseAdapter(&$db)
+function ADODB_SetDatabaseAdapter(&$db, $index=false)
 {
 	global $_ADODB_ACTIVE_DBS;
 	
@@ -56,13 +63,20 @@ function ADODB_SetDatabaseAdapter(&$db)
 		$obj->db = $db;
 		$obj->tables = array();
 		
-		$_ADODB_ACTIVE_DBS[] = $obj;
+		if ($index == false) $index = sizeof($_ADODB_ACTIVE_DBS);
+
+		
+		$_ADODB_ACTIVE_DBS[$index] = $obj;
 		
 		return sizeof($_ADODB_ACTIVE_DBS)-1;
 }
 
 
 class ADODB_Active_Record {
+	static $_changeNames = true; // dynamically pluralize table names
+	static $_quoteNames = false;
+	
+	static $_foreignSuffix = '_id'; // 
 	var $_dbat; // associative index pointing to ADODB_Active_DB eg. $ADODB_Active_DBS[_dbat]
 	var $_table; // tablename, if set in class definition then use it as table name
 	var $_tableat; // associative index pointing to ADODB_Active_Table, eg $ADODB_Active_DBS[_dbat]->tables[$this->_tableat]
@@ -70,7 +84,9 @@ class ADODB_Active_Record {
 	var $_saved = false; // indicates whether data is already inserted.
 	var $_lasterr = false; // last error message
 	var $_original = false; // the original values loaded or inserted, refreshed on update
-	
+
+	var $foreignName; // CFR: class name when in a relationship
+
 	static function UseDefaultValues($bool=null)
 	{
 	global $ADODB_ACTIVE_DEFVALS;
@@ -79,9 +95,9 @@ class ADODB_Active_Record {
 	}
 
 	// should be static
-	static function SetDatabaseAdapter(&$db) 
+	static function SetDatabaseAdapter(&$db, $index=false) 
 	{
-		return ADODB_SetDatabaseAdapter($db);
+		return ADODB_SetDatabaseAdapter($db, $index);
 	}
 	
 	
@@ -105,16 +121,18 @@ class ADODB_Active_Record {
 			if (!empty($this->_table)) $table = $this->_table;
 			else $table = $this->_pluralize(get_class($this));
 		}
+		$this->foreignName = strtolower(get_class($this)); // CFR: default foreign name
 		if ($db) {
 			$this->_dbat = ADODB_Active_Record::SetDatabaseAdapter($db);
-		} else
-			$this->_dbat = sizeof($_ADODB_ACTIVE_DBS)-1;
-		
-		
-		if ($this->_dbat < 0) $this->Error("No database connection set; use ADOdb_Active_Record::SetDatabaseAdapter(\$db)",'ADODB_Active_Record::__constructor');
-		
+		} else if (!isset($this->_dbat)) {
+			if (sizeof($_ADODB_ACTIVE_DBS) == 0) $this->Error("No database connection set; use ADOdb_Active_Record::SetDatabaseAdapter(\$db)",'ADODB_Active_Record::__constructor');
+			end($_ADODB_ACTIVE_DBS);
+			$this->_dbat = key($_ADODB_ACTIVE_DBS);
+		}
+
 		$this->_table = $table;
 		$this->_tableat = $table; # reserved for setting the assoc value to a non-table name, eg. the sql string in future
+
 		$this->UpdateActiveTable($pkeyarr);
 	}
 	
@@ -126,6 +144,8 @@ class ADODB_Active_Record {
 	
 	function _pluralize($table)
 	{
+		if (!ADODB_Active_Record::$_changeNames) return $table;
+
 		$ut = strtoupper($table);
 		$len = strlen($table);
 		$lastc = $ut[$len-1];
@@ -145,13 +165,178 @@ class ADODB_Active_Record {
 		}
 	}
 	
+	// CFR Lamest singular inflector ever - @todo Make it real!
+	// Note: There is an assumption here...and it is that the argument's length >= 4
+	function _singularize($tables)
+	{
+	
+		if (!ADODB_Active_Record::$_changeNames) return $table;
+	
+		$ut = strtoupper($tables);
+		$len = strlen($tables);
+		if($ut[$len-1] != 'S')
+			return $tables; // I know...forget oxen
+		if($ut[$len-2] != 'E')
+			return substr($tables, 0, $len-1);
+		switch($ut[$len-3])
+		{
+			case 'S':
+			case 'X':
+				return substr($tables, 0, $len-2);
+			case 'I':
+				return substr($tables, 0, $len-3) . 'y';
+			case 'H';
+				if($ut[$len-4] == 'C' || $ut[$len-4] == 'S')
+					return substr($tables, 0, $len-2);
+			default:
+				return substr($tables, 0, $len-1); // ?
+		}
+	}
+
+	function hasMany($foreignRef, $foreignKey = false, $foreignClass = 'ADODB_Active_Record')
+	{
+		$ar = new $foreignClass($foreignRef);
+		$ar->foreignName = $foreignRef;
+		$ar->UpdateActiveTable();
+		$ar->foreignKey = ($foreignKey) ? $foreignKey : $foreignRef.ADODB_Active_Record::$_foreignSuffix;
+		$table =& $this->TableInfo();
+		$table->_hasMany[$foreignRef] = $ar;
+	#	$this->$foreignRef = $this->_hasMany[$foreignRef]; // WATCHME Removed assignment by ref. to please __get()
+	}
+	
+	// use when you don't want ADOdb to auto-pluralize tablename
+	static function TableHasMany($table, $foreignRef, $foreignKey = false, $foreignClass = 'ADODB_Active_Record')
+	{
+		$ar = new ADODB_Active_Record($table);
+		$ar->hasMany($foreignRef, $foreignKey, $foreignClass);
+	}
+	
+	// use when you don't want ADOdb to auto-pluralize tablename
+	static function TableKeyHasMany($table, $tablePKey, $foreignRef, $foreignKey = false, $foreignClass = 'ADODB_Active_Record')
+	{
+		if (!is_array($tablePKey)) $tablePKey = array($tablePKey);
+		$ar = new ADODB_Active_Record($table,$tablePKey);
+		$ar->hasMany($foreignRef, $foreignKey, $foreignClass);
+	}
+	
+	
+	// use when you want ADOdb to auto-pluralize tablename for you. Note that the class must already be defined.
+	// e.g. class Person will generate relationship for table Persons
+	static function ClassHasMany($parentclass, $foreignRef, $foreignKey = false, $foreignClass = 'ADODB_Active_Record')
+	{
+		$ar = new $parentclass();
+		$ar->hasMany($foreignRef, $foreignKey, $foreignClass);
+	}
+	
+
+	function belongsTo($foreignRef,$foreignKey=false, $parentKey='', $parentClass = 'ADODB_Active_Record')
+	{
+		global $inflector;
+
+		$ar = new $parentClass($this->_pluralize($foreignRef));
+		$ar->foreignName = $foreignRef;
+		$ar->parentKey = $parentKey;
+		$ar->UpdateActiveTable();
+		$ar->foreignKey = ($foreignKey) ? $foreignKey : $foreignRef.ADODB_Active_Record::$_foreignSuffix;
+		
+		$table =& $this->TableInfo();
+		$table->_belongsTo[$foreignRef] = $ar;
+	#	$this->$foreignRef = $this->_belongsTo[$foreignRef];
+	}
+	
+	static function ClassBelongsTo($class, $foreignRef, $foreignKey=false, $parentKey='', $parentClass = 'ADODB_Active_Record')
+	{
+		$ar = new $class();
+		$ar->belongsTo($foreignRef, $foreignKey, $parentKey, $parentClass);
+	}
+	
+	static function TableBelongsTo($table, $foreignRef, $foreignKey=false, $parentKey='', $parentClass = 'ADODB_Active_Record')
+	{
+		$ar = new ADOdb_Active_Record($table);
+		$ar->belongsTo($foreignRef, $foreignKey, $parentKey, $parentClass);
+	}
+	
+	static function TableKeyBelongsTo($table, $tablePKey, $foreignRef, $foreignKey=false, $parentKey='', $parentClass = 'ADODB_Active_Record')
+	{
+		if (!is_array($tablePKey)) $tablePKey = array($tablePKey);
+		$ar = new ADOdb_Active_Record($table, $tablePKey);
+		$ar->belongsTo($foreignRef, $foreignKey, $parentKey, $parentClass);
+	}
+
+
+	/**
+	 * __get Access properties - used for lazy loading
+	 * 
+	 * @param mixed $name 
+	 * @access protected
+	 * @return mixed
+	 */
+	 function __get($name)
+	{
+		return $this->LoadRelations($name, '', -1, -1);
+	}
+	
+	/**
+	 * @param string $name 
+	 * @param string $whereOrderBy : eg. ' AND field1 = value ORDER BY field2'
+	 * @param offset
+	 * @param limit
+	 * @return mixed
+	 */
+	function LoadRelations($name, $whereOrderBy='', $offset=-1,$limit=-1)
+	{
+		$extras = array();
+		$table = $this->TableInfo();
+		if ($limit >= 0) $extras['limit'] = $limit;
+		if ($offset >= 0) $extras['offset'] = $offset;
+		
+		if (strlen($whereOrderBy)) 
+			if (!preg_match('/^[ \n\r]*AND/i',$whereOrderBy))
+				if (!preg_match('/^[ \n\r]*ORDER[ \n\r]/i',$whereOrderBy))
+					$whereOrderBy = 'AND '.$whereOrderBy;
+				
+		if(!empty($table->_belongsTo[$name]))
+		{
+			$obj = $table->_belongsTo[$name];
+			$columnName = $obj->foreignKey;
+			if(empty($this->$columnName))
+				$this->$name = null;
+			else
+			{
+				if ($obj->parentKey) $key = $obj->parentKey;
+				else $key = reset($table->keys);
+				
+				$arrayOfOne = $obj->Find($key.'='.$this->$columnName.' '.$whereOrderBy,false,false,$extras);
+				if ($arrayOfOne) {
+					$this->$name = $arrayOfOne[0];
+					return $arrayOfOne[0];
+				}
+			}
+		}
+		if(!empty($table->_hasMany[$name]))
+		{	
+			$obj = $table->_hasMany[$name];
+			$key = reset($table->keys);
+			$id = @$this->$key;
+			if (!is_numeric($id)) {
+				$db = $this->DB();
+				$id = $db->qstr($id);
+			}
+			$objs = $obj->Find($obj->foreignKey.'='.$id. ' '.$whereOrderBy,false,false,$extras);
+			if (!$objs) $objs = array();
+			$this->$name = $objs;
+			return $objs;
+		}
+		
+		return array();
+	}
 	//////////////////////////////////
 	
 	// update metadata
 	function UpdateActiveTable($pkeys=false,$forceUpdate=false)
 	{
 	global $ADODB_ASSOC_CASE,$_ADODB_ACTIVE_DBS , $ADODB_CACHE_DIR, $ADODB_ACTIVE_CACHESECS;
-	global $ADODB_ACTIVE_DEFVALS;
+	global $ADODB_ACTIVE_DEFVALS,$ADODB_FETCH_MODE;
 
 		$activedb = $_ADODB_ACTIVE_DBS[$this->_dbat];
 
@@ -169,7 +354,6 @@ class ADODB_Active_Record {
 			}
 			return;
 		}
-		
 		$db = $activedb->db;
 		$fname = $ADODB_CACHE_DIR . '/adodb_' . $db->databaseType . '_active_'. $table . '.cache';
 		if (!$forceUpdate && $ADODB_ACTIVE_CACHESECS && $ADODB_CACHE_DIR && file_exists($fname)) {
@@ -191,8 +375,15 @@ class ADODB_Active_Record {
 		$activetab = new ADODB_Active_Table();
 		$activetab->name = $table;
 		
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
+		if ($db->fetchMode !== false) $savem = $db->SetFetchMode(false);
 		
 		$cols = $db->MetaColumns($table);
+		
+		if (isset($savem)) $db->SetFetchMode($savem);
+		$ADODB_FETCH_MODE = $save;
+		
 		if (!$cols) {
 			$this->Error("Invalid table name: $table",'UpdateActiveTable'); 
 			return false;
@@ -270,6 +461,12 @@ class ADODB_Active_Record {
 			if (!function_exists('adodb_write_file')) include(ADODB_DIR.'/adodb-csvlib.inc.php');
 			adodb_write_file($fname,$s);
 		}
+		if (isset($activedb->tables[$table])) {
+			$oldtab = $activedb->tables[$table];
+		
+			if ($oldtab) $activetab->_belongsTo = $oldtab->_belongsTo;
+			if ($oldtab) $activetab->_hasMany = $oldtab->_hasMany;
+		}
 		$activedb->tables[$table] = $activetab;
 	}
 	
@@ -338,15 +535,26 @@ class ADODB_Active_Record {
 	}
 	
 	// retrieve ADODB_Active_Table
-	function TableInfo()
+	function &TableInfo()
 	{
 	global $_ADODB_ACTIVE_DBS;
-	
 		$activedb = $_ADODB_ACTIVE_DBS[$this->_dbat];
 		$table = $activedb->tables[$this->_tableat];
 		return $table;
 	}
 	
+	
+	// I have an ON INSERT trigger on a table that sets other columns in the table.
+	// So, I find that for myTable, I want to reload an active record after saving it. -- Malcolm Cook
+	function Reload()
+	{
+		$db =& $this->DB(); if (!$db) return false;
+		$table =& $this->TableInfo();
+		$where = $this->GenWhere($db, $table);
+		return($this->Load($where));
+	}
+
+	
 	// set a numeric array (using natural table field ordering) as object properties
 	function Set(&$row)
 	{
@@ -378,7 +586,8 @@ class ADODB_Active_Record {
             # </AP>
 		}
         else
-		$keys = array_keys($row);
+			$keys = array_keys($row);
+			
         # <AP>
         reset($keys);
         $this->_original = array();
@@ -388,6 +597,7 @@ class ADODB_Active_Record {
             $this->_original[] = $value;
             next($keys);
 		}
+
         # </AP>
 		return true;
 	}
@@ -414,12 +624,15 @@ class ADODB_Active_Record {
 		case 'D':
 		case 'T':
 			if (empty($val)) return 'null';
-			
+		
+		case 'B':
+		case 'N':
 		case 'C':
 		case 'X':
 			if (is_null($val)) return 'null';
 			
-			if (strncmp($val,"'",1) != 0 && substr($val,strlen($val)-1,1) != "'") { 
+			if (strlen($val)>1 && 
+				(strncmp($val,"'",1) != 0 || substr($val,strlen($val)-1,1) != "'")) { 
 				return $db->qstr($val);
 				break;
 			}
@@ -445,20 +658,57 @@ class ADODB_Active_Record {
 	}
 	
 	
+	function _QName($n,$db=false)
+	{
+		if (!ADODB_Active_Record::$_quoteNames) return $n;
+		if (!$db) $db = $this->DB(); if (!$db) return false;
+		return $db->nameQuote.$n.$db->nameQuote;
+	}
+	
 	//------------------------------------------------------------ Public functions below
 	
-	function Load($where,$bindarr=false)
+	function Load($where=null,$bindarr=false)
 	{
+	global $ADODB_FETCH_MODE;
+	
 		$db = $this->DB(); if (!$db) return false;
 		$this->_where = $where;
 		
-		$save = $db->SetFetchMode(ADODB_FETCH_NUM);
-		$row = $db->GetRow("select * from ".$this->_table.' WHERE '.$where,$bindarr);
-		$db->SetFetchMode($save);
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		if ($db->fetchMode !== false) $savem = $db->SetFetchMode(false);
+		
+		$qry = "select * from ".$this->_table;
+
+		if($where) {
+			$qry .= ' WHERE '.$where;
+		}
+		$row = $db->GetRow($qry,$bindarr);
+		
+		if (isset($savem)) $db->SetFetchMode($savem);
+		$ADODB_FETCH_MODE = $save;
 		
 		return $this->Set($row);
 	}
 	
+	# useful for multiple record inserts
+	# see http://phplens.com/lens/lensforum/msgs.php?id=17795
+	function Reset()
+	{
+        $this->_where=null;
+        $this->_saved = false; 
+        $this->_lasterr = false; 
+        $this->_original = false;
+        $vars=get_object_vars($this);
+        foreach($vars as $k=>$v){
+        	if(substr($k,0,1)!=='_'){
+        		$this->{$k}=null;
+        	}
+        }
+        $this->foreignName=strtolower(get_class($this));
+        return true;
+    }
+	
 	// false on error
 	function Save()
 	{
@@ -468,6 +718,7 @@ class ADODB_Active_Record {
 		return $ok;
 	}
 	
+	
 	// false on error
 	function Insert()
 	{
@@ -481,9 +732,9 @@ class ADODB_Active_Record {
 
 		foreach($table->flds as $name=>$fld) {
 			$val = $this->$name;
-			if(!is_null($val) || !array_key_exists($name, $table->keys)) {
+			if(!is_array($val) || !is_null($val) || !array_key_exists($name, $table->keys)) {
 				$valarr[] = $val;
-				$names[] = $name;
+				$names[] = $this->_QName($name,$db);
 				$valstr[] = $db->Param($cnt);
 				$cnt += 1;
 			}
@@ -532,10 +783,10 @@ class ADODB_Active_Record {
 	}
 	
 	// returns an array of active record objects
-	function Find($whereOrderBy,$bindarr=false,$pkeysArr=false)
+	function Find($whereOrderBy,$bindarr=false,$pkeysArr=false,$extra=array())
 	{
 		$db = $this->DB(); if (!$db || empty($this->_table)) return false;
-		$arr = $db->GetActiveRecordsClass(get_class($this),$this->_table, $whereOrderBy,$bindarr,$pkeysArr);
+		$arr = $db->GetActiveRecordsClass(get_class($this),$this->_table, $whereOrderBy,$bindarr,$pkeysArr,$extra);
 		return $arr;
 	}
 	
@@ -564,6 +815,9 @@ class ADODB_Active_Record {
 			if (is_null($val) && !empty($fld->auto_increment)) {
             	continue;
             }
+			
+			if (is_array($val)) continue;
+			
 			$t = $db->MetaType($fld->type);
 			$arr[$name] = $this->doquote($db,$val,$t);
 			$valarr[] = $val;
@@ -623,9 +877,8 @@ class ADODB_Active_Record {
 			$val = $this->$name;
 			$neworig[] = $val;
 			
-			if (isset($table->keys[$name])) {
+			if (isset($table->keys[$name]) || is_array($val)) 
 				continue;
-			}
 			
 			if (is_null($val)) {
 				if (isset($fld->not_null) && $fld->not_null) {
@@ -641,7 +894,7 @@ class ADODB_Active_Record {
 				continue;
 			}			
 			$valarr[] = $val;
-			$pairs[] = $name.'='.$db->Param($cnt);
+			$pairs[] = $this->_QName($name,$db).'='.$db->Param($cnt);
 			$cnt += 1;
 		}
 		
@@ -665,4 +918,65 @@ class ADODB_Active_Record {
 	
 };
 
+function adodb_GetActiveRecordsClass(&$db, $class, $table,$whereOrderBy,$bindarr, $primkeyArr,
+			$extra)
+{
+global $_ADODB_ACTIVE_DBS;
+
+	
+	$save = $db->SetFetchMode(ADODB_FETCH_NUM);
+	$qry = "select * from ".$table;
+	
+	if (!empty($whereOrderBy))
+		$qry .= ' WHERE '.$whereOrderBy;
+	if(isset($extra['limit']))
+	{
+		$rows = false;
+		if(isset($extra['offset'])) {
+			$rs = $db->SelectLimit($qry, $extra['limit'], $extra['offset'],$bindarr);
+		} else {
+			$rs = $db->SelectLimit($qry, $extra['limit'],-1,$bindarr);
+		}
+		if ($rs) {
+			while (!$rs->EOF) {
+				$rows[] = $rs->fields;
+				$rs->MoveNext();
+			}
+		}
+	} else
+		$rows = $db->GetAll($qry,$bindarr);
+
+	$db->SetFetchMode($save);
+	
+	$false = false;
+	
+	if ($rows === false) {	
+		return $false;
+	}
+	
+
+	if (!class_exists($class)) {
+		$db->outp_throw("Unknown class $class in GetActiveRecordsClass()",'GetActiveRecordsClass');
+		return $false;
+	}
+	$arr = array();
+	// arrRef will be the structure that knows about our objects.
+	// It is an associative array.
+	// We will, however, return arr, preserving regular 0.. order so that
+	// obj[0] can be used by app developpers.
+	$arrRef = array();
+	$bTos = array(); // Will store belongTo's indices if any
+	foreach($rows as $row) {
+	
+		$obj = new $class($table,$primkeyArr,$db);
+		if ($obj->ErrorNo()){
+			$db->_errorMsg = $obj->ErrorMsg();
+			return $false;
+		}
+		$obj->Set($row);
+		$arr[] = $obj;
+	} // foreach($rows as $row) 
+
+	return $arr;
+}
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/adodb-active-recordx.inc.php b/third_party/adodb/adodb-active-recordx.inc.php
new file mode 100644
index 0000000..6d270b6
--- /dev/null
+++ b/third_party/adodb/adodb-active-recordx.inc.php
@@ -0,0 +1,1421 @@
+<?php
+/*
+
+@version V5.06 29 Sept 2008   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
+  Latest version is available at http://adodb.sourceforge.net
+ 
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence.
+  
+  Active Record implementation. Superset of Zend Framework's.
+  
+  This is "Active Record eXtended" to support JOIN, WORK and LAZY mode by Chris Ravenscroft  chris#voilaweb.com 
+  
+  Version 0.9
+  
+  See http://www-128.ibm.com/developerworks/java/library/j-cb03076/?ca=dgr-lnxw01ActiveRecord 
+  	for info on Ruby on Rails Active Record implementation
+*/
+
+
+	// CFR: Active Records Definitions
+define('ADODB_JOIN_AR', 0x01);
+define('ADODB_WORK_AR', 0x02);
+define('ADODB_LAZY_AR', 0x03);
+
+
+global $_ADODB_ACTIVE_DBS;
+global $ADODB_ACTIVE_CACHESECS; // set to true to enable caching of metadata such as field info
+global $ACTIVE_RECORD_SAFETY; // set to false to disable safety checks
+global $ADODB_ACTIVE_DEFVALS; // use default values of table definition when creating new active record.
+
+// array of ADODB_Active_DB's, indexed by ADODB_Active_Record->_dbat
+$_ADODB_ACTIVE_DBS = array();
+$ACTIVE_RECORD_SAFETY = true; // CFR: disabled while playing with relations
+$ADODB_ACTIVE_DEFVALS = false;
+
+class ADODB_Active_DB {
+	var $db; // ADOConnection
+	var $tables; // assoc array of ADODB_Active_Table objects, indexed by tablename
+}
+
+class ADODB_Active_Table {
+	var $name; // table name
+	var $flds; // assoc array of adofieldobjs, indexed by fieldname
+	var $keys; // assoc array of primary keys, indexed by fieldname
+	var $_created; // only used when stored as a cached file
+	var $_belongsTo = array();
+	var $_hasMany = array();
+	var $_colsCount; // total columns count, including relations
+
+	function updateColsCount()
+	{
+		$this->_colsCount = sizeof($this->flds);
+		foreach($this->_belongsTo as $foreignTable)
+			$this->_colsCount += sizeof($foreignTable->TableInfo()->flds);
+		foreach($this->_hasMany as $foreignTable)
+			$this->_colsCount += sizeof($foreignTable->TableInfo()->flds);
+	}
+}
+
+// returns index into $_ADODB_ACTIVE_DBS
+function ADODB_SetDatabaseAdapter(&$db)
+{
+	global $_ADODB_ACTIVE_DBS;
+	
+		foreach($_ADODB_ACTIVE_DBS as $k => $d) {
+			if (PHP_VERSION >= 5) {
+				if ($d->db === $db) return $k;
+			} else {
+				if ($d->db->_connectionID === $db->_connectionID && $db->database == $d->db->database) 
+					return $k;
+			}
+		}
+		
+		$obj = new ADODB_Active_DB();
+		$obj->db = $db;
+		$obj->tables = array();
+		
+		$_ADODB_ACTIVE_DBS[] = $obj;
+		
+		return sizeof($_ADODB_ACTIVE_DBS)-1;
+}
+
+
+class ADODB_Active_Record {
+	static $_changeNames = true; // dynamically pluralize table names
+	static $_foreignSuffix = '_id'; // 
+	var $_dbat; // associative index pointing to ADODB_Active_DB eg. $ADODB_Active_DBS[_dbat]
+	var $_table; // tablename, if set in class definition then use it as table name
+	var $_sTable; // singularized table name
+	var $_pTable; // pluralized table name
+	var $_tableat; // associative index pointing to ADODB_Active_Table, eg $ADODB_Active_DBS[_dbat]->tables[$this->_tableat]
+	var $_where; // where clause set in Load()
+	var $_saved = false; // indicates whether data is already inserted.
+	var $_lasterr = false; // last error message
+	var $_original = false; // the original values loaded or inserted, refreshed on update
+
+	var $foreignName; // CFR: class name when in a relationship
+
+	static function UseDefaultValues($bool=null)
+	{
+	global $ADODB_ACTIVE_DEFVALS;
+		if (isset($bool)) $ADODB_ACTIVE_DEFVALS = $bool;
+		return $ADODB_ACTIVE_DEFVALS;
+	}
+
+	// should be static
+	static function SetDatabaseAdapter(&$db) 
+	{
+		return ADODB_SetDatabaseAdapter($db);
+	}
+	
+	
+	public function __set($name, $value)
+	{
+		$name = str_replace(' ', '_', $name);
+		$this->$name = $value;
+	}
+	
+	// php5 constructor
+	// Note: if $table is defined, then we will use it as our table name
+	// Otherwise we will use our classname...
+	// In our database, table names are pluralized (because there can be
+	// more than one row!)
+	// Similarly, if $table is defined here, it has to be plural form.
+	//
+	// $options is an array that allows us to tweak the constructor's behaviour
+	// if $options['refresh'] is true, we re-scan our metadata information
+	// if $options['new'] is true, we forget all relations
+	function __construct($table = false, $pkeyarr=false, $db=false, $options=array())
+	{
+	global $ADODB_ASSOC_CASE,$_ADODB_ACTIVE_DBS;
+	
+		if ($db == false && is_object($pkeyarr)) {
+			$db = $pkeyarr;
+			$pkeyarr = false;
+		}
+		
+		if($table)
+		{
+			// table argument exists. It is expected to be
+			// already plural form.
+			$this->_pTable = $table;
+			$this->_sTable = $this->_singularize($this->_pTable);
+		}
+		else
+		{
+			// We will use current classname as table name.
+			// We need to pluralize it for the real table name.
+			$this->_sTable = strtolower(get_class($this));
+			$this->_pTable = $this->_pluralize($this->_sTable);
+		}
+		$this->_table = &$this->_pTable;
+
+		$this->foreignName = $this->_sTable; // CFR: default foreign name (singular)
+
+		if ($db) {
+			$this->_dbat = ADODB_Active_Record::SetDatabaseAdapter($db);
+		} else
+			$this->_dbat = sizeof($_ADODB_ACTIVE_DBS)-1;
+		
+		
+		if ($this->_dbat < 0) $this->Error("No database connection set; use ADOdb_Active_Record::SetDatabaseAdapter(\$db)",'ADODB_Active_Record::__constructor');
+		
+		$this->_tableat = $this->_table; # reserved for setting the assoc value to a non-table name, eg. the sql string in future
+
+		// CFR: Just added this option because UpdateActiveTable() can refresh its information
+		// but there was no way to ask it to do that.
+		$forceUpdate = (isset($options['refresh']) && true === $options['refresh']);
+		$this->UpdateActiveTable($pkeyarr, $forceUpdate);
+		if(isset($options['new']) && true === $options['new'])
+		{
+			$table =& $this->TableInfo();
+			unset($table->_hasMany);
+			unset($table->_belongsTo);
+			$table->_hasMany = array();
+			$table->_belongsTo = array();
+		}
+	}
+	
+	function __wakeup()
+	{
+  		$class = get_class($this);
+  		new $class;
+	}
+	
+	// CFR: Constants found in Rails
+	static $IrregularP = array(
+		'PERSON'    => 'people',
+		'MAN'       => 'men',
+		'WOMAN'     => 'women',
+		'CHILD'     => 'children',
+		'COW'       => 'kine',
+	);
+
+	static $IrregularS = array(
+		'PEOPLE'    => 'PERSON',
+		'MEN'       => 'man',
+		'WOMEN'     => 'woman',
+		'CHILDREN'  => 'child',
+		'KINE'      => 'cow',
+	);
+
+	static $WeIsI = array(
+		'EQUIPMENT' => true,
+		'INFORMATION'   => true,
+		'RICE'      => true,
+		'MONEY'     => true,
+		'SPECIES'   => true,
+		'SERIES'    => true,
+		'FISH'      => true,
+		'SHEEP'     => true,
+	);
+
+	function _pluralize($table)
+	{
+		if (!ADODB_Active_Record::$_changeNames) return $table;
+
+		$ut = strtoupper($table);
+		if(isset(self::$WeIsI[$ut]))
+		{
+			return $table;
+		}
+		if(isset(self::$IrregularP[$ut]))
+		{
+			return self::$IrregularP[$ut];
+		}
+		$len = strlen($table);
+		$lastc = $ut[$len-1];
+		$lastc2 = substr($ut,$len-2);
+		switch ($lastc) {
+		case 'S':
+			return $table.'es';	
+		case 'Y':
+			return substr($table,0,$len-1).'ies';
+		case 'X':	
+			return $table.'es';
+		case 'H': 
+			if ($lastc2 == 'CH' || $lastc2 == 'SH')
+				return $table.'es';
+		default:
+			return $table.'s';
+		}
+	}
+	
+	// CFR Lamest singular inflector ever - @todo Make it real!
+	// Note: There is an assumption here...and it is that the argument's length >= 4
+	function _singularize($table)
+	{
+	
+		if (!ADODB_Active_Record::$_changeNames) return $table;
+	
+		$ut = strtoupper($table);
+		if(isset(self::$WeIsI[$ut]))
+		{
+			return $table;
+		}
+		if(isset(self::$IrregularS[$ut]))
+		{
+			return self::$IrregularS[$ut];
+		}
+		$len = strlen($table);
+		if($ut[$len-1] != 'S')
+			return $table; // I know...forget oxen
+		if($ut[$len-2] != 'E')
+			return substr($table, 0, $len-1);
+		switch($ut[$len-3])
+		{
+			case 'S':
+			case 'X':
+				return substr($table, 0, $len-2);
+			case 'I':
+				return substr($table, 0, $len-3) . 'y';
+			case 'H';
+				if($ut[$len-4] == 'C' || $ut[$len-4] == 'S')
+					return substr($table, 0, $len-2);
+			default:
+				return substr($table, 0, $len-1); // ?
+		}
+	}
+
+	/*
+	 * ar->foreignName will contain the name of the tables associated with this table because
+	 * these other tables' rows may also be referenced by this table using theirname_id or the provided
+	 * foreign keys (this index name is stored in ar->foreignKey)
+	 *
+	 * this-table.id = other-table-#1.this-table_id
+	 *               = other-table-#2.this-table_id
+	 */
+	function hasMany($foreignRef,$foreignKey=false)
+	{
+		$ar = new ADODB_Active_Record($foreignRef);
+		$ar->foreignName = $foreignRef;
+		$ar->UpdateActiveTable();
+		$ar->foreignKey = ($foreignKey) ? $foreignKey : strtolower(get_class($this)) . self::$_foreignSuffix;
+
+		$table =& $this->TableInfo();
+		if(!isset($table->_hasMany[$foreignRef]))
+		{
+			$table->_hasMany[$foreignRef] = $ar;
+			$table->updateColsCount();
+		}
+# @todo Can I make this guy be lazy?
+		$this->$foreignRef = $table->_hasMany[$foreignRef]; // WATCHME Removed assignment by ref. to please __get()
+	}
+
+	/**
+	 * ar->foreignName will contain the name of the tables associated with this table because
+	 * this table's rows may also be referenced by those tables using thistable_id or the provided
+	 * foreign keys (this index name is stored in ar->foreignKey)
+	 *
+	 * this-table.other-table_id = other-table.id
+	 */
+	function belongsTo($foreignRef,$foreignKey=false)
+	{
+		global $inflector;
+
+		$ar = new ADODB_Active_Record($this->_pluralize($foreignRef));
+		$ar->foreignName = $foreignRef;
+		$ar->UpdateActiveTable();
+		$ar->foreignKey = ($foreignKey) ? $foreignKey : $ar->foreignName . self::$_foreignSuffix;
+		
+		$table =& $this->TableInfo();
+		if(!isset($table->_belongsTo[$foreignRef]))
+		{
+			$table->_belongsTo[$foreignRef] = $ar;
+			$table->updateColsCount();
+		}
+		$this->$foreignRef = $table->_belongsTo[$foreignRef];
+	}
+
+	/**
+	 * __get Access properties - used for lazy loading
+	 * 
+	 * @param mixed $name 
+	 * @access protected
+	 * @return void
+	 */
+	function __get($name)
+	{
+		return $this->LoadRelations($name, '', -1. -1);
+	}
+
+	function LoadRelations($name, $whereOrderBy, $offset=-1, $limit=-1)
+	{
+		$extras = array();
+		if($offset >= 0) $extras['offset'] = $offset;
+		if($limit >= 0) $extras['limit'] = $limit;
+		$table =& $this->TableInfo();
+		
+		if (strlen($whereOrderBy)) 
+			if (!preg_match('/^[ \n\r]*AND/i',$whereOrderBy))
+				if (!preg_match('/^[ \n\r]*ORDER[ \n\r]/i',$whereOrderBy))
+					$whereOrderBy = 'AND '.$whereOrderBy;
+					
+		if(!empty($table->_belongsTo[$name]))
+		{
+			$obj = $table->_belongsTo[$name];
+			$columnName = $obj->foreignKey;
+			if(empty($this->$columnName))
+				$this->$name = null;
+			else
+			{
+				if(($k = reset($obj->TableInfo()->keys)))
+					$belongsToId = $k;
+				else
+					$belongsToId = 'id';
+				
+				$arrayOfOne =
+					$obj->Find(
+						$belongsToId.'='.$this->$columnName.' '.$whereOrderBy, false, false, $extras);
+				$this->$name = $arrayOfOne[0];
+			}
+			return $this->$name;
+		}
+		if(!empty($table->_hasMany[$name]))
+		{
+			$obj = $table->_hasMany[$name];
+			if(($k = reset($table->keys)))
+				$hasManyId   = $k;
+			else
+				$hasManyId   = 'id';			
+
+			$this->$name =
+				$obj->Find(
+					$obj->foreignKey.'='.$this->$hasManyId.' '.$whereOrderBy, false, false, $extras);
+			return $this->$name;
+		}
+	}
+	//////////////////////////////////
+	
+	// update metadata
+	function UpdateActiveTable($pkeys=false,$forceUpdate=false)
+	{
+	global $ADODB_ASSOC_CASE,$_ADODB_ACTIVE_DBS , $ADODB_CACHE_DIR, $ADODB_ACTIVE_CACHESECS;
+	global $ADODB_ACTIVE_DEFVALS, $ADODB_FETCH_MODE;
+
+		$activedb = $_ADODB_ACTIVE_DBS[$this->_dbat];
+
+		$table = $this->_table;
+		$tables = $activedb->tables;
+		$tableat = $this->_tableat;
+		if (!$forceUpdate && !empty($tables[$tableat])) {
+
+			$tobj = $tables[$tableat];
+			foreach($tobj->flds as $name => $fld) {
+			if ($ADODB_ACTIVE_DEFVALS && isset($fld->default_value)) 
+				$this->$name = $fld->default_value;
+			else
+				$this->$name = null;
+			}
+			return;
+		}
+		
+		$db = $activedb->db;
+		$fname = $ADODB_CACHE_DIR . '/adodb_' . $db->databaseType . '_active_'. $table . '.cache';
+		if (!$forceUpdate && $ADODB_ACTIVE_CACHESECS && $ADODB_CACHE_DIR && file_exists($fname)) {
+			$fp = fopen($fname,'r');
+			@flock($fp, LOCK_SH);
+			$acttab = unserialize(fread($fp,100000));
+			fclose($fp);
+			if ($acttab->_created + $ADODB_ACTIVE_CACHESECS - (abs(rand()) % 16) > time()) { 
+				// abs(rand()) randomizes deletion, reducing contention to delete/refresh file
+				// ideally, you should cache at least 32 secs
+				$activedb->tables[$table] = $acttab;
+				
+				//if ($db->debug) ADOConnection::outp("Reading cached active record file: $fname");
+			  	return;
+			} else if ($db->debug) {
+				ADOConnection::outp("Refreshing cached active record file: $fname");
+			}
+		}
+		$activetab = new ADODB_Active_Table();
+		$activetab->name = $table;
+		
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
+		if ($db->fetchMode !== false) $savem = $db->SetFetchMode(false);
+		
+		$cols = $db->MetaColumns($table);
+		
+		if (isset($savem)) $db->SetFetchMode($savem);
+		$ADODB_FETCH_MODE = $save;
+		
+		if (!$cols) {
+			$this->Error("Invalid table name: $table",'UpdateActiveTable'); 
+			return false;
+		}
+		$fld = reset($cols);
+		if (!$pkeys) {
+			if (isset($fld->primary_key)) {
+				$pkeys = array();
+				foreach($cols as $name => $fld) {
+					if (!empty($fld->primary_key)) $pkeys[] = $name;
+				}
+			} else	
+				$pkeys = $this->GetPrimaryKeys($db, $table);
+		}
+		if (empty($pkeys)) {
+			$this->Error("No primary key found for table $table",'UpdateActiveTable');
+			return false;
+		}
+		
+		$attr = array();
+		$keys = array();
+		
+		switch($ADODB_ASSOC_CASE) {
+		case 0:
+			foreach($cols as $name => $fldobj) {
+				$name = strtolower($name);
+                if ($ADODB_ACTIVE_DEFVALS && isset($fldobj->default_value))
+                    $this->$name = $fldobj->default_value;
+                else
+					$this->$name = null;
+				$attr[$name] = $fldobj;
+			}
+			foreach($pkeys as $k => $name) {
+				$keys[strtolower($name)] = strtolower($name);
+			}
+			break;
+			
+		case 1: 
+			foreach($cols as $name => $fldobj) {
+				$name = strtoupper($name);
+               
+                if ($ADODB_ACTIVE_DEFVALS && isset($fldobj->default_value))
+                    $this->$name = $fldobj->default_value;
+                else
+					$this->$name = null;
+				$attr[$name] = $fldobj;
+			}
+			
+			foreach($pkeys as $k => $name) {
+				$keys[strtoupper($name)] = strtoupper($name);
+			}
+			break;
+		default:
+			foreach($cols as $name => $fldobj) {
+				$name = ($fldobj->name);
+                
+                if ($ADODB_ACTIVE_DEFVALS && isset($fldobj->default_value))
+                    $this->$name = $fldobj->default_value;
+                else
+					$this->$name = null;
+				$attr[$name] = $fldobj;
+			}
+			foreach($pkeys as $k => $name) {
+				$keys[$name] = $cols[$name]->name;
+			}
+			break;
+		}
+		
+		$activetab->keys = $keys;
+		$activetab->flds = $attr;
+		$activetab->updateColsCount();
+
+		if ($ADODB_ACTIVE_CACHESECS && $ADODB_CACHE_DIR) {
+			$activetab->_created = time();
+			$s = serialize($activetab);
+			if (!function_exists('adodb_write_file')) include(ADODB_DIR.'/adodb-csvlib.inc.php');
+			adodb_write_file($fname,$s);
+		}
+		if (isset($activedb->tables[$table])) {
+			$oldtab = $activedb->tables[$table];
+		
+			if ($oldtab) $activetab->_belongsTo = $oldtab->_belongsTo;
+			if ($oldtab) $activetab->_hasMany = $oldtab->_hasMany;
+		}
+		$activedb->tables[$table] = $activetab;
+	}
+	
+	function GetPrimaryKeys(&$db, $table)
+	{
+		return $db->MetaPrimaryKeys($table);
+	}
+	
+	// error handler for both PHP4+5. 
+	function Error($err,$fn)
+	{
+	global $_ADODB_ACTIVE_DBS;
+	
+		$fn = get_class($this).'::'.$fn;
+		$this->_lasterr = $fn.': '.$err;
+		
+		if ($this->_dbat < 0) $db = false;
+		else {
+			$activedb = $_ADODB_ACTIVE_DBS[$this->_dbat];
+			$db = $activedb->db;
+		}
+		
+		if (function_exists('adodb_throw')) {	
+			if (!$db) adodb_throw('ADOdb_Active_Record', $fn, -1, $err, 0, 0, false);
+			else adodb_throw($db->databaseType, $fn, -1, $err, 0, 0, $db);
+		} else
+			if (!$db || $db->debug) ADOConnection::outp($this->_lasterr);
+		
+	}
+	
+	// return last error message
+	function ErrorMsg()
+	{
+		if (!function_exists('adodb_throw')) {
+			if ($this->_dbat < 0) $db = false;
+			else $db = $this->DB();
+		
+			// last error could be database error too
+			if ($db && $db->ErrorMsg()) return $db->ErrorMsg();
+		}
+		return $this->_lasterr;
+	}
+	
+	function ErrorNo() 
+	{
+		if ($this->_dbat < 0) return -9999; // no database connection...
+		$db = $this->DB();
+		
+		return (int) $db->ErrorNo();
+	}
+
+
+	// retrieve ADOConnection from _ADODB_Active_DBs
+	function DB()
+	{
+	global $_ADODB_ACTIVE_DBS;
+	
+		if ($this->_dbat < 0) {
+			$false = false;
+			$this->Error("No database connection set: use ADOdb_Active_Record::SetDatabaseAdaptor(\$db)", "DB");
+			return $false;
+		}
+		$activedb = $_ADODB_ACTIVE_DBS[$this->_dbat];
+		$db = $activedb->db;
+		return $db;
+	}
+	
+	// retrieve ADODB_Active_Table
+	function &TableInfo()
+	{
+	global $_ADODB_ACTIVE_DBS;
+	
+		$activedb = $_ADODB_ACTIVE_DBS[$this->_dbat];
+		$table = $activedb->tables[$this->_tableat];
+		return $table;
+	}
+	
+	
+	// I have an ON INSERT trigger on a table that sets other columns in the table.
+	// So, I find that for myTable, I want to reload an active record after saving it. -- Malcolm Cook
+	function Reload()
+	{
+		$db =& $this->DB(); if (!$db) return false;
+		$table =& $this->TableInfo();
+		$where = $this->GenWhere($db, $table);
+		return($this->Load($where));
+	}
+
+	
+	// set a numeric array (using natural table field ordering) as object properties
+	function Set(&$row)
+	{
+	global $ACTIVE_RECORD_SAFETY;
+	
+		$db = $this->DB();
+		
+		if (!$row) {
+			$this->_saved = false;		
+			return false;
+		}
+		
+		$this->_saved = true;
+		
+		$table = $this->TableInfo();
+		$sizeofFlds = sizeof($table->flds);
+		$sizeofRow  = sizeof($row);
+		if ($ACTIVE_RECORD_SAFETY && $table->_colsCount != $sizeofRow && $sizeofFlds != $sizeofRow) {
+            # <AP>
+            $bad_size = TRUE;
+	if($sizeofRow == 2 * $table->_colsCount || $sizeofRow == 2 * $sizeofFlds) {
+                // Only keep string keys
+                $keys = array_filter(array_keys($row), 'is_string');
+                if (sizeof($keys) == sizeof($table->flds))
+                    $bad_size = FALSE;
+            }
+            if ($bad_size) {
+			$this->Error("Table structure of $this->_table has changed","Load");
+			return false;
+		}
+            # </AP>
+		}
+        else
+		$keys = array_keys($row);
+        # <AP>
+        reset($keys);
+        $this->_original = array();
+		foreach($table->flds as $name=>$fld)
+		{
+            $value = $row[current($keys)];
+			$this->$name = $value;
+            $this->_original[] = $value;
+            if(!next($keys)) break;
+		}
+		$table =& $this->TableInfo();
+		foreach($table->_belongsTo as $foreignTable)
+		{
+			$ft = $foreignTable->TableInfo();
+			$propertyName = $ft->name;
+			foreach($ft->flds as $name=>$fld)
+			{
+				$value = $row[current($keys)];
+				$foreignTable->$name = $value;
+				$foreignTable->_original[] = $value;
+				if(!next($keys)) break;
+			}
+		}
+		foreach($table->_hasMany as $foreignTable)
+		{
+			$ft = $foreignTable->TableInfo();
+			foreach($ft->flds as $name=>$fld)
+			{
+				$value = $row[current($keys)];
+				$foreignTable->$name = $value;
+				$foreignTable->_original[] = $value;
+				if(!next($keys)) break;
+			}
+		}
+        # </AP>
+		return true;
+	}
+	
+	// get last inserted id for INSERT
+	function LastInsertID(&$db,$fieldname)
+	{
+		if ($db->hasInsertID)
+			$val = $db->Insert_ID($this->_table,$fieldname);
+		else
+			$val = false;
+			
+		if (is_null($val) || $val === false) {
+			// this might not work reliably in multi-user environment
+			return $db->GetOne("select max(".$fieldname.") from ".$this->_table);
+		}
+		return $val;
+	}
+	
+	// quote data in where clause
+	function doquote(&$db, $val,$t)
+	{
+		switch($t) {
+		case 'D':
+		case 'T':
+			if (empty($val)) return 'null';
+			
+		case 'C':
+		case 'X':
+			if (is_null($val)) return 'null';
+			
+			if (strlen($val)>1 && 
+				(strncmp($val,"'",1) != 0 || substr($val,strlen($val)-1,1) != "'")) { 
+				return $db->qstr($val);
+				break;
+			}
+		default:
+			return $val;
+			break;
+		}
+	}
+	
+	// generate where clause for an UPDATE/SELECT
+	function GenWhere(&$db, &$table)
+	{
+		$keys = $table->keys;
+		$parr = array();
+		
+		foreach($keys as $k) {
+			$f = $table->flds[$k];
+			if ($f) {
+				$parr[] = $k.' = '.$this->doquote($db,$this->$k,$db->MetaType($f->type));
+			}
+		}
+		return implode(' and ', $parr);
+	}
+	
+	
+	//------------------------------------------------------------ Public functions below
+	
+	function Load($where=null,$bindarr=false)
+	{
+		$db = $this->DB(); if (!$db) return false;
+		$this->_where = $where;
+		
+		$save = $db->SetFetchMode(ADODB_FETCH_NUM);
+		$qry = "select * from ".$this->_table;
+		$table =& $this->TableInfo();
+
+		if(($k = reset($table->keys)))
+			$hasManyId   = $k;
+		else
+			$hasManyId   = 'id';
+		
+		foreach($table->_belongsTo as $foreignTable)
+		{
+			if(($k = reset($foreignTable->TableInfo()->keys)))
+			{
+				$belongsToId = $k;
+			}
+			else
+			{
+				$belongsToId = 'id';
+			}
+			$qry .= ' LEFT JOIN '.$foreignTable->_table.' ON '.
+				$this->_table.'.'.$foreignTable->foreignKey.'='.
+				$foreignTable->_table.'.'.$belongsToId;
+		}
+		foreach($table->_hasMany as $foreignTable)
+		{
+			$qry .= ' LEFT JOIN '.$foreignTable->_table.' ON '.
+				$this->_table.'.'.$hasManyId.'='.
+				$foreignTable->_table.'.'.$foreignTable->foreignKey;
+		}
+		if($where)
+			$qry .= ' WHERE '.$where;
+		
+		// Simple case: no relations. Load row and return.
+		if((count($table->_hasMany) + count($table->_belongsTo)) < 1)
+		{
+			$row = $db->GetRow($qry,$bindarr);
+			if(!$row)
+				return false;
+			$db->SetFetchMode($save);
+			return $this->Set($row);
+		}
+		
+		// More complex case when relations have to be collated
+		$rows = $db->GetAll($qry,$bindarr);
+		if(!$rows)
+			return false;
+		$db->SetFetchMode($save);
+		if(count($rows) < 1)
+			return false;
+		$class = get_class($this);
+		$isFirstRow = true;
+		
+		if(($k = reset($this->TableInfo()->keys)))
+			$myId   = $k;
+		else
+			$myId   = 'id';
+		$index = 0; $found = false;
+		/** @todo Improve by storing once and for all in table metadata */
+		/** @todo Also re-use info for hasManyId */
+		foreach($this->TableInfo()->flds as $fld)
+		{
+			if($fld->name == $myId)
+			{
+				$found = true;
+				break;
+			}
+			$index++;
+		}
+		if(!$found)
+			$this->outp_throw("Unable to locate key $myId for $class in Load()",'Load');
+		
+		foreach($rows as $row)
+		{
+			$rowId = intval($row[$index]);
+			if($rowId > 0)
+			{
+				if($isFirstRow)
+				{
+					$isFirstRow = false;
+					if(!$this->Set($row))
+						return false;
+				}
+				$obj = new $class($table,false,$db);
+				$obj->Set($row);
+				// TODO Copy/paste code below: bad!
+				if(count($table->_hasMany) > 0)
+				{
+					foreach($table->_hasMany as $foreignTable)
+					{
+						$foreignName = $foreignTable->foreignName;
+						if(!empty($obj->$foreignName))
+						{
+							if(!is_array($this->$foreignName))
+							{
+								$foreignObj = $this->$foreignName;
+								$this->$foreignName = array(clone($foreignObj));
+							}
+							else
+							{
+								$foreignObj = $obj->$foreignName;
+								array_push($this->$foreignName, clone($foreignObj));
+							}
+						}
+					}
+				}
+				if(count($table->_belongsTo) > 0)
+				{
+					foreach($table->_belongsTo as $foreignTable)
+					{
+						$foreignName = $foreignTable->foreignName;
+						if(!empty($obj->$foreignName))
+						{
+							if(!is_array($this->$foreignName))
+							{
+								$foreignObj = $this->$foreignName;
+								$this->$foreignName = array(clone($foreignObj));
+							}
+							else
+							{
+								$foreignObj = $obj->$foreignName;
+								array_push($this->$foreignName, clone($foreignObj));
+							}
+						}
+					}
+				}				
+			}
+		}
+		return true;
+	}
+	
+	// false on error
+	function Save()
+	{
+		if ($this->_saved) $ok = $this->Update();
+		else $ok = $this->Insert();
+		
+		return $ok;
+	}
+	
+	// CFR: Sometimes we may wish to consider that an object is not to be replaced but inserted.
+	// Sample use case: an 'undo' command object (after a delete())
+	function Dirty()
+	{
+		$this->_saved = false;
+	}
+
+	// false on error
+	function Insert()
+	{
+		$db = $this->DB(); if (!$db) return false;
+		$cnt = 0;
+		$table = $this->TableInfo();
+		
+		$valarr = array();
+		$names = array();
+		$valstr = array();
+
+		foreach($table->flds as $name=>$fld) {
+			$val = $this->$name;
+			if(!is_null($val) || !array_key_exists($name, $table->keys)) {
+				$valarr[] = $val;
+				$names[] = $name;
+				$valstr[] = $db->Param($cnt);
+				$cnt += 1;
+			}
+		}
+		
+		if (empty($names)){
+			foreach($table->flds as $name=>$fld) {
+				$valarr[] = null;
+				$names[] = $name;
+				$valstr[] = $db->Param($cnt);
+				$cnt += 1;
+			}
+		}
+		$sql = 'INSERT INTO '.$this->_table."(".implode(',',$names).') VALUES ('.implode(',',$valstr).')';
+		$ok = $db->Execute($sql,$valarr);
+		
+		if ($ok) {
+			$this->_saved = true;
+			$autoinc = false;
+			foreach($table->keys as $k) {
+				if (is_null($this->$k)) {
+					$autoinc = true;
+					break;
+				}
+			}
+			if ($autoinc && sizeof($table->keys) == 1) {
+				$k = reset($table->keys);
+				$this->$k = $this->LastInsertID($db,$k);
+			}
+		}
+		
+		$this->_original = $valarr;
+		return !empty($ok);
+	}
+	
+	function Delete()
+	{
+		$db = $this->DB(); if (!$db) return false;
+		$table = $this->TableInfo();
+		
+		$where = $this->GenWhere($db,$table);
+		$sql = 'DELETE FROM '.$this->_table.' WHERE '.$where;
+		$ok = $db->Execute($sql);
+		
+		return $ok ? true : false;
+	}
+	
+	// returns an array of active record objects
+	function Find($whereOrderBy,$bindarr=false,$pkeysArr=false,$extra=array())
+	{
+		$db = $this->DB(); if (!$db || empty($this->_table)) return false;
+		$table =& $this->TableInfo();
+		$arr = $db->GetActiveRecordsClass(get_class($this),$this, $whereOrderBy,$bindarr,$pkeysArr,$extra,
+			array('foreignName'=>$this->foreignName, 'belongsTo'=>$table->_belongsTo, 'hasMany'=>$table->_hasMany));
+		return $arr;
+	}
+	
+	// CFR: In introduced this method to ensure that inner workings are not disturbed by
+	// subclasses...for instance when GetActiveRecordsClass invokes Find()
+	// Why am I not invoking parent::Find?
+	// Shockingly because I want to preserve PHP4 compatibility.
+	function packageFind($whereOrderBy,$bindarr=false,$pkeysArr=false,$extra=array())
+	{
+		$db = $this->DB(); if (!$db || empty($this->_table)) return false;
+		$table =& $this->TableInfo();
+		$arr = $db->GetActiveRecordsClass(get_class($this),$this, $whereOrderBy,$bindarr,$pkeysArr,$extra,
+			array('foreignName'=>$this->foreignName, 'belongsTo'=>$table->_belongsTo, 'hasMany'=>$table->_hasMany));
+		return $arr;
+	}
+
+	// returns 0 on error, 1 on update, 2 on insert
+	function Replace()
+	{
+	global $ADODB_ASSOC_CASE;
+		
+		$db = $this->DB(); if (!$db) return false;
+		$table = $this->TableInfo();
+		
+		$pkey = $table->keys;
+		
+		foreach($table->flds as $name=>$fld) {
+			$val = $this->$name;
+			/*
+			if (is_null($val)) {
+				if (isset($fld->not_null) && $fld->not_null) {
+					if (isset($fld->default_value) && strlen($fld->default_value)) continue;
+					else {
+						$this->Error("Cannot update null into $name","Replace");
+						return false;
+					}
+				}
+			}*/
+			if (is_null($val) && !empty($fld->auto_increment)) {
+            	continue;
+            }
+			$t = $db->MetaType($fld->type);
+			$arr[$name] = $this->doquote($db,$val,$t);
+			$valarr[] = $val;
+		}
+		
+		if (!is_array($pkey)) $pkey = array($pkey);
+		
+		
+		if ($ADODB_ASSOC_CASE == 0) 
+			foreach($pkey as $k => $v)
+				$pkey[$k] = strtolower($v);
+		elseif ($ADODB_ASSOC_CASE == 1) 
+			foreach($pkey as $k => $v)
+				$pkey[$k] = strtoupper($v);
+				
+		$ok = $db->Replace($this->_table,$arr,$pkey);
+		if ($ok) {
+			$this->_saved = true; // 1= update 2=insert
+			if ($ok == 2) {
+				$autoinc = false;
+				foreach($table->keys as $k) {
+					if (is_null($this->$k)) {
+						$autoinc = true;
+						break;
+					}
+				}
+				if ($autoinc && sizeof($table->keys) == 1) {
+					$k = reset($table->keys);
+					$this->$k = $this->LastInsertID($db,$k);
+				}
+			}
+			
+			$this->_original = $valarr;
+		} 
+		return $ok;
+	}
+
+	// returns 0 on error, 1 on update, -1 if no change in data (no update)
+	function Update()
+	{
+		$db = $this->DB(); if (!$db) return false;
+		$table = $this->TableInfo();
+		
+		$where = $this->GenWhere($db, $table);
+		
+		if (!$where) {
+			$this->error("Where missing for table $table", "Update");
+			return false;
+		}
+		$valarr = array(); 
+		$neworig = array();
+		$pairs = array();
+		$i = -1;
+		$cnt = 0;
+		foreach($table->flds as $name=>$fld) {
+			$i += 1;
+			$val = $this->$name;
+			$neworig[] = $val;
+			
+			if (isset($table->keys[$name])) {
+				continue;
+			}
+			
+			if (is_null($val)) {
+				if (isset($fld->not_null) && $fld->not_null) {
+					if (isset($fld->default_value) && strlen($fld->default_value)) continue;
+					else {
+						$this->Error("Cannot set field $name to NULL","Update");
+						return false;
+					}
+				}
+			}
+			
+			if (isset($this->_original[$i]) && $val == $this->_original[$i]) {
+				continue;
+			}			
+			$valarr[] = $val;
+			$pairs[] = $name.'='.$db->Param($cnt);
+			$cnt += 1;
+		}
+		
+		
+		if (!$cnt) return -1;
+		$sql = 'UPDATE '.$this->_table." SET ".implode(",",$pairs)." WHERE ".$where;
+		$ok = $db->Execute($sql,$valarr);
+		if ($ok) {
+			$this->_original = $neworig;
+			return 1;
+		}
+		return 0;
+	}
+	
+	function GetAttributeNames()
+	{
+		$table = $this->TableInfo();
+		if (!$table) return false;
+		return array_keys($table->flds);
+	}
+	
+};
+
+function adodb_GetActiveRecordsClass(&$db, $class, $tableObj,$whereOrderBy,$bindarr, $primkeyArr,
+			$extra, $relations)
+{
+	global $_ADODB_ACTIVE_DBS;
+	
+		if (empty($extra['loading'])) $extra['loading'] = ADODB_LAZY_AR;
+		
+		$save = $db->SetFetchMode(ADODB_FETCH_NUM);
+		$table = &$tableObj->_table;
+		$tableInfo =& $tableObj->TableInfo();
+		if(($k = reset($tableInfo->keys)))
+			$myId   = $k;
+		else
+			$myId   = 'id';
+		$index = 0; $found = false;
+		/** @todo Improve by storing once and for all in table metadata */
+		/** @todo Also re-use info for hasManyId */
+		foreach($tableInfo->flds as $fld)
+		{
+			if($fld->name == $myId)
+			{
+				$found = true;
+				break;
+			}
+			$index++;
+		}
+		if(!$found)
+			$db->outp_throw("Unable to locate key $myId for $class in GetActiveRecordsClass()",'GetActiveRecordsClass');
+		
+		$qry = "select * from ".$table;
+		if(ADODB_JOIN_AR == $extra['loading'])
+		{
+			if(!empty($relations['belongsTo']))
+			{
+				foreach($relations['belongsTo'] as $foreignTable)
+				{
+					if(($k = reset($foreignTable->TableInfo()->keys)))
+					{
+						$belongsToId = $k;
+					}
+					else
+					{
+						$belongsToId = 'id';
+					}
+
+					$qry .= ' LEFT JOIN '.$foreignTable->_table.' ON '.
+						$table.'.'.$foreignTable->foreignKey.'='.
+						$foreignTable->_table.'.'.$belongsToId;
+				}
+			}
+			if(!empty($relations['hasMany']))
+			{
+				if(empty($relations['foreignName']))
+					$db->outp_throw("Missing foreignName is relation specification in GetActiveRecordsClass()",'GetActiveRecordsClass');
+				if(($k = reset($tableInfo->keys)))
+					$hasManyId   = $k;
+				else
+					$hasManyId   = 'id';
+
+				foreach($relations['hasMany'] as $foreignTable)
+				{
+					$qry .= ' LEFT JOIN '.$foreignTable->_table.' ON '.
+						$table.'.'.$hasManyId.'='.
+						$foreignTable->_table.'.'.$foreignTable->foreignKey;
+				}
+			}
+		}
+		if (!empty($whereOrderBy))
+			$qry .= ' WHERE '.$whereOrderBy;
+		if(isset($extra['limit']))
+		{
+			$rows = false;
+			if(isset($extra['offset'])) {
+				$rs = $db->SelectLimit($qry, $extra['limit'], $extra['offset']);
+			} else {
+				$rs = $db->SelectLimit($qry, $extra['limit']);
+			}
+			if ($rs) {
+				while (!$rs->EOF) {
+					$rows[] = $rs->fields;
+					$rs->MoveNext();
+				}
+			}
+		} else
+			$rows = $db->GetAll($qry,$bindarr);
+			
+		$db->SetFetchMode($save);
+		
+		$false = false;
+		
+		if ($rows === false) {	
+			return $false;
+		}
+		
+		
+		if (!isset($_ADODB_ACTIVE_DBS)) {
+			include(ADODB_DIR.'/adodb-active-record.inc.php');
+		}	
+		if (!class_exists($class)) {
+			$db->outp_throw("Unknown class $class in GetActiveRecordsClass()",'GetActiveRecordsClass');
+			return $false;
+		}
+		$uniqArr = array(); // CFR Keep track of records for relations
+		$arr = array();
+		// arrRef will be the structure that knows about our objects.
+		// It is an associative array.
+		// We will, however, return arr, preserving regular 0.. order so that
+		// obj[0] can be used by app developpers.
+		$arrRef = array();
+		$bTos = array(); // Will store belongTo's indices if any
+		foreach($rows as $row) {
+		
+			$obj = new $class($table,$primkeyArr,$db);
+			if ($obj->ErrorNo()){
+				$db->_errorMsg = $obj->ErrorMsg();
+				return $false;
+			}
+			$obj->Set($row);
+			// CFR: FIXME: Insane assumption here:
+			// If the first column returned is an integer, then it's a 'id' field
+			// And to make things a bit worse, I use intval() rather than is_int() because, in fact,
+			// $row[0] is not an integer.
+			//
+			// So, what does this whole block do?
+			// When relationships are found, we perform JOINs. This is fast. But not accurate:
+			// instead of returning n objects with their n' associated cousins,
+			// we get n*n' objects. This code fixes this.
+			// Note: to-many relationships mess around with the 'limit' parameter
+			$rowId = intval($row[$index]);
+
+			if(ADODB_WORK_AR == $extra['loading'])
+			{
+				$arrRef[$rowId] = $obj;
+				$arr[] = &$arrRef[$rowId];
+				if(!isset($indices))
+					$indices = $rowId;
+				else
+					$indices .= ','.$rowId;
+				if(!empty($relations['belongsTo']))
+				{
+					foreach($relations['belongsTo'] as $foreignTable)
+					{
+						$foreignTableRef = $foreignTable->foreignKey;
+						// First array: list of foreign ids we are looking for
+						if(empty($bTos[$foreignTableRef]))
+							$bTos[$foreignTableRef] = array();
+						// Second array: list of ids found
+						if(empty($obj->$foreignTableRef))
+							continue;
+						if(empty($bTos[$foreignTableRef][$obj->$foreignTableRef]))
+							$bTos[$foreignTableRef][$obj->$foreignTableRef] = array();
+						$bTos[$foreignTableRef][$obj->$foreignTableRef][] = $obj;
+					}
+				}
+				continue;
+			}
+
+			if($rowId>0)
+			{
+				if(ADODB_JOIN_AR == $extra['loading'])
+				{
+					$isNewObj = !isset($uniqArr['_'.$row[0]]); 
+					if($isNewObj)
+						$uniqArr['_'.$row[0]] = $obj;
+
+					// TODO Copy/paste code below: bad!
+					if(!empty($relations['hasMany']))
+					{
+						foreach($relations['hasMany'] as $foreignTable)
+						{
+							$foreignName = $foreignTable->foreignName;
+							if(!empty($obj->$foreignName))
+							{
+								$masterObj = &$uniqArr['_'.$row[0]];
+								// Assumption: this property exists in every object since they are instances of the same class
+								if(!is_array($masterObj->$foreignName))
+								{
+									// Pluck!
+									$foreignObj = $masterObj->$foreignName;
+									$masterObj->$foreignName = array(clone($foreignObj));
+								}
+								else
+								{
+									// Pluck pluck!
+									$foreignObj = $obj->$foreignName;
+									array_push($masterObj->$foreignName, clone($foreignObj));
+								}
+							}
+						}
+					}
+					if(!empty($relations['belongsTo']))
+					{
+						foreach($relations['belongsTo'] as $foreignTable)
+						{
+							$foreignName = $foreignTable->foreignName;
+							if(!empty($obj->$foreignName))
+							{
+								$masterObj = &$uniqArr['_'.$row[0]];
+								// Assumption: this property exists in every object since they are instances of the same class
+								if(!is_array($masterObj->$foreignName))
+								{
+									// Pluck!
+									$foreignObj = $masterObj->$foreignName;
+									$masterObj->$foreignName = array(clone($foreignObj));
+								}
+								else
+								{
+									// Pluck pluck!
+									$foreignObj = $obj->$foreignName;
+									array_push($masterObj->$foreignName, clone($foreignObj));
+								}
+							}
+						}
+					}
+					if(!$isNewObj)
+						unset($obj); // We do not need this object itself anymore and do not want it re-added to the main array					
+				}
+				else if(ADODB_LAZY_AR == $extra['loading'])
+				{
+					// Lazy loading: we need to give AdoDb a hint that we have not really loaded
+					// anything, all the while keeping enough information on what we wish to load.
+					// Let's do this by keeping the relevant info in our relationship arrays
+					// but get rid of the actual properties.
+					// We will then use PHP's __get to load these properties on-demand.
+					if(!empty($relations['hasMany']))
+					{
+						foreach($relations['hasMany'] as $foreignTable)
+						{
+							$foreignName = $foreignTable->foreignName;
+							if(!empty($obj->$foreignName))
+							{
+								unset($obj->$foreignName);
+							}
+						}
+					}
+					if(!empty($relations['belongsTo']))
+					{
+						foreach($relations['belongsTo'] as $foreignTable)
+						{
+							$foreignName = $foreignTable->foreignName;
+							if(!empty($obj->$foreignName))
+							{
+								unset($obj->$foreignName);
+							}
+						}
+					}
+				}
+			}
+
+			if(isset($obj))
+				$arr[] = $obj;
+		}
+
+		if(ADODB_WORK_AR == $extra['loading'])
+		{
+			// The best of both worlds?
+			// Here, the number of queries is constant: 1 + n*relationship.
+			// The second query will allow us to perform a good join
+			// while preserving LIMIT etc.
+			if(!empty($relations['hasMany']))
+			{
+				foreach($relations['hasMany'] as $foreignTable)
+				{
+					$foreignName = $foreignTable->foreignName;
+					$className = ucfirst($foreignTable->_singularize($foreignName));
+					$obj = new $className();
+					$dbClassRef = $foreignTable->foreignKey;
+					$objs = $obj->packageFind($dbClassRef.' IN ('.$indices.')');
+					foreach($objs as $obj)
+					{
+						if(!is_array($arrRef[$obj->$dbClassRef]->$foreignName))
+							$arrRef[$obj->$dbClassRef]->$foreignName = array();
+						array_push($arrRef[$obj->$dbClassRef]->$foreignName, $obj);
+					}
+				}
+				
+			}
+			if(!empty($relations['belongsTo']))
+			{
+				foreach($relations['belongsTo'] as $foreignTable)
+				{
+					$foreignTableRef = $foreignTable->foreignKey;
+					if(empty($bTos[$foreignTableRef]))
+						continue;
+					if(($k = reset($foreignTable->TableInfo()->keys)))
+					{
+						$belongsToId = $k;
+					}
+					else
+					{
+						$belongsToId = 'id';
+					}						
+					$origObjsArr = $bTos[$foreignTableRef];
+					$bTosString = implode(',', array_keys($bTos[$foreignTableRef]));
+					$foreignName = $foreignTable->foreignName;
+					$className = ucfirst($foreignTable->_singularize($foreignName));
+					$obj = new $className();
+					$objs = $obj->packageFind($belongsToId.' IN ('.$bTosString.')');
+					foreach($objs as $obj)
+					{
+						foreach($origObjsArr[$obj->$belongsToId] as $idx=>$origObj)
+						{
+							$origObj->$foreignName = $obj;
+						}
+					}
+				}
+			}
+		}
+
+		return $arr;
+}
+?>
diff --git a/third_party/adodb/adodb-csvlib.inc.php b/third_party/adodb/adodb-csvlib.inc.php
index 2872f20..7b1c9e1 100644
--- a/third_party/adodb/adodb-csvlib.inc.php
+++ b/third_party/adodb/adodb-csvlib.inc.php
@@ -8,7 +8,7 @@ $ADODB_INCLUDED_CSV = 1;
 
 /* 
 
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
@@ -71,6 +71,7 @@ $ADODB_INCLUDED_CSV = 1;
 		$savefetch = isset($rs->adodbFetchMode) ? $rs->adodbFetchMode : $rs->fetchMode;
 		$class = $rs->connection->arrayClass;
 		$rs2 = new $class();
+		$rs2->timeCreated = $rs->timeCreated; # memcache fix
 		$rs2->sql = $rs->sql;
 		$rs2->oldProvider = $rs->dataProvider; 
 		$rs2->InitArrayFields($rows,$flds);
@@ -287,7 +288,7 @@ $ADODB_INCLUDED_CSV = 1;
 			fclose($fd);
 			
 			if ($ok) {
-				chmod($tmpname,0644);
+				@chmod($tmpname,0644);
 				// the tricky moment
 				@unlink($filename);
 				if (!@rename($tmpname,$filename)) {
@@ -305,7 +306,7 @@ $ADODB_INCLUDED_CSV = 1;
 			if (fwrite( $fd, $contents )) $ok = true;
 			else $ok = false;
 			fclose($fd);
-			chmod($filename,0644);
+			@chmod($filename,0644);
 		}else {
 			fclose($fd);
 			if ($debug)ADOConnection::outp( " Failed acquiring lock for $filename<br>\n");
diff --git a/third_party/adodb/adodb-datadict.inc.php b/third_party/adodb/adodb-datadict.inc.php
index d98d551..19500ca 100644
--- a/third_party/adodb/adodb-datadict.inc.php
+++ b/third_party/adodb/adodb-datadict.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -230,6 +230,7 @@ class ADODB_DataDict {
 		'CHARACTER' => 'C',
 		'INTERVAL' => 'C',  # Postgres
 		'MACADDR' => 'C', # postgres
+		'VAR_STRING' => 'C', # mysql
 		##
 		'LONGCHAR' => 'X',
 		'TEXT' => 'X',
@@ -257,6 +258,7 @@ class ADODB_DataDict {
 		'TIMESTAMP' => 'T',
 		'DATETIME' => 'T',
 		'TIMESTAMPTZ' => 'T',
+		'SMALLDATETIME' => 'T',
 		'T' => 'T',
 		'TIMESTAMP WITHOUT TIME ZONE' => 'T', // postgresql
 		##
@@ -517,7 +519,7 @@ class ADODB_DataDict {
 			// genfields can return FALSE at times
 			if ($lines == null) $lines = array();
 			list(,$first) = each($lines);
-			list(,$column_def) = split("[\t ]+",$first,2);
+			list(,$column_def) = preg_split("/[\t ]+/",$first,2);
 		}
 		return array(sprintf($this->renameColumn,$tabname,$this->NameQuote($oldcolumn),$this->NameQuote($newcolumn),$column_def));
 	}
@@ -812,7 +814,7 @@ class ADODB_DataDict {
 	
 	
 	// return string must begin with space
-	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint)
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{	
 		$suffix = '';
 		if (strlen($fdefault)) $suffix .= " DEFAULT $fdefault";
@@ -917,7 +919,7 @@ class ADODB_DataDict {
 	This function changes/adds new fields to your table. You don't
 	have to know if the col is new or not. It will check on its own.
 	*/
-	function ChangeTableSQL($tablename, $flds, $tableoptions = false)
+	function ChangeTableSQL($tablename, $flds, $tableoptions = false, $dropOldFlds=false)
 	{
 	global $ADODB_FETCH_MODE;
 	
@@ -950,13 +952,15 @@ class ADODB_DataDict {
 					$obj = $cols[$k];
 					if (isset($obj->not_null) && $obj->not_null)
 						$v = str_replace('NOT NULL','',$v);
-
+					if (isset($obj->auto_increment) && $obj->auto_increment && empty($v['AUTOINCREMENT'])) 
+					    $v = str_replace('AUTOINCREMENT','',$v);
+					
 					$c = $cols[$k];
 					$ml = $c->max_length;
 					$mt = $this->MetaType($c->type,$ml);
 					if ($ml == -1) $ml = '';
 					if ($mt == 'X') $ml = $v['SIZE'];
-					if (($mt != $v['TYPE']) ||  $ml != $v['SIZE']) {
+					if (($mt != $v['TYPE']) ||  $ml != $v['SIZE'] || (isset($v['AUTOINCREMENT']) && $v['AUTOINCREMENT'] != $obj->auto_increment)) {
 						$holdflds[$k] = $v;
 					}
 				} else {
@@ -993,6 +997,11 @@ class ADODB_DataDict {
 			}
 		}
 		
+		if ($dropOldFlds) {
+			foreach ( $cols as $id => $v )
+			    if ( !isset($lines[$id]) ) 
+					$sql[] = $alter . $this->dropCol . ' ' . $v->name;
+		}
 		return $sql;
 	}
 } // class
diff --git a/third_party/adodb/adodb-error.inc.php b/third_party/adodb/adodb-error.inc.php
index 72779ab..ae0b9e3 100644
--- a/third_party/adodb/adodb-error.inc.php
+++ b/third_party/adodb/adodb-error.inc.php
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
diff --git a/third_party/adodb/adodb-errorhandler.inc.php b/third_party/adodb/adodb-errorhandler.inc.php
index 4b7941f..3cf68a4 100644
--- a/third_party/adodb/adodb-errorhandler.inc.php
+++ b/third_party/adodb/adodb-errorhandler.inc.php
@@ -1,6 +1,6 @@
 <?php
 /**
- * @version V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license.
  * Whenever there is any discrepancy between the two licenses,
  * the BSD license will take precedence.
diff --git a/third_party/adodb/adodb-errorpear.inc.php b/third_party/adodb/adodb-errorpear.inc.php
index 70c2f6e..d1e2eb9 100644
--- a/third_party/adodb/adodb-errorpear.inc.php
+++ b/third_party/adodb/adodb-errorpear.inc.php
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/adodb-exceptions.inc.php b/third_party/adodb/adodb-exceptions.inc.php
index d2f589b..b444706 100644
--- a/third_party/adodb/adodb-exceptions.inc.php
+++ b/third_party/adodb/adodb-exceptions.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
- * @version V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license.
  * Whenever there is any discrepancy between the two licenses,
  * the BSD license will take precedence.
diff --git a/third_party/adodb/adodb-iterator.inc.php b/third_party/adodb/adodb-iterator.inc.php
index 73e8904..0ecea26 100644
--- a/third_party/adodb/adodb-iterator.inc.php
+++ b/third_party/adodb/adodb-iterator.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/adodb-lib.inc.php b/third_party/adodb/adodb-lib.inc.php
index c5d2970..9b46ded 100644
--- a/third_party/adodb/adodb-lib.inc.php
+++ b/third_party/adodb/adodb-lib.inc.php
@@ -10,7 +10,7 @@ global $ADODB_INCLUDED_LIB;
 $ADODB_INCLUDED_LIB = 1;
 
 /* 
- @version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim\@natsoft.com.my). All rights reserved.
+ @version V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim\@natsoft.com.my). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
@@ -147,7 +147,7 @@ function _adodb_replace(&$zthis, $table, $fieldArray, $keyCol, $autoQuote, $has_
 			if ($v === null) {
 				$v = 'NULL';
 				$fieldArray[$k] = $v;
-			} else if ($autoQuote && !is_numeric($v) /*and strncmp($v,"'",1) !== 0 -- sql injection risk*/ and strcasecmp($v,$zthis->null2null)!=0) {
+			} else if ($autoQuote && /*!is_numeric($v) /*and strncmp($v,"'",1) !== 0 -- sql injection risk*/ strcasecmp($v,$zthis->null2null)!=0) {
 				$v = $zthis->qstr($v);
 				$fieldArray[$k] = $v;
 			}
@@ -159,7 +159,7 @@ function _adodb_replace(&$zthis, $table, $fieldArray, $keyCol, $autoQuote, $has_
 			} else
 				$uSet .= ",$k=$v";
 		}
-		 
+		
 		$where = false;
 		foreach ($keyCol as $v) {
 			if (isset($fieldArray[$v])) {
@@ -1053,11 +1053,13 @@ function _adodb_debug_execute(&$zthis, $sql, $inputarr)
 			$ss = '<code>'.htmlspecialchars($ss).'</code>';
 		}
 		if ($zthis->debug === -1)
-			ADOConnection::outp( "<br />\n($dbt): ".htmlspecialchars($sqlTxt)." &nbsp; $ss\n<br />\n",false);
-		else 
-			ADOConnection::outp( "<hr />\n($dbt): ".htmlspecialchars($sqlTxt)." &nbsp; $ss\n<hr />\n",false);
+			ADOConnection::outp( "<br>\n($dbt): ".htmlspecialchars($sqlTxt)." &nbsp; $ss\n<br>\n",false);
+		else if ($zthis->debug !== -99)
+			ADOConnection::outp( "<hr>\n($dbt): ".htmlspecialchars($sqlTxt)." &nbsp; $ss\n<hr>\n",false);
 	} else {
-		ADOConnection::outp("-----\n($dbt): ".$sqlTxt."\n-----\n",false);
+		$ss = "\n   ".$ss;
+		if ($zthis->debug !== -99)
+			ADOConnection::outp("-----<hr>\n($dbt): ".$sqlTxt." $ss\n-----<hr>\n",false);
 	}
 
 	$qID = $zthis->_query($sql,$inputarr);
@@ -1068,10 +1070,21 @@ function _adodb_debug_execute(&$zthis, $sql, $inputarr)
 	*/
 	if ($zthis->databaseType == 'mssql') { 
 	// ErrorNo is a slow function call in mssql, and not reliable in PHP 4.0.6
+	
 		if($emsg = $zthis->ErrorMsg()) {
-			if ($err = $zthis->ErrorNo()) ADOConnection::outp($err.': '.$emsg);
+			if ($err = $zthis->ErrorNo()) {
+				if ($zthis->debug === -99) 
+					ADOConnection::outp( "<hr>\n($dbt): ".htmlspecialchars($sqlTxt)." &nbsp; $ss\n<hr>\n",false);
+		
+				ADOConnection::outp($err.': '.$emsg);
+			}
 		}
 	} else if (!$qID) {
+	
+		if ($zthis->debug === -99) 
+				if ($inBrowser) ADOConnection::outp( "<hr>\n($dbt): ".htmlspecialchars($sqlTxt)." &nbsp; $ss\n<hr>\n",false);
+				else ADOConnection::outp("-----<hr>\n($dbt): ".$sqlTxt."$ss\n-----<hr>\n",false);
+				
 		ADOConnection::outp($zthis->ErrorNo() .': '. $zthis->ErrorMsg());
 	}
 	
@@ -1080,11 +1093,13 @@ function _adodb_debug_execute(&$zthis, $sql, $inputarr)
 }
 
 # pretty print the debug_backtrace function
-function _adodb_backtrace($printOrArr=true,$levels=9999,$skippy=0)
+function _adodb_backtrace($printOrArr=true,$levels=9999,$skippy=0,$ishtml=null)
 {
 	if (!function_exists('debug_backtrace')) return '';
 	 
-	$html =  (isset($_SERVER['HTTP_USER_AGENT']));
+	if ($ishtml === null) $html =  (isset($_SERVER['HTTP_USER_AGENT']));
+	else $html = $ishtml;
+	
 	$fmt =  ($html) ? "</font><font color=#808080 size=-1> %% line %4d, file: <a href=\"file:/%s\">%s</a></font>" : "%% line %4d, file: %s";
 
 	$MAXSTRLEN = 128;
@@ -1115,7 +1130,7 @@ function _adodb_backtrace($printOrArr=true,$levels=9999,$skippy=0)
 			else if (is_bool($v)) $args[] = $v ? 'true' : 'false';
 			else {
 				$v = (string) @$v;
-				$str = htmlspecialchars(substr($v,0,$MAXSTRLEN));
+				$str = htmlspecialchars(str_replace(array("\r","\n"),' ',substr($v,0,$MAXSTRLEN)));
 				if (strlen($v) > $MAXSTRLEN) $str .= '...';
 				$args[] = $str;
 			}
diff --git a/third_party/adodb/adodb-memcache.lib.inc.php b/third_party/adodb/adodb-memcache.lib.inc.php
index a4b7e75..dad4c38 100644
--- a/third_party/adodb/adodb-memcache.lib.inc.php
+++ b/third_party/adodb/adodb-memcache.lib.inc.php
@@ -6,113 +6,185 @@ if (!defined('ADODB_DIR')) die();
 global $ADODB_INCLUDED_MEMCACHE;
 $ADODB_INCLUDED_MEMCACHE = 1;
 
+global $ADODB_INCLUDED_CSV;
+if (empty($ADODB_INCLUDED_CSV)) include(ADODB_DIR.'/adodb-csvlib.inc.php');
+
 /* 
 
-  V4.90 8 June 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
   Set tabs to 4 for best viewing.
   
   Latest version is available at http://adodb.sourceforge.net
+
+Usage:
+  
+$db = NewADOConnection($driver);
+$db->memCache = true; /// should we use memCache instead of caching in files
+$db->memCacheHost = array($ip1, $ip2, $ip3);
+$db->memCachePort = 11211; /// this is default memCache port
+$db->memCacheCompress = false; /// Use 'true' to store the item compressed (uses zlib)
+
+$db->Connect(...);
+$db->CacheExecute($sql);
+  
+  Note the memcache class is shared by all connections, is created during the first call to Connect/PConnect.
   
+  Class instance is stored in $ADODB_CACHE
 */
 
-	function getmemcache($key,&$err, $timeout=0, $host, $port)
-	{
-		$false = false;
-		$err = false;
-
-		if (!function_exists('memcache_pconnect')) {
-			$err = 'Memcache module PECL extension not found!';
-			return $false;
+	class ADODB_Cache_MemCache {
+		var $createdir = false; // create caching directory structure?
+		
+		//-----------------------------
+		// memcache specific variables
+		
+		var $hosts;	// array of hosts
+		var $port = 11211;
+		var $compress = false; // memcache compression with zlib
+		
+		var $_connected = false;
+		var $_memcache = false;
+		
+		function ADODB_Cache_MemCache(&$obj)
+		{
+			$this->hosts = $obj->memCacheHost;
+			$this->port = $obj->memCachePort;
+			$this->compress = $obj->memCacheCompress;
 		}
+		
+		// implement as lazy connection. The connection only occurs on CacheExecute call
+		function connect(&$err)
+		{
+			if (!function_exists('memcache_pconnect')) {
+				$err = 'Memcache module PECL extension not found!';
+				return false;
+			}
 
-		$memcache = new Memcache;
-		if (!@$memcache->pconnect($host, $port)) {
-			$err = 'Can\'t connect to memcache server on: '.$host.':'.$port;
-			return $false;
+			$memcache = new MemCache;
+			
+			if (!is_array($this->hosts)) $this->hosts = array($this->hosts);
+		
+			$failcnt = 0;
+			foreach($this->hosts as $host) {
+				if (!@$memcache->addServer($host,$this->port,true)) {
+					$failcnt += 1;
+				}
+			}
+			if ($failcnt == sizeof($this->hosts)) {
+				$err = 'Can\'t connect to any memcache server';
+				return false;
+			}
+			$this->_connected = true;
+			$this->_memcache = $memcache;
+			return true;
 		}
-
-		$rs = $memcache->get($key);
-		if (!$rs) {
-			$err = 'Item with such key doesn\'t exists on the memcached server.';
-			return $false;
+		
+		// returns true or false. true if successful save
+		function writecache($filename, $contents, $debug, $secs2cache)
+		{
+			if (!$this->_connected) {
+				$err = '';
+				if (!$this->connect($err) && $debug) ADOConnection::outp($err);
+			}
+			if (!$this->_memcache) return false;
+			
+			if (!$this->_memcache->set($filename, $contents, $this->compress, $secs2cache)) {
+				if ($debug) ADOConnection::outp(" Failed to save data at the memcached server!<br>\n");
+				return false;
+			}
+			
+			return true;
 		}
-
-		$tdiff = intval($rs->timeCreated+$timeout - time());
-		if ($tdiff <= 2) {
-			switch($tdiff) {
-				case 2: 
-					if ((rand() & 15) == 0) {
-						$err = "Timeout 2";
-						return $false;
-					}
-					break;
-				case 1:
-					if ((rand() & 3) == 0) {
-						$err = "Timeout 1";
+		
+		// returns a recordset
+		function readcache($filename, &$err, $secs2cache, $rsClass)
+		{
+			$false = false;
+			if (!$this->_connected) $this->connect($err);
+			if (!$this->_memcache) return $false;
+			
+			$rs = $this->_memcache->get($filename);
+			if (!$rs) {
+				$err = 'Item with such key doesn\'t exists on the memcached server.';
+				return $false;
+			}
+			
+			// hack, should actually use _csv2rs
+			$rs = explode("\n", $rs);
+            unset($rs[0]);
+            $rs = join("\n", $rs);
+ 			$rs = unserialize($rs);
+			if (! is_object($rs)) {
+				$err = 'Unable to unserialize $rs';		
+				return $false;
+			}
+			if ($rs->timeCreated == 0) return $rs; // apparently have been reports that timeCreated was set to 0 somewhere
+			
+			$tdiff = intval($rs->timeCreated+$secs2cache - time());
+			if ($tdiff <= 2) {
+				switch($tdiff) {
+					case 2: 
+						if ((rand() & 15) == 0) {
+							$err = "Timeout 2";
+							return $false;
+						}
+						break;
+					case 1:
+						if ((rand() & 3) == 0) {
+							$err = "Timeout 1";
+							return $false;
+						}
+						break;
+					default: 
+						$err = "Timeout 0";
 						return $false;
-					}
-					break;
-				default: 
-					$err = "Timeout 0";
-					return $false;
+				}
 			}
+			return $rs;
 		}
-		return $rs;
-	}
-
-	function putmemcache($key, $rs, $host, $port, $compress, $debug=false)
-	{
-		$false = false;
-		$true = true;
-
-		if (!function_exists('memcache_pconnect')) {
-			if ($debug) ADOConnection::outp(" Memcache module PECL extension not found!<br>\n");
-			return $false;
+		
+		function flushall($debug=false)
+		{
+			if (!$this->_connected) {
+				$err = '';
+				if (!$this->connect($err) && $debug) ADOConnection::outp($err);
+			}
+			if (!$this->_memcache) return false;
+			
+			$del = $this->_memcache->flush();
+			
+			if ($debug) 
+				if (!$del) ADOConnection::outp("flushall: failed!<br>\n");
+				else ADOConnection::outp("flushall: succeeded!<br>\n");
+				
+			return $del;
 		}
-
-		$memcache = new Memcache;
-		if (!@$memcache->pconnect($host, $port)) {
-			if ($debug) ADOConnection::outp(" Can't connect to memcache server on: $host:$port<br>\n");
-			return $false;
+		
+		function flushcache($filename, $debug=false)
+		{
+			if (!$this->_connected) {
+  				$err = '';
+  				if (!$this->connect($err) && $debug) ADOConnection::outp($err); 
+			} 
+			if (!$this->_memcache) return false;
+  
+			$del = $this->_memcache->delete($filename);
+			
+			if ($debug) 
+				if (!$del) ADOConnection::outp("flushcache: $key entry doesn't exist on memcached server!<br>\n");
+				else ADOConnection::outp("flushcache: $key entry flushed from memcached server!<br>\n");
+				
+			return $del;
 		}
-
-		$rs->timeCreated = time();
-		if (!$memcache->set($key, $rs, $compress, 0)) {
-			if ($debug) ADOConnection::outp(" Failed to save data at the memcached server!<br>\n");
-			return $false;
+		
+		// not used for memcache
+		function createdir($dir, $hash) 
+		{
+			return true;
 		}
-		return $true;
 	}
 
-	function flushmemcache($key=false, $host, $port, $debug=false)
-	{
-		if (!function_exists('memcache_pconnect')) {
-			if ($debug) ADOConnection::outp(" Memcache module PECL extension not found!<br>\n");
-			return;
-		}
-
-		$memcache = new Memcache;
-		if (!@$memcache->pconnect($host, $port)) {
-			if ($debug) ADOConnection::outp(" Can't connect to memcache server on: $host:$port<br>\n");
-			return;
-		}
-
-		if ($key) {
-			if (!$memcache->delete($key)) {
-				if ($debug) ADOConnection::outp("CacheFlush: $key entery doesn't exist on memcached server!<br>\n");
-			} else {
-				if ($debug) ADOConnection::outp("CacheFlush: $key entery flushed from memcached server!<br>\n");
-			}
-		} else {
-			if (!$memcache->flush()) {
-				if ($debug) ADOConnection::outp("CacheFlush: Failure flushing all enteries from memcached server!<br>\n");
-			} else {
-				if ($debug) ADOConnection::outp("CacheFlush: All enteries flushed from memcached server!<br>\n");
-			}
-		}
-		return;
-	}
-?>
+?>
\ No newline at end of file
diff --git a/third_party/adodb/adodb-pager.inc.php b/third_party/adodb/adodb-pager.inc.php
index 16acee3..d6980c1 100644
--- a/third_party/adodb/adodb-pager.inc.php
+++ b/third_party/adodb/adodb-pager.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-	V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+	V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
 	  Released under both BSD license and Lesser GPL library license. 
 	  Whenever there is any discrepancy between the two licenses, 
 	  the BSD license will take precedence. 
@@ -60,7 +60,7 @@ class ADODB_Pager {
 	global $PHP_SELF;
 	
 		$curr_page = $id.'_curr_page';
-		if (empty($PHP_SELF)) $PHP_SELF = htmlspecialchars($_SERVER['PHP_SELF']); // htmlspecialchars() to prevent XSS attacks
+		if (!empty($PHP_SELF)) $PHP_SELF = htmlspecialchars($_SERVER['PHP_SELF']); // htmlspecialchars() to prevent XSS attacks
 		
 		$this->sql = $sql;
 		$this->id = $id;
diff --git a/third_party/adodb/adodb-pear.inc.php b/third_party/adodb/adodb-pear.inc.php
index 60696c5..6563704 100644
--- a/third_party/adodb/adodb-pear.inc.php
+++ b/third_party/adodb/adodb-pear.inc.php
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
@@ -211,7 +211,7 @@ class DB
 	function isError($value)
 	{
 		if (!is_object($value)) return false;
-		$class = get_class($value);
+		$class = strtolower(get_class($value));
 		return $class == 'pear_error' || is_subclass_of($value, 'pear_error') || 
 				$class == 'db_error' || is_subclass_of($value, 'db_error');
 	}
diff --git a/third_party/adodb/adodb-perf.inc.php b/third_party/adodb/adodb-perf.inc.php
index 50af6e3..bd50c8f 100644
--- a/third_party/adodb/adodb-perf.inc.php
+++ b/third_party/adodb/adodb-perf.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
@@ -57,12 +57,10 @@ function adodb_round($n,$prec)
 	return number_format($n, $prec, '.', '');
 }
 
-/* return microtime value as a float */
+/* obsolete: return microtime value as a float. Retained for backward compat */
 function adodb_microtime()
 {
-	$t = microtime();
-	$t = explode(' ',$t);
-	return (float)$t[1]+ (float)$t[0];
+	return microtime(true);
 }
 
 /* sql code timing */
@@ -70,9 +68,9 @@ function adodb_log_sql(&$connx,$sql,$inputarr)
 {
     $perf_table = adodb_perf::table();
 	$connx->fnExecute = false;
-	$t0 = microtime();
+	$a0 = microtime(true);
 	$rs = $connx->Execute($sql,$inputarr);
-	$t1 = microtime();
+	$a1 = microtime(true);
 
 	if (!empty($connx->_logsql) && (empty($connx->_logsqlErrors) || !$rs)) {
 	global $ADODB_LOG_CONN;
@@ -91,12 +89,6 @@ function adodb_log_sql(&$connx,$sql,$inputarr)
 		$conn->_logsql = false; // disable logsql error simulation
 		$dbT = $conn->databaseType;
 		
-		$a0 = split(' ',$t0);
-		$a0 = (float)$a0[1]+(float)$a0[0];
-		
-		$a1 = split(' ',$t1);
-		$a1 = (float)$a1[1]+(float)$a1[0];
-		
 		$time = $a1 - $a0;
 	
 		if (!$rs) {
@@ -117,9 +109,9 @@ function adodb_log_sql(&$connx,$sql,$inputarr)
 		}
 		if (isset($_SERVER['HTTP_HOST'])) {
 			$tracer .= '<br>'.$_SERVER['HTTP_HOST'];
-			if (isset($_SERVER['PHP_SELF'])) $tracer .= $_SERVER['PHP_SELF'];
+			if (isset($_SERVER['PHP_SELF'])) $tracer .= htmlspecialchars($_SERVER['PHP_SELF']);
 		} else 
-			if (isset($_SERVER['PHP_SELF'])) $tracer .= '<br>'.$_SERVER['PHP_SELF'];
+			if (isset($_SERVER['PHP_SELF'])) $tracer .= '<br>'.htmlspecialchars($_SERVER['PHP_SELF']);
 		//$tracer .= (string) adodb_backtrace(false);
 		
 		$tracer = (string) substr($tracer,0,500);
@@ -264,7 +256,7 @@ processes 69293
 
 */
 		// Algorithm is taken from
-		// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/example__obtaining_raw_performance_data.asp
+		// http://social.technet.microsoft.com/Forums/en-US/winservergen/thread/414b0e1b-499c-411e-8a02-6a12e339c0f1/
 		if (strncmp(PHP_OS,'WIN',3)==0) {
 			if (PHP_VERSION == '5.0.0') return false;
 			if (PHP_VERSION == '5.0.1') return false;
@@ -272,14 +264,33 @@ processes 69293
 			if (PHP_VERSION == '5.0.3') return false;
 			if (PHP_VERSION == '4.3.10') return false; # see http://bugs.php.net/bug.php?id=31737
 			
-			@$c = new COM("WinMgmts:{impersonationLevel=impersonate}!Win32_PerfRawData_PerfOS_Processor.Name='_Total'");
-			if (!$c) return false;
+			static $FAIL = false;
+			if ($FAIL) return false;
+			
+			$objName = "winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\CIMV2";	
+			$myQuery = "SELECT * FROM Win32_PerfFormattedData_PerfOS_Processor WHERE Name = '_Total'";
+			
+			try {
+				@$objWMIService = new COM($objName);
+				if (!$objWMIService) {
+					$FAIL = true;
+					return false;
+				}
+		
+				$info[0] = -1;
+				$info[1] = 0;
+				$info[2] = 0;
+				$info[3] = 0;
+				foreach($objWMIService->ExecQuery($myQuery) as $objItem)  {
+						$info[0] = $objItem->PercentProcessorTime();
+				}
+			
+			} catch(Exception $e) {
+				$FAIL = true;
+				echo $e->getMessage();
+				return false;
+			}
 			
-			$info[0] = $c->PercentProcessorTime;
-			$info[1] = 0;
-			$info[2] = 0;
-			$info[3] = $c->TimeStamp_Sys100NS;
-			//print_r($info);
 			return $info;
 		}
 		
@@ -342,27 +353,26 @@ Committed_AS:   348732 kB
 	{
 		$info = $this->_CPULoad();
 		if (!$info) return false;
-			
-		if (empty($this->_lastLoad)) {
-			sleep(1);
-			$this->_lastLoad = $info;
-			$info = $this->_CPULoad();
-		}
-		
-		$last = $this->_lastLoad;
-		$this->_lastLoad = $info;
-		
-		$d_user = $info[0] - $last[0];
-		$d_nice = $info[1] - $last[1];
-		$d_system = $info[2] - $last[2];
-		$d_idle = $info[3] - $last[3];
 		
-		//printf("Delta - User: %f  Nice: %f  System: %f  Idle: %f<br>",$d_user,$d_nice,$d_system,$d_idle);
-
 		if (strncmp(PHP_OS,'WIN',3)==0) {
-			if ($d_idle < 1) $d_idle = 1;
-			return 100*(1-$d_user/$d_idle);
+			return (integer) $info[0];
 		}else {
+			if (empty($this->_lastLoad)) {
+				sleep(1);
+				$this->_lastLoad = $info;
+				$info = $this->_CPULoad();
+			}
+			
+			$last = $this->_lastLoad;
+			$this->_lastLoad = $info;
+			
+			$d_user = $info[0] - $last[0];
+			$d_nice = $info[1] - $last[1];
+			$d_system = $info[2] - $last[2];
+			$d_idle = $info[3] - $last[3];
+			
+			//printf("Delta - User: %f  Nice: %f  System: %f  Idle: %f<br>",$d_user,$d_nice,$d_system,$d_idle);
+		
 			$total=$d_user+$d_nice+$d_system+$d_idle;
 			if ($total<1) $total=1;
 			return 100*($d_user+$d_nice+$d_system)/$total; 
@@ -727,8 +737,9 @@ Committed_AS:   348732 kB
 			echo $this->CheckMemory();		
 			break;
 		case 'poll':
+			$self = htmlspecialchars($_SERVER['PHP_SELF']);
 			echo "<iframe width=720 height=80% 
-				src=\"{$_SERVER['PHP_SELF']}?do=poll2&hidem=1\"></iframe>";
+				src=\"{$self}?do=poll2&hidem=1\"></iframe>";
 			break;
 		case 'poll2':
 			echo "<pre>";
@@ -905,7 +916,7 @@ Committed_AS:   348732 kB
 	{
 	
 		
-		$PHP_SELF = $_SERVER['PHP_SELF'];
+		$PHP_SELF = htmlspecialchars($_SERVER['PHP_SELF']);
 		$sql = isset($_REQUEST['sql']) ? $_REQUEST['sql'] : '';
 
 		if (isset($_SESSION['phplens_sqlrows'])) $rows = $_SESSION['phplens_sqlrows'];
diff --git a/third_party/adodb/adodb-php4.inc.php b/third_party/adodb/adodb-php4.inc.php
index dca7610..aa8fa0f 100644
--- a/third_party/adodb/adodb-php4.inc.php
+++ b/third_party/adodb/adodb-php4.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/adodb-time.inc.php b/third_party/adodb/adodb-time.inc.php
index 19b22fb..0763895 100644
--- a/third_party/adodb/adodb-time.inc.php
+++ b/third_party/adodb/adodb-time.inc.php
@@ -1006,7 +1006,6 @@ function adodb_tz_offset($gmt,$isphp5)
 		return sprintf('%s%02d%02d',($gmt<=0)?'+':'-',floor($zhrs),($zhrs-$hrs)*60); 
 	else
 		return sprintf('%s%02d%02d',($gmt<0)?'+':'-',floor($zhrs),($zhrs-$hrs)*60); 
-	break;
 }
 
 
@@ -1215,7 +1214,7 @@ function adodb_mktime($hr,$min,$sec,$mon=false,$day=false,$year=false,$is_dst=fa
 		
 		// for windows, we don't check 1970 because with timezone differences, 
 		// 1 Jan 1970 could generate negative timestamp, which is illegal
-		$usephpfns = (1971 < $year && $year < 2038
+		$usephpfns = (1970 < $year && $year < 2038
 			|| !defined('ADODB_NO_NEGATIVE_TS') && (1901 < $year && $year < 2038)
 			); 
 			
diff --git a/third_party/adodb/adodb-xmlschema.inc.php b/third_party/adodb/adodb-xmlschema.inc.php
index 4854f61..b2f0ddc 100644
--- a/third_party/adodb/adodb-xmlschema.inc.php
+++ b/third_party/adodb/adodb-xmlschema.inc.php
@@ -10,9 +10,9 @@
  * build a database on any ADOdb-supported platform using a simple
  * XML schema.
  *
- * Last Editor: $Author: franciscom $
+ * Last Editor: $Author: jlim $
  * @author Richard Tango-Lowy & Dan Cech
- * @version $Revision: 1.3 $
+ * @version $Revision: 1.12 $
  *
  * @package axmls
  * @tutorial getting_started.pkg
@@ -463,10 +463,12 @@ class dbTable extends dbObject {
 	* @return array Options
 	*/
 	function addTableOpt( $opt ) {
-		$this->opts[] = $opt;
-		
+		if(isset($this->currentPlatform)) {
+			$this->opts[$this->parent->db->databaseType] = $opt;
+		}
 		return $this->opts;
 	}
+
 	
 	/**
 	* Generates the SQL that will create the table in the database
@@ -1209,7 +1211,7 @@ class dbQuerySet extends dbObject {
 * @tutorial getting_started.pkg
 *
 * @author Richard Tango-Lowy & Dan Cech
-* @version $Revision: 1.3 $
+* @version $Revision: 1.12 $
 *
 * @package axmls
 */
diff --git a/third_party/adodb/adodb-xmlschema03.inc.php b/third_party/adodb/adodb-xmlschema03.inc.php
index 7ae26ac..cbd49b9 100644
--- a/third_party/adodb/adodb-xmlschema03.inc.php
+++ b/third_party/adodb/adodb-xmlschema03.inc.php
@@ -10,9 +10,9 @@
  * build a database on any ADOdb-supported platform using a simple
  * XML schema.
  *
- * Last Editor: $Author: franciscom $
+ * Last Editor: $Author: jlim $
  * @author Richard Tango-Lowy & Dan Cech
- * @version $Revision: 1.2 $
+ * @version $Revision: 1.62 $
  *
  * @package axmls
  * @tutorial getting_started.pkg
@@ -504,11 +504,12 @@ class dbTable extends dbObject {
 	* @return array Options
 	*/
 	function addTableOpt( $opt ) {
-		if( $this->currentPlatform ) {
-		$this->opts[] = $opt;
+		if(isset($this->currentPlatform)) {
+			$this->opts[$this->parent->db->databaseType] = $opt;
 		}
 		return $this->opts;
 	}
+
 	
 	/**
 	* Generates the SQL that will create the table in the database
@@ -1309,7 +1310,7 @@ class dbQuerySet extends dbObject {
 * @tutorial getting_started.pkg
 *
 * @author Richard Tango-Lowy & Dan Cech
-* @version $Revision: 1.2 $
+* @version $Revision: 1.62 $
 *
 * @package axmls
 */
@@ -1497,7 +1498,7 @@ class adoSchema {
 					$mode = XMLS_MODE_INSERT;
 					break;
 				default:
-					$mode = XMLS_EXISITNG_DATA;
+					$mode = XMLS_EXISTING_DATA;
 					break;
 			}
 			$this->existingData = $mode;
diff --git a/third_party/adodb/adodb.inc.php b/third_party/adodb/adodb.inc.php
index 42fc35a..9752d10 100644
--- a/third_party/adodb/adodb.inc.php
+++ b/third_party/adodb/adodb.inc.php
@@ -12,9 +12,9 @@
  */
 
 /**
-	\mainpage 	
+	\mainpage
 	
-	 @version V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+	 @version V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
 
 	Released under both BSD license and Lesser GPL library license. You can choose which license
 	you prefer.
@@ -54,9 +54,12 @@
 		$ADODB_vers, 		// database version
 		$ADODB_COUNTRECS,	// count number of records returned - slows down query
 		$ADODB_CACHE_DIR,	// directory to cache recordsets
+		$ADODB_CACHE,
+		$ADODB_CACHE_CLASS,
 		$ADODB_EXTENSION,   // ADODB extension installed
 		$ADODB_COMPAT_FETCH, // If $ADODB_COUNTRECS and this is true, $rs->fields is available on EOF
 	 	$ADODB_FETCH_MODE,	// DEFAULT, NUM, ASSOC or BOTH. Default follows native driver default...
+		$ADODB_GETONE_EOF,
 		$ADODB_QUOTE_FIELDNAMES; // Allows you to force quotes (backticks) around field names in queries generated by getinsertsql and getupdatesql.	
 	
 	//==============================================================================================	
@@ -119,6 +122,7 @@
 			die("PHP5 or later required. You are running ".PHP_VERSION);
 	}
 	
+	
 	//if (!defined('ADODB_ASSOC_CASE')) define('ADODB_ASSOC_CASE',2);
 
 	
@@ -146,12 +150,16 @@
 		$ADODB_COUNTRECS,	// count number of records returned - slows down query
 		$ADODB_CACHE_DIR,	// directory to cache recordsets
 	 	$ADODB_FETCH_MODE,
+		$ADODB_CACHE,
+		$ADODB_CACHE_CLASS,
 		$ADODB_FORCE_TYPE,
+		$ADODB_GETONE_EOF,
 		$ADODB_QUOTE_FIELDNAMES;
 		
+		if (empty($ADODB_CACHE_CLASS)) $ADODB_CACHE_CLASS =  'ADODB_Cache_File' ;
 		$ADODB_FETCH_MODE = ADODB_FETCH_DEFAULT;
 		$ADODB_FORCE_TYPE = ADODB_FORCE_VALUE;
-
+		$ADODB_GETONE_EOF = null;
 
 		if (!isset($ADODB_CACHE_DIR)) {
 			$ADODB_CACHE_DIR = '/tmp'; //(isset($_ENV['TMP'])) ? $_ENV['TMP'] : '/tmp';
@@ -169,7 +177,7 @@
 		/**
 		 * ADODB version as a string.
 		 */
-		$ADODB_vers = 'V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved. Released BSD & LGPL.';
+		$ADODB_vers = 'V5.10 10 Nov 2009  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved. Released BSD & LGPL.';
 	
 		/**
 		 * Determines whether recordset->RecordCount() is used. 
@@ -208,7 +216,7 @@
 */
 	}
 	
-
+	// for transaction handling
 	
 	function ADODB_TransMonitor($dbms, $fn, $errno, $errmsg, $p1, $p2, &$thisConnection)
 	{
@@ -220,6 +228,95 @@
 		}
 	}
 	
+	//------------------
+	// class for caching
+	class ADODB_Cache_File {
+	
+		var $createdir = true; // requires creation of temp dirs
+		
+		function ADODB_Cache_File()
+		{
+		global $ADODB_INCLUDED_CSV;
+			if (empty($ADODB_INCLUDED_CSV)) include_once(ADODB_DIR.'/adodb-csvlib.inc.php');
+		}
+		
+		// write serialised recordset to cache item/file
+		function writecache($filename, $contents,  $debug, $secs2cache)
+		{
+			return adodb_write_file($filename, $contents,$debug);
+		}
+		
+		// load serialised recordset and unserialise it
+		function &readcache($filename, &$err, $secs2cache, $rsClass)
+		{
+			$rs = csv2rs($filename,$err,$secs2cache,$rsClass);
+			return $rs;
+		}
+		
+		// flush all items in cache
+		function flushall($debug=false)
+		{
+		global $ADODB_CACHE_DIR;
+
+		$rez = false;
+		
+			if (strlen($ADODB_CACHE_DIR) > 1) {
+				$rez = $this->_dirFlush($ADODB_CACHE_DIR);
+	         	if ($debug) ADOConnection::outp( "flushall: $dir<br><pre>\n". $rez."</pre>");
+	   		}
+			return $rez;
+		}
+		
+		// flush one file in cache
+		function flushcache($f, $debug=false)
+		{
+			if (!@unlink($f)) {
+		   		if ($debug) ADOConnection::outp( "flushcache: failed for $f");
+			}
+		}
+		
+		function getdirname($hash)
+		{
+		global $ADODB_CACHE_DIR;
+			if (!isset($this->notSafeMode)) $this->notSafeMode = !ini_get('safe_mode');
+			return ($this->notSafeMode) ? $ADODB_CACHE_DIR.'/'.substr($hash,0,2) : $ADODB_CACHE_DIR;
+		}
+		
+		// create temp directories
+		function createdir($hash, $debug)
+		{
+			$dir = $this->getdirname($hash);
+			if ($this->notSafeMode && !file_exists($dir)) {
+				$oldu = umask(0);
+				if (!@mkdir($dir,0771)) if(!is_dir($dir) && $debug) ADOConnection::outp("Cannot create $dir");
+				umask($oldu);
+			}
+		
+			return $dir;
+		}
+		
+		/**
+		* Private function to erase all of the files and subdirectories in a directory.
+		*
+		* Just specify the directory, and tell it if you want to delete the directory or just clear it out.
+		* Note: $kill_top_level is used internally in the function to flush subdirectories.
+		*/
+		function _dirFlush($dir, $kill_top_level = false) 
+		{
+		   if(!$dh = @opendir($dir)) return;
+		   
+		   while (($obj = readdir($dh))) {
+		   		if($obj=='.' || $obj=='..') continue;
+				$f = $dir.'/'.$obj;
+		
+				if (strpos($obj,'.cache')) @unlink($f);
+				if (is_dir($f)) $this->_dirFlush($f, true);
+		   }
+		   if ($kill_top_level === true) @rmdir($dir);
+		   return true;
+		}
+	}
+	
 	//==============================================================================================	
 	// CLASS ADOConnection
 	//==============================================================================================	
@@ -280,6 +377,7 @@
 
 	var $sysDate = false; /// name of function that returns the current date
 	var $sysTimeStamp = false; /// name of function that returns the current timestamp
+	var $sysUTimeStamp = false; // name of function that returns the current timestamp accurate to the microsecond or nearest fraction
 	var $arrayClass = 'ADORecordSet_array'; /// name of class used to generate array recordsets, which are pre-downloaded recordsets
 	
 	var $noNullStrings = false; /// oracle specific stuff - if true ensures that '' is converted to ' '
@@ -417,6 +515,7 @@
 		if ($argDatabaseName != "") $this->database = $argDatabaseName;		
 		
 		$this->_isPersistentConnection = false;	
+			
 		if ($forceNew) {
 			if ($rez=$this->_nconnect($this->host, $this->user, $this->password, $this->database)) return true;
 		} else {
@@ -472,6 +571,7 @@
 	 */	
 	function PConnect($argHostname = "", $argUsername = "", $argPassword = "", $argDatabaseName = "")
 	{
+		
 		if (defined('ADODB_NEVER_PERSIST')) 
 			return $this->Connect($argHostname,$argUsername,$argPassword,$argDatabaseName);
 		
@@ -481,6 +581,7 @@
 		if ($argDatabaseName != "") $this->database = $argDatabaseName;		
 			
 		$this->_isPersistentConnection = true;	
+		
 		if ($rez = $this->_pconnect($this->host, $this->user, $this->password, $this->database)) return true;
 		if (isset($rez)) {
 			$err = $this->ErrorMsg();
@@ -508,6 +609,21 @@
 		ADOConnection::outp($msg);
 	}
 	
+	// create cache class. Code is backward compat with old memcache implementation
+	function _CreateCache()
+	{
+	global $ADODB_CACHE, $ADODB_CACHE_CLASS;
+	
+		if ($this->memCache) {
+		global $ADODB_INCLUDED_MEMCACHE;
+		
+			if (empty($ADODB_INCLUDED_MEMCACHE)) include(ADODB_DIR.'/adodb-memcache.lib.inc.php');
+				$ADODB_CACHE = new ADODB_Cache_MemCache($this);
+		} else
+				$ADODB_CACHE = new $ADODB_CACHE_CLASS($this);
+		
+	}
+	
 	// Format date column in sql string given an input format that understands Y M D
 	function SQLDate($fmt, $col=false)
 	{	
@@ -600,7 +716,7 @@
 	*  @param $table	name of table to lock
 	*  @param $where	where clause to use, eg: "WHERE row=12". If left empty, will escalate to table lock
 	*/
-	function RowLock($table,$where)
+	function RowLock($table,$where,$col='1 as ignore')
 	{
 		return false;
 	}
@@ -745,7 +861,7 @@
 	{
 		if ($this->transOff > 0) {
 			$this->transOff += 1;
-			return;
+			return true;
 		}
 		
 		$this->_oldRaiseFn = $this->raiseErrorFn;
@@ -753,8 +869,9 @@
 		$this->_transOK = true;
 		
 		if ($this->debug && $this->transCnt > 0) ADOConnection::outp("Bad Transaction: StartTrans called within BeginTrans");
-		$this->BeginTrans();
+		$ok = $this->BeginTrans();
 		$this->transOff = 1;
+		return $ok;
 	}
 	
 	
@@ -839,7 +956,7 @@
 			
 			if (!is_array($sql) && !$this->_bindInputArray) {
 				$sqlarr = explode('?',$sql);
-					
+				$nparams = sizeof($sqlarr)-1;
 				if (!$array_2d) $inputarr = array($inputarr);
 				foreach($inputarr as $arr) {
 					$sql = ''; $i = 0;
@@ -864,7 +981,9 @@
 						else
 							$sql .= $v;
 						$i += 1;
-					}
+						
+						if ($i == $nparams) break;
+					} // while
 					if (isset($sqlarr[$i])) {
 						$sql .= $sqlarr[$i];
 						if ($i+1 != sizeof($sqlarr)) $this->outp_throw( "Input Array does not match ?: ".htmlspecialchars($sql),'Execute');
@@ -1181,13 +1300,10 @@
 		$savec = $ADODB_COUNTRECS;
 		$ADODB_COUNTRECS = false;
 			
-		if ($offset>0){
-			if ($secs2cache != 0) $rs = $this->CacheExecute($secs2cache,$sql,$inputarr);
-			else $rs = $this->Execute($sql,$inputarr);
-		} else {
-			if ($secs2cache != 0) $rs = $this->CacheExecute($secs2cache,$sql,$inputarr);
-			else $rs = $this->Execute($sql,$inputarr);
-		}
+
+		if ($secs2cache != 0) $rs = $this->CacheExecute($secs2cache,$sql,$inputarr);
+		else $rs = $this->Execute($sql,$inputarr);
+		
 		$ADODB_COUNTRECS = $savec;
 		if ($rs && !$rs->EOF) {
 			$rs = $this->_rs2rs($rs,$nrows,$offset);
@@ -1300,14 +1416,14 @@
 	*/
 	function GetOne($sql,$inputarr=false)
 	{
-	global $ADODB_COUNTRECS;
+	global $ADODB_COUNTRECS,$ADODB_GETONE_EOF;
 		$crecs = $ADODB_COUNTRECS;
 		$ADODB_COUNTRECS = false;
 		
 		$ret = false;
 		$rs = $this->Execute($sql,$inputarr);
 		if ($rs) {	
-			if ($rs->EOF) $ret = null;
+			if ($rs->EOF) $ret = $ADODB_GETONE_EOF;
 			else $ret = reset($rs->fields);
 			
 			$rs->Close();
@@ -1316,12 +1432,26 @@
 		return $ret;
 	}
 	
+	// $where should include 'WHERE fld=value'
+	function GetMedian($table, $field,$where = '')
+	{
+		$total = $this->GetOne("select count(*) from $table $where");
+		if (!$total) return false;
+	
+		$midrow = (integer) ($total/2);
+		$rs = $this->SelectLimit("select $field from $table $where order by 1",1,$midrow);
+		if ($rs && !$rs->EOF) return reset($rs->fields);
+		return false;
+	}
+	
+	
 	function CacheGetOne($secs2cache,$sql=false,$inputarr=false)
 	{
+	global $ADODB_GETONE_EOF;
 		$ret = false;
 		$rs = $this->CacheExecute($secs2cache,$sql,$inputarr);
 		if ($rs) {
-			if ($rs->EOF) $ret = null;
+			if ($rs->EOF) $ret = $ADODB_GETONE_EOF;
 			else $ret = reset($rs->fields);
 			$rs->Close();
 		} 
@@ -1456,7 +1586,7 @@
 	function GetRandRow($sql, $arr= false)
 	{
 		$rezarr = $this->GetAll($sql, $arr);
-		$sz = sizeof($rez);
+		$sz = sizeof($rezarr);
 		return $rezarr[abs(rand()) % $sz];
 	}
 	
@@ -1573,103 +1703,19 @@
     */
 	function CacheFlush($sql=false,$inputarr=false)
 	{
-	global $ADODB_CACHE_DIR;
-	
-		if ($this->memCache) {
-		global $ADODB_INCLUDED_MEMCACHE;
+	global $ADODB_CACHE_DIR, $ADODB_CACHE;
 		
-			$key = false;
-			if (empty($ADODB_INCLUDED_MEMCACHE)) include(ADODB_DIR.'/adodb-memcache.lib.inc.php');
-			if ($sql) $key = $this->_gencachename($sql.serialize($inputarr),false,true);
-			FlushMemCache($key, $this->memCacheHost, $this->memCachePort, $this->debug);
-			return;
-		}
-	
-		if (strlen($ADODB_CACHE_DIR) > 1 && !$sql) {
-         /*if (strncmp(PHP_OS,'WIN',3) === 0)
-            $dir = str_replace('/', '\\', $ADODB_CACHE_DIR);
-         else */
-            $dir = $ADODB_CACHE_DIR;
-            
-         if ($this->debug) {
-            ADOConnection::outp( "CacheFlush: $dir<br><pre>\n". $this->_dirFlush($dir)."</pre>");
-         } else {
-            $this->_dirFlush($dir);
-         }
-         return;
-      } 
-      
-      global $ADODB_INCLUDED_CSV;
-      if (empty($ADODB_INCLUDED_CSV)) include(ADODB_DIR.'/adodb-csvlib.inc.php');
-      
-      $f = $this->_gencachename($sql.serialize($inputarr),false);
-      adodb_write_file($f,''); // is adodb_write_file needed?
-      if (!@unlink($f)) {
-         if ($this->debug) ADOConnection::outp( "CacheFlush: failed for $f");
-      }
-   }
-   
-   /**
-   * Private function to erase all of the files and subdirectories in a directory.
-   *
-   * Just specify the directory, and tell it if you want to delete the directory or just clear it out.
-   * Note: $kill_top_level is used internally in the function to flush subdirectories.
-   *
-   */
-   function _dirFlush($dir, $kill_top_level = false) 
-   {
-      if(!$dh = @opendir($dir)) return;
-      
-      while (($obj = readdir($dh))) {
-         if($obj=='.' || $obj=='..') continue;
-		$f = $dir.'/'.$obj;
-		
-		if (strpos($obj,'.cache')) @unlink($f);
-		if (is_dir($f)) $this->_dirFlush($f, true);
-      }
-      if ($kill_top_level === true) @rmdir($dir);
-      return true;
-   }
-   
-    // this only deletes .cache files
-	function xCacheFlush($sql=false,$inputarr=false)
-	{
-	global $ADODB_CACHE_DIR;
-	
-		if ($this->memCache) {
-			global $ADODB_INCLUDED_MEMCACHE;
-			$key = false;
-			if (empty($ADODB_INCLUDED_MEMCACHE)) include(ADODB_DIR.'/adodb-memcache.lib.inc.php');
-			if ($sql) $key = $this->_gencachename($sql.serialize($inputarr),false,true);
-			flushmemCache($key, $this->memCacheHost, $this->memCachePort, $this->debug);
-			return;
-		}
-
-		if (strlen($ADODB_CACHE_DIR) > 1 && !$sql) {
-			if (strncmp(PHP_OS,'WIN',3) === 0) {
-				$cmd = 'del /s '.str_replace('/','\\',$ADODB_CACHE_DIR).'\adodb_*.cache';
-			} else {
-				//$cmd = 'find "'.$ADODB_CACHE_DIR.'" -type f -maxdepth 1 -print0 | xargs -0 rm -f';
-				$cmd = 'rm -rf '.$ADODB_CACHE_DIR.'/[0-9a-f][0-9a-f]/'; 
-				// old version 'rm -f `find '.$ADODB_CACHE_DIR.' -name adodb_*.cache`';
-			}
-			if ($this->debug) {
-				ADOConnection::outp( "CacheFlush: $cmd<br><pre>\n", system($cmd),"</pre>");
-			} else {
-				exec($cmd);
-			}
-			return;
-		} 
+		if (empty($ADODB_CACHE)) return false;
 		
-		global $ADODB_INCLUDED_CSV;
-		if (empty($ADODB_INCLUDED_CSV)) include(ADODB_DIR.'/adodb-csvlib.inc.php');
+		if (!$sql) {
+			 $ADODB_CACHE->flushall($this->debug);
+	         return;
+	    }
 		
 		$f = $this->_gencachename($sql.serialize($inputarr),false);
-		adodb_write_file($f,''); // is adodb_write_file needed?
-		if (!@unlink($f)) {
-			if ($this->debug) ADOConnection::outp( "CacheFlush: failed for $f");
-		}
+		return $ADODB_CACHE->flushcache($f, $this->debug);
 	}
+   
 	
 	/**
 	* Private function to generate filename for caching.
@@ -1685,10 +1731,9 @@
 	* Assuming that we can have 50,000 files per directory with good performance, 
 	* then we can scale to 12.8 million unique cached recordsets. Wow!
  	*/
-	function _gencachename($sql,$createdir,$memcache=false)
+	function _gencachename($sql,$createdir)
 	{
-	global $ADODB_CACHE_DIR;
-	static $notSafeMode;
+	global $ADODB_CACHE, $ADODB_CACHE_DIR;
 		
 		if ($this->fetchMode === false) { 
 		global $ADODB_FETCH_MODE;
@@ -1697,17 +1742,10 @@
 			$mode = $this->fetchMode;
 		}
 		$m = md5($sql.$this->databaseType.$this->database.$this->user.$mode);
-		if ($memcache) return $m;
+		if (!$ADODB_CACHE->createdir) return $m;
+		if (!$createdir) $dir = $ADODB_CACHE->getdirname($m);
+		else $dir = $ADODB_CACHE->createdir($m, $this->debug);
 		
-		if (!isset($notSafeMode)) $notSafeMode = !ini_get('safe_mode');
-		$dir = ($notSafeMode) ? $ADODB_CACHE_DIR.'/'.substr($m,0,2) : $ADODB_CACHE_DIR;
-			
-		if ($createdir && $notSafeMode && !file_exists($dir)) {
-			$oldu = umask(0);
-			if (!@mkdir($dir,0771)) 
-				 if(!is_dir($dir) && $this->debug) ADOConnection::outp( "Unable to mkdir $dir for $sql");
-			umask($oldu);
-		}
 		return $dir.'/adodb_'.$m.'.cache';
 	}
 	
@@ -1723,6 +1761,10 @@
 	 */
 	function CacheExecute($secs2cache,$sql=false,$inputarr=false)
 	{
+	global $ADODB_CACHE;
+	
+		if (empty($ADODB_CACHE)) $this->_CreateCache();
+		
 		if (!is_numeric($secs2cache)) {
 			$inputarr = $sql;
 			$sql = $secs2cache;
@@ -1735,30 +1777,19 @@
 		} else
 			$sqlparam = $sql;
 			
-		if ($this->memCache) {
-			global $ADODB_INCLUDED_MEMCACHE;
-			if (empty($ADODB_INCLUDED_MEMCACHE)) include(ADODB_DIR.'/adodb-memcache.lib.inc.php');
-			$md5file = $this->_gencachename($sql.serialize($inputarr),false,true);
-		} else {
-		global $ADODB_INCLUDED_CSV;
-			if (empty($ADODB_INCLUDED_CSV)) include(ADODB_DIR.'/adodb-csvlib.inc.php');
-			$md5file = $this->_gencachename($sql.serialize($inputarr),true);
-		}
-
+		
+		$md5file = $this->_gencachename($sql.serialize($inputarr),true);
 		$err = '';
 		
 		if ($secs2cache > 0){
-			if ($this->memCache)
-				$rs = getmemCache($md5file,$err,$secs2cache, $this->memCacheHost, $this->memCachePort);
-			else
-				$rs = csv2rs($md5file,$err,$secs2cache,$this->arrayClass);
+			$rs = $ADODB_CACHE->readcache($md5file,$err,$secs2cache,$this->arrayClass);
 			$this->numCacheHits += 1;
 		} else {
 			$err='Timeout 1';
 			$rs = false;
 			$this->numCacheMisses += 1;
 		}
-	
+		
 		if (!$rs) {
 		// no cached rs found
 			if ($this->debug) {
@@ -1770,19 +1801,14 @@
 			
 			$rs = $this->Execute($sqlparam,$inputarr);
 
-			if ($rs && $this->memCache) {
-				$rs = $this->_rs2rs($rs); // read entire recordset into memory immediately
-				if(!putmemCache($md5file, $rs, $this->memCacheHost, $this->memCachePort, $this->memCacheCompress, $this->debug)) {
-					if ($fn = $this->raiseErrorFn)
-						$fn($this->databaseType,'CacheExecute',-32000,"Cache write error",$md5file,$sql,$this);
-					if ($this->debug) ADOConnection::outp( " Cache write error");
-				}
-			} else if ($rs) {
+			if ($rs) {
+
 				$eof = $rs->EOF;
 				$rs = $this->_rs2rs($rs); // read entire recordset into memory immediately
+				$rs->timeCreated = time(); // used by caching
 				$txt = _rs2serialize($rs,false,$sql); // serialize
 	
-				$ok = adodb_write_file($md5file,$txt,$this->debug);
+				$ok = $ADODB_CACHE->writecache($md5file,$txt,$this->debug, $secs2cache);
 				if (!$ok) {
 					if ($ok === false) {
 						$em = 'Cache write error';
@@ -1805,9 +1831,8 @@
 					$rs->connection = $this; // Pablo suggestion
 				}  
 				
-			} else
-			if (!$this->memCache)
-				@unlink($md5file);
+			} else if (!$this->memCache)
+				$ADODB_CACHE->flushcache($md5file);
 		} else {
 			$this->_errorMsg = '';
 			$this->_errorCode = 0;
@@ -1852,6 +1877,7 @@
 		$rs = $this->SelectLimit($sql,1);
 		if (!$rs) return $false; // table does not exist
 		$rs->tableName = $table;
+		$rs->sql = $sql;
 		
 		switch((string) $mode) {
 		case 'UPDATE':
@@ -2068,41 +2094,29 @@
 		}
 	}
 
-	function GetActiveRecordsClass($class, $table,$whereOrderBy=false,$bindarr=false, $primkeyArr=false)
+	/**
+	 * GetActiveRecordsClass Performs an 'ALL' query 
+	 * 
+	 * @param mixed $class This string represents the class of the current active record
+	 * @param mixed $table Table used by the active record object
+	 * @param mixed $whereOrderBy Where, order, by clauses
+	 * @param mixed $bindarr 
+	 * @param mixed $primkeyArr 
+	 * @param array $extra Query extras: limit, offset...
+	 * @param mixed $relations Associative array: table's foreign name, "hasMany", "belongsTo"
+	 * @access public
+	 * @return void
+	 */
+	function GetActiveRecordsClass(
+			$class, $table,$whereOrderBy=false,$bindarr=false, $primkeyArr=false,
+			$extra=array(),
+			$relations=array())
 	{
 	global $_ADODB_ACTIVE_DBS;
-	
-		$save = $this->SetFetchMode(ADODB_FETCH_NUM);
-		if (empty($whereOrderBy)) $whereOrderBy = '1=1';
-		$rows = $this->GetAll("select * from ".$table.' WHERE '.$whereOrderBy,$bindarr);
-		$this->SetFetchMode($save);
-		
-		$false = false;
-		
-		if ($rows === false) {	
-			return $false;
-		}
-		
-		
-		if (!isset($_ADODB_ACTIVE_DBS)) {
-			include(ADODB_DIR.'/adodb-active-record.inc.php');
-		}	
-		if (!class_exists($class)) {
-			$this->outp_throw("Unknown class $class in GetActiveRecordsClass()",'GetActiveRecordsClass');
-			return $false;
-		}
-		$arr = array();
-		foreach($rows as $row) {
-		
-			$obj = new $class($table,$primkeyArr,$this);
-			if ($obj->ErrorMsg()){
-				$this->_errorMsg = $obj->ErrorMsg();
-				return $false;
-			}
-			$obj->Set($row);
-			$arr[] = $obj;
-		}
-		return $arr;
+		## reduce overhead of adodb.inc.php -- moved to adodb-active-record.inc.php
+		## if adodb-active-recordx is loaded -- should be no issue as they will probably use Find()
+		if (!isset($_ADODB_ACTIVE_DBS))include_once(ADODB_DIR.'/adodb-active-record.inc.php');
+		return adodb_GetActiveRecordsClass($this, $class, $table, $whereOrderBy, $bindarr, $primkeyArr, $extra, $relations);
 	}
 	
 	function GetActiveRecords($table,$where=false,$bindarr=false,$primkeyArr=false)
@@ -2420,10 +2434,14 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 	 *
 	 * @return  date string in database date format
 	 */
-	function DBDate($d)
+	function DBDate($d, $isfld=false)
 	{
 		if (empty($d) && $d !== 0) return 'null';
-
+		if ($isfld) return $d;
+		
+		if (is_object($d)) return $d->format($this->fmtDate);
+		
+		
 		if (is_string($d) && !is_numeric($d)) {
 			if ($d === 'null' || strncmp($d,"'",1) === 0) return $d;
 			if ($this->isoDates) return "'$d'";
@@ -2457,10 +2475,12 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 	 *
 	 * @return  timestamp string in database timestamp format
 	 */
-	function DBTimeStamp($ts)
+	function DBTimeStamp($ts,$isfld=false)
 	{
 		if (empty($ts) && $ts !== 0) return 'null';
-
+		if ($isfld) return $ts;
+		if (is_object($ts)) return $ts->format($this->fmtTimeStamp);
+		
 		# strlen(14) allows YYYYMMDDHHMMSS format
 		if (!is_string($ts) || (is_numeric($ts) && strlen($ts)<14)) 
 			return adodb_date($this->fmtTimeStamp,$ts);
@@ -2588,7 +2608,7 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 		// undo magic quotes for "
 		$s = str_replace('\\"','"',$s);
 		
-		if ($this->replaceQuote == "\\'")  // ' already quoted, no need to change anything
+		if ($this->replaceQuote == "\\'" || ini_get('magic_quotes_sybase'))  // ' already quoted, no need to change anything
 			return $s;
 		else {// change \' to '' for sybase/mssql
 			$s = str_replace('\\\\','\\',$s);
@@ -2622,7 +2642,7 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 		// undo magic quotes for "
 		$s = str_replace('\\"','"',$s);
 		
-		if ($this->replaceQuote == "\\'")  // ' already quoted, no need to change anything
+		if ($this->replaceQuote == "\\'" || ini_get('magic_quotes_sybase'))  // ' already quoted, no need to change anything
 			return "'$s'";
 		else {// change \' to '' for sybase/mssql
 			$s = str_replace('\\\\','\\',$s);
@@ -2719,12 +2739,12 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 		
 	    function key() 
 		{
-	        return $false;
+	        return false;
 	    }
 		
 	    function current() 
 		{
-	        return $false;
+	        return false;
 	    }
 		
 	    function next() 
@@ -3670,6 +3690,7 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 		'CHARACTER' => 'C',
 		'INTERVAL' => 'C',  # Postgres
 		'MACADDR' => 'C', # postgres
+		'VAR_STRING' => 'C', # mysql
 		##
 		'LONGCHAR' => 'X',
 		'TEXT' => 'X',
@@ -3693,6 +3714,7 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 		##
 		'UNIQUEIDENTIFIER' => 'C', # MS SQL Server
 		##
+		'SMALLDATETIME' => 'T',
 		'TIME' => 'T',
 		'TIMESTAMP' => 'T',
 		'DATETIME' => 'T',
@@ -4139,8 +4161,12 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 			if (strncmp($origdsn,'pdo',3) == 0) {
 				$sch = explode('_',$dsna['scheme']);
 				if (sizeof($sch)>1) {
+				
 					$dsna['host'] = isset($dsna['host']) ? rawurldecode($dsna['host']) : '';
-					$dsna['host'] = rawurlencode($sch[1].':host='.rawurldecode($dsna['host']));
+					if ($sch[1] == 'sqlite')
+						$dsna['host'] = rawurlencode($sch[1].':'.rawurldecode($dsna['host']));
+					else
+						$dsna['host'] = rawurlencode($sch[1].':host='.rawurldecode($dsna['host']));
 					$dsna['scheme'] = 'pdo';
 				}
 			}
@@ -4172,7 +4198,9 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 		if (!empty($ADODB_NEWCONNECTION)) {
 			$obj = $ADODB_NEWCONNECTION($db);
 
-		} else {
+		} 
+		
+		if(empty($obj)) {
 		
 			if (!isset($ADODB_LASTDB)) $ADODB_LASTDB = '';
 			if (empty($db)) $db = $ADODB_LASTDB;
@@ -4230,6 +4258,18 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 					case 'socket': $obj->socket = $v; break;
 					#oci8
 					case 'nls_date_format': $obj->NLS_DATE_FORMAT = $v; break;
+					case 'cachesecs': $obj->cacheSecs = $v; break;
+					case 'memcache': 
+						$varr = explode(':',$v);
+						$vlen = sizeof($varr);
+						if ($vlen == 0) break;	
+						$obj->memCache = true;
+						$obj->memCacheHost = explode(',',$varr[0]);
+						if ($vlen == 1) break;	
+						$obj->memCachePort = $varr[1];
+						if ($vlen == 2) break;	
+						$obj->memCacheCompress = $varr[2] ?  true : false;
+						break;
 					}
 				}
 				if (empty($persist))
@@ -4347,13 +4387,13 @@ http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_1
 		@param printOrArr  Pass in a boolean to indicate print, or an $exception->trace array (assumes that print is true then).
 		@param levels Number of levels to display
 	*/
-	function adodb_backtrace($printOrArr=true,$levels=9999)
+	function adodb_backtrace($printOrArr=true,$levels=9999,$ishtml=null)
 	{
 		global $ADODB_INCLUDED_LIB;
 		if (empty($ADODB_INCLUDED_LIB)) include(ADODB_DIR.'/adodb-lib.inc.php');
-		return _adodb_backtrace($printOrArr,$levels);
+		return _adodb_backtrace($printOrArr,$levels,0,$ishtml);
 	}
 
 
 }
-?>
+?>
\ No newline at end of file
diff --git a/third_party/adodb/contrib/toxmlrpc.inc.php b/third_party/adodb/contrib/toxmlrpc.inc.php
index 3711bda..030d60a 100644
--- a/third_party/adodb/contrib/toxmlrpc.inc.php
+++ b/third_party/adodb/contrib/toxmlrpc.inc.php
@@ -1,183 +1,183 @@
-<?php
-    /**
-    * Helper functions to convert between ADODB recordset objects and XMLRPC values.
-    * Uses John Lim's AdoDB and Edd Dumbill's phpxmlrpc libs
-    * 
-    * @author Daniele Baroncelli
-    * @author Gaetano Giunta
-    * @copyright (c) 2003-2004 Giunta/Baroncelli. All rights reserved.
-    * 
-    * @todo some more error checking here and there
-    * @todo document the xmlrpc-struct used to encode recordset info
-    * @todo verify if using xmlrpc_encode($rs->GetArray()) would work with:
-    *       - ADODB_FETCH_BOTH
-    *       - null values
-    */
-
-    /**
-    * Include the main libraries
-    */    
-    require_once('xmlrpc.inc');
-    if (!defined('ADODB_DIR')) require_once('adodb.inc.php');
-            
-    /**
-    * Builds an xmlrpc struct value out of an AdoDB recordset
-    */
-    function rs2xmlrpcval(&$adodbrs) {
-
-        $header = rs2xmlrpcval_header($adodbrs);
-        $body = rs2xmlrpcval_body($adodbrs);
-
-        // put it all together and build final xmlrpc struct
-        $xmlrpcrs = new xmlrpcval ( array(
-                "header" => $header,
-                "body" => $body,
-                ), "struct");
-
-        return $xmlrpcrs;
-
-    }
-
-    /**
-    * Builds an xmlrpc struct value describing an AdoDB recordset
-    */
-    function rs2xmlrpcval_header($adodbrs)
-    {
-        $numfields = $adodbrs->FieldCount();
-        $numrecords = $adodbrs->RecordCount();
-
-        // build structure holding recordset information
-        $fieldstruct = array();
-        for ($i = 0; $i < $numfields; $i++) {
-            $fld = $adodbrs->FetchField($i);
-            $fieldarray = array();
-            if (isset($fld->name))
-                $fieldarray["name"] = new xmlrpcval ($fld->name);
-            if (isset($fld->type))
-                $fieldarray["type"] = new xmlrpcval ($fld->type);
-            if (isset($fld->max_length))
-                $fieldarray["max_length"] = new xmlrpcval ($fld->max_length, "int");
-            if (isset($fld->not_null))
-                $fieldarray["not_null"] = new xmlrpcval ($fld->not_null, "boolean");
-            if (isset($fld->has_default))
-                $fieldarray["has_default"] = new xmlrpcval ($fld->has_default, "boolean");
-            if (isset($fld->default_value))
-                $fieldarray["default_value"] = new xmlrpcval ($fld->default_value);
-            $fieldstruct[$i] = new xmlrpcval ($fieldarray, "struct");
-        }
-        $fieldcount = new xmlrpcval ($numfields, "int");
-        $recordcount = new xmlrpcval ($numrecords, "int");
-        $sql = new xmlrpcval ($adodbrs->sql);
-        $fieldinfo = new xmlrpcval ($fieldstruct, "array");
-
-        $header = new xmlrpcval ( array(
-                "fieldcount" => $fieldcount,
-                "recordcount" => $recordcount,
-                "sql" => $sql,
-                "fieldinfo" => $fieldinfo
-                ), "struct");
-
-        return $header;
-    }
-
-    /**
-    * Builds an xmlrpc struct value out of an AdoDB recordset
-    * (data values only, no data definition)
-    */
-    function rs2xmlrpcval_body($adodbrs)
-    {
-        $numfields = $adodbrs->FieldCount();
-
-        // build structure containing recordset data
-        $adodbrs->MoveFirst();
-        $rows = array();
-        while (!$adodbrs->EOF) {
-            $columns = array();
-            // This should work on all cases of fetch mode: assoc, num, both or default
-            if ($adodbrs->fetchMode == 'ADODB_FETCH_BOTH' || count($adodbrs->fields) == 2 * $adodbrs->FieldCount())
-                for ($i = 0; $i < $numfields; $i++)
-                    if ($adodbrs->fields[$i] === null)
-                        $columns[$i] = new xmlrpcval ('');
-                    else
-                        $columns[$i] = xmlrpc_encode ($adodbrs->fields[$i]);
-            else
-                foreach ($adodbrs->fields as $val)
-                    if ($val === null)
-                        $columns[] = new xmlrpcval ('');
-                    else
-                        $columns[] = xmlrpc_encode ($val);
-
-            $rows[] = new xmlrpcval ($columns, "array");
-
-            $adodbrs->MoveNext();
-        }
-        $body = new xmlrpcval ($rows, "array");
-
-        return $body;    
-    }
-    
-    /**
-    * Returns an xmlrpc struct value as string out of an AdoDB recordset
-    */    
-    function rs2xmlrpcstring (&$adodbrs) {
-        $xmlrpc = rs2xmlrpcval ($adodbrs);
-        if ($xmlrpc)
-          return $xmlrpc->serialize();
-        else
-          return null;
-    }
-
-    /**
-    * Given a well-formed xmlrpc struct object returns an AdoDB object
-    * 
-    * @todo add some error checking on the input value
-    */
-    function xmlrpcval2rs (&$xmlrpcval) {
-
-        $fields_array = array();
-        $data_array = array();
- 
-        // rebuild column information  
-        $header = $xmlrpcval->structmem('header');
-        
-        $numfields = $header->structmem('fieldcount');
-        $numfields = $numfields->scalarval();
-        $numrecords = $header->structmem('recordcount');
-        $numrecords = $numrecords->scalarval();
-        $sqlstring = $header->structmem('sql');
-        $sqlstring = $sqlstring->scalarval();
-        
-        $fieldinfo = $header->structmem('fieldinfo');
-        for ($i = 0; $i < $numfields; $i++) {
-            $temp = $fieldinfo->arraymem($i);
-            $fld = new ADOFieldObject();
-            while (list($key,$value) = $temp->structeach()) {
-                if ($key == "name") $fld->name = $value->scalarval();
-                if ($key == "type") $fld->type = $value->scalarval();
-                if ($key == "max_length") $fld->max_length = $value->scalarval();
-                if ($key == "not_null") $fld->not_null = $value->scalarval();
-                if ($key == "has_default") $fld->has_default = $value->scalarval();
-                if ($key == "default_value") $fld->default_value = $value->scalarval();
-            } // while
-            $fields_array[] = $fld;
-        } // for
-
-        // fetch recordset information into php array
-        $body = $xmlrpcval->structmem('body');
-        for ($i = 0; $i < $numrecords; $i++) {
-            $data_array[$i]= array();
-            $xmlrpcrs_row = $body->arraymem($i);
-            for ($j = 0; $j < $numfields; $j++) {
-                $temp = $xmlrpcrs_row->arraymem($j);
-                $data_array[$i][$j] = $temp->scalarval();
-            } // for j
-        } // for i
-
-        // finally build in-memory recordset object and return it
-        $rs = new ADORecordSet_array();
-        $rs->InitArrayFields($data_array,$fields_array);
-        return $rs;
-
-    }
-
+<?php
+    /**
+    * Helper functions to convert between ADODB recordset objects and XMLRPC values.
+    * Uses John Lim's AdoDB and Edd Dumbill's phpxmlrpc libs
+    * 
+    * @author Daniele Baroncelli
+    * @author Gaetano Giunta
+    * @copyright (c) 2003-2004 Giunta/Baroncelli. All rights reserved.
+    * 
+    * @todo some more error checking here and there
+    * @todo document the xmlrpc-struct used to encode recordset info
+    * @todo verify if using xmlrpc_encode($rs->GetArray()) would work with:
+    *       - ADODB_FETCH_BOTH
+    *       - null values
+    */
+
+    /**
+    * Include the main libraries
+    */    
+    require_once('xmlrpc.inc');
+    if (!defined('ADODB_DIR')) require_once('adodb.inc.php');
+            
+    /**
+    * Builds an xmlrpc struct value out of an AdoDB recordset
+    */
+    function rs2xmlrpcval(&$adodbrs) {
+
+        $header = rs2xmlrpcval_header($adodbrs);
+        $body = rs2xmlrpcval_body($adodbrs);
+
+        // put it all together and build final xmlrpc struct
+        $xmlrpcrs = new xmlrpcval ( array(
+                "header" => $header,
+                "body" => $body,
+                ), "struct");
+
+        return $xmlrpcrs;
+
+    }
+
+    /**
+    * Builds an xmlrpc struct value describing an AdoDB recordset
+    */
+    function rs2xmlrpcval_header($adodbrs)
+    {
+        $numfields = $adodbrs->FieldCount();
+        $numrecords = $adodbrs->RecordCount();
+
+        // build structure holding recordset information
+        $fieldstruct = array();
+        for ($i = 0; $i < $numfields; $i++) {
+            $fld = $adodbrs->FetchField($i);
+            $fieldarray = array();
+            if (isset($fld->name))
+                $fieldarray["name"] = new xmlrpcval ($fld->name);
+            if (isset($fld->type))
+                $fieldarray["type"] = new xmlrpcval ($fld->type);
+            if (isset($fld->max_length))
+                $fieldarray["max_length"] = new xmlrpcval ($fld->max_length, "int");
+            if (isset($fld->not_null))
+                $fieldarray["not_null"] = new xmlrpcval ($fld->not_null, "boolean");
+            if (isset($fld->has_default))
+                $fieldarray["has_default"] = new xmlrpcval ($fld->has_default, "boolean");
+            if (isset($fld->default_value))
+                $fieldarray["default_value"] = new xmlrpcval ($fld->default_value);
+            $fieldstruct[$i] = new xmlrpcval ($fieldarray, "struct");
+        }
+        $fieldcount = new xmlrpcval ($numfields, "int");
+        $recordcount = new xmlrpcval ($numrecords, "int");
+        $sql = new xmlrpcval ($adodbrs->sql);
+        $fieldinfo = new xmlrpcval ($fieldstruct, "array");
+
+        $header = new xmlrpcval ( array(
+                "fieldcount" => $fieldcount,
+                "recordcount" => $recordcount,
+                "sql" => $sql,
+                "fieldinfo" => $fieldinfo
+                ), "struct");
+
+        return $header;
+    }
+
+    /**
+    * Builds an xmlrpc struct value out of an AdoDB recordset
+    * (data values only, no data definition)
+    */
+    function rs2xmlrpcval_body($adodbrs)
+    {
+        $numfields = $adodbrs->FieldCount();
+
+        // build structure containing recordset data
+        $adodbrs->MoveFirst();
+        $rows = array();
+        while (!$adodbrs->EOF) {
+            $columns = array();
+            // This should work on all cases of fetch mode: assoc, num, both or default
+            if ($adodbrs->fetchMode == 'ADODB_FETCH_BOTH' || count($adodbrs->fields) == 2 * $adodbrs->FieldCount())
+                for ($i = 0; $i < $numfields; $i++)
+                    if ($adodbrs->fields[$i] === null)
+                        $columns[$i] = new xmlrpcval ('');
+                    else
+                        $columns[$i] = xmlrpc_encode ($adodbrs->fields[$i]);
+            else
+                foreach ($adodbrs->fields as $val)
+                    if ($val === null)
+                        $columns[] = new xmlrpcval ('');
+                    else
+                        $columns[] = xmlrpc_encode ($val);
+
+            $rows[] = new xmlrpcval ($columns, "array");
+
+            $adodbrs->MoveNext();
+        }
+        $body = new xmlrpcval ($rows, "array");
+
+        return $body;    
+    }
+    
+    /**
+    * Returns an xmlrpc struct value as string out of an AdoDB recordset
+    */    
+    function rs2xmlrpcstring (&$adodbrs) {
+        $xmlrpc = rs2xmlrpcval ($adodbrs);
+        if ($xmlrpc)
+          return $xmlrpc->serialize();
+        else
+          return null;
+    }
+
+    /**
+    * Given a well-formed xmlrpc struct object returns an AdoDB object
+    * 
+    * @todo add some error checking on the input value
+    */
+    function xmlrpcval2rs (&$xmlrpcval) {
+
+        $fields_array = array();
+        $data_array = array();
+ 
+        // rebuild column information  
+        $header = $xmlrpcval->structmem('header');
+        
+        $numfields = $header->structmem('fieldcount');
+        $numfields = $numfields->scalarval();
+        $numrecords = $header->structmem('recordcount');
+        $numrecords = $numrecords->scalarval();
+        $sqlstring = $header->structmem('sql');
+        $sqlstring = $sqlstring->scalarval();
+        
+        $fieldinfo = $header->structmem('fieldinfo');
+        for ($i = 0; $i < $numfields; $i++) {
+            $temp = $fieldinfo->arraymem($i);
+            $fld = new ADOFieldObject();
+            while (list($key,$value) = $temp->structeach()) {
+                if ($key == "name") $fld->name = $value->scalarval();
+                if ($key == "type") $fld->type = $value->scalarval();
+                if ($key == "max_length") $fld->max_length = $value->scalarval();
+                if ($key == "not_null") $fld->not_null = $value->scalarval();
+                if ($key == "has_default") $fld->has_default = $value->scalarval();
+                if ($key == "default_value") $fld->default_value = $value->scalarval();
+            } // while
+            $fields_array[] = $fld;
+        } // for
+
+        // fetch recordset information into php array
+        $body = $xmlrpcval->structmem('body');
+        for ($i = 0; $i < $numrecords; $i++) {
+            $data_array[$i]= array();
+            $xmlrpcrs_row = $body->arraymem($i);
+            for ($j = 0; $j < $numfields; $j++) {
+                $temp = $xmlrpcrs_row->arraymem($j);
+                $data_array[$i][$j] = $temp->scalarval();
+            } // for j
+        } // for i
+
+        // finally build in-memory recordset object and return it
+        $rs = new ADORecordSet_array();
+        $rs->InitArrayFields($data_array,$fields_array);
+        return $rs;
+
+    }
+
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/datadict/datadict-access.inc.php b/third_party/adodb/datadict/datadict-access.inc.php
index 468c070..8cd25d5 100644
--- a/third_party/adodb/datadict/datadict-access.inc.php
+++ b/third_party/adodb/datadict/datadict-access.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -30,7 +30,8 @@ class ADODB2_access extends ADODB_DataDict {
 		case 'X2': return 'MEMO';
 		
 		case 'B': return 'BINARY';
-			
+		
+		case 'TS':
 		case 'D': return 'DATETIME';
 		case 'T': return 'DATETIME';
 		
@@ -49,7 +50,7 @@ class ADODB2_access extends ADODB_DataDict {
 	}
 	
 	// return string must begin with space
-	function _CreateSuffix($fname, &$ftype, $fnotnull,$fdefault,$fautoinc,$fconstraint)
+	function _CreateSuffix($fname, &$ftype, $fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{
 		if ($fautoinc) {
 			$ftype = 'COUNTER';
diff --git a/third_party/adodb/datadict/datadict-db2.inc.php b/third_party/adodb/datadict/datadict-db2.inc.php
index 116aa5a..9177a1b 100644
--- a/third_party/adodb/datadict/datadict-db2.inc.php
+++ b/third_party/adodb/datadict/datadict-db2.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -30,6 +30,7 @@ class ADODB2_db2 extends ADODB_DataDict {
 		case 'B': return 'BLOB';
 
 		case 'D': return 'DATE';
+		case 'TS':
 		case 'T': return 'TIMESTAMP';
 
 		case 'L': return 'SMALLINT';
@@ -47,7 +48,7 @@ class ADODB2_db2 extends ADODB_DataDict {
 	}
 	
 	// return string must begin with space
-	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint)
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{	
 		$suffix = '';
 		if ($fautoinc) return ' GENERATED ALWAYS AS IDENTITY'; # as identity start with 
diff --git a/third_party/adodb/datadict/datadict-firebird.inc.php b/third_party/adodb/datadict/datadict-firebird.inc.php
index 5d14c72..2a2a064 100644
--- a/third_party/adodb/datadict/datadict-firebird.inc.php
+++ b/third_party/adodb/datadict/datadict-firebird.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -30,6 +30,7 @@ class ADODB2_firebird extends ADODB_DataDict {
 		case 'B': return 'BLOB';
 			
 		case 'D': return 'DATE';
+		case 'TS':
 		case 'T': return 'TIMESTAMP';
 		
 		case 'L': return 'SMALLINT';
@@ -93,7 +94,7 @@ class ADODB2_firebird extends ADODB_DataDict {
 	}
 	
 
-	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{
 		$suffix = '';
 		
diff --git a/third_party/adodb/datadict/datadict-generic.inc.php b/third_party/adodb/datadict/datadict-generic.inc.php
index f376d97..53a0fdf 100644
--- a/third_party/adodb/datadict/datadict-generic.inc.php
+++ b/third_party/adodb/datadict/datadict-generic.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -32,6 +32,7 @@ class ADODB2_generic extends ADODB_DataDict {
 		case 'B': return 'VARCHAR';
 			
 		case 'D': return 'DATE';
+		case 'TS':
 		case 'T': return 'DATE';
 		
 		case 'L': return 'DECIMAL(1)';
diff --git a/third_party/adodb/datadict/datadict-ibase.inc.php b/third_party/adodb/datadict/datadict-ibase.inc.php
index 656d211..e3efec1 100644
--- a/third_party/adodb/datadict/datadict-ibase.inc.php
+++ b/third_party/adodb/datadict/datadict-ibase.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -32,6 +32,7 @@ class ADODB2_ibase extends ADODB_DataDict {
 		case 'B': return 'BLOB';
 			
 		case 'D': return 'DATE';
+		case 'TS':
 		case 'T': return 'TIMESTAMP';
 		
 		case 'L': return 'SMALLINT';
diff --git a/third_party/adodb/datadict/datadict-informix.inc.php b/third_party/adodb/datadict/datadict-informix.inc.php
index 34fd943..63a0c01 100644
--- a/third_party/adodb/datadict/datadict-informix.inc.php
+++ b/third_party/adodb/datadict/datadict-informix.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -32,6 +32,7 @@ class ADODB2_informix extends ADODB_DataDict {
 		case 'B': return 'BLOB';
 			
 		case 'D': return 'DATE';
+		case 'TS':
 		case 'T': return 'DATETIME YEAR TO SECOND';
 		
 		case 'L': return 'SMALLINT';
@@ -62,7 +63,7 @@ class ADODB2_informix extends ADODB_DataDict {
 	}
 	
 	// return string must begin with space
-	function _CreateSuffix($fname, &$ftype, $fnotnull,$fdefault,$fautoinc,$fconstraint)
+	function _CreateSuffix($fname, &$ftype, $fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{
 		if ($fautoinc) {
 			$ftype = 'SERIAL';
diff --git a/third_party/adodb/datadict/datadict-mssql.inc.php b/third_party/adodb/datadict/datadict-mssql.inc.php
index d9e59a3..57652ab 100644
--- a/third_party/adodb/datadict/datadict-mssql.inc.php
+++ b/third_party/adodb/datadict/datadict-mssql.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -69,7 +69,7 @@ class ADODB2_mssql extends ADODB_DataDict {
 		case 'TINYINT': return  'I1';
 		case 'SMALLINT': return 'I2';
 		case 'BIGINT':  return  'I8';
-		
+		case 'SMALLDATETIME': return 'T';
 		case 'REAL':
 		case 'FLOAT': return 'F';
 		default: return parent::MetaType($t,$len,$fieldobj);
@@ -89,6 +89,8 @@ class ADODB2_mssql extends ADODB_DataDict {
 		case 'B': return 'IMAGE';
 			
 		case 'D': return 'DATETIME';
+		
+		case 'TS':
 		case 'T': return 'DATETIME';
 		case 'L': return 'BIT';
 		
@@ -151,7 +153,7 @@ class ADODB2_mssql extends ADODB_DataDict {
 	}
 	
 	// return string must begin with space
-	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint)
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{	
 		$suffix = '';
 		if (strlen($fdefault)) $suffix .= " DEFAULT $fdefault";
diff --git a/third_party/adodb/datadict/datadict-mssqlnative.inc.php b/third_party/adodb/datadict/datadict-mssqlnative.inc.php
new file mode 100644
index 0000000..5162c6f
--- /dev/null
+++ b/third_party/adodb/datadict/datadict-mssqlnative.inc.php
@@ -0,0 +1,282 @@
+<?php
+
+/**
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence.
+	
+  Set tabs to 4 for best viewing.
+ 
+*/
+
+/*
+In ADOdb, named quotes for MS SQL Server use ". From the MSSQL Docs:
+
+	Note Delimiters are for identifiers only. Delimiters cannot be used for keywords, 
+	whether or not they are marked as reserved in SQL Server.
+	
+	Quoted identifiers are delimited by double quotation marks ("):
+	SELECT * FROM "Blanks in Table Name"
+	
+	Bracketed identifiers are delimited by brackets ([ ]):
+	SELECT * FROM [Blanks In Table Name]
+	
+	Quoted identifiers are valid only when the QUOTED_IDENTIFIER option is set to ON. By default, 
+	the Microsoft OLE DB Provider for SQL Server and SQL Server ODBC driver set QUOTED_IDENTIFIER ON 
+	when they connect. 
+	
+	In Transact-SQL, the option can be set at various levels using SET QUOTED_IDENTIFIER, 
+	the quoted identifier option of sp_dboption, or the user options option of sp_configure.
+	
+	When SET ANSI_DEFAULTS is ON, SET QUOTED_IDENTIFIER is enabled.
+	
+	Syntax
+	
+		SET QUOTED_IDENTIFIER { ON | OFF }
+
+
+*/
+
+// security - hide paths
+if (!defined('ADODB_DIR')) die();
+
+class ADODB2_mssqlnative extends ADODB_DataDict {
+	var $databaseType = 'mssqlnative';
+	var $dropIndex = 'DROP INDEX %2$s.%1$s';
+	var $renameTable = "EXEC sp_rename '%s','%s'";
+	var $renameColumn = "EXEC sp_rename '%s.%s','%s'";
+
+	var $typeX = 'TEXT';  ## Alternatively, set it to VARCHAR(4000)
+	var $typeXL = 'TEXT';
+	
+	//var $alterCol = ' ALTER COLUMN ';
+	
+	function MetaType($t,$len=-1,$fieldobj=false)
+	{
+		if (is_object($t)) {
+			$fieldobj = $t;
+			$t = $fieldobj->type;
+			$len = $fieldobj->max_length;
+		}
+		
+		$len = -1; // mysql max_length is not accurate
+		switch (strtoupper($t)) {
+		case 'R':
+		case 'INT': 
+		case 'INTEGER': return  'I';
+		case 'BIT':
+		case 'TINYINT': return  'I1';
+		case 'SMALLINT': return 'I2';
+		case 'BIGINT':  return  'I8';
+		
+		case 'REAL':
+		case 'FLOAT': return 'F';
+		default: return parent::MetaType($t,$len,$fieldobj);
+		}
+	}
+	
+	function ActualType($meta)
+	{
+		switch(strtoupper($meta)) {
+
+		case 'C': return 'VARCHAR';
+		case 'XL': return (isset($this)) ? $this->typeXL : 'TEXT';
+		case 'X': return (isset($this)) ? $this->typeX : 'TEXT'; ## could be varchar(8000), but we want compat with oracle
+		case 'C2': return 'NVARCHAR';
+		case 'X2': return 'NTEXT';
+		
+		case 'B': return 'IMAGE';
+			
+		case 'D': return 'DATETIME';
+		case 'T': return 'DATETIME';
+		case 'L': return 'BIT';
+		
+		case 'R':		
+		case 'I': return 'INT'; 
+		case 'I1': return 'TINYINT';
+		case 'I2': return 'SMALLINT';
+		case 'I4': return 'INT';
+		case 'I8': return 'BIGINT';
+		
+		case 'F': return 'REAL';
+		case 'N': return 'NUMERIC';
+		default:
+			return $meta;
+		}
+	}
+	
+	
+	function AddColumnSQL($tabname, $flds)
+	{
+		$tabname = $this->TableName ($tabname);
+		$f = array();
+		list($lines,$pkey) = $this->_GenFields($flds);
+		$s = "ALTER TABLE $tabname $this->addCol";
+		foreach($lines as $v) {
+			$f[] = "\n $v";
+		}
+		$s .= implode(', ',$f);
+		$sql[] = $s;
+		return $sql;
+	}
+	
+	/*
+	function AlterColumnSQL($tabname, $flds)
+	{
+		$tabname = $this->TableName ($tabname);
+		$sql = array();
+		list($lines,$pkey) = $this->_GenFields($flds);
+		foreach($lines as $v) {
+			$sql[] = "ALTER TABLE $tabname $this->alterCol $v";
+		}
+
+		return $sql;
+	}
+	*/
+	
+	function DropColumnSQL($tabname, $flds)
+	{
+		$tabname = $this->TableName ($tabname);
+		if (!is_array($flds))
+			$flds = explode(',',$flds);
+		$f = array();
+		$s = 'ALTER TABLE ' . $tabname;
+		foreach($flds as $v) {
+			$f[] = "\n$this->dropCol ".$this->NameQuote($v);
+		}
+		$s .= implode(', ',$f);
+		$sql[] = $s;
+		return $sql;
+	}
+	
+	// return string must begin with space
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
+	{	
+		$suffix = '';
+		if (strlen($fdefault)) $suffix .= " DEFAULT $fdefault";
+		if ($fautoinc) $suffix .= ' IDENTITY(1,1)';
+		if ($fnotnull) $suffix .= ' NOT NULL';
+		else if ($suffix == '') $suffix .= ' NULL';
+		if ($fconstraint) $suffix .= ' '.$fconstraint;
+		return $suffix;
+	}
+	
+	/*
+CREATE TABLE 
+    [ database_name.[ owner ] . | owner. ] table_name 
+    ( { < column_definition > 
+        | column_name AS computed_column_expression 
+        | < table_constraint > ::= [ CONSTRAINT constraint_name ] }
+
+            | [ { PRIMARY KEY | UNIQUE } [ ,...n ] 
+    ) 
+
+[ ON { filegroup | DEFAULT } ] 
+[ TEXTIMAGE_ON { filegroup | DEFAULT } ] 
+
+< column_definition > ::= { column_name data_type } 
+    [ COLLATE < collation_name > ] 
+    [ [ DEFAULT constant_expression ] 
+        | [ IDENTITY [ ( seed , increment ) [ NOT FOR REPLICATION ] ] ]
+    ] 
+    [ ROWGUIDCOL] 
+    [ < column_constraint > ] [ ...n ] 
+
+< column_constraint > ::= [ CONSTRAINT constraint_name ] 
+    { [ NULL | NOT NULL ] 
+        | [ { PRIMARY KEY | UNIQUE } 
+            [ CLUSTERED | NONCLUSTERED ] 
+            [ WITH FILLFACTOR = fillfactor ] 
+            [ON {filegroup | DEFAULT} ] ] 
+        ] 
+        | [ [ FOREIGN KEY ] 
+            REFERENCES ref_table [ ( ref_column ) ] 
+            [ ON DELETE { CASCADE | NO ACTION } ] 
+            [ ON UPDATE { CASCADE | NO ACTION } ] 
+            [ NOT FOR REPLICATION ] 
+        ] 
+        | CHECK [ NOT FOR REPLICATION ] 
+        ( logical_expression ) 
+    } 
+
+< table_constraint > ::= [ CONSTRAINT constraint_name ] 
+    { [ { PRIMARY KEY | UNIQUE } 
+        [ CLUSTERED | NONCLUSTERED ] 
+        { ( column [ ASC | DESC ] [ ,...n ] ) } 
+        [ WITH FILLFACTOR = fillfactor ] 
+        [ ON { filegroup | DEFAULT } ] 
+    ] 
+    | FOREIGN KEY 
+        [ ( column [ ,...n ] ) ] 
+        REFERENCES ref_table [ ( ref_column [ ,...n ] ) ] 
+        [ ON DELETE { CASCADE | NO ACTION } ] 
+        [ ON UPDATE { CASCADE | NO ACTION } ] 
+        [ NOT FOR REPLICATION ] 
+    | CHECK [ NOT FOR REPLICATION ] 
+        ( search_conditions ) 
+    } 
+
+
+	*/
+	
+	/*
+	CREATE [ UNIQUE ] [ CLUSTERED | NONCLUSTERED ] INDEX index_name 
+    ON { table | view } ( column [ ASC | DESC ] [ ,...n ] ) 
+		[ WITH < index_option > [ ,...n] ] 
+		[ ON filegroup ]
+		< index_option > :: = 
+		    { PAD_INDEX | 
+		        FILLFACTOR = fillfactor | 
+		        IGNORE_DUP_KEY | 
+		        DROP_EXISTING | 
+		    STATISTICS_NORECOMPUTE | 
+		    SORT_IN_TEMPDB  
+		}
+*/
+	function _IndexSQL($idxname, $tabname, $flds, $idxoptions)
+	{
+		$sql = array();
+		
+		if ( isset($idxoptions['REPLACE']) || isset($idxoptions['DROP']) ) {
+			$sql[] = sprintf ($this->dropIndex, $idxname, $tabname);
+			if ( isset($idxoptions['DROP']) )
+				return $sql;
+		}
+		
+		if ( empty ($flds) ) {
+			return $sql;
+		}
+		
+		$unique = isset($idxoptions['UNIQUE']) ? ' UNIQUE' : '';
+		$clustered = isset($idxoptions['CLUSTERED']) ? ' CLUSTERED' : '';
+		
+		if ( is_array($flds) )
+			$flds = implode(', ',$flds);
+		$s = 'CREATE' . $unique . $clustered . ' INDEX ' . $idxname . ' ON ' . $tabname . ' (' . $flds . ')';
+		
+		if ( isset($idxoptions[$this->upperName]) )
+			$s .= $idxoptions[$this->upperName];
+		
+
+		$sql[] = $s;
+		
+		return $sql;
+	}
+	
+	
+	function _GetSize($ftype, $ty, $fsize, $fprec)
+	{
+		switch ($ftype) {
+		case 'INT':
+		case 'SMALLINT':
+		case 'TINYINT':
+		case 'BIGINT':
+			return $ftype;
+		}
+    	if ($ty == 'T') return $ftype;
+    	return parent::_GetSize($ftype, $ty, $fsize, $fprec);    
+
+	}
+}
+?>
\ No newline at end of file
diff --git a/third_party/adodb/datadict/datadict-mysql.inc.php b/third_party/adodb/datadict/datadict-mysql.inc.php
index 27e0b09..9551e4a 100644
--- a/third_party/adodb/datadict/datadict-mysql.inc.php
+++ b/third_party/adodb/datadict/datadict-mysql.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -89,6 +89,7 @@ class ADODB2_mysql extends ADODB_DataDict {
 		case 'B': return 'LONGBLOB';
 			
 		case 'D': return 'DATE';
+		case 'TS':
 		case 'T': return 'DATETIME';
 		case 'L': return 'TINYINT';
 		
@@ -107,7 +108,7 @@ class ADODB2_mysql extends ADODB_DataDict {
 	}
 	
 	// return string must begin with space
-	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{	
 		$suffix = '';
 		if ($funsigned) $suffix .= ' UNSIGNED';
diff --git a/third_party/adodb/datadict/datadict-oci8.inc.php b/third_party/adodb/datadict/datadict-oci8.inc.php
index 4b78847..25eca9a 100644
--- a/third_party/adodb/datadict/datadict-oci8.inc.php
+++ b/third_party/adodb/datadict/datadict-oci8.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -55,6 +55,9 @@ class ADODB2_oci8 extends ADODB_DataDict {
 		case 'BLOB':
 			return 'B';
 		
+		case 'TIMESTAMP':
+			return 'TS';
+			
 		case 'DATE': 
 			return 'T';
 		
@@ -79,18 +82,22 @@ class ADODB2_oci8 extends ADODB_DataDict {
 		case 'X2': return 'NVARCHAR2(4000)';
 		
 		case 'B': return 'BLOB';
-			
+		
+		case 'TS':
+				return 'TIMESTAMP';
+				
 		case 'D': 
 		case 'T': return 'DATE';
-		case 'L': return 'DECIMAL(1)';
-		case 'I1': return 'DECIMAL(3)';
-		case 'I2': return 'DECIMAL(5)';
+		case 'L': return 'NUMBER(1)';
+		case 'I1': return 'NUMBER(3)';
+		case 'I2': return 'NUMBER(5)';
 		case 'I':
-		case 'I4': return 'DECIMAL(10)';
+		case 'I4': return 'NUMBER(10)';
 		
-		case 'I8': return 'DECIMAL(20)';
-		case 'F': return 'DECIMAL';
-		case 'N': return 'DECIMAL';
+		case 'I8': return 'NUMBER(20)';
+		case 'F': return 'NUMBER';
+		case 'N': return 'NUMBER';
+		case 'R': return 'NUMBER(20)';
 		default:
 			return $meta;
 		}	
@@ -156,7 +163,7 @@ class ADODB2_oci8 extends ADODB_DataDict {
 	}
 	
 	// return string must begin with space
-	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{
 		$suffix = '';
 		
diff --git a/third_party/adodb/datadict/datadict-postgres.inc.php b/third_party/adodb/datadict/datadict-postgres.inc.php
index af948e1..b9a984f 100644
--- a/third_party/adodb/datadict/datadict-postgres.inc.php
+++ b/third_party/adodb/datadict/datadict-postgres.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -100,6 +100,7 @@ class ADODB2_postgres extends ADODB_DataDict {
 		case 'B': return 'BYTEA';
 			
 		case 'D': return 'DATE';
+		case 'TS':
 		case 'T': return 'TIMESTAMP';
 		
 		case 'L': return 'BOOLEAN';
@@ -326,7 +327,7 @@ class ADODB2_postgres extends ADODB_DataDict {
 	}
 
 	// return string must begin with space
-	function _CreateSuffix($fname, &$ftype, $fnotnull,$fdefault,$fautoinc,$fconstraint)
+	function _CreateSuffix($fname, &$ftype, $fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{
 		if ($fautoinc) {
 			$ftype = 'SERIAL';
diff --git a/third_party/adodb/datadict/datadict-sapdb.inc.php b/third_party/adodb/datadict/datadict-sapdb.inc.php
index bf52455..d4143d1 100644
--- a/third_party/adodb/datadict/datadict-sapdb.inc.php
+++ b/third_party/adodb/datadict/datadict-sapdb.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V4.50 6 July 2004  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V4.50 6 July 2004  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -33,6 +33,7 @@ class ADODB2_sapdb extends ADODB_DataDict {
 		case 'B': return 'LONG';
 			
 		case 'D': return 'DATE';
+		case 'TS':
 		case 'T': return 'TIMESTAMP';
 		
 		case 'L': return 'BOOLEAN';
@@ -80,7 +81,7 @@ class ADODB2_sapdb extends ADODB_DataDict {
 	}
 	
 	// return string must begin with space
-	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{	
 		$suffix = '';
 		if ($funsigned) $suffix .= ' UNSIGNED';
diff --git a/third_party/adodb/datadict/datadict-sybase.inc.php b/third_party/adodb/datadict/datadict-sybase.inc.php
index d0acc34..a3fd0bc 100644
--- a/third_party/adodb/datadict/datadict-sybase.inc.php
+++ b/third_party/adodb/datadict/datadict-sybase.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /**
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -55,6 +55,7 @@ class ADODB2_sybase extends ADODB_DataDict {
 		case 'B': return 'IMAGE';
 			
 		case 'D': return 'DATETIME';
+		case 'TS':
 		case 'T': return 'DATETIME';
 		case 'L': return 'BIT';
 		
@@ -113,7 +114,7 @@ class ADODB2_sybase extends ADODB_DataDict {
 	}
 	
 	// return string must begin with space
-	function _CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint)
+	function _CreateSuffix($fname,&$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned)
 	{	
 		$suffix = '';
 		if (strlen($fdefault)) $suffix .= " DEFAULT $fdefault";
diff --git a/third_party/adodb/docs/docs-active-record.htm b/third_party/adodb/docs/docs-active-record.htm
index a914c25..5a9f197 100644
--- a/third_party/adodb/docs/docs-active-record.htm
+++ b/third_party/adodb/docs/docs-active-record.htm
@@ -14,7 +14,7 @@ font-family: Arial, Helvetica, sans-serif ;
 <title>ADOdb Active Record</title>
 <body>
 <h1>ADOdb Active Record</h1>
-<p> (c) 2000-2008 John Lim (jlim#natsoft.com)</p>
+<p> (c) 2000-2009 John Lim (jlim#natsoft.com)</p>
 <p><font size="1">This software is dual licensed using BSD-Style and LGPL. This 
   means you can use it in compiled proprietary and commercial products.</font></p>
 <p><hr>
@@ -32,7 +32,9 @@ This implementation differs from Zend Framework's implementation in the followin
 <li>No field name conversion to camel-caps style, unlike Zend's implementation which will convert field names such as 'first_name' to 'firstName'.<p>
 <li>NewADOConnection::GetActiveRecords() and ADOConnection::GetActiveRecordsClass() functions in adodb.inc.php.<p>
 <li>Caching of table metadata so it is only queried once per table, no matter how many Active Records are created.<p>
-<li>The additional functionality is described <a href=#additional>below</a>. 
+<li>PHP5 version of ADOdb_Active_Record now supports <a href=#onetomany>one-to-many</a> relationships.<p>
+<li>New adodb-active-recordx.inc.php, which is an <a href=#recordx>Active Record eXtended</a> implementation that support JOINs for higher performance when loading children, and other nice features.<p>
+<li>Lots of  <a href=#additional>additional functionality</a>.<p> 
 </ul>
 <P>
 ADOdb_Active_Record is designed upon the principles of the "ActiveRecord" design pattern, which was first described by Martin Fowler. The ActiveRecord pattern has been implemented in many forms across the spectrum of programming languages. ADOdb_Active_Record attempts to represent the database as closely to native PHP objects as possible.
@@ -66,15 +68,15 @@ $db->Execute("CREATE TEMPORARY TABLE `persons` (
            ");
  </pre>   
 <p>
-ADOdb_Active_Record's are object representations of table rows. Each table in the database is represented by a class in PHP. To begin working with a table as a ADOdb_Active_Record, a class that extends ADOdb_Active_Records needs to be created for it.
+ADOdb_Active_Records are object representations of table rows. Each table in the database is represented by a class in PHP. To begin working with a table as a ADOdb_Active_Record, a class that extends ADOdb_Active_Record needs to be created for it.
 
 <pre>
-class Person extends ADOdb_Active_Record{}
-$person = new Person();
+class person extends ADOdb_Active_Record{}
+$person = new person();
 </pre>   
 
 <p>
-In the above example, a new ADOdb_Active_Record object $person was created to access the "persons" table. Zend_Db_DataObject takes the name of the class, pluralizes it (according to American English rules), and assumes that this is the name of the table in the database.
+In the above example, a new ADOdb_Active_Record object $person was created to access the "persons" table. Zend_Db_DataObject takes the name of the class, pluralizes it (according to American English rules), and assumes that this is the name of the table in the database. Also note that with MySQL, table names are case-sensitive, so your class name must match the table name's case. With other databases with case-insensitive tables, your class can be capitalized differently.
 <p>
 This kind of behavior is typical of ADOdb_Active_Record. It will assume as much as possible by convention rather than explicit configuration. In situations where it isn't possible to use the conventions that ADOdb_Active_Record expects, options can be overridden as we'll see later.
 
@@ -109,15 +111,15 @@ An ADOdb_Active_Record object is a representation of a single table row. However
 <p>
 To insert a new record into the database, change the object's properties and then call the ADOdb_Active_Record::save() method:
 <pre>
-$person = new Person();
-$person->nameFirst = 'Andi';
-$person->nameLast  = 'Gutmans';
+$person = new person();
+$person->name_first = 'Andi';
+$person->name_last  = 'Gutmans';
 $person->save();
  </pre>   
 <p>
 Oh, no! The above code snippet does not insert a new record into the database. Instead, outputs an error:
 <pre>
-1048: Column 'name_first' cannot be null
+1048: Column 'favorite_color' cannot be null
  </pre>   
 <p>
 This error occurred because MySQL rejected the INSERT query that was generated by ADOdb_Active_Record. If exceptions are enabled in ADOdb and you are using PHP5, an error will be thrown. In the definition of our table, we specified all of the fields as NOT NULL; i.e., they must contain a value.
@@ -130,7 +132,7 @@ To insert a new ADOdb_Active_Record in the database, populate all of ADOdb_Activ
  * Calling the save() method will successfully INSERT
  * this $person into the database table.
  */
-$person = new Person();
+$person = new person();
 $person->name_first     = 'Andi';
 $person->name_last      = 'Gutmans';
 $person->favorite_color = 'blue';
@@ -160,21 +162,21 @@ The code snippet above will change the favorite color to red, and then UPDATE th
 <h2>ADOdb Specific Functionality</h2>
 <h3><li>Setting the Table Name</h3>
 <p>The default behaviour on creating an ADOdb_Active_Record is to "pluralize" the class name and
- use that as the table name. Often, this is not the case. For example, the Person class could be reading 
+ use that as the table name. Often, this is not the case. For example, the person class could be reading 
  from the "People" table. 
 <p>We provide two ways to define your own table:
 <p>1. Use a constructor parameter to override the default table naming behaviour.
 <pre>
-	class Person extends ADOdb_Active_Record{}
-	$person = new Person('People');
+	class person extends ADOdb_Active_Record{}
+	$person = new person('People');
 </pre>
 <p>2. Define it in a class declaration:
 <pre>
-	class Person extends ADOdb_Active_Record
+	class person extends ADOdb_Active_Record
 	{
 	var $_table = 'People';
 	}
-	$person = new Person();
+	$person = new person();
 </pre>
 
 <h3><li>$ADODB_ASSOC_CASE</h3>
@@ -188,10 +190,10 @@ can force field names to be lowercase using $ADODB_ASSOC_CASE. Legal values are
 <p>So to force all Oracle field names to lower-case, use
 <pre>
 $ADODB_ASSOC_CASE = 0;
-$person = new Person('People');
+$person = new person('People');
 $person->name = 'Lily';
 $ADODB_ASSOC_CASE = 2;
-$person2 = new Person('People');
+$person2 = new person('People');
 $person2->NAME = 'Lily'; 
 </pre>
 
@@ -228,14 +230,21 @@ $person->load("id=?", array(3));
 <h3><li>ADOdb_Active_Record::Find($whereOrderBy, $bindarr=false, $pkeyArr=false)</h3>
 <p>We want to retrieve an array of active records based on some search criteria. For example:
 <pre>
-class Person extends ADOdb_Active_Record {
+class person extends ADOdb_Active_Record {
 var $_table = 'people';
 }
 
-$person = new Person();
+$person = new person();
 $peopleArray = $person->Find("name like ? order by age", array('Sm%'));
 </pre>
 
+<h3><li>Quoting Identifiers</h3>
+<p>You can force column names to be quoted in INSERT and UPDATE statements, typically because you are using reserved words as column names by setting
+<pre>
+ADODB_Active_Record::$_quoteNames = true;
+</pre>
+<p>Default is false.
+
 <h3><li>Error Handling and Debugging</h3>
 <p>
 In PHP5, if adodb-exceptions.inc.php is included, then errors are thrown. Otherwise errors are handled by returning a value. False by default means an error has occurred. You can get the last error message using the ErrorMsg() function. 
@@ -280,15 +289,22 @@ try {
 <h3><li>Primary Keys</h3>
 <p>
 ADOdb_Active_Record does not require the table to have a primary key. You can insert records for such a table, but you will not be able to update nor delete. 
-<p>Sometimes you are retrieving data from a view or table that has no primary key, but has a unique index. You can dynamically set the primary key of a table through the constructor, or using ADOdb_Active_Record::SetPrimaryKeys():
+<p>Sometimes you are retrieving data from a view or table that has no primary key, but has a unique index. You can dynamically set the primary key of a table through the constructor:
 <pre>
 	$pkeys = array('category','prodcode');
 	
 	// set primary key using constructor
 	$rec = new ADOdb_Active_Record('Products', $pkeys);
 	
-	 // or use method
-	$rec->SetPrimaryKeys($pkeys);
+	// or define a new class
+	class Product extends ADOdb_Active_Record {
+		function __construct()
+		{
+			parent::__construct('Products', array('prodid'));
+		}
+	}
+	
+	$rec = new Product();
 </pre>
 
 
@@ -297,7 +313,7 @@ When creating a new record, the retrieval of the last auto-incrementing ID is no
 
 <h3><li>Dealing with Multiple Databases</h3>
 <p>
-Sometimes we want to load  data from one database and insert it into another using ActiveRecords. This can be done using the optional parameter of the ADOdb_Active_Record constructor. In the following example, we read data from db.table1 and store it in db2.table2:
+Sometimes we want to load data from one database and insert it into another using ActiveRecords. This can be done using the optional parameter of the ADOdb_Active_Record constructor. In the following example, we read data from db.table1 and store it in db2.table2:
 <pre>
 $db = NewADOConnection(...);
 $db2 = NewADOConnection(...);
@@ -319,7 +335,19 @@ If you have to pass in a primary key called "id" and the 2nd db connection in th
 <pre>
 $rec = new ADOdb_Active_Record("table1",array("id"),$db2);
 </pre>
-
+<p>You can now give a named label in SetDatabaseAdapter, allowing to determine in your class definition which database to load, using var $_dbat.
+<pre>
+$db1 = NewADOConnection(...); // some ADOdb DB
+ADOdb_Active_Record::SetDatabaseAdapter($db1, 'mysql');
+$db2 = NewADOConnection(...); // some ADOdb DB
+ADOdb_Active_Record::SetDatabaseAdapter($db2, 'oracle');
+
+class FooRecord extends ADOdb_Active_Record
+{
+<b>var $_dbat = 'mysql';</b>  // uses 'mysql' connection
+...
+}
+</pre>
 <h3><li>$ADODB_ACTIVE_CACHESECS</h3>
 <p>You can cache the table metadata (field names, types, and other info such primary keys) in $ADODB_CACHE_DIR (which defaults to /tmp) by setting
 the global variable $ADODB_ACTIVE_CACHESECS to a value greater than 0. This will be the number of seconds to cache.
@@ -334,11 +362,11 @@ the global variable $ADODB_ACTIVE_CACHESECS to a value greater than 0. This will
     $rec->save();
  }
 </pre>
-Of course a SELECT statement is superior because it's simpler and much more efficient (probably by a factor of x10 or more):
+Of course an UPDATE statement is superior because it's simpler and much more efficient (probably by a factor of x10 or more):
 <pre>
    $db->Execute("update Products set price = price * 1.1 where category='Furniture'");
 </pre>
-<p>Another issue is performance. For performance sensitive code, using direct SQL will always be faster than using Active Records due to overhead and the fact that all fields in a row are retrieved (rather than only the subset you need) whenever an Active Record is loaded.
+<p>For performance sensitive code, using direct SQL will always be faster than using Active Records due to overhead and the fact that all fields in a row are retrieved (rather than only the subset you need) whenever an Active Record is loaded.
 
 <h3><li>Transactions</h3>
 <p>
@@ -353,6 +381,280 @@ $child->save();
 $conn->CompleteTrans();
 </pre>
 
+<a name=onetomany>
+<h2>One to Many Relations</h3>
+<p>Since ADOdb 5.06, we support parent child relationships. This is done using the ClassBelongsTo() and ClassHasMany() functions. 
+<a name=tablehasmany>
+<h3><li>ClassHasMany</h3>
+<p>To globally define a one-to-many relationship we use the static function ADODB_Active_Record::ClassHasMany($class, $relation, $foreignKey = '', $foreignClass = 'ADODB_Active_Record'). For example, we have 2 tables, <strong>persons</strong> (parent table) and <strong>children</strong> (child table)
+linked by <strong>persons.id = children.person_id</strong>. The variable $person->children is an array that holds the children. To define this relationship:
+<pre>
+	class person extends ADOdb_Active_Record{}
+	ADODB_Active_Record::ClassHasMany('person', 'children','person_id');
+	
+	$person = new person();
+	$person->Load("id=1");
+	foreach($person->children as $c) {
+		echo " $c->name_first ";
+		$c->name_first .= ' K.';
+		$c->Save();  ## each child record must be saved individually
+	}
+</pre>
+<p>If no data is loaded, then children is set to an empty array:
+<pre>
+	$person2 = new person();
+	$p = $person2->children;  ## $p is an empty array()
+</pre>
+<P>By default, data returned by HasMany() is unsorted. To define an order by clause (or define a SELECT LIMIT window), see <a href=#loadrelations>LoadRelations()</a> below. Another point is that all children are loaded only when the child member is accessed (in __get), and not when the Load() function of the parent object is called. This helps to conserve memory.
+
+<p>To create and save new parent and child records:
+<pre>
+
+	class person extends ADOdb_Active_Record{}
+	class children extends ADOdb_Active_Record{}
+	ADODB_Active_Record::ClassHasMany('person', 'children','person_id');
+	
+	$person = new person();
+	
+	for ($i=0; $i<10; $i++) 
+		$person->children[0] = new children('children');
+	 
+	 // modify fields of $person, then...
+	$person->save();
+	
+	foreach($person->children as $c) {
+		// modify fields of $c then...
+		$c->save();
+	}
+</pre>
+<p>You can have multiple relationships (warning: relations are case-sensitive, 'Children' !== 'children'):
+<pre>
+	ADODB_Active_Record::ClassHasMany('person', 'children','person_id');
+	ADODB_Active_Record::ClassHasMany('person', 'siblings','person_id');
+	$person = new person();
+	$person->Load('id=1');
+	var_dump($person->children);
+	var_dump($person->siblings);
+</pre>
+<p>By default, the child class is ADOdb_Active_Record. Sometimes you might want the child class to be based on your own class which has additional functions. You can do so using the last parameter:
+<pre>
+	class person extends ADOdb_Active_Record{}
+	class child extends ADOdb_Active_Record { .... some modifications here ... }
+	ADODB_Active_Record::ClassHasMany('person', 'children','person_id', 'child');
+</pre>
+<p>Lastly some troubleshooting issues. We use the __get() method to set 
+$p->children below. So once $p->children is defined by accessing it, we don't change the child reference, as shown below:
+<pre>
+	ADODB_Active_Record::ClassHasMany('person', 'children','person_id');
+	$p = new person();
+	$p->Load('id=1');
+	# $p->children points to person_id = 1
+	var_dump($p->children);
+	
+	$p->Load('id=2');
+	# $p->children still points to person_id = 1
+	var_dump($p->children); 
+</pre>
+<p>The solution to the above is to unset($p->children) before $p->Load('id=2').
+<h3><li>TableHasMany</h3>
+For some classes, the mapping between class name and table name (which is the pluralised version) might not match. For example, 
+the class name might be <b>person</b>, but the table name might be <b>people</b>. So we have 2 tables, <strong>people</strong> (parent table) and <strong>children</strong> (child table)
+linked by <strong>people.id = children.person_id</strong>.
+<p>Then you use the following static function
+ ADODB_Active_Record::TableHasMany($table, $relation, $foreignKey = '', $foreignClass = 'ADODB_Active_Record') like this:
+<pre>
+ADODB_Active_Record::TableHasMany('people', 'children', 'person_id')
+</pre>
+<h3><li>TableKeyHasMany</h3>
+For some classes, the mapping between class name and table name (which is the pluralised version) might not match or the primary key is not the default <b>id</b>. For example, 
+the class name might be <b>person</b>, but the table name might be <b>people</b>. So we have 2 tables, <strong>people</strong> (parent table) and <strong>children</strong> (child table)
+linked by <strong>people.pid = children.person_id</strong>.
+<p>Then you use the following static function
+ ADODB_Active_Record::TableKeyHasMany($table, $tablePKey, $relation, $foreignKey = '', $foreignClass = 'ADODB_Active_Record') like this:
+<pre>
+ADODB_Active_Record::TableKeyHasMany('people', 'pid', 'children', 'person_id')
+</pre>
+
+
+<h3><li>A Complete ClassHasMany example</h3>
+<p>Here is sample usage using mysql:
+<pre>
+	include_once('../adodb.inc.php');
+	include_once('../adodb-active-record.inc.php');
+
+	$db = NewADOConnection('mysql://root@localhost/northwind');
+	ADOdb_Active_Record::SetDatabaseAdapter($db);
+
+	$db->Execute("CREATE TEMPORARY TABLE `persons` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_color` varchar(100) NOT NULL default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+			   
+	$db->Execute("CREATE TEMPORARY TABLE `children` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+					`person_id` int(10) unsigned NOT NULL,
+					`gender` varchar(10) default 'F',
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_pet` varchar(100) NOT NULL default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+			   
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'Jill','Lim')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'Joan','Lim')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'JAMIE','Lim')");
+			   
+	class person extends ADOdb_Active_Record{}
+	ADODB_Active_Record::ClassHasMany('person', 'children','person_id');	
+	
+	$person = new person();
+	
+	$person->name_first     = 'John';
+	$person->name_last      = 'Lim';
+	$person->favorite_color = 'lavender';
+	$person->save(); // this save will perform an INSERT successfully
+	
+	$person2 = new person(); # no need to define HasMany() again, adodb remembers definition
+	$person2->Load('id=1');
+	
+	$c = $person2->children;
+	if (is_array($c) && sizeof($c) == 3 && $c[0]->name_first=='Jill' && $c[1]->name_first=='Joan'
+		&& $c[2]->name_first == 'JAMIE') echo "OK Loaded HasMany&lt;br>";
+	else {
+		echo "Error loading hasMany should have 3 array elements Jill Joan Jamie&lt;br>";
+	}
+</pre>
+
+<h3><li>HasMany</h3>
+<p>This older method is deprecated and ClassHasMany/TableHasMany/TableKeyHasMany should be used. 
+<p>The older way to define a one-to-many relationship is to use $parentobj->HasMany($relation, $foreignKey = ''). For example, we have 2 tables, <strong>persons</strong> (parent table) and <strong>children</strong> (child table)
+linked by <strong>persons.id = children.person_id</strong>. The variable $person->children is an array that holds the children. To define this relationship:
+<pre>
+	class person extends ADOdb_Active_Record{}
+	
+	$person = new person();
+	$person->HasMany('children','person_id');
+	$person->Load("id=1");
+	foreach($person->children as $c) {
+		echo " $c->name_first ";
+		$c->name_first .= ' K.';
+		$c->Save();  ## each child record must be saved individually
+	}
+</pre>
+<p>This HasMany() definition is global for the current script. This means that you only need to define it once. In the following example, $person2 knows about <em>children</em>.
+<pre>
+	$person = new person();
+	$person->HasMany('children','person_id');
+	
+	$person2 = new person();
+	$person->Load("id=1");
+	$p = $person2->children;
+</pre>
+
+
+<h3><li>ClassBelongsTo</h3>
+<p>You can define the parent of the current object using ADODB_Active_Record::ClassBelongsTo($class, $relationName, $foreignKey, $parentPrimaryKey = 'id', $parentClass = 'ADODB_Active_Record'). In the example below,
+we have a child table <strong>kids</strong>, and a parent table <strong>person</strong>. We have a link <strong>kids.person_id = persons.id</strong>. We create a child first, then link it to the parent:
+<pre>
+	class kid extends ADOdb_Active_Record{};
+	ADODB_Active_Record::ClassBelongsTo('kid','person','person_id','id'); 
+
+	$ch = new kid(); // default tablename will be 'kids', with primary key 'id' 
+	$ch->Load('id=1');
+	$p = $ch->person;
+	if (!$p || $p->name_first != 'John') echo "Error loading belongsTo&lt;br>";
+	else echo "OK loading BelongTo&lt;br>";
+</pre>
+<p>
+<p>Note that relationships are case-sensitive, so ClassBelongsTo('kid','PARENT', 'parent_id') and ClassBelongsTo('kid', 'parent', 'parent_id') are not the same. 
+<p>Also if no data is loaded into the child instance, then $p will return null;
+<pre>
+	ADODB_Active_Record::ClassBelongsTo('kid','person','person_id','id'); 
+	
+	$ch = new kid();
+	$p = $ch->person; # $p is null
+</pre>
+<p>Another way to define the class of the parent (which otherwise defaults to ADODB_Active_Record) as follows:
+<pre>
+
+	class kid extends ADOdb_Active_Record{};
+	class person extends ADOdb_Active_Record{... your modifications ... };
+	ADODB_Active_Record::ClassBelongsTo('kid','person','person_id','id', 'person'); 
+</pre>
+<h3><li>TableBelongsTo</h3>
+<p>If the child table differs from the convention that the child table name is the plural of the child class name, use this function:
+ADODB_Active_Record::TableBelongsTo($childTable, $relationName, $foreignKey, $parentPrimaryKey = 'id', $parentClass = 'ADODB_Active_Record').
+<p>E.g. the class is <b>child</b>, but the table name is <b>children</b>, and the link between the two tables is children.person_id = person.id:
+<pre>
+	ADODB_Active_Record::TableBelongsTo('children','person','person_id','id');
+</pre>
+<h3><li>TableKeyBelongsTo</h3>
+<p>If the child table differs from the convention that the child table name is the plural of the child class name or the primary key is not 'id', use this function:
+ADODB_Active_Record::TableKeyBelongsTo($childTable, $childKey, $relationName, $foreignKey, $parentPrimaryKey = 'id', $parentClass = 'ADODB_Active_Record').
+<p>E.g. the class is <b>child</b>, but the table name is <b>children</b> and primary key is <b>ch_id</b>, and the link between the two tables is children.person_id = person.id:
+<pre>
+	ADODB_Active_Record::TableKeyBelongsTo('children','ch_id', 'person','person_id','id');
+</pre>
+<h3><li>BelongsTo</h3>
+<p>The following is deprecated. Use ClassBelongsTo/TableBelongsTo/TableKeyBelongsTo instead.
+<p>The older way to define the parent of the current object is using BelongsTo($relationName, $foreignKey, $parentPrimaryKey = 'id'). In the example below,
+we have a child table <strong>children</strong>, and a parent table <strong>person</strong>. We have a link <strong>children.person_id = persons.id</strong>. We create a child first, then link it to the parent:
+<pre>
+	class Child extends ADOdb_Active_Record{};
+	$ch = new Child('children',array('id'));
+	$ch->BelongsTo('person','person_id','id');  ## this can be simplified to $ch->BelongsTo('person')
+	                                            ## as foreign key defaults to $table.'_id' and 
+	                                            ## parent pkey defaults to 'id' 
+	$ch->Load('id=1');
+	$p = $ch->person;
+	if (!$p || $p->name_first != 'John') echo "Error loading belongsTo&lt;br>";
+	else echo "OK loading BelongTo&lt;br>";
+</pre>
+<p>You only need to define BelongsTo() once in a script as it is global for all instances. 
+<a name=loadrelations>
+<h3><li>LoadRelations</h3>
+<p>Sometimes you want to load only a subset of data in a relationship. For example, you could load all female children sorted by children.name
+using LoadRelations($relation, $whereOrderBy = '', $offset = -1, $limit = -1):
+<pre>
+	# assume this has been called: 
+	#   ADODB_Active_Record::ClassHasMany('person', 'children','person_id');
+	$person = new person(); 
+	$person->Load('id=23');  
+	# Load doesn't load children until $person->children is accessed or LoadRelations is called:
+	$person->LoadRelations('children',"gender='F' order by name");
+</pre>
+<p>Lastly, if you have lots of child data, you can define a window of data of records to load. In the following
+example, we load a window of 100 records at a time:
+<pre>
+
+	# assume this has been called: 
+	#  ADODB_Active_Record::ClassHasMany('Account', 'transactions','account_id'); 
+	$acc = new Account();
+	$acc->Load('id=23');
+	
+	$start = 0;
+	while(true) {
+		$acc->LoadRelations('transactions',"tx_done=0 order by trxdate", $start, $start+100);
+		if (!$acc->transactions) break;
+		foreach ($acc->transactions as $k => $trx) {
+			## process
+			$trx->tx_done = 1;
+			$trx->save();
+		}
+		$start += 100;
+		unset($acc->transactions);
+
+
+	}
+</pre>
+<p>The $offset is 0-based, and $limit is the number of records to retrieve. The default is to ignore $offset (-1) and $limit (-1).
+<h3><li>Acknowledgements</h3>
+<p>Thanks to Chris Ravenscroft for original one-to-many code (chris#voilaweb.com).
 <h2>ADOConnection Supplement</h2>
 
 <h3><li>ADOConnection::GetActiveRecords()</h3>
@@ -371,7 +673,7 @@ foreach($activeRecArr as $rec) {
 And to retrieve all records ordered by specific fields:
 <pre>
 $whereOrderBy = "1=1 ORDER BY Name";
-$activeRecArr = $db->ADOdb_Active_Records($table);
+$activeRecArr = $db->GetActiveRecords($table);
 </pre>
 <p>
 To use bind variables (assuming ? is the place-holder for your database):
@@ -389,7 +691,7 @@ $activeRecArr = $db->GetActiveRecords($tableName, 'name LIKE ?',
 <p>
 This allows you to retrieve an array of objects derived from ADOdb_Active_Records. Returns false if an error occurs.
 <pre>
-class Product extends ADOdb_Active_Records{};
+class Product extends ADOdb_Active_Record{};
 $table = 'products';
 $whereOrderBy = "name LIKE 'A%' ORDER BY Name";
 $activeRecArr = $db->GetActiveRecordsClass('Product',$table, $whereOrderBy);
@@ -418,7 +720,8 @@ $activeRecArr = $db->GetActiveRecordsClass($className,$tableName, 'name LIKE ?',
 <p>Returns last error message.
 <h3><li>ADOConnection::ErrorNo()</h3>
 <p>Returns last error number.
-<h2>Code Sample</h2>
+
+<h2>ActiveRecord Code Sample</h2>
 <p>The following works with PHP4 and PHP5
 <pre>
 include('../adodb.inc.php');
@@ -440,8 +743,8 @@ $db->Execute("CREATE TEMPORARY TABLE `persons` (
             ) ENGINE=MyISAM;
            ");
 		   
-class Person extends ADOdb_Active_Record{}
-$person = new Person();
+class person extends ADOdb_Active_Record{}
+$person = new person();
 
 echo "&lt;p>Output of getAttributeNames: ";
 var_dump($person->getAttributeNames());
@@ -460,13 +763,13 @@ var_dump($person->getAttributeNames());
  *  }
  */
 
-$person = new Person();
-$person->nameFirst = 'Andi';
-$person->nameLast  = 'Gutmans';
+$person = new person();
+$person->name_first = 'Andi';
+$person->name_last  = 'Gutmans';
 $person->save(); // this save() will fail on INSERT as favorite_color is a must fill...
 
 
-$person = new Person();
+$person = new person();
 $person->name_first     = 'Andi';
 $person->name_last      = 'Gutmans';
 $person->favorite_color = 'blue';
@@ -477,30 +780,273 @@ echo "&lt;p>The Insert ID generated:"; print_r($person->id);
 $person->favorite_color = 'red';
 $person->save(); // this save() will perform an UPDATE
 
-$person = new Person();
+$person = new person();
 $person->name_first     = 'John';
 $person->name_last      = 'Lim';
 $person->favorite_color = 'lavender';
 $person->save(); // this save will perform an INSERT successfully
 
 // load record where id=2 into a new ADOdb_Active_Record
-$person2 = new Person();
+$person2 = new person();
 $person2->Load('id=2');
 var_dump($person2);
 
 // retrieve an array of records
-$activeArr = $db->GetActiveRecordsClass($class = "Person",$table = "persons","id=".$db->Param(0),array(2));
+$activeArr = $db->GetActiveRecordsClass($class = "person",$table = "persons","id=".$db->Param(0),array(2));
 $person2 = $activeArr[0];
 echo "&lt;p>Name first (should be John): ",$person->name_first, "&lt;br>Class = ",get_class($person2);	
 </pre>
 
+
+
+<a name=recordx>
+<h2>Active Record eXtended</h2>
+<p>This is the original one-to-many Active Record implementation submitted by
+Chris Ravenscroft  (chris#voilaweb.com). The reason why we are offering both versions is that the Extended version
+is more powerful but more complex. My personal preference is to keep it simpler, but your view may vary. 
+<p>To use, just include adodb-active-recordx.inc.php instead of adodb-active-record.inc.php.
+<p>It provides a new function called Find() that is quite intuitive to use as shown in the example below. It also supports loading all relationships using a single query (using joins).
+<pre>
+&lt;?php
+	function ar_assert($obj, $cond)
+	{
+		global $err_count;
+		$res = var_export($obj, true);
+		return (strpos($res, $cond));
+	}
+
+	include_once('../adodb.inc.php');
+	include_once('../adodb-active-recordx.inc.php');
+	
+
+	$db = NewADOConnection('mysql://root@localhost/northwind');
+	$db->debug=0;
+	ADOdb_Active_Record::SetDatabaseAdapter($db);
+	echo "&lt;pre>\n";
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "Preparing database using SQL queries (creating 'people', 'children')\n";
+
+	$db->Execute("DROP TABLE `people`");
+	$db->Execute("DROP TABLE `children`");
+
+	$db->Execute("CREATE TABLE `people` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_color` varchar(100) NOT NULL default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+	$db->Execute("CREATE TABLE `children` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+					`person_id` int(10) unsigned NOT NULL,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_pet` varchar(100) NOT NULL default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+			   
+	
+	$db->Execute("insert into children (person_id,name_first,name_last,favorite_pet) values (1,'Jill','Lim','tortoise')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'Joan','Lim')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'JAMIE','Lim')");
+			   
+	// This class _implicitely_ relies on the 'people' table (pluralized form of 'person')
+	class Person extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct();
+			$this->hasMany('children');
+		}
+	}
+	// This class _implicitely_ relies on the 'children' table
+	class Child extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct();
+			$this->belongsTo('person');
+		}
+	}
+	// This class _explicitely_ relies on the 'children' table and shares its metadata with Child
+	class Kid extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct('children');
+			$this->belongsTo('person');
+		}
+	}
+	// This class _explicitely_ relies on the 'children' table but does not share its metadata
+	class Rugrat extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct('children', false, false, array('new' => true));
+		}
+	}
+	
+	echo "Inserting person in 'people' table ('John Lim, he likes lavender')\n";
+	echo "---------------------------------------------------------------------------\n";
+	$person = new Person();
+	$person->name_first     = 'John';
+	$person->name_last      = 'Lim';
+	$person->favorite_color = 'lavender';
+	$person->save(); // this save will perform an INSERT successfully
+
+	$err_count = 0;
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "person->Find('id=1') [Lazy Method]\n";
+	echo "person is loaded but its children will be loaded on-demand later on\n";
+	echo "---------------------------------------------------------------------------\n";
+	$person5 = new Person();
+	$people5 = $person5->Find('id=1');
+	echo (ar_assert($people5, "'name_first' => 'John'")) ? "[OK] Found John\n" : "[!!] Find failed\n";
+	echo (ar_assert($people5, "'favorite_pet' => 'tortoise'")) ? "[!!] Found relation when I shouldn't\n" : "[OK] No relation yet\n";
+	foreach($people5 as $person)
+	{
+		foreach($person->children as $child)
+		{
+			if($child->name_first);
+		}
+	}
+	echo (ar_assert($people5, "'favorite_pet' => 'tortoise'")) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n";
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "person->Find('id=1' ... ADODB_WORK_AR) [Worker Method]\n";
+	echo "person is loaded, and so are its children\n";
+	echo "---------------------------------------------------------------------------\n";
+	$person6 = new Person();
+	$people6 = $person6->Find('id=1', false, false, array('loading' => ADODB_WORK_AR));
+	echo (ar_assert($people6, "'name_first' => 'John'")) ? "[OK] Found John\n" : "[!!] Find failed\n";
+	echo (ar_assert($people6, "'favorite_pet' => 'tortoise'")) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n";
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "person->Find('id=1' ... ADODB_JOIN_AR) [Join Method]\n";
+	echo "person and its children are loaded using a single query\n";
+	echo "---------------------------------------------------------------------------\n";
+	$person7 = new Person();
+	// When I specifically ask for a join, I have to specify which table id I am looking up
+	// otherwise the SQL parser will wonder which table's id that would be.
+	$people7 = $person7->Find('people.id=1', false, false, array('loading' => ADODB_JOIN_AR));
+	echo (ar_assert($people7, "'name_first' => 'John'")) ? "[OK] Found John\n" : "[!!] Find failed\n";
+	echo (ar_assert($people7, "'favorite_pet' => 'tortoise'")) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n";
+	
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "person->Load('people.id=1') [Join Method]\n";
+	echo "Load() always uses the join method since it returns only one row\n";
+	echo "---------------------------------------------------------------------------\n";
+	$person2 = new Person();
+	// Under the hood, Load(), since it returns only one row, always perform a join
+	// Therefore we need to clarify which id we are talking about.
+	$person2->Load('people.id=1');
+	echo (ar_assert($person2, "'name_first' => 'John'")) ? "[OK] Found John\n" : "[!!] Find failed\n";
+	echo (ar_assert($person2, "'favorite_pet' => 'tortoise'")) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n";
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "child->Load('children.id=1') [Join Method]\n";
+	echo "We are now loading from the 'children' table, not from 'people'\n";
+	echo "---------------------------------------------------------------------------\n";
+	$ch = new Child();
+	$ch->Load('children.id=1');
+	echo (ar_assert($ch, "'name_first' => 'Jill'")) ? "[OK] Found Jill\n" : "[!!] Find failed\n";
+	echo (ar_assert($ch, "'favorite_color' => 'lavender'")) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n";
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "child->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n";
+	echo "---------------------------------------------------------------------------\n";
+	$ch2 = new Child();
+	$ach2 = $ch2->Find('id=1', false, false, array('loading' => ADODB_WORK_AR));
+	echo (ar_assert($ach2, "'name_first' => 'Jill'")) ? "[OK] Found Jill\n" : "[!!] Find failed\n";
+	echo (ar_assert($ach2, "'favorite_color' => 'lavender'")) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n";
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "kid->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n";
+	echo "Where we see that kid shares relationships with child because they are stored\n";
+	echo "in the common table's metadata structure.\n";
+	echo "---------------------------------------------------------------------------\n";
+	$ch3 = new Kid('children');
+	$ach3 = $ch3->Find('children.id=1', false, false, array('loading' => ADODB_WORK_AR));
+	echo (ar_assert($ach3, "'name_first' => 'Jill'")) ? "[OK] Found Jill\n" : "[!!] Find failed\n";
+	echo (ar_assert($ach3, "'favorite_color' => 'lavender'")) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n";
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "kid->Find('children.id=1' ... ADODB_LAZY_AR) [Lazy Method]\n";
+	echo "Of course, lazy loading also retrieve medata information...\n";
+	echo "---------------------------------------------------------------------------\n";
+	$ch32 = new Kid('children');
+	$ach32 = $ch32->Find('children.id=1', false, false, array('loading' => ADODB_LAZY_AR));
+	echo (ar_assert($ach32, "'name_first' => 'Jill'")) ? "[OK] Found Jill\n" : "[!!] Find failed\n";
+	echo (ar_assert($ach32, "'favorite_color' => 'lavender'")) ? "[!!] Found relation when I shouldn't\n" : "[OK] No relation yet\n";
+	foreach($ach32 as $akid)
+	{
+		if($akid->person);
+	}
+	echo (ar_assert($ach32, "'favorite_color' => 'lavender'")) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n";
+	
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "rugrat->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n";
+	echo "In rugrat's constructor it is specified that\nit must forget any existing relation\n";
+	echo "---------------------------------------------------------------------------\n";
+	$ch4 = new Rugrat('children');
+	$ach4 = $ch4->Find('children.id=1', false, false, array('loading' => ADODB_WORK_AR));
+	echo (ar_assert($ach4, "'name_first' => 'Jill'")) ? "[OK] Found Jill\n" : "[!!] Find failed\n";
+	echo (ar_assert($ach4, "'favorite_color' => 'lavender'")) ? "[!!] Found relation when I shouldn't\n" : "[OK] No relation found\n";
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "kid->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n";
+	echo "Note how only rugrat forgot its relations - kid is fine.\n";
+	echo "---------------------------------------------------------------------------\n";
+	$ch5 = new Kid('children');
+	$ach5 = $ch5->Find('children.id=1', false, false, array('loading' => ADODB_WORK_AR));
+	echo (ar_assert($ach5, "'name_first' => 'Jill'")) ? "[OK] Found Jill\n" : "[!!] Find failed\n";
+	echo (ar_assert($ach5, "'favorite_color' => 'lavender'")) ? "[OK] I did not forget relation: person\n" : "[!!] I should not have forgotten relation: person\n";
+	
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "rugrat->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n";
+	echo "---------------------------------------------------------------------------\n";
+	$ch6 = new Rugrat('children');
+	$ch6s = $ch6->Find('children.id=1', false, false, array('loading' => ADODB_WORK_AR));
+	$ach6 = $ch6s[0];
+	echo (ar_assert($ach6, "'name_first' => 'Jill'")) ? "[OK] Found Jill\n" : "[!!] Find failed\n";
+	echo (ar_assert($ach6, "'favorite_color' => 'lavender'")) ? "[!!] Found relation when I shouldn't\n" : "[OK] No relation yet\n";
+	echo "\nLoading relations:\n";
+	$ach6->belongsTo('person');
+	$ach6->LoadRelations('person', 'order by id', 0, 2);
+	echo (ar_assert($ach6, "'favorite_color' => 'lavender'")) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n";
+
+	echo "\n\n---------------------------------------------------------------------------\n";
+	echo "Test suite complete.\n";
+	echo "---------------------------------------------------------------------------\n";
+?>
+</pre>
  <h3>Todo (Code Contributions welcome)</h3>
  <p>Check _original and current field values before update, only update changes. Also if the primary key value is changed, then on update, we should save and use the original primary key values in the WHERE clause!
- <p>Handle 1-to-many relationships.
+
  <p>PHP5 specific:  Make GetActiveRecords*() return an Iterator.
  <p>PHP5 specific: Change PHP5 implementation of Active Record to use __get() and __set() for better performance.
 
 <h3> Change Log</h3>
+<p>0.93
+<p>You can force column names to be quoted in INSERT and UPDATE statements, typically because you are using reserved words as column names by setting
+ADODB_Active_Record::$_quoteNames = true;
+
+<p>0.92
+<p>Fixed some issues with incompatible fetch modes (ADODB_FETCH_ASSOC) causing problems in UpdateActiveTable.
+<p>Added support for functions that support predefining one-to-many relationships:<br> 
+&nbsp; <i>ClassHasMany ClassBelongsTo TableHasMany TableBelongsTo TableKeyHasMany TableKeyBelongsTo</i>. <br>
+<p>You can also define your child/parent class in these functions, instead of the default ADODB_Active_Record.
+
+<P>0.91
+<p>HasMany hardcoded primary key field name to "id". Fixed.
+
+<p>0.90
+<p>Support for belongsTo and hasMany. Thanks to Chris Ravenscroft (chris#voilaweb.com).
+<p>Added LoadRelations().
+
 <p>0.08
 Added support for assoc arrays in Set().
 
diff --git a/third_party/adodb/docs/docs-adodb.htm b/third_party/adodb/docs/docs-adodb.htm
index c001f23..df6d327 100644
--- a/third_party/adodb/docs/docs-adodb.htm
+++ b/third_party/adodb/docs/docs-adodb.htm
@@ -1,3204 +1,6905 @@
-<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
-<html><head><title>ADODB Manual</title>
+<html xmlns:v="urn:schemas-microsoft-com:vml"
+xmlns:o="urn:schemas-microsoft-com:office:office"
+xmlns:w="urn:schemas-microsoft-com:office:word"
+xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
+xmlns="http://www.w3.org/TR/REC-html40">
 
-<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
+<head>
+<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
+<meta name=ProgId content=Word.Document>
+<meta name=Generator content="Microsoft Word 11">
+<meta name=Originator content="Microsoft Word 11">
+<link rel=File-List href="docs-adodb_files/filelist.xml">
+<link rel=Edit-Time-Data href="docs-adodb_files/editdata.mso">
+<!--[if !mso]>
+<style>
+v\:* {behavior:url(#default#VML);}
+o\:* {behavior:url(#default#VML);}
+w\:* {behavior:url(#default#VML);}
+.shape {behavior:url(#default#VML);}
+</style>
+<![endif]-->
+<title>ADODB Manual</title>
+<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
+ name="State"/>
+<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
+ name="PlaceType"/>
+<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
+ name="PlaceName"/>
+<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
+ name="country-region"/>
+<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
+ name="City"/>
+<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
+ name="place"/>
+<!--[if gte mso 9]><xml>
+ <o:DocumentProperties>
+  <o:Author>John</o:Author>
+  <o:LastAuthor>John</o:LastAuthor>
+  <o:Revision>3</o:Revision>
+  <o:TotalTime>3</o:TotalTime>
+  <o:Created>2008-12-24T10:43:00Z</o:Created>
+  <o:LastSaved>2008-12-24T10:46:00Z</o:LastSaved>
+  <o:Pages>73</o:Pages>
+  <o:Words>30239</o:Words>
+  <o:Characters>172366</o:Characters>
+  <o:Company> </o:Company>
+  <o:Lines>1436</o:Lines>
+  <o:Paragraphs>404</o:Paragraphs>
+  <o:CharactersWithSpaces>202201</o:CharactersWithSpaces>
+  <o:Version>11.9999</o:Version>
+ </o:DocumentProperties>
+</xml><![endif]--><!--[if gte mso 9]><xml>
+ <w:WordDocument>
+  <w:Zoom>140</w:Zoom>
+  <w:FormsDesign/>
+  <w:ValidateAgainstSchemas/>
+  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
+  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
+  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
+  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
+ </w:WordDocument>
+</xml><![endif]--><!--[if gte mso 9]><xml>
+ <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
+ </w:LatentStyles>
+</xml><![endif]--><!--[if !mso]><object
+ classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
+<style>
+st1\:*{behavior:url(#ieooui) }
+</style>
+<![endif]-->
+<style>
+<!--
+f
 
-	
+
+ /* Font Definitions */
+ @font-face
+	{font-family:Helvetica;
+	panose-1:2 11 6 4 2 2 2 2 2 4;
+	mso-font-charset:0;
+	mso-generic-font-family:swiss;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:3 0 0 0 1 0;}
+@font-face
+	{font-family:Courier;
+	panose-1:2 7 4 9 2 2 5 2 4 4;
+	mso-font-charset:0;
+	mso-generic-font-family:modern;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:3 0 0 0 1 0;}
+@font-face
+	{font-family:"Tms Rmn";
+	panose-1:2 2 6 3 4 5 5 2 3 4;
+	mso-font-charset:0;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:3 0 0 0 1 0;}
+@font-face
+	{font-family:Helv;
+	panose-1:2 11 6 4 2 2 2 3 2 4;
+	mso-font-charset:0;
+	mso-generic-font-family:swiss;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:3 0 0 0 1 0;}
+@font-face
+	{font-family:"New York";
+	panose-1:2 4 5 3 6 5 6 2 3 4;
+	mso-font-charset:0;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:3 0 0 0 1 0;}
+@font-face
+	{font-family:System;
+	panose-1:0 0 0 0 0 0 0 0 0 0;
+	mso-font-charset:0;
+	mso-generic-font-family:swiss;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:3 0 0 0 1 0;}
+@font-face
+	{font-family:Wingdings;
+	panose-1:5 0 0 0 0 0 0 0 0 0;
+	mso-font-charset:2;
+	mso-generic-font-family:auto;
+	mso-font-pitch:variable;
+	mso-font-signature:0 268435456 0 0 -2147483648 0;}
+@font-face
+	{font-family:"MS Mincho";
+	panose-1:2 2 6 9 4 2 5 8 3 4;
+	mso-font-alt:"\FF2D\FF33 \660E\671D";
+	mso-font-charset:128;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:1 134676480 16 0 131072 0;}
+@font-face
+	{font-family:Batang;
+	panose-1:2 3 6 0 0 1 1 1 1 1;
+	mso-font-alt:\BC14\D0D5;
+	mso-font-charset:129;
+	mso-generic-font-family:auto;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:1 151388160 16 0 524288 0;}
+@font-face
+	{font-family:SimSun;
+	panose-1:2 1 6 0 3 1 1 1 1 1;
+	mso-font-alt:\5B8B\4F53;
+	mso-font-charset:134;
+	mso-generic-font-family:auto;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:1 135135232 16 0 262144 0;}
+@font-face
+	{font-family:PMingLiU;
+	panose-1:2 2 3 0 0 0 0 0 0 0;
+	mso-font-alt:\65B0\7D30\660E\9AD4;
+	mso-font-charset:136;
+	mso-generic-font-family:auto;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:1 134742016 16 0 1048576 0;}
+@font-face
+	{font-family:"MS Gothic";
+	panose-1:2 11 6 9 7 2 5 8 2 4;
+	mso-font-alt:"\FF2D\FF33 \30B4\30B7\30C3\30AF";
+	mso-font-charset:128;
+	mso-generic-font-family:modern;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:1 134676480 16 0 131072 0;}
+@font-face
+	{font-family:Dotum;
+	panose-1:2 11 6 0 0 1 1 1 1 1;
+	mso-font-alt:\B3CB\C6C0;
+	mso-font-charset:129;
+	mso-generic-font-family:modern;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:1 151388160 16 0 524288 0;}
+@font-face
+	{font-family:SimHei;
+	panose-1:2 1 6 0 3 1 1 1 1 1;
+	mso-font-alt:\9ED1\4F53;
+	mso-font-charset:134;
+	mso-generic-font-family:modern;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:1 135135232 16 0 262144 0;}
+@font-face
+	{font-family:MingLiU;
+	panose-1:2 2 3 9 0 0 0 0 0 0;
+	mso-font-alt:\7D30\660E\9AD4;
+	mso-font-charset:136;
+	mso-generic-font-family:modern;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:1 134742016 16 0 1048576 0;}
+@font-face
+	{font-family:Mincho;
+	panose-1:2 2 6 9 4 3 5 8 3 5;
+	mso-font-alt:\660E\671D;
+	mso-font-charset:128;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:1 134676480 16 0 131072 0;}
+@font-face
+	{font-family:Gulim;
+	panose-1:2 11 6 0 0 1 1 1 1 1;
+	mso-font-alt:\AD74\B9BC;
+	mso-font-charset:129;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:fixed;
+	mso-font-signature:1 151388160 16 0 524288 0;}
+@font-face
+	{font-family:Century;
+	panose-1:2 4 6 4 5 5 5 2 3 4;
+	mso-font-charset:0;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:3 0 0 0 1 0;}
+@font-face
+	{font-family:"Angsana New";
+	panose-1:2 2 6 3 5 4 5 2 3 4;
+	mso-font-charset:222;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:16777217 0 0 0 65536 0;}
+@font-face
+	{font-family:"Cordia New";
+	panose-1:2 11 3 4 2 2 2 2 2 4;
+	mso-font-charset:222;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:16777217 0 0 0 65536 0;}
+@font-face
+	{font-family:Mangal;
+	panose-1:0 0 4 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:32768 0 0 0 0 0;}
+@font-face
+	{font-family:Latha;
+	panose-1:2 0 4 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:1048576 0 0 0 0 0;}
+@font-face
+	{font-family:Sylfaen;
+	panose-1:1 10 5 2 5 3 6 3 3 3;
+	mso-font-charset:0;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:16778883 0 512 0 13 0;}
+@font-face
+	{font-family:Vrinda;
+	panose-1:0 0 4 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:0 0 0 0 0 0;}
+@font-face
+	{font-family:Raavi;
+	panose-1:2 0 5 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:0 0 0 0 0 0;}
+@font-face
+	{font-family:Shruti;
+	panose-1:2 0 5 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:0 0 0 0 0 0;}
+@font-face
+	{font-family:Sendnya;
+	panose-1:0 0 4 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:0 0 0 0 0 0;}
+@font-face
+	{font-family:Gautami;
+	panose-1:2 0 5 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:0 0 0 0 0 0;}
+@font-face
+	{font-family:Tunga;
+	panose-1:0 0 4 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:0 0 0 0 0 0;}
+@font-face
+	{font-family:"Estrangelo Edessa";
+	panose-1:0 0 0 0 0 0 0 0 0 0;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:0 0 0 0 0 0;}
+@font-face
+	{font-family:Kartika;
+	panose-1:1 1 1 0 1 1 1 1 1 1;
+	mso-font-charset:1;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:0 0 0 0 0 0;}
+@font-face
+	{font-family:"Arial Unicode MS";
+	panose-1:2 11 6 4 2 2 2 2 2 4;
+	mso-font-charset:0;
+	mso-generic-font-family:roman;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:3 0 0 0 1 0;}
+@font-face
+	{font-family:Tahoma;
+	panose-1:2 11 6 4 3 5 4 4 2 4;
+	mso-font-charset:0;
+	mso-generic-font-family:swiss;
+	mso-font-format:other;
+	mso-font-pitch:variable;
+	mso-font-signature:3 0 0 0 1 0;}
+ /* Style Definitions */
+ p.MsoNormal, li.MsoNormal, div.MsoNormal
+	{mso-style-parent:"";
+	margin:0cm;
+	margin-bottom:.0001pt;
+	mso-pagination:widow-orphan;
+	font-size:12.0pt;
+	font-family:"Times New Roman";
+	mso-fareast-font-family:"Times New Roman";
+	color:black;}
+h1
+	{mso-margin-top-alt:auto;
+	margin-right:0cm;
+	mso-margin-bottom-alt:auto;
+	margin-left:0cm;
+	mso-pagination:widow-orphan;
+	mso-outline-level:1;
+	font-size:24.0pt;
+	font-family:"Times New Roman";
+	color:black;
+	font-weight:bold;}
+h2
+	{mso-margin-top-alt:auto;
+	margin-right:0cm;
+	mso-margin-bottom-alt:auto;
+	margin-left:0cm;
+	mso-pagination:widow-orphan;
+	mso-outline-level:2;
+	font-size:18.0pt;
+	font-family:"Times New Roman";
+	color:black;
+	font-weight:bold;}
+h3
+	{mso-margin-top-alt:auto;
+	margin-right:0cm;
+	mso-margin-bottom-alt:auto;
+	margin-left:0cm;
+	mso-pagination:widow-orphan;
+	mso-outline-level:3;
+	font-size:13.5pt;
+	font-family:"Times New Roman";
+	color:black;
+	font-weight:bold;}
+h4
+	{mso-margin-top-alt:auto;
+	margin-right:0cm;
+	mso-margin-bottom-alt:auto;
+	margin-left:0cm;
+	mso-pagination:widow-orphan;
+	mso-outline-level:4;
+	font-size:12.0pt;
+	font-family:"Times New Roman";
+	color:black;
+	font-weight:bold;}
+a:link, span.MsoHyperlink
+	{color:blue;
+	text-decoration:underline;
+	text-underline:single;}
+a:visited, span.MsoHyperlinkFollowed
+	{color:blue;
+	text-decoration:underline;
+	text-underline:single;}
+p
+	{font-size:12.0pt;
+	font-family:"Times New Roman";
+	mso-fareast-font-family:"Times New Roman";
+	color:black;}
+code
+	{font-family:"Courier New";
+	mso-ascii-font-family:"Courier New";
+	mso-fareast-font-family:"Times New Roman";
+	mso-hansi-font-family:"Courier New";
+	mso-bidi-font-family:"Courier New";}
+pre
+	{margin:0cm;
+	margin-bottom:.0001pt;
+	mso-pagination:widow-orphan;
+	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
+	background:#EEEEEE;
+	border:none;
+	mso-border-alt:solid #DDDDDD .75pt;
+	padding:0cm;
+	mso-padding-alt:9.0pt 18.0pt 9.0pt 18.0pt;
+	font-size:9.0pt;
+	font-family:"Courier New";
+	mso-fareast-font-family:"Times New Roman";
+	color:black;}
+span.msoIns
+	{mso-style-type:export-only;
+	mso-style-name:"";
+	text-decoration:underline;
+	text-underline:single;
+	color:teal;}
+span.msoDel
+	{mso-style-type:export-only;
+	mso-style-name:"";
+	text-decoration:line-through;
+	color:red;}
+span.msoChangeProp
+	{mso-style-type:export-only;
+	mso-style-name:"";}
+@page Section1
+	{size:612.0pt 792.0pt;
+	margin:72.0pt 90.0pt 72.0pt 90.0pt;
+	mso-header-margin:35.4pt;
+	mso-footer-margin:35.4pt;
+	mso-paper-source:0;}
+div.Section1
+	{page:Section1;}
+ /* List Definitions */
+ @list l0
+	{mso-list-id:3098366;
+	mso-list-template-ids:-1654113918;}
+@list l0:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l1
+	{mso-list-id:118686534;
+	mso-list-template-ids:1789952844;}
+@list l1:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l2
+	{mso-list-id:325595838;
+	mso-list-template-ids:-924547596;}
+@list l2:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l3
+	{mso-list-id:577053254;
+	mso-list-template-ids:1006266472;}
+@list l3:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l4
+	{mso-list-id:584261941;
+	mso-list-template-ids:1672376844;}
+@list l4:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l5
+	{mso-list-id:678311197;
+	mso-list-template-ids:-1025849406;}
+@list l5:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l6
+	{mso-list-id:993068284;
+	mso-list-template-ids:-1149100626;}
+@list l6:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l7
+	{mso-list-id:1120344907;
+	mso-list-template-ids:-1732590280;}
+@list l7:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l8
+	{mso-list-id:1134718884;
+	mso-list-template-ids:-1854392276;}
+@list l8:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l9
+	{mso-list-id:1289897560;
+	mso-list-template-ids:-1284101662;}
+@list l9:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+@list l10
+	{mso-list-id:1461026030;
+	mso-list-template-ids:65944450;}
+@list l11
+	{mso-list-id:1566380536;
+	mso-list-template-ids:395727058;}
+@list l11:level1
+	{mso-level-number-format:bullet;
+	mso-level-text:\F0B7;
+	mso-level-tab-stop:36.0pt;
+	mso-level-number-position:left;
+	text-indent:-18.0pt;
+	mso-ansi-font-size:10.0pt;
+	font-family:Symbol;}
+ol
+	{margin-bottom:0cm;}
+ul
+	{margin-bottom:0cm;}
+-->
+</style>
+<!--[if gte mso 10]>
 <style>
-pre {
-  background-color: #eee;
-  padding: 0.75em 1.5em;
-  font-size: 12px;
-  border: 1px solid #ddd;
-}
-</style></head>
-<body bgcolor="#ffffff" text="black">
+ /* Style Definitions */
+ table.MsoNormalTable
+	{mso-style-name:"Table Normal";
+	mso-tstyle-rowband-size:0;
+	mso-tstyle-colband-size:0;
+	mso-style-noshow:yes;
+	mso-style-parent:"";
+	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
+	mso-para-margin:0cm;
+	mso-para-margin-bottom:.0001pt;
+	mso-pagination:widow-orphan;
+	font-size:10.0pt;
+	font-family:"Times New Roman";
+	mso-ansi-language:#0400;
+	mso-fareast-language:#0400;
+	mso-bidi-language:#0400;}
+</style>
+<![endif]--><!--[if gte mso 9]><xml>
+ <o:shapedefaults v:ext="edit" spidmax="1026"/>
+</xml><![endif]--><!--[if gte mso 9]><xml>
+ <o:shapelayout v:ext="edit">
+  <o:idmap v:ext="edit" data="1"/>
+ </o:shapelayout></xml><![endif]-->
+</head>
+
+<body bgcolor=white lang=EN-US link=blue vlink=blue style='tab-interval:36.0pt'>
+
+<div class=Section1>
 
 <h2>ADOdb Library for PHP</h2>
-<p>V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com)</p>
-<p><font size="1">This software is dual licensed using BSD-Style and LGPL. This 
-  means you can use it in compiled proprietary and commercial products.</font></p>
-  
-
-	<p>Useful ADOdb links:  <a href="http://adodb.sourceforge.net/#download">Download</a> &nbsp; <a href="http://adodb.sourceforge.net/#docs">Other Docs</a>
-
-</p><p><a href="#intro"><b>Introduction</b></a><b><br>
-	<a href="#features">Unique Features</a><br>
-	<a href="#users">How People are using ADOdb</a><br>
-	<a href="#bugs">Feature Requests and Bug Reports</a><br>
-	</b><b><a href="#install">Installation</a><br>
-	<a href="#mininstall">Minimum Install</a><br>
-	<a href="#coding">Initializing Code and Connectioning to Databases</a><br>
-	</b><font size="2"> &nbsp; <a href="#dsnsupport">Data Source Name (DSN) Support</a></font>  &nbsp;  <a href="#connect_ex">Connection Examples</a> <br>
-	<b><a href="#speed">High Speed ADOdb - tuning tips</a></b><br>
-	<b><a href="#hack">Hacking and Modifying ADOdb Safely</a><br>
-	<a href="#php5">PHP5 Features</a></b><br>
-	<font size="2"><a href="#php5iterators">foreach iterators</a> <a href="#php5exceptions">exceptions</a></font><br>
-	<b> <a href="#drivers">Supported Databases</a></b><br>
-	<b> <a href="#quickstart">Tutorials</a></b><br>
-	<a href="#ex1">Example 1: Select</a><br>
-	<a href="#ex2">Example 2: Advanced Select</a><br>
-	<a href="#ex3">Example 3: Insert</a><br>
-	<a href="#ex4">Example 4: Debugging</a> &nbsp;<a href="#exrs2html">rs2html 
-	example</a><br>
-	<a href="#ex5">Example 5: MySQL and Menus</a><br>
-	<a href="#ex6">Example 6: Connecting to Multiple Databases at once</a> <br>
-	<a href="#ex7">Example 7: Generating Update and Insert SQL</a> <br>
-	<a href="#ex8">Example 8: Implementing Scrolling with Next and Previous</a><br>
-	<a href="#ex9">Example 9: Exporting in CSV or Tab-Delimited Format</a> <br>
-	<a href="#ex10">Example 10: Custom filters</a><br>
-	<a href="#ex11">Example 11: Smart Transactions</a><br>
-	<br>
-	<b> <a href="#errorhandling">Using Custom Error Handlers and PEAR_Error</a><br>
-	<a href="#DSN">Data Source Names</a><br>
-	<a href="#caching">Caching</a><br>
-	<a href="#pivot">Pivot Tables</a></b> 
-</p><p><a href="#ref"><b>REFERENCE</b></a>
-</p><p> <font size="2">Variables: <a href="#adodb_countrecs">$ADODB_COUNTRECS</a> 
-<a href="#adodb_ansi_padding_off">$ADODB_ANSI_PADDING_OFF</a>
-  <a href="#adodb_cache_dir">$ADODB_CACHE_DIR</a> <br>
-  &nbsp; &nbsp; &nbsp; &nbsp;  <a href="#force_type">$ADODB_FORCE_TYPE</a> 
-  <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a> 
-  <a href="#adodb_lang">$ADODB_LANG</a> <a href=#adodb_auto_quote>ADODB_QUOTE_FIELDNAMES</a> <br>
-  Constants: </font><font size="2"><a href="#adodb_assoc_case">ADODB_ASSOC_CASE</a> 
-  </font><br>
-  <a href="#ADOConnection"><b> ADOConnection</b></a><br>
-  <font size="2">Connections: <a href="#connect">Connect</a> <a href="#pconnect">PConnect</a> 
-  <a href="#nconnect">NConnect</a> <a href="#isconnected">IsConnected</a><br>
-  Executing SQL: <a href="#execute">Execute</a> <a href="#cacheexecute"><i>CacheExecute</i></a> 
-  <a href="#selectlimit">SelectLimit</a> <a href="#cacheSelectLimit"><i>CacheSelectLimit</i></a> 
-  <a href="#param">Param</a> <a href="#prepare">Prepare</a> <a href="#preparesp">PrepareSP</a> 
-  <a href="#inparameter">InParameter</a> <a href="#outparameter">OutParameter</a> <a href="#autoexecute">AutoExecute</a>
-  <br>
-  &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#getone">GetOne</a> 
-  <a href="#cachegetone"><i>CacheGetOne</i></a> <a href="#getrow">GetRow</a> <a href="#cachegetrow"><i>CacheGetRow</i></a> 
-  <a href="#getall">GetAll</a> <a href="#cachegetall"><i>CacheGetAll</i></a> <a href="#getcol">GetCol</a> 
-  <a href="#cachegetcol"><i>CacheGetCol</i></a> <a href="#getassoc1">GetAssoc</a> <a href="#cachegetassoc"><i>CacheGetAssoc</i></a> <a href="#replace">Replace</a> 
-  <br>
-  &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#executecursor">ExecuteCursor</a> 
-  (oci8 only)<br>
-  Generates SQL strings: <a href="#getupdatesql">GetUpdateSQL</a> <a href="#getinsertsql">GetInsertSQL</a> 
-  <a href="#concat">Concat</a> <a href="#ifnull">IfNull</a> <a href="#length">length</a> <a href="#random">random</a> <a href="#substr">substr</a> 
-  <a href="#qstr">qstr</a> <a href="#param">Param</a>  <a href="#OffsetDate">OffsetDate</a> <a href="#sqldate">SQLDate</a> 
-  <a href="#dbdate">DBDate</a>  <a href="#dbtimestamp">DBTimeStamp</a>
-  <a href="#binddate">BindDate</a>  <a href="#bindtimestamp">BindTimeStamp</a>
-  <br>
-  Blobs: <a href="#updateblob">UpdateBlob</a> <a href="#updateclob">UpdateClob</a> 
-  <a href="#updateblobfile">UpdateBlobFile</a> <a href="#blobencode">BlobEncode</a> 
-  <a href="#blobdecode">BlobDecode</a><br>
-  Paging/Scrolling: <a href="#pageexecute">PageExecute</a> <a href="#cachepageexecute">CachePageExecute</a><br>
-  Cleanup: <a href="#cacheflush">CacheFlush</a> <a href="#Close">Close</a><br>
-  Transactions: <a href="#starttrans">StartTrans</a> <a href="#completetrans">CompleteTrans</a> 
-  <a href="#failtrans">FailTrans</a> <a href="#hasfailedtrans">HasFailedTrans</a> 
-  <a href="#begintrans">BeginTrans</a> <a href="#committrans">CommitTrans</a> 
-  <a href="#rollbacktrans">RollbackTrans</a> <a href=#SetTransactionMode>SetTransactionMode</a><br>
-  Fetching Data: </font> <font size="2"><a href="#setfetchmode">SetFetchMode</a><br>
-  Strings: <a href="#concat">concat</a> <a href="#length">length</a>  <a href="#qstr">qstr</a> <a href="#quote">quote</a> <a href="#substr">substr</a><br>
-  Dates: <a href="#dbdate">DBDate</a> <a href="#dbtimestamp">DBTimeStamp</a> <a href="#unixdate">UnixDate</a> 
-  <a href="#binddate">BindDate</a>  <a href="#bindtimestamp">BindTimeStamp</a>
-  <a href="#unixtimestamp">UnixTimeStamp</a> <a href="#OffsetDate">OffsetDate</a> 
-  <a href="#SQLDate">SQLDate</a> <br>
-  Row Management: <a href="#affected_rows">Affected_Rows</a> <a href="#inserted_id">Insert_ID</a>  <a href="#rowlock">RowLock</a>
-  <a href="#genid">GenID</a> <a href="#createseq">CreateSequence</a> <a href="#dropseq">DropSequence</a> 
-  <br>
-  Error Handling: <a href="#errormsg">ErrorMsg</a> <a href="#errorno">ErrorNo</a> 
-  <a href="#metaerror">MetaError</a> <a href="#metaerrormsg">MetaErrorMsg</a> <a href="#ignoreerrors">IgnoreErrors</a><br>
-  Data Dictionary (metadata): <a href="#metadatabases">MetaDatabases</a> <a href="#metatables">MetaTables</a> 
-  <a href="#metacolumns">MetaColumns</a> <a href="#metacolumnames">MetaColumnNames</a> 
-  <a href="#metaprimarykeys">MetaPrimaryKeys</a> <a href="#metaforeignkeys">MetaForeignKeys</a> 
-  <a href="#serverinfo">ServerInfo</a> <br>
-  Statistics and Query-Rewriting: <a href="#logsql">LogSQL</a> <a href="#fnexecute">fnExecute 
-  and fnCacheExecute</a><br>
-  </font><font size="2">Deprecated: <a href="#bind">Bind</a> <a href="#blankrecordset">BlankRecordSet</a>
-  <a href="#parameter">Parameter</a></font>
-  <a href="#adorecordSet"><b><br>
-  ADORecordSet</b></a><br>
-  <font size="2">
-  Returns one field: <a href="#fields">Fields</a><br>
- Returns one row:<a href="#fetchrow">FetchRow</a> <a href="#fetchinto">FetchInto</a> 
-  <a href="#fetchobject">FetchObject</a> <a href="#fetchnextobject">FetchNextObject</a> 
-  <a href="#fetchobj">FetchObj</a> <a href="#fetchnextobj">FetchNextObj</a>
- <a href="#getrowassoc">GetRowAssoc</a> <br>
-  Returns all rows:<a href="#getarray">GetArray</a> <a href="#getrows">GetRows</a> 
-  <a href="#getassoc">GetAssoc</a><br>
-  Scrolling:<a href="#move">Move</a> <a href="#movenext">MoveNext</a> <a href="#movefirst">MoveFirst</a> 
-  <a href="#movelast">MoveLast</a> <a href="#abspos">AbsolutePosition</a> <a href="#currentrow">CurrentRow</a> 
-  <a href="#atfirstpage">AtFirstPage</a> <a href="#atlastpage">AtLastPage</a> 
-  <a href="#absolutepage">AbsolutePage</a> </font> <font size="2"><br>
-  Menu generation:<a href="#getmenu">GetMenu</a> <a href="#getmenu2">GetMenu2</a><br>
-  Dates:<a href="#userdate">UserDate</a> <a href="#usertimestamp">UserTimeStamp</a> 
-  <a href="#unixdate">UnixDate</a> <a href="#unixtimestamp">UnixTimeStamp<br>
-  </a>Recordset Info:<a href="#recordcount">RecordCount</a> <a href="#po_recordcount">PO_RecordCount</a> 
-  <a href="#nextrecordset">NextRecordSet</a><br>
-  Field Info:<a href="#fieldcount">FieldCount</a> <a href="#fetchfield">FetchField</a> 
-  <a href="#metatype">MetaType</a><br>
-  Cleanup: <a href="#rsclose">Close</a></font>  
-</p>
-<p><font size="2"><a href="#rs2html"><b>rs2html</b></a>&nbsp; <a href="#exrs2html">example</a></font><br>
-  <a href="#adodiff">Differences between ADOdb and ADO</a><br>
-  <a href="#driverguide"><b>Database Driver Guide<br>
-  </b></a><b><a href="#changes">Change Log</a></b><br>
-</p>
-<h2>Introduction<a name="intro"></a></h2>
-<p>PHP's database access functions are not standardised. This creates a need for 
-  a database class library to hide the differences between the different database 
-  API's (encapsulate the differences) so we can easily switch databases. PHP 4.0.5 or later
-  is now required (because we use array-based str_replace).</p>
-<p>We currently support MySQL, Oracle, Microsoft SQL Server, Sybase, Sybase SQL Anywhere, Informix, 
-  PostgreSQL, FrontBase,  SQLite, Interbase (Firebird and Borland variants), Foxpro, Access, ADO, DB2, SAP DB and ODBC. 
-  We have had successful reports of connecting to Progress and CacheLite via ODBC. We hope more people 
-  will contribute drivers to support other databases.</p>
-<p>PHP4 supports session variables. You can store your session information using 
-  ADOdb for true portability and scalability. See adodb-session.php for more information.</p>
-<p>Also read <a href="http://phplens.com/lens/adodb/tips_portable_sql.htm">tips_portable_sql.htm</a> 
- for tips on writing 
-  portable SQL.</p>
-<h2>Unique Features of ADOdb<a name="features"></a></h2>
-<ul>
-  <li><b>Easy for Windows programmers</b> to adapt to because many of the conventions 
-	are similar to Microsoft's ADO.</li>
-  <li>Unlike other PHP database classes which focus only on select statements, 
-	<b>we provide support code to handle inserts and updates which can be adapted 
-	to multiple databases quickly.</b> Methods are provided for date handling, 
-	string concatenation and string quoting characters for differing databases.</li>
-  <li>A<b> metatype system </b>is built in so that we can figure out that types 
-	such as CHAR, TEXT and STRING are equivalent in different databases.</li>
-  <li><b>Easy to port</b> because all the database dependant code are stored in 
-	stub functions. You do not need to port the core logic of the classes.</li>
-  <li><b>Portable table and index creation</b> with the <a href="docs-datadict.htm">datadict</a> classes.
-  </li><li><b>Database performance monitoring and SQL tuning</b> with the <a href="docs-perf.htm">performance monitoring</a> classes.
-  </li><li><b>Database-backed sessions</b> with the <a href="docs-session.htm">session management</a> classes. Supports session expiry notification.
-<li><b>Object-Relational Mapping</b> using <a href="docs-active-record.htm">ADOdb_Active_Record</a> classes.
-</li></ul>
-<h2>How People are using ADOdb<a name="users"></a></h2>
-Here are some examples of how people are using ADOdb (for a much longer list, 
-visit <a href="http://phplens.com/phpeverywhere/adodb-cool-apps">adodb-cool-apps</a>): 
-<ul>
-<li><a href="http://phplens.com/">PhpLens</a> is a commercial data grid
-component that allows both cool Web designers and serious unshaved
-programmers to develop and maintain databases on the Web easily.
-Developed by the author of ADOdb.<p>
-
-</p></li><li><a href="http://www.interakt.ro/phakt/">PHAkt: PHP Extension for DreamWeaver Ultradev</a> allows you to script PHP in the popular Web page editor. Database handling provided by ADOdb.<p>
-
-</p></li><li><a href="http://www.andrew.cmu.edu/%7Erdanyliw/snort/snortacid.html">Analysis Console for Intrusion Databases</a>
-(ACID): PHP-based analysis engine to search and process a database of
-security incidents generated by security-related software such as IDSes
-and firewalls (e.g. Snort, ipchains). By Roman Danyliw.<p>
-
-</p></li><li><a href="http://www.postnuke.com/">PostNuke</a> is a very
-popular free content management system and weblog system. It offers
-full CSS support, HTML 4.01 transitional compliance throughout, an
-advanced blocks system, and is fully multi-lingual enabled. <p>
-
-</p></li><li><a href="http://www.auto-net.no/easypublish.php?page=index&amp;lang_id=2">EasyPublish CMS</a>
-is another free content management system for managing information and
-integrated modules on your internet, intranet- and extranet-sites. From
-Norway.<p>
-
-</p></li><li><a href="http://nola.noguska.com/">NOLA</a> is a full featured accounting, inventory, and job tracking application. It is licensed under the GPL, and developed by Noguska.
-</li></ul><p>
-
-</p><h2>Feature Requests and Bug Reports<a name="bugs"></a></h2>
-<p>Feature requests and bug reports can be emailed to <a href="mailto:jlim#natsoft.com.my">jlim#natsoft.com.my</a> 
-  or posted to the ADOdb Help forums at <a href="http://phplens.com/lens/lensforum/topics.php?id=4">http://phplens.com/lens/lensforum/topics.php?id=4</a>.</p>
-<h2>Installation Guide<a name="install"></a></h2>
-<p>Make sure you are running PHP 4.0.5 or later. 
-  Unpack all the files into a directory accessible by your webserver.</p>
-<p>To test, try modifying some of the tutorial examples. Make sure you customize 
-  the connection settings correctly. You can debug using <i>$db-&gt;debug = true</i> as shown below:</p>
-<pre>&lt;?php<br>	include('adodb/adodb.inc.php');<br>	$db = <a href="#adonewconnection">ADONewConnection</a>($dbdriver); # eg 'mysql' or 'postgres'<br>	$db-&gt;debug = true;<br>	$db-&gt;<a href="#connect">Connect</a>($server, $user, $password, $database);<br>	$rs = $db-&gt;<a href="#execute">Execute</a>('select * from some_small_table');<br>	print "&lt;pre&gt;";<br>	print_r($rs-&gt;<a href="#getrows">GetRows</a>());<br>	print "&lt;/pre&gt;";<br>?&gt;</pre>
-
- <h3>Minimum Install<a name="mininstall"></a></h3>
-<p>For developers who want to release a minimal install of ADOdb, you will need:
-</p><ul>
-<li>adodb.inc.php
-</li><li>adodb-lib.inc.php
-</li><li>adodb-time.inc.php
-</li><li>drivers/adodb-$database.inc.php
-</li><li>license.txt (for legal reasons)
-</li><li>adodb-php4.inc.php 
-</li><li>adodb-iterator.inc.php  (php5 functionality)
-</li></ul>
-Optional:
+
+<p>V5.06 16 Oct 2008 (c) 2000-2009 John Lim (jlim#natsoft.com)</p>
+
+<p><span style='font-size:7.5pt'>This software is dual licensed using BSD-Style
+and LGPL. This means you can use it in compiled proprietary and commercial
+products.</span></p>
+
+<p>Useful ADOdb links: <a href="http://adodb.sourceforge.net/#download">Download</a>
+&nbsp; <a href="http://adodb.sourceforge.net/#docs">Other Docs</a> </p>
+
+<p><a href="#intro"><b>Introduction</b></a><b><br>
+<a href="#features">Unique Features</a><br>
+<a href="#users">How People are using ADOdb</a><br>
+<a href="#bugs">Feature Requests and Bug Reports</a><br>
+<a href="#install">Installation</a><br>
+<a href="#mininstall">Minimum Install</a><br>
+<a href="#coding">Initializing Code and Connectioning to Databases</a><br>
+</b><span style='font-size:10.0pt'>&nbsp; <a href="#dsnsupport">Data Source
+Name (DSN) Support</a></span> &nbsp; <a href="#connect_ex">Connection Examples</a>
+<br>
+<b><a href="#speed">High Speed ADOdb - tuning tips</a></b><br>
+<b><a href="#hack">Hacking and Modifying ADOdb Safely</a><br>
+<a href="#php5">PHP5 Features</a></b><br>
+<span style='font-size:10.0pt'><a href="#php5iterators">foreach iterators</a> <a
+href="#php5exceptions">exceptions</a></span><br>
+<b><a href="#drivers">Supported Databases</a></b><br>
+<b><a href="#quickstart">Tutorials</a></b><br>
+<a href="#ex1">Example 1: Select</a><br>
+<a href="#ex2">Example 2: Advanced Select</a><br>
+<a href="#ex3">Example 3: Insert</a><br>
+<a href="#ex4">Example 4: Debugging</a> &nbsp;<a href="#exrs2html">rs2html
+example</a><br>
+<a href="#ex5">Example 5: MySQL and Menus</a><br>
+<a href="#ex6">Example 6: Connecting to Multiple Databases at once</a> <br>
+<a href="#ex7">Example 7: Generating Update and Insert SQL</a> <br>
+<a href="#ex8">Example 8: Implementing Scrolling with Next and Previous</a><br>
+<a href="#ex9">Example 9: Exporting in CSV or Tab-Delimited Format</a> <br>
+<a href="#ex10">Example 10: Custom filters</a><br>
+<a href="#ex11">Example 11: Smart Transactions</a><br>
+<br>
+<b><a href="#errorhandling">Using Custom Error Handlers and PEAR_Error</a><br>
+<a href="#DSN">Data Source Names</a><br>
+<a href="#caching">Caching</a></b><br>
+&nbsp; &nbsp; <a href="#memcache">MemCache</a><br>
+&nbsp; &nbsp; <a href="#cacheapi">Caching API</a><br>
+<b><a href="#pivot">Pivot Tables</a></b> </p>
+
+<p><a href="#ref"><b>REFERENCE</b></a> </p>
+
+<p><span style='font-size:10.0pt'>Variables: <a href="#adodb_countrecs">$ADODB_COUNTRECS</a>
+<a href="#adodb_ansi_padding_off">$ADODB_ANSI_PADDING_OFF</a> <a
+href="#adodb_cache_dir">$ADODB_CACHE_DIR</a> <br>
+&nbsp; &nbsp; &nbsp; &nbsp; <a href="#force_type">$ADODB_FORCE_TYPE</a> <a
+href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a> <a href="#adodb_lang">$ADODB_LANG</a>
+<a href="#adodb_auto_quote">ADODB_QUOTE_FIELDNAMES</a> <br>
+Constants: <a href="#adodb_assoc_case">ADODB_ASSOC_CASE</a> </span><br>
+<a href="#ADOConnection"><b>ADOConnection</b></a><br>
+<span style='font-size:10.0pt'>Connections: <a href="#connect">Connect</a> <a
+href="#pconnect">PConnect</a> <a href="#nconnect">NConnect</a> <a
+href="#isconnected">IsConnected</a><br>
+Executing SQL: <a href="#execute">Execute</a> <a href="#cacheexecute"><i>CacheExecute</i></a>
+<a href="#selectlimit">SelectLimit</a> <a href="#cacheSelectLimit"><i>CacheSelectLimit</i></a>
+<a href="#param">Param</a> <a href="#prepare">Prepare</a> <a href="#preparesp">PrepareSP</a>
+<a href="#inparameter">InParameter</a> <a href="#outparameter">OutParameter</a>
+<a href="#autoexecute">AutoExecute</a> <br>
+&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a
+href="#getone">GetOne</a> <a href="#cachegetone"><i>CacheGetOne</i></a> <a
+href="#getrow">GetRow</a> <a href="#cachegetrow"><i>CacheGetRow</i></a> <a
+href="#getall">GetAll</a> <a href="#cachegetall"><i>CacheGetAll</i></a> <a
+href="#getcol">GetCol</a> <a href="#cachegetcol"><i>CacheGetCol</i></a> <a
+href="#getassoc1">GetAssoc</a> <a href="#cachegetassoc"><i>CacheGetAssoc</i></a>
+<a href="#replace">Replace</a> <a href="#getmedian">GetMedian</a> <br>
+&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a
+href="#executecursor">ExecuteCursor</a> (oci8 only)<br>
+Generates SQL strings: <a href="#getupdatesql">GetUpdateSQL</a> <a
+href="#getinsertsql">GetInsertSQL</a> <a href="#concat">Concat</a> <a
+href="#ifnull">IfNull</a> <a href="#length">length</a> <a href="#random">random</a>
+<a href="#substr">substr</a> <a href="#qstr">qstr</a> <a href="#param">Param</a>
+<a href="#OffsetDate">OffsetDate</a> <a href="#sqldate">SQLDate</a> <a
+href="#dbdate">DBDate</a> <a href="#dbtimestamp">DBTimeStamp</a> <a
+href="#binddate">BindDate</a> <a href="#bindtimestamp">BindTimeStamp</a> <br>
+Blobs: <a href="#updateblob">UpdateBlob</a> <a href="#updateclob">UpdateClob</a>
+<a href="#updateblobfile">UpdateBlobFile</a> <a href="#blobencode">BlobEncode</a>
+<a href="#blobdecode">BlobDecode</a><br>
+Paging/Scrolling: <a href="#pageexecute">PageExecute</a> <a
+href="#cachepageexecute">CachePageExecute</a><br>
+Cleanup: <a href="#cacheflush">CacheFlush</a> <a href="#Close">Close</a><br>
+Transactions: <a href="#starttrans">StartTrans</a> <a href="#completetrans">CompleteTrans</a>
+<a href="#failtrans">FailTrans</a> <a href="#hasfailedtrans">HasFailedTrans</a>
+<a href="#begintrans">BeginTrans</a> <a href="#committrans">CommitTrans</a> <a
+href="#rollbacktrans">RollbackTrans</a> <a href="#SetTransactionMode">SetTransactionMode</a><br>
+Fetching Data: <a href="#setfetchmode">SetFetchMode</a><br>
+Strings: <a href="#concat">concat</a> <a href="#length">length</a> <a
+href="#qstr">qstr</a> <a href="#quote">quote</a> <a href="#substr">substr</a><br>
+Dates: <a href="#dbdate">DBDate</a> <a href="#dbtimestamp">DBTimeStamp</a> <a
+href="#unixdate">UnixDate</a> <a href="#binddate">BindDate</a> <a
+href="#bindtimestamp">BindTimeStamp</a> <a href="#unixtimestamp">UnixTimeStamp</a>
+<a href="#OffsetDate">OffsetDate</a> <a href="#SQLDate">SQLDate</a> <br>
+Row Management: <a href="#affected_rows">Affected_Rows</a> <a
+href="#inserted_id">Insert_ID</a> <a href="#rowlock">RowLock</a> <a
+href="#genid">GenID</a> <a href="#createseq">CreateSequence</a> <a
+href="#dropseq">DropSequence</a> <br>
+Error Handling: <a href="#errormsg">ErrorMsg</a> <a href="#errorno">ErrorNo</a>
+<a href="#metaerror">MetaError</a> <a href="#metaerrormsg">MetaErrorMsg</a> <a
+href="#ignoreerrors">IgnoreErrors</a><br>
+Data Dictionary (metadata): <a href="#metadatabases">MetaDatabases</a> <a
+href="#metatables">MetaTables</a> <a href="#metacolumns">MetaColumns</a> <a
+href="#metacolumnames">MetaColumnNames</a> <a href="#metaprimarykeys">MetaPrimaryKeys</a>
+<a href="#metaforeignkeys">MetaForeignKeys</a> <a href="#serverinfo">ServerInfo</a>
+<br>
+Statistics and Query-Rewriting: <a href="#logsql">LogSQL</a> <a
+href="#fnexecute">fnExecute and fnCacheExecute</a><br>
+Deprecated: <a href="#bind">Bind</a> <a href="#blankrecordset">BlankRecordSet</a>
+<a href="#parameter">Parameter</a></span> <a href="#adorecordSet"><b><br>
+ADORecordSet</b></a><br>
+<span style='font-size:10.0pt'>Returns one field: <a href="#fields">Fields</a><br>
+Returns one row:<a href="#fetchrow">FetchRow</a> <a href="#fetchinto">FetchInto</a>
+<a href="#fetchobject">FetchObject</a> <a href="#fetchnextobject">FetchNextObject</a>
+<a href="#fetchobj">FetchObj</a> <a href="#fetchnextobj">FetchNextObj</a> <a
+href="#getrowassoc">GetRowAssoc</a> <br>
+Returns all rows:<a href="#getarray">GetArray</a> <a href="#getrows">GetRows</a>
+<a href="#getassoc">GetAssoc</a><br>
+Scrolling:<a href="#move">Move</a> <a href="#movenext">MoveNext</a> <a
+href="#movefirst">MoveFirst</a> <a href="#movelast">MoveLast</a> <a
+href="#abspos">AbsolutePosition</a> <a href="#currentrow">CurrentRow</a> <a
+href="#atfirstpage">AtFirstPage</a> <a href="#atlastpage">AtLastPage</a> <a
+href="#absolutepage">AbsolutePage</a> <br>
+Menu generation:<a href="#getmenu">GetMenu</a> <a href="#getmenu2">GetMenu2</a><br>
+Dates:<a href="#userdate">UserDate</a> <a href="#usertimestamp">UserTimeStamp</a>
+<a href="#unixdate">UnixDate</a> <a href="#unixtimestamp">UnixTimeStamp<br>
+</a>Recordset Info:<a href="#recordcount">RecordCount</a> <a
+href="#po_recordcount">PO_RecordCount</a> <a href="#nextrecordset">NextRecordSet</a><br>
+Field Info:<a href="#fieldcount">FieldCount</a> <a href="#fetchfield">FetchField</a>
+<a href="#metatype">MetaType</a><br>
+Cleanup: <a href="#rsclose">Close</a></span> </p>
+
+<p><span style='font-size:10.0pt'><a href="#rs2html"><b>rs2html</b></a>&nbsp; <a
+href="#exrs2html">example</a></span><br>
+<a href="#adodiff">Differences between ADOdb and ADO</a><br>
+<a href="#driverguide"><b>Database Driver Guide<br>
+</b></a><b><a href="#changes">Change Log</a></b></p>
+
+<h2>Introduction<a name=intro></a></h2>
+
+<p>PHP's database access functions are not standardised. This creates a need
+for a database class library to hide the differences between the different
+database API's (encapsulate the differences) so we can easily switch databases.
+PHP 4.0.5 or later is now required (because we use array-based str_replace).</p>
+
+<p>We currently support MySQL, Oracle, Microsoft SQL Server, Sybase, Sybase SQL
+Anywhere, Informix, PostgreSQL, FrontBase, SQLite, Interbase (Firebird and
+Borland variants), Foxpro, Access, <st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>,
+DB2, SAP DB and ODBC. We have had successful reports of connecting to Progress
+and CacheLite via ODBC. We hope more people will contribute drivers to support
+other databases.</p>
+
+<p>PHP4 supports session variables. You can store your session information
+using ADOdb for true portability and scalability. See adodb-session.php for
+more information.</p>
+
+<p>Also read <a href="http://phplens.com/lens/adodb/tips_portable_sql.htm">tips_portable_sql.htm</a>
+for tips on writing portable SQL.</p>
+
+<h2>Unique Features of ADOdb<a name=features></a></h2>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><b>Easy for Windows
+     programmers</b> to adapt to because many of the conventions are similar to
+     Microsoft's <st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'>Unlike other PHP database
+     classes which focus only on select statements, <b>we provide support code
+     to handle inserts and updates which can be adapted to multiple databases
+     quickly.</b> Methods are provided for date handling, string concatenation
+     and string quoting characters for differing databases.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'>A<b> metatype system </b>is
+     built in so that we can figure out that types such as CHAR, TEXT and
+     STRING are equivalent in different databases.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><b>Easy to port</b> because
+     all the database dependant code are stored in stub functions. You do not
+     need to port the core logic of the classes.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><b>Portable table and index
+     creation</b> with the <a href="docs-datadict.htm">datadict</a> classes. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><b>Database performance
+     monitoring and SQL tuning</b> with the <a href="docs-perf.htm">performance
+     monitoring</a> classes. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><b>Database-backed sessions</b>
+     with the <a href="docs-session.htm">session management</a> classes.
+     Supports session expiry notification. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><b>Object-Relational
+     Mapping</b> using <a href="docs-active-record.htm">ADOdb_Active_Record</a>
+     classes. </li>
+</ul>
+
+<h2>How People are using ADOdb<a name=users></a></h2>
+
+<p class=MsoNormal>Here are some examples of how people are using ADOdb (for a
+much longer list, visit <a
+href="http://phplens.com/phpeverywhere/adodb-cool-apps">adodb-cool-apps</a>): </p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l4 level1 lfo2;tab-stops:list 36.0pt'><a
+     href="http://phplens.com/">PhpLens</a> is a commercial data grid component
+     that allows both cool Web designers and serious unshaved programmers to
+     develop and maintain databases on the Web easily. Developed by the author
+     of ADOdb.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l4 level1 lfo2;tab-stops:list 36.0pt'><a
+     href="http://www.interakt.ro/phakt/">PHAkt: PHP Extension for DreamWeaver
+     Ultradev</a> allows you to script PHP in the popular Web page editor.
+     Database handling provided by ADOdb.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l4 level1 lfo2;tab-stops:list 36.0pt'><a
+     href="http://www.andrew.cmu.edu/%7Erdanyliw/snort/snortacid.html">Analysis
+     Console for Intrusion Databases</a> (ACID): PHP-based analysis engine to
+     search and process a database of security incidents generated by
+     security-related software such as IDSes and firewalls (e.g. Snort,
+     ipchains). By Roman Danyliw.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l4 level1 lfo2;tab-stops:list 36.0pt'><a
+     href="http://www.postnuke.com/">PostNuke</a> is a very popular free
+     content management system and weblog system. It offers full CSS support,
+     HTML 4.01 transitional compliance throughout, an advanced blocks system,
+     and is fully multi-lingual enabled. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l4 level1 lfo2;tab-stops:list 36.0pt'><a
+     href="http://www.auto-net.no/easypublish.php?page=index&amp;lang_id=2">EasyPublish
+     CMS</a> is another free content management system for managing information
+     and integrated modules on your internet, intranet- and extranet-sites.
+     From <st1:country-region w:st="on"><st1:place w:st="on">Norway</st1:place></st1:country-region>.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l4 level1 lfo2;tab-stops:list 36.0pt'><a
+     href="http://nola.noguska.com/">NOLA</a> is a full featured accounting,
+     inventory, and job tracking application. It is licensed under the GPL, and
+     developed by Noguska. </li>
+</ul>
+
+<h2>Feature Requests and Bug Reports<a name=bugs></a></h2>
+
+<p>Feature requests and bug reports can be emailed to <a
+href="mailto:jlim#natsoft.com">jlim#natsoft.com</a> or posted to the ADOdb Help
+forums at <a href="http://phplens.com/lens/lensforum/topics.php?id=4">http://phplens.com/lens/lensforum/topics.php?id=4</a>.</p>
+
+<h2>Installation Guide<a name=install></a></h2>
+
+<p>Make sure you are running PHP 4.0.5 or later. Unpack all the files into a
+directory accessible by your webserver.</p>
+
+<p>To test, try modifying some of the tutorial examples. Make sure you
+customize the connection settings correctly. You can debug using <i>$db-&gt;debug
+= true</i> as shown below:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>&lt;?php<br>
+<span style='mso-tab-count:1'> </span>include('adodb/adodb.inc.php');<br>
+<span style='mso-tab-count:1'> </span>$db = <a href="#adonewconnection">ADONewConnection</a>($dbdriver); # eg 'mysql' or 'postgres'<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;debug = true;<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;<a href="#connect">Connect</a>($server, $user, $password, $database);<br>
+<span style='mso-tab-count:1'> </span>$rs = $db-&gt;<a href="#execute">Execute</a>('select * from some_small_table');<br>
+<span style='mso-tab-count:1'> </span>print &quot;&lt;pre&gt;&quot;;<br>
+<span style='mso-tab-count:1'> </span>print_r($rs-&gt;<a href="#getrows">GetRows</a>());<br>
+<span style='mso-tab-count:1'> </span>print &quot;&lt;/pre&gt;&quot;;<br>
+?&gt;</pre></div>
+
+<h3>Minimum Install<a name=mininstall></a></h3>
+
+<p>For developers who want to release a minimal install of ADOdb, you will
+need: </p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l9 level1 lfo3;tab-stops:list 36.0pt'>adodb.inc.php </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l9 level1 lfo3;tab-stops:list 36.0pt'>adodb-lib.inc.php </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l9 level1 lfo3;tab-stops:list 36.0pt'>adodb-time.inc.php </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l9 level1 lfo3;tab-stops:list 36.0pt'>drivers/adodb-$database.inc.php
+     </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l9 level1 lfo3;tab-stops:list 36.0pt'>license.txt (for legal
+     reasons) </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l9 level1 lfo3;tab-stops:list 36.0pt'>adodb-php4.inc.php </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l9 level1 lfo3;tab-stops:list 36.0pt'>adodb-iterator.inc.php
+     (php5 functionality) </li>
+</ul>
+
+<p class=MsoNormal>Optional: </p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l3 level1 lfo4;tab-stops:list 36.0pt'>adodb-error.inc.php and
+     lang/adodb-$lang.inc.php (if you use MetaError()) </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l3 level1 lfo4;tab-stops:list 36.0pt'>adodb-csvlib.inc.php (if
+     you use cached recordsets - CacheExecute(), etc) </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l3 level1 lfo4;tab-stops:list 36.0pt'>adodb-exceptions.inc.php
+     and adodb-errorhandler.inc.php (if you use adodb error handler or php5
+     exceptions). </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l3 level1 lfo4;tab-stops:list 36.0pt'>adodb-active-record.inc.php
+     if you use <a href="docs-active-record.htm">Active Records</a>. </li>
+</ul>
+
+<h3>Code Initialization Examples<a name=coding></a></h3>
+
+<p>When running ADOdb, at least two files are loaded. First is
+adodb/adodb.inc.php, which contains all functions used by all database classes.
+The code specific to a particular database is in the
+adodb/driver/adodb-????.inc.php file.</p>
+
+<p><a name=adonewconnection></a>For example, to connect to a mysql database:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>include('/path/to/set/here/adodb.inc.php');<br>
+$conn = &amp;ADONewConnection('mysql');</pre></div>
+
+<p>Whenever you need to connect to a database, you create a Connection object
+using the <b>ADONewConnection</b>($driver) function. <b>NewADOConnection</b>($driver)
+is an alternative name for the same function.</p>
+
+<p>At this point, you are not connected to the database (no longer true if you
+pass in a <a href="#dsnsupport">dsn</a>). You will first need to decide whether
+to use <i>persistent</i> or <i>non-persistent</i> connections. The advantage of
+<i>persistent</i> connections is that they are faster, as the database
+connection is never closed (even when you call Close()). <i>Non-persistent </i>connections
+take up much fewer resources though, reducing the risk of your database and
+your web-server becoming overloaded. </p>
+
+<p>For persistent connections, use $conn-&gt;<a href="#pconnect">PConnect()</a>,
+or $conn-&gt;<a href="#connect">Connect()</a> for non-persistent connections.
+Some database drivers also support <a href="#nconnect">NConnect()</a>, which
+forces the creation of a new connection. <a name="connection_gotcha"></a></p>
+
+<p><b>Connection Gotcha</b>: If you create two connections, but both use the
+same userid and password, PHP will share the same connection. This can cause
+problems if the connections are meant to different databases. The solution is
+to always use different userid's for different databases, or use NConnect(). <a
+name=dsnsupport></a></p>
+
+<h3>Data Source Name (DSN) Support</h3>
+
+<p>Since ADOdb 4.51, you can connect to a database by passing a dsn to
+NewADOConnection() (or ADONewConnection, which is the same function). The dsn
+format is: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$driver://$username:$password@hostname/$database?options[=value]</pre></div>
+
+<p>NewADOConnection() calls Connect() or PConnect() internally for you. If the
+connection fails, false is returned. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:1'> </span><span style='color:green'># non-persistent connection</span></pre><pre><span
+style='mso-tab-count:1'> </span>$dsn = 'mysql://root:pwd@localhost/mydb'; </pre><pre><span
+style='mso-tab-count:1'> </span>$db = NewADOConnection($dsn);</pre><pre><span
+style='mso-tab-count:1'> </span>if (!$db) die(&quot;Connection failed&quot;);<span style='mso-spacerun:yes'> </span></pre><pre><span
+style='mso-tab-count:1'> </span></pre><pre><span style='mso-tab-count:
+1'> </span><span style='color:green'># no need to call connect/pconnect!</span></pre><pre><span
+style='mso-tab-count:1'> </span>$arr = $db-&gt;GetArray(&quot;select * from table&quot;);</pre><pre><span
+style='mso-tab-count:1'> </span></pre><pre><span style='mso-tab-count:
+1'> </span><span style='color:green'># persistent connection</span></pre>
+<pre><span
+style='mso-tab-count:1'> </span>$dsn2 = 'mysql://root:pwd@localhost/mydb?persist'; 
+<span
+style='mso-tab-count:1'></span></pre>
+<pre><span style='mso-tab-count:
+1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='color:green'># non-persistent connection on port 3000</span></pre>
+<pre><span
+style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$dsn2 = 'mysqli://root:pwd@localhost/mydb?persist=0&amp;port=3000';</pre>
+</div>
+
+<p>If you have special characters such as /:?_ in your dsn, then you need to
+rawurlencode them first: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:1'> </span>$pwd = rawurlencode($pwd);<br>
+<span style='mso-tab-count:1'> </span>$dsn = &quot;mysql://root:$pwd@localhost/mydb&quot;;</pre><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$dsn2=rawurlencode(&quot;sybase_ase&quot;).&quot;://user:pass@host/path?query&quot;;</pre></div>
+
+<p>Legal options are: </p>
+
+<div align=center>
+
+<table class=MsoNormalTable border=1 cellpadding=0 style='mso-cellspacing:1.5pt'>
+ <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>For all drivers</p>
+  </td>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>'persist', 'persistent', 'debug', 'fetchmode', 'new' , 'cachesecs', 'memcache'</p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:1'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>Interbase/Firebird </p>
+  </td>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>'dialect','charset','buffers','role' </p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:2'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>M'soft <st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City></p>
+  </td>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>'charpage' </p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:3'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>MySQL</p>
+  </td>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>'clientflags' </p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:4'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>MySQLi</p>
+  </td>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>'port', 'socket', 'clientflags' </p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>Oci8</p>
+  </td>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>'nls_date_format','charset' </p>
+  </td>
+ </tr>
+</table>
+
+</div>
+
+<p>For all drivers, when the options <i>persist</i> or <i>persistent</i> are
+set, a persistent connection is forced; similarly, when <i>new</i> is set, then
+a new connection will be created using NConnect if the underlying driver
+supports it. The <i>debug</i> option enables debugging. The <i>fetchmode</i>
+calls <a href="#setfetchmode">SetFetchMode()</a>. If no value is defined for an
+option, then the value is set to 1. </p>
+
+<p>Since ADOdb 5.09, we added 2 new parameters:</p>
 <ul>
-<li>adodb-error.inc.php and lang/adodb-$lang.inc.php (if you use MetaError())
-</li><li>adodb-csvlib.inc.php (if you use cached recordsets - CacheExecute(), etc)
-</li><li>adodb-exceptions.inc.php and adodb-errorhandler.inc.php (if you use adodb error handler or php5 exceptions).
-<li>adodb-active-record.inc.php if you use <a href=docs-active-record.htm>Active Records</a>.
-</li></ul>
-
-<h3>Code Initialization Examples<a name="coding"></a></h3>
-<p>When running ADOdb, at least two files are loaded. First is adodb/adodb.inc.php, 
- which contains all functions used by all database classes. The code specific 
- to a particular database is in the adodb/driver/adodb-????.inc.php file.</p>
- <a name="adonewconnection"></a>
-<p>For example, to connect to a mysql database:</p>
-<pre>include('/path/to/set/here/adodb.inc.php');<br>$conn =ADONewConnection('mysql');<br></pre>
-<p>Whenever you need to connect to a database, you create a Connection object 
-  using the <b>ADONewConnection</b>($driver) function. 
-  <b>NewADOConnection</b>($driver) is an alternative name for the same function.</p>
-
-<p>At this point, you are not connected to the database (no longer true if you pass in a <a href="#dsnsupport">dsn</a>). You will first need to decide
-whether to use <i>persistent</i> or <i>non-persistent</i> connections. The advantage of <i>persistent</i>
-connections is that they are faster, as the database connection is never closed (even 
-when you call Close()). <i>Non-persistent </i>connections take up much fewer resources though,
-reducing the risk of your database and your web-server becoming overloaded. 
-</p><p>For persistent connections,
-use $conn-&gt;<a href="#pconnect">PConnect()</a>,
- or $conn-&gt;<a href="#connect">Connect()</a> for non-persistent connections.
-Some database drivers also support <a href="#nconnect">NConnect()</a>, which forces 
-the creation of a new connection. 
-
-<a name="connection_gotcha"></a>
-</p><p><b>Connection Gotcha</b>:  If you create two connections, but both use the same userid and password,
-PHP will share the same connection. This can cause problems if the connections are meant to 
-different databases. The solution is to always use different userid's for different databases,
- or use NConnect().
-
- <a name="dsnsupport"></a>
- </p><h3>Data Source Name (DSN) Support</h3>
- <p> Since ADOdb 4.51, you can connect to a database by passing a dsn to NewADOConnection() (or ADONewConnection, which is
- the same function). The dsn format is:
-</p><pre>	$driver://$username:$password@hostname/$database?options[=value]<br></pre><p>
-NewADOConnection() calls Connect() or PConnect() internally for you. If the connection fails, false is returned.
-</p><pre>	<font color="#008000"># non-persistent connection</font>
-	$dsn = 'mysql://root:pwd@localhost/mydb'; 
-	$db = NewADOConnection($dsn);
-	if (!$db) die("Connection failed");   
-	
-	<font color="#008000"># no need to call connect/pconnect!</font>
-	$arr = $db-&gt;GetArray("select * from table");
-	
-	<font color="#008000"># persistent connection</font>
-	$dsn2 = 'mysql://root:pwd@localhost/mydb?persist'; 
-</pre>
-<p>
-If you have special characters such as /:?_ in your dsn, then you need to rawurlencode them first:
-</p><pre>	$pwd = rawurlencode($pwd);<br>	$dsn = "mysql://root:$pwd@localhost/mydb";
-	$dsn2=rawurlencode("sybase_ase")."://user:pass@host/path?query";<br></pre>
-<p>
-Legal options are:
-</p><p>
-<table align="center" border="1"><tbody><tr><td>For all drivers</td><td>
-	'persist', 'persistent', 'debug', 'fetchmode', 'new'
-	</td></tr><tr><td>Interbase/Firebird
-	</td><td>
-					 'dialect','charset','buffers','role'
-	</td></tr><tr><td>M'soft ADO</td><td>
-					 'charpage'
-					
-		</td></tr><tr><td>MySQL</td><td>
-					'clientflags'
-</td></tr><tr><td>MySQLi</td><td>
-	'port', 'socket', 'clientflags'
-</td></tr><tr><td>Oci8</td><td>
- 'nls_date_format','charset'
-</td></tr></tbody></table>
-</p><p>
-For all drivers, when the options <i>persist</i> or <i>persistent</i> are set,  a persistent connection is forced; similarly, when <i>new</i> is set, then
-a new connection will be created using NConnect if the underlying driver supports it. 
-The <i>debug</i> option enables debugging. The <i>fetchmode</i> calls <a href="#setfetchmode">SetFetchMode()</a>.
-If no value is defined for an option, then the value is set to 1.
-</p><p>
-ADOdb DSN's are compatible with version 1.0 of PEAR DB's DSN format.
-<a name="connect_ex">
-</a></p><h3><a name="connect_ex">Examples of Connecting to Databases</a></h3>
-<h4><a name="connect_ex">MySQL and Most Other Database Drivers</a></h4>
-<p><a name="connect_ex">MySQL connections are very straightforward, and the parameters are identical 
-  to mysql_connect:</a></p>
-<pre><a name="connect_ex">	$conn =ADONewConnection('mysql'); <br>	$conn-&gt;PConnect('localhost','userid','password','database');<br>	<br>	<font color="#008000"># or dsn </font>
-	$dsn = 'mysql://user:pwd@localhost/mydb'; 
-	$conn = ADONewConnection($dsn);  # no need for Connect()
+<li class=MsoNormal><i>cachesecs</i> which globally determines how many seconds to cache recordsets (default is 3600 secs if not defined) when
+CacheExecute() and CacheSelectLimit() are called and no cache-time parameter is passed into these functions.
+<li class=MsoNormal><i>memcache</i> which defines the memcache host, port and whether to use compression. For example:
+<pre>
+	# we have a memcache server at 10.1.1.22 using default port 11211, no compression
+	$dsn = 'mysql://user:pwd@localhost/mydb?memcache=10.1.1.22'; 
 	
-	<font color="#008000"># or persistent dsn</font>
-	$dsn = 'mysql://user:pwd@localhost/mydb?persist'; 
-	$conn = ADONewConnection($dsn);  # no need for PConnect()
+	# we have a memcache server 10.1.1.22 port 8888, compression=on
+	$dsn = 'mysql://user:pwd@localhost/mydb?memcache=10.1.1.22:8888:1';
+	 	
+	# we have a memcache servers mem1,mem2 on port 8888, compression=off
+	$dsn = 'mysql://user:pwd@localhost/mydb?memcache=mem1,mem2:8888:0'; 
 	
-	<font color="#008000"># a more complex example:</font>
-	$pwd = urlencode($pwd);
-	$flags =  MYSQL_CLIENT_COMPRESS;
-	$dsn = "mysql://user:$pwd@localhost/mydb?persist&amp;clientflags=$flags";
-	$conn = ADONewConnection($dsn);  # no need for PConnect()
- </a></pre>
-<p><a name="connect_ex"> For most drivers, you can use the standard function: Connect($server, $user, $password, $database), or
-a </a><a href="dsnsupport">DSN</a> since ADOdb 4.51. Exceptions to this are listed below.
-</p>
-<a name=pdo>
-<h4>PDO</h4>
-<p>PDO, which only works with PHP5, accepts a driver specific connection string:
-<pre>
-	$conn = NewADOConnection('pdo');
-	$conn->Connect('mysql:host=localhost',$user,$pwd,$mydb);
-	$conn->Connect('mysql:host=localhost;dbname=mydb',$user,$pwd);
-	$conn->Connect("mysql:host=localhost;dbname=mydb;username=$user;password=$pwd");
-</pre>
-<p>The DSN mechanism is also supported:
-<pre>
-	$conn = NewADOConnection("pdo_mysql://user:pwd@localhost/mydb?persist"); # persist is optional
+	# we have a memcache servers mem1,mem2 on port 8888, compression=off and cachesecs=120
+	$dsn = 'mysql://user:pwd@localhost/mydb?memcache=mem1,mem2:8888:0&cachesecs=120';
 </pre>
-<h4>PostgreSQL</h4>
-<p>PostgreSQL 7 and 8 accepts connections using: </p>
-<p>a. the standard connection string:</p>
-<pre>	$conn = ADONewConnection('postgres');  <br>	$conn-&gt;PConnect('host=localhost port=5432 dbname=mary');</pre>
-<p> b. the classical 4 parameters:</p>
- <pre>	$conn-&gt;PConnect('localhost','userid','password','database');<br> </pre>
-<p>c. dsn:
-</p><pre>	$dsn = 'postgres://user:pwd@localhost/mydb?persist';  # persist is optional
-	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect<br></pre>
-<a name="ldap"></a>
-
- <h4>LDAP</h4>
-  <p>Here is an example of querying a LDAP server. Thanks to Josh Eldridge for the driver and this example:
-</p><pre>
-require('/path/to/adodb.inc.php');
-
-/* Make sure to set this BEFORE calling Connect() */
-$LDAP_CONNECT_OPTIONS = Array(
-	Array ("OPTION_NAME"=>LDAP_OPT_DEREF, "OPTION_VALUE"=>2),
-	Array ("OPTION_NAME"=>LDAP_OPT_SIZELIMIT,"OPTION_VALUE"=>100),
-	Array ("OPTION_NAME"=>LDAP_OPT_TIMELIMIT,"OPTION_VALUE"=>30),
-	Array ("OPTION_NAME"=>LDAP_OPT_PROTOCOL_VERSION,"OPTION_VALUE"=>3),
-	Array ("OPTION_NAME"=>LDAP_OPT_ERROR_NUMBER,"OPTION_VALUE"=>13),
-	Array ("OPTION_NAME"=>LDAP_OPT_REFERRALS,"OPTION_VALUE"=>FALSE),
-	Array ("OPTION_NAME"=>LDAP_OPT_RESTART,"OPTION_VALUE"=>FALSE)
-);
-$host = 'ldap.baylor.edu';
-$ldapbase = 'ou=People,o=Baylor University,c=US';
-
-$ldap = NewADOConnection( 'ldap' );
-$ldap->Connect( $host, $user_name='', $password='', $ldapbase );
-
-echo "&lt;pre>";
-
-print_r( $ldap->ServerInfo() );
-$ldap->SetFetchMode(ADODB_FETCH_ASSOC);
-$userName = 'eldridge';
-$filter="(|(CN=$userName*)(sn=$userName*)(givenname=$userName*)(uid=$userName*))";
-
-$rs = $ldap->Execute( $filter );
-if ($rs)
-	while ($arr = $rs->FetchRow()) {
-	     print_r($arr);	
-	}
-
-$rs = $ldap->Execute( $filter );
-if ($rs) 
-	while (!$rs->EOF) {
- 		print_r($rs->fields);	
-		$rs->MoveNext();
-	} 
-	
-print_r( $ldap->GetArray( $filter ) );
-print_r( $ldap->GetRow( $filter ) );
+</ul>
+
+<p>ADOdb DSN's are compatible with version 1.0 of PEAR DB's DSN format. <a
+name="connect_ex"></a></p>
+
+<h3><span style='mso-bookmark:connect_ex'>Examples of Connecting to Databases</span></h3>
+
+<h4><span style='mso-bookmark:connect_ex'>MySQL and Most Other Database Drivers</span></h4>
+
+<p><span style='mso-bookmark:connect_ex'>MySQL connections are very
+straightforward, and the parameters are identical to mysql_connect:</span></p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$conn = &amp;ADONewConnection('mysql'); <br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;PConnect('localhost','userid','password','database');<br>
+<span style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span></span><span style='mso-bookmark:
+connect_ex'><span style='color:green'># or dsn </span></span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$dsn = 'mysql://user:pwd@localhost/mydb'; </span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);<span style='mso-spacerun:yes'> </span># no need for Connect()</span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span></span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span></span><span
+style='mso-bookmark:connect_ex'><span style='color:green'># or persistent dsn</span></span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$dsn = 'mysql://user:pwd@localhost/mydb?persist'; </span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);<span style='mso-spacerun:yes'> </span># no need for PConnect()</span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span></span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span></span><span
+style='mso-bookmark:connect_ex'><span style='color:green'># a more complex example:</span></span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$pwd = urlencode($pwd);</span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$flags =<span style='mso-spacerun:yes'> </span>MYSQL_CLIENT_COMPRESS;</span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$dsn = &quot;mysql://user:$pwd@localhost/mydb?persist&amp;clientflags=$flags&quot;;</span></pre><pre><span
+style='mso-bookmark:connect_ex'><span style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);<span style='mso-spacerun:yes'> </span># no need for PConnect()</span></pre><pre
+style='background:#EEEEEE'><span style='mso-bookmark:connect_ex'> </span></pre></div>
+
+<p><span style='mso-bookmark:connect_ex'>For most drivers, you can use the
+standard function: Connect($server, $user, $password, $database), or a </span><a
+href="dsnsupport">DSN</a> since ADOdb 4.51. Exceptions to this are listed
+below. </p>
+
+<h4><a name=pdo>PDO</a></h4>
+
+<p><span style='mso-bookmark:pdo'>PDO, which only works with PHP5, accepts a
+driver specific connection string: </span></p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-bookmark:pdo'><o:p>&nbsp;</o:p></span></pre><pre><span
+style='mso-bookmark:pdo'><span style='mso-tab-count:1'> </span>$conn =&amp; NewADConnection('pdo');</span></pre><pre><span
+style='mso-bookmark:pdo'><span style='mso-tab-count:1'> </span>$conn-&gt;Connect('mysql:host=localhost',$user,$pwd,$mydb);</span></pre><pre><span
+style='mso-bookmark:pdo'><span style='mso-tab-count:1'> </span>$conn-&gt;Connect('mysql:host=localhost;dbname=mydb',$user,$pwd);</span></pre><pre><span
+style='mso-bookmark:pdo'><span style='mso-tab-count:1'> </span>$conn-&gt;Connect(&quot;mysql:host=localhost;dbname=mydb;username=$user;password=$pwd&quot;);</span></pre></div>
+
+<p><span style='mso-bookmark:pdo'>The DSN mechanism is also supported: </span></p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-bookmark:pdo'><o:p>&nbsp;</o:p></span></pre><pre><span
+style='mso-bookmark:pdo'><span style='mso-tab-count:1'> </span>$conn =&amp; NewADConnection(&quot;pdo_mysql://user:pwd@localhost/mydb?persist&quot;); # persist is optional</span></pre></div>
+
+<h4><span style='mso-bookmark:pdo'>PostgreSQL</span></h4>
+
+<p><span style='mso-bookmark:pdo'>PostgreSQL 7 and 8 accepts connections using:
+</span></p>
+
+<p><span style='mso-bookmark:pdo'>a. the standard connection string:</span></p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-bookmark:pdo'><span
+style='mso-tab-count:1'> </span>$conn = &amp;ADONewConnection('postgres');<span style='mso-spacerun:yes'> </span><br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;PConnect('host=localhost port=5432 dbname=mary');</span></pre></div>
+
+<p><span style='mso-bookmark:pdo'>b. the classical 4 parameters:</span></p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-bookmark:pdo'><span
+style='mso-tab-count:1'> </span>$conn-&gt;PConnect('localhost','userid','password','database');<br>
+<span style='mso-spacerun:yes'></span></span></pre></div>
+
+<p><span style='mso-bookmark:pdo'>c. dsn: </span></p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-bookmark:pdo'><span style='mso-tab-count:1'> </span>$dsn = 'postgres://user:pwd@localhost/mydb?persist';<span style='mso-spacerun:yes'> </span># persist is optional</span></pre><pre
+style='background:#EEEEEE'><span style='mso-bookmark:pdo'><span
+style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);<span style='mso-spacerun:yes'> </span># no need for Connect/PConnect</span></pre></div>
+
+<span style='mso-bookmark:pdo'></span>
+
+<h4><a name=ldap></a>LDAP</h4>
+
+<p>Here is an example of querying a LDAP server. Thanks to Josh Eldridge for
+the driver and this example: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>require('/path/to/adodb.inc.php');</pre><pre><o:p>&nbsp;</o:p></pre><pre>/* Make sure to set this BEFORE calling Connect() */</pre><pre>$LDAP_CONNECT_OPTIONS = Array(</pre><pre><span
+style='mso-tab-count:1'> </span>Array (&quot;OPTION_NAME&quot;=&gt;LDAP_OPT_DEREF, &quot;OPTION_VALUE&quot;=&gt;2),</pre><pre><span
+style='mso-tab-count:1'> </span>Array (&quot;OPTION_NAME&quot;=&gt;LDAP_OPT_SIZELIMIT,&quot;OPTION_VALUE&quot;=&gt;100),</pre><pre><span
+style='mso-tab-count:1'> </span>Array (&quot;OPTION_NAME&quot;=&gt;LDAP_OPT_TIMELIMIT,&quot;OPTION_VALUE&quot;=&gt;30),</pre><pre><span
+style='mso-tab-count:1'> </span>Array (&quot;OPTION_NAME&quot;=&gt;LDAP_OPT_PROTOCOL_VERSION,&quot;OPTION_VALUE&quot;=&gt;3),</pre><pre><span
+style='mso-tab-count:1'> </span>Array (&quot;OPTION_NAME&quot;=&gt;LDAP_OPT_ERROR_NUMBER,&quot;OPTION_VALUE&quot;=&gt;13),</pre><pre><span
+style='mso-tab-count:1'> </span>Array (&quot;OPTION_NAME&quot;=&gt;LDAP_OPT_REFERRALS,&quot;OPTION_VALUE&quot;=&gt;FALSE),</pre><pre><span
+style='mso-tab-count:1'> </span>Array (&quot;OPTION_NAME&quot;=&gt;LDAP_OPT_RESTART,&quot;OPTION_VALUE&quot;=&gt;FALSE)</pre><pre>);</pre><pre>$host = 'ldap.baylor.edu';</pre><pre>$ldapbase = 'ou=People,o=<st1:place
+w:st="on"><st1:PlaceName w:st="on">Baylor</st1:PlaceName> <st1:PlaceType w:st="on">University</st1:PlaceType></st1:place>,c=US';</pre><pre><o:p>&nbsp;</o:p></pre><pre>$ldap = NewADOConnection( 'ldap' );</pre><pre>$ldap-&gt;Connect( $host, $user_name='', $password='', $ldapbase );</pre><pre><o:p>&nbsp;</o:p></pre><pre>echo &quot;&lt;pre&gt;&quot;;</pre><pre><o:p>&nbsp;</o:p></pre><pre>print_r( $ldap-&gt;ServerInfo() );</pre><pre>$ldap-&gt;SetFetchMode(ADODB_FETCH_ASSOC);</pre><pre>$userName = 'eldridge';</pre><pre>$filter=&quot;(|(CN=$userName*)(sn=$userName*)(givenname=$userName*)(uid=$userName*))&quot;;</pre><pre><o:p>&nbsp;</o:p></pre><pre>$rs = $ldap-&gt;Execute( $filter );</pre><pre>if ($rs)</pre><pre><span
+style='mso-tab-count:1'> </span>while ($arr = $rs-&gt;FetchRow()) {</pre><pre><span
+style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span>print_r($arr);<span
+style='mso-tab-count:1'> </span></pre><pre><span style='mso-tab-count:
+1'> </span>}</pre><pre><o:p>&nbsp;</o:p></pre><pre>$rs = $ldap-&gt;Execute( $filter );</pre><pre>if ($rs) </pre><pre><span
+style='mso-tab-count:1'> </span>while (!$rs-&gt;EOF) {</pre><pre> <span
+style='mso-tab-count:2'> </span>print_r($rs-&gt;fields);<span
+style='mso-tab-count:1'> </span></pre><pre><span style='mso-tab-count:2'> </span>$rs-&gt;MoveNext();</pre><pre><span
+style='mso-tab-count:1'> </span>} </pre><pre><span style='mso-tab-count:
+1'> </span></pre><pre>print_r( $ldap-&gt;GetArray( $filter ) );</pre><pre>print_r( $ldap-&gt;GetRow( $filter ) );</pre><pre><o:p>&nbsp;</o:p></pre><pre>$ldap-&gt;Close();</pre><pre>echo &quot;&lt;/pre&gt;&quot;;</pre></div>
+
+<p>Using DSN: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>$dsn = &quot;ldap://ldap.baylor.edu/ou=People,o=<st1:place
+w:st="on"><st1:PlaceName w:st="on">Baylor</st1:PlaceName> <st1:PlaceType w:st="on">University</st1:PlaceType></st1:place>,c=US&quot;;</pre><pre>$db = NewADOConnection($dsn);</pre></div>
 
-$ldap->Close();
-echo "&lt;/pre>";
-</pre>
-<p>Using DSN:
-<pre>
-$dsn = "ldap://ldap.baylor.edu/ou=People,o=Baylor University,c=US";
-$db = NewADOConnection($dsn);
-</pre>
 <h4>Interbase/Firebird</h4>
-You define the database in the $host parameter:
-<pre>	$conn =ADONewConnection('ibase'); <br>	$conn-&gt;PConnect('localhost:c:\ibase\employee.gdb','sysdba','masterkey');<br></pre>
-<p>Or dsn:
-</p><pre>	$dsn = 'firebird://user:pwd@localhost/mydb?persist&amp;dialect=3';  # persist is optional<br>	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect<br></pre>
+
+<p class=MsoNormal>You define the database in the $host parameter: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn = &amp;ADONewConnection('ibase'); <br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;PConnect('localhost:c:\ibase\employee.gdb','sysdba','masterkey');</pre></div>
+
+<p>Or dsn: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$dsn = 'firebird://user:pwd@localhost/mydb?persist&amp;dialect=3';<span style='mso-spacerun:yes'> </span># persist is optional<br>
+<span style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);<span style='mso-spacerun:yes'> </span># no need for Connect/PConnect</pre></div>
+
 <h4>SQLite</h4>
-Sqlite will create the database file if it does not exist.
-<pre>	$conn =ADONewConnection('sqlite');
-	$conn-&gt;PConnect('c:\path\to\sqlite.db'); # sqlite will create if does not exist<br></pre>
-<p>Or dsn:
-</p><pre>	$path = urlencode('c:\path\to\sqlite.db');
-	$dsn = "sqlite://$path/?persist";  # persist is optional
-	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect<br></pre>
+
+<p class=MsoNormal>Sqlite will create the database file if it does not exist. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:1'> </span>$conn = &amp;ADONewConnection('sqlite');</pre><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn-&gt;PConnect('c:\path\to\sqlite.db'); # sqlite will create if does not exist</pre></div>
+
+<p>Or dsn: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:1'> </span>$path = urlencode('c:\path\to\sqlite.db');</pre><pre><span
+style='mso-tab-count:1'> </span>$dsn = &quot;sqlite://$path/?persist&quot;;<span style='mso-spacerun:yes'> </span># persist is optional</pre><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);<span style='mso-spacerun:yes'> </span># no need for Connect/PConnect</pre></div>
+
 <h4>Oracle (oci8)</h4>
-<p>With oci8, you can connect in multiple ways. Note that oci8 works fine with 
+
+<p>With oci8, you can connect in multiple ways. Note that oci8 works fine with
 newer versions of the Oracle, eg. 9i and 10g.</p>
+
 <p>a. PHP and Oracle reside on the same machine, use default SID.</p>
-<pre>	$conn-&gt;Connect(false, 'scott', 'tiger');</pre>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn-&gt;Connect(false, 'scott', 'tiger');</pre></div>
+
 <p>b. TNS Name defined in tnsnames.ora (or ONAMES or HOSTNAMES), eg. 'myTNS'</p>
-<pre>	$conn-&gt;PConnect(false, 'scott', 'tiger', 'myTNS');</pre>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn-&gt;PConnect(false, 'scott', 'tiger', 'myTNS');</pre></div>
+
 <p>or</p>
-<pre> 	$conn-&gt;PConnect('myTNS', 'scott', 'tiger');</pre>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'></span><span
+style='mso-tab-count:1'> </span>$conn-&gt;PConnect('myTNS', 'scott', 'tiger');</pre></div>
+
 <p>c. Host Address and SID</p>
-<pre>
-	$conn->connectSID = true;
-	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'SID');</pre>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='mso-tab-count:1'> </span># with adodb 5.06 or 4.991 and later</pre><pre><span
+style='mso-tab-count:1'> </span>$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', &quot;SID=$SID&quot;);</pre><pre><span
+style='mso-tab-count:1'> </span></pre><pre><span style='mso-tab-count:
+1'> </span># OR with all versions of ADOdb</pre><pre><span
+style='mso-tab-count:1'> </span>$conn-&gt;connectSID = true;</pre><pre><span
+style='mso-tab-count:1'> </span>$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', $SID);</pre><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span></pre></div>
+
 <p>d. Host Address and Service Name</p>
-<pre>	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'servicename');</pre>
-<p>e. Oracle connection string:
-</p><pre>	$cstr = "(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=$host)(PORT=$port))<br>			(CONNECT_DATA=(SID=$sid)))";<br>	$conn-&gt;Connect($cstr, 'scott', 'tiger');<br></pre>
-<p>f. ADOdb dsn:
-</p><pre>	$dsn = 'oci8://user:pwd@tnsname/?persist';  # persist is optional<br>	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect<br>	<br>	$dsn = 'oci8://user:pwd@host/sid';<br>	$conn = ADONewConnection($dsn);<br>	<br>	$dsn = 'oci8://user:pwd@/';   # oracle on local machine<br>	$conn = ADONewConnection($dsn);<br></pre>
-<p>You can also set the charSet for Oracle 9.2 and later, supported since PHP 4.3.2, ADOdb 4.54:
-</p><pre>	$conn-&gt;charSet = 'we8iso8859p1';<br>	$conn-&gt;Connect(...);<br>	<br>	# or<br>	$dsn = 'oci8://user:pwd@tnsname/?charset=WE8MSWIN1252';<br>	$db = ADONewConnection($dsn);<br></pre>
-<a name="dsnless"></a>
-<h4>DSN-less ODBC ( Access, MSSQL and DB2 examples)</h4>
-<p>ODBC DSN's can be created in the ODBC control panel, or you can use a DSN-less 
-  connection.To use DSN-less connections with ODBC you need PHP 4.3 or later. 
-</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'servicename');</pre></div>
+
+<p>e. Oracle connection string: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$cstr = &quot;(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=$host)(PORT=$port))<br>
+<span style='mso-tab-count:3'> </span>(CONNECT_DATA=(SID=$sid)))&quot;;<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;Connect($cstr, 'scott', 'tiger');</pre></div>
+
+<p>f. ADOdb dsn: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$dsn = 'oci8://user:pwd@tnsname/?persist';<span style='mso-spacerun:yes'> </span># persist is optional<br>
+<span style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);<span style='mso-spacerun:yes'> </span># no need for Connect/PConnect<br>
+<span style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span>$dsn = 'oci8://user:pwd@host/sid';<br>
+<span style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);<br>
+<span style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span>$dsn = 'oci8://user:pwd@/';<span style='mso-spacerun:yes'> </span># oracle on local machine<br>
+<span style='mso-tab-count:1'> </span>$conn = ADONewConnection($dsn);</pre></div>
+
+<p>You can also set the charSet for Oracle 9.2 and later, supported since PHP
+4.3.2, ADOdb 4.54: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn-&gt;charSet = 'we8iso8859p1';<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;Connect(...);<br>
+<span style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span># or<br>
+<span style='mso-tab-count:1'> </span>$dsn = 'oci8://user:pwd@tnsname/?charset=WE8MSWIN1252';<br>
+<span style='mso-tab-count:1'> </span>$db = ADONewConnection($dsn);</pre></div>
+
+<h4><a name=dsnless></a>DSN-less ODBC ( Access, MSSQL and DB2 examples)</h4>
+
+<p>ODBC DSN's can be created in the ODBC control panel, or you can use a
+DSN-less connection.To use DSN-less connections with ODBC you need PHP 4.3 or
+later. </p>
+
 <p>For Microsoft Access:</p>
-<pre>	$db = ADONewConnection('access');<br>	$dsn = <strong>"Driver={Microsoft Access Driver (*.mdb)};Dbq=d:\\northwind.mdb;Uid=Admin;Pwd=;";</strong>
-	$db-&gt;Connect($dsn);
-</pre>
-For Microsoft SQL Server: 
-<pre>	$db = ADONewConnection('odbc_mssql');<br>	$dsn = <strong>"Driver={SQL Server};Server=localhost;Database=northwind;"</strong>;<br>	$db-&gt;Connect($dsn,'userid','password');<br></pre>
-or if you prefer to use the mssql extension (which is limited to mssql 6.5 functionality):
-<pre>	$db = ADONewConnection('mssql');<br>	$db-&gt;Execute('localhost', 'userid', 'password', 'northwind');<br></pre>
-For DB2:
-<pre>
-	$dbms = 'db2'; # or 'odbc_db2' if db2 extension not available
-	$db = ADONewConnection($dbms);
-	$dsn = "driver={IBM db2 odbc DRIVER};Database=sample;hostname=localhost;port=50000;protocol=TCPIP;".
-				"uid=root; pwd=secret";<br>	$db-&gt;Connect($dsn);
-</pre>
-<b>DSN-less Connections with ADO</b><br>
-If you are using versions of PHP earlier than PHP 4.3.0, DSN-less connections 
-only work with Microsoft's ADO, which is Microsoft's COM based API. An example 
-using the ADOdb library and Microsoft's ADO: 
-<pre>&lt;?php<br>	include('adodb.inc.php'); <br>	$db =ADONewConnection("ado_mssql");<br>	print "&lt;h1&gt;Connecting DSN-less $db-&gt;databaseType...&lt;/h1&gt;";<br>		<br>	<b>$myDSN="PROVIDER=MSDASQL;DRIVER={SQL Server};"<br>		. "SERVER=flipper;DATABASE=ai;UID=sa;PWD=;"  ;</b>
-	$db-&gt;Connect($myDSN);
-	
-	$rs = $db-&gt;Execute("select * from table");
-	$arr = $rs-&gt;GetArray();
-	print_r($arr);
-?&gt;
-</pre><a name="speed"></a>
-<h2>High Speed ADOdb - tuning tips</h2>
-<p>ADOdb is a big class library, yet it <a href="http://phplens.com/lens/adodb/">consistently beats</a> all other PHP class 
-  libraries in performance. This is because it is designed in a layered fashion, 
-  like an onion, with the fastest functions in the innermost layer. Stick to the 
-  following functions for best performance:</p>
-<table align="center" border="1" width="40%">
-  <tbody><tr>
-    <td><div align="center"><b>Innermost Layer</b></div></td>
-  </tr>
-  <tr> 
-    <td><p align="center">Connect, PConnect, NConnect<br>
-        Execute, CacheExecute<br>
-        SelectLimit, CacheSelectLimit<br>
-        MoveNext, Close <br>
-		qstr, Affected_Rows, Insert_ID</p></td>
-  </tr>
-</tbody></table>
-<p>The fastest way to access the field data is by accessing the array $recordset-&gt;fields 
-  directly. Also set the global variables <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a> 
-  = ADODB_FETCH_NUM, and (for oci8, ibase/firebird and odbc) <a href="#adodb_countrecs">$ADODB_COUNTRECS</a> = false 
-  before you connect to your database.</p>
-<p>Consider using bind parameters if your database supports it, as it improves 
-  query plan reuse. Use ADOdb's performance tuning system to identify bottlenecks 
-  quickly. At the time of writing (Dec 2003), this means oci8 and odbc drivers.</p>
- <p>Lastly make sure you have a PHP accelerator cache installed such as APC, Turck 
-  MMCache, Zend Accelerator or ionCube.</p>
- <p>Some examples:</p>
- <table align="center" border="1"><tbody><tr><td><b>Fastest data retrieval using PHP</b></td><td><b>Fastest data retrieval using ADOdb extension</b></td></tr>
-<tr><td>
-<pre>$rs = $rs-&gt;Execute($sql);<br>while (!$rs-&gt;EOF) {<br>	var_dump($rs-&gt;fields);<br>	$rs-&gt;MoveNext();<br>}</pre></td><td>
-<pre>$rs = $rs-&gt;Execute($sql);<br>$array = adodb_getall($rs);<br>var_dump($array);<br><br><br></pre></td></tr></tbody></table>
- <p><b>Advanced Tips</b>
- </p><p>If you have the <a href="http://adodb.sourceforge.net/#extension">ADOdb C extension</a> installed, 
- you can replace your calls to $rs-&gt;MoveNext() with adodb_movenext($rs). 
- This doubles the speed of this operation. For retrieving entire recordsets at once,
-use GetArray(), which uses the high speed extension function adodb_getall($rs) internally.
- </p><p>Execute() is the default way to run queries. You can use the low-level functions _Execute() and _query()
-to reduce query overhead.  Both these functions share the same parameters as Execute().
-</p><p>If you do not have any bind parameters or your database supports
-binding (without emulation),
-then you can call _Execute() directly. Calling this function bypasses
-bind emulation. Debugging is still supported in _Execute().
-</p><p>If you do not require debugging facilities nor emulated
-binding, and do not require a recordset to be returned, then you can
-call _query. This is great for inserts, updates and deletes. Calling
-this function
-bypasses emulated binding, debugging, and recordset handling. Either
-the resultid, true or false are returned by _query(). </p><p>For Informix, you can disable scrollable cursors with $db-&gt;cursorType = 0.
-</p><p><a name="hack"></a> </p>
-<h2>Hacking ADOdb Safely</h2>
-<p>You might want to modify ADOdb for your own purposes. Luckily you can
-still maintain backward compatibility by sub-classing ADOdb and using the $ADODB_NEWCONNECTION
-variable. $ADODB_NEWCONNECTION allows you to override the behaviour of ADONewConnection().
-ADOConnection() checks for this variable and will call
-the function-name stored in this variable if it is defined.
-</p><p>In the following example, new functionality for the connection object 
-is placed in the <i>hack_mysql</i> and <i>hack_postgres7</i> classes. The recordset class naming convention
-can be controlled using $rsPrefix. Here we set it to 'hack_rs_', which will make ADOdb use
-<i>hack_rs_mysql</i> and <i>hack_rs_postgres7</i> as the recordset classes.
-
-
-</p><pre>class hack_mysql extends adodb_mysql {<br>var $rsPrefix = 'hack_rs_';<br>  /* Your mods here */<br>}<br><br>class hack_rs_mysql extends ADORecordSet_mysql {<br>	 /* Your mods here */<br>}<br><br>class hack_postgres7 extends adodb_postgres7 {<br>var $rsPrefix = 'hack_rs_';<br>  /* Your mods here */<br>}<br><br>class hack_rs_postgres7 extends ADORecordSet_postgres7 {<br> /* Your mods here */<br>}<br><br>$ADODB_NEWCONNECTION = 'hack_factory';<br><br>function hack_factory($driver)<br>{<br>	if ($driver !== 'mysql' &amp;&amp; $driver !== 'postgres7') return false;<br>	<br>	$driver = 'hack_'.$driver;<br>	$obj = new $driver();<br>	return $obj;<br>}<br><br>include_once('adodb.inc.php');<br></pre>
-<p></p><p>Don't forget to call the constructor of the parent class in
-your constructor. If you want to use the default ADOdb drivers return
-false in the above hack_factory() function.
- Also you can define your own ADORecordSet_empty() class, by defining a class $$this->rsPrefix.'empty' since 4.96/5.02.
-<a name="php5"></a>
-</p><h2>PHP5 Features</h2>
- ADOdb 4.02 or later will transparently determine which version of PHP you are using.
-If PHP5 is detected, the following features become available:
-<ul>
 
-<li><b>PDO</b>: PDO drivers are available. See the <a href=#pdo>connection examples</a>. Currently PDO drivers are
- not as powerful as native drivers, and should be treated as experimental.<br><br>
-<a name="php5iterators"></a>
-<li><b>Foreach iterators</b>: This is a very natural way of going through a recordset:
-<pre>	$ADODB_FETCH_MODE = ADODB_FETCH_NUM;<br>	$rs = $db-&gt;Execute($sql);<br>	foreach($rs as $k =gt; $row) {<br>		echo "r1=".$row[0]." r2=".$row[1]."&lt;br&gt;";<br>	}<br></pre>
-<p>
-<a name="php5exceptions"></a>
-</p></li><li><b>Exceptions</b>: Just include <i>adodb-exceptions.inc.php</i> and you can now 
-catch exceptions on errors as they occur.
-<pre>	<b>include("../adodb-exceptions.inc.php");</b> <br>	include("../adodb.inc.php");	 <br>	try { <br>		$db = NewADOConnection("oci8"); <br>		$db-&gt;Connect('','scott','bad-password'); <br>	} catch (exception $e) { <br>		var_dump($e); <br>		adodb_backtrace($e-&gt;gettrace());<br>	} <br></pre>
-<p>Note that reaching EOF is <b>not</b> considered an error nor an exception.
-</p></li></ul> 
-<h3><a name="drivers"></a>Databases Supported</h3>
-The <i>name</i> below is the value you pass to NewADOConnection($name) to create a  connection object for that database.
-<p>
-</p><p> 
-</p><table border="1" width="100%">
-  <tbody><tr valign="top"> 
-    <td><b>Name</b></td>
-    <td><b>Tested</b></td>
-    <td><b>Database</b></td>
-    <td><b><font size="2">RecordCount() usable</font></b></td>
-    <td><b>Prerequisites</b></td>
-    <td><b>Operating Systems</b></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">access</font></b></td>
-    <td><font size="2">B</font></td>
-    <td><font size="2">Microsoft Access/Jet. You need to create an ODBC DSN.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">ODBC </font></td>
-    <td><font size="2">Windows only</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">ado</font></b></td>
-    <td><font size="2">B</font></td>
-    <td><p><font size="2">Generic ADO, not tuned for specific databases. Allows 
-        DSN-less connections. For best performance, use an OLEDB provider. This 
-        is the base class for all ado drivers.</font></p>
-      <p><font size="2">You can set $db-&gt;codePage before connecting.</font></p></td>
-    <td><font size="2">? depends on database</font></td>
-    <td><font size="2">ADO or OLEDB provider</font></td>
-    <td><font size="2">Windows only</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">ado_access</font></b></td>
-    <td><font size="2">B</font></td>
-    <td><font size="2">Microsoft Access/Jet using ADO. Allows DSN-less connections. 
-      For best performance, use an OLEDB provider.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">ADO or OLEDB provider</font></td>
-    <td><font size="2">Windows only</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">ado_mssql</font></b></td>
-    <td><font size="2">B</font></td>
-    <td><font size="2">Microsoft SQL Server using ADO. Allows DSN-less connections. 
-      For best performance, use an OLEDB provider.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">ADO or OLEDB provider</font></td>
-    <td><font size="2">Windows only</font></td>
-  </tr>
-    <tr valign="top"> 
-    <td height="54"><b><font size="2">db2</font></b></td>
-    <td height="54"><font size="2">C</font></td>
-    <td height="54"><font size="2">Uses PHP's db2-specific extension for better performance.</font></td>
-    <td height="54"><font size="2">Y/N</font></td>
-    <td height="54"><font size="2">DB2 CLI/ODBC interface</font></td>
-    <td height="54"> <p><font size="2">Unix and Windows. Requires IBM DB2 Universal Database client.</font></p></td>
-  </tr>
-  <tr valign="top"> 
-    <td height="54"><b><font size="2">odbc_db2</font></b></td>
-    <td height="54"><font size="2">C</font></td>
-    <td height="54"><font size="2">Connects to DB2 using generic ODBC extension.</font></td>
-    <td height="54"><font size="2">Y/N</font></td>
-    <td height="54"><font size="2">DB2 CLI/ODBC interface</font></td>
-    <td height="54"> <p><font size="2">Unix and Windows. <a href="http://www.faqts.com/knowledge_base/view.phtml/aid/6283/fid/14">Unix 
-        install hints</a>. I have had reports that the $host and $database params have to be reversed in Connect() when using the CLI interface.</font></p></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">vfp</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">Microsoft Visual FoxPro. You need to create an ODBC DSN.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">ODBC</font></td>
-    <td><font size="2">Windows only</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">fbsql</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">FrontBase. </font></td>
-    <td><font size="2">Y</font></td>
-    <td><font size="2">?</font></td>
-    <td> <p><font size="2">Unix and Windows</font></p></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">ibase</font></b></td>
-    <td><font size="2">B</font></td>
-    <td><font size="2">Interbase 6 or earlier. Some users report you might need 
-      to use this<br>
-      $db-&gt;PConnect('localhost:c:/ibase/employee.gdb', "sysdba", "masterkey") 
-      to connect. Lacks Affected_Rows currently.<br>
-      <br>
-      You can set $db-&gt;role, $db-&gt;dialect, $db-&gt;buffers and $db-&gt;charSet before connecting.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Interbase client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><i><font size="2">firebird</font></i></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Firebird version of interbase.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Interbase client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><i><font size="2">borland_ibase</font></i></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Borland version of Interbase 6.5 or later. Very sad that 
-      the forks differ.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Interbase client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-
-  <tr valign="top"> 
-    <td><b><font size="2">informix</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Generic informix driver. Use this if you are using Informix 7.3 or later.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Informix client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">informix72</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2"> Informix databases before Informix 7.3 that do no support 
-      SELECT FIRST.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Informix client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">ldap</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">LDAP driver. See this example for usage information.</font></td>
-    <td>&nbsp;</td>
-    <td><font size="2">LDAP extension</font></td>
-    <td><font size="2">?</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td height="73"><b><font size="2">mssql</font></b></td>
-    <td height="73"><font size="2">A</font></td>
-    <td height="73"> <p><font size="2">Microsoft SQL Server 7 and later. Works 
-        with Microsoft SQL Server 2000 also. Note that date formating is problematic 
-        with this driver. For example, the PHP mssql extension does not return 
-        the seconds for datetime!</font></p></td>
-    <td height="73"><font size="2">Y/N</font></td>
-    <td height="73"><font size="2">Mssql client</font></td>
-    <td height="73"> <p><font size="2">Unix and Windows. <br>
-        <a href="http://phpbuilder.com/columns/alberto20000919.php3">Unix install 
-        howto</a> and <a href="http://linuxjournal.com/article.php?sid=6636&amp;mode=thread&amp;order=0">another 
-        one</a>. </font></p></td>
-  </tr>
-  <tr valign="top"> 
-    <td height="73"><b><font size="2">mssqlpo</font></b></td>
-    <td height="73"><font size="2">A</font></td>
-    <td height="73"> <p><font size="2">Portable mssql driver. Identical to above 
-        mssql driver, except that '||', the concatenation operator, is converted 
-        to '+'. Useful for porting scripts from most other sql variants that use 
-        ||.</font></p></td>
-    <td height="73"><font size="2">Y/N</font></td>
-    <td height="73"><font size="2">Mssql client</font></td>
-    <td height="73"> <p><font size="2">Unix and Windows. <a href="http://phpbuilder.com/columns/alberto20000919.php3"><br>
-        Unix install howto</a>.</font></p></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">mysql</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">MySQL without transaction support. You can also set $db-&gt;clientFlags 
-      before connecting.</font></td>
-    <td><font size="2">Y</font></td>
-    <td><font size="2">MySQL client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><font size="2"><b>mysqlt</b> or <b>maxsql</b></font></td>
-    <td><font size="2">A</font></td>
-    <td> <p><font size="2">MySQL with transaction support. We recommend using 
-        || as the concat operator for best portability. This can be done by running 
-        MySQL using: <br>
-        <i>mysqld --ansi</i> or <i>mysqld --sql-mode=PIPES_AS_CONCAT</i></font></p></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">MySQL client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">oci8</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">Oracle 8/9. Has more functionality than <i>oracle</i> driver 
-      (eg. Affected_Rows). You might have to putenv('ORACLE_HOME=...') before 
-      Connect/PConnect. </font> <p><font size="2"> There are 2 ways of connecting 
-        - with server IP and service name: <br>
-        <i>PConnect('serverip:1521','scott','tiger','service'</i>)<br>
-        or using an entry in TNSNAMES.ORA or ONAMES or HOSTNAMES: <br>
-        <i>PConnect(false, 'scott', 'tiger', $oraname)</i>. </font> 
-      </p><p><font size="2">Since 2.31, we support Oracle REF cursor variables directly 
-        (see <a href="#executecursor">ExecuteCursor</a>).</font> </p></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Oracle client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">oci805</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Supports reduced Oracle functionality for Oracle 8.0.5. 
-      SelectLimit is not as efficient as in the oci8 or oci8po drivers.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Oracle client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">oci8po</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">Oracle 8/9 portable driver. This is nearly identical with 
-      the oci8 driver except (a) bind variables in Prepare() use the ? convention, 
-      instead of :bindvar, (b) field names use the more common PHP convention 
-      of lowercase names. </font> <p><font size="2">Use this driver if porting 
-        from other databases is important. Otherwise the oci8 driver offers better 
-        performance. </font> </p></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Oracle client</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">odbc</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">Generic ODBC, not tuned for specific databases. To connect, 
-      use <br>
-      PConnect('DSN','user','pwd'). This is the base class for all odbc derived 
-      drivers.</font></td>
-    <td><font size="2">? depends on database</font></td>
-    <td><font size="2">ODBC</font></td>
-    <td><font size="2">Unix and Windows. <a href="http://phpbuilder.com/columns/alberto20000919.php3?page=4">Unix 
-      hints.</a></font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">odbc_mssql</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Uses ODBC to connect to MSSQL</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">ODBC</font></td>
-    <td><font size="2">Unix and Windows. </font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">odbc_oracle</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Uses ODBC to connect to Oracle</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">ODBC</font></td>
-    <td><font size="2">Unix and Windows. </font></td>
-  </tr>
-    
-  <tr valign="top"> 
-    <td><b><font size="2">odbtp</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Generic odbtp driver. <a href="http://odbtp.sourceforge.net/">Odbtp</a> is a software for
-	accessing Windows ODBC data sources from other operating systems.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">odbtp</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">odbtp_unicode</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Odtbp with unicode support</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">odbtp</font></td>
-    <td><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td height="34"><b><font size="2">oracle</font></b></td>
-    <td height="34"><font size="2">C</font></td>
-    <td height="34"><font size="2">Implements old Oracle 7 client API. Use oci8 
-      driver if possible for better performance.</font></td>
-    <td height="34"><font size="2">Y/N</font></td>
-    <td height="34"><font size="2">Oracle client</font></td>
-    <td height="34"><font size="2">Unix and Windows</font></td>
-  </tr>
-  <tr valign="top"> 
-    <td height="34"><b><font size="2">netezza</font></b></td>
-    <td height="34"><font size="2">C</font></td>
-    <td height="34"><font size="2">Netezza driver. Netezza is based on postgres code-base.</font></td>
-    <td height="34"><font size="2">Y</font></td>
-    <td height="34"><font size="2">?</font></td>
-    <td height="34"><font size="2">?</font></td>
-  </tr>
-     <tr valign="top"> 
-    <td><b><font size="2">pdo</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Generic PDO driver for PHP5. </font></td>
-    <td><font size="2">Y</font></td>
-    <td><font size="2">PDO extension and database specific drivers</font></td>
-    <td><font size="2">Unix and Windows. </font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">postgres</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">Generic PostgreSQL driver. Currently identical to postgres7 
-      driver.</font></td>
-    <td><font size="2">Y</font></td>
-    <td><font size="2">PostgreSQL client</font></td>
-    <td><font size="2">Unix and Windows. </font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">postgres64</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">For PostgreSQL 6.4 and earlier which does not support LIMIT 
-      internally.</font></td>
-    <td><font size="2">Y</font></td>
-    <td><font size="2">PostgreSQL client</font></td>
-    <td><font size="2">Unix and Windows. </font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">postgres7</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">PostgreSQL which supports LIMIT and other version 7 functionality.</font></td>
-    <td><font size="2">Y</font></td>
-    <td><font size="2">PostgreSQL client</font></td>
-    <td><font size="2">Unix and Windows. </font></td>
-  </tr>
-    <tr valign="top"> 
-    <td><b><font size="2">postgres8</font></b></td>
-    <td><font size="2">A</font></td>
-    <td><font size="2">PostgreSQL which supports version 8 functionality.</font></td>
-    <td><font size="2">Y</font></td>
-    <td><font size="2">PostgreSQL client</font></td>
-    <td><font size="2">Unix and Windows. </font></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">sapdb</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">SAP DB. Should work reliably as based on ODBC driver.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">SAP ODBC client</font></td>
-    <td> <p><font size="2">?</font></p></td>
-  </tr>
-  <tr valign="top"> 
-    <td><b><font size="2">sqlanywhere</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Sybase SQL Anywhere. Should work reliably as based on ODBC 
-      driver.</font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">SQL Anywhere ODBC client</font></td>
-    <td> <p><font size="2">?</font></p></td>
-  </tr>
-  <tr valign="top"> 
-    <td height="54"><b><font size="2">sqlite</font></b></td>
-    <td height="54"><font size="2">B</font></td>
-    <td height="54"><font size="2">SQLite.</font></td>
-    <td height="54"><font size="2">Y</font></td>
-    <td height="54"><font size="2">-</font></td>
-    <td height="54"> <p><font size="2">Unix and Windows.</font></p></td>
-  </tr>
-    <tr valign="top"> 
-    <td height="54"><b><font size="2">sqlitepo</font></b></td>
-    <td height="54"><font size="2">B</font></td>
-    <td height="54"><font size="2">Portable SQLite driver.  This is because assoc mode does not work like other drivers in sqlite.
-   Namely, when selecting (joining) multiple tables, the table
-   	  names are included in the assoc keys in the "sqlite" driver.</font><p>
-<font size="2">	  In "sqlitepo" driver, the table names are stripped from the returned column names. 
-	  When this results in a conflict,  the first field get preference.
-	  </font></p></td>
-    <td height="54"><font size="2">Y</font></td>
-    <td height="54"><font size="2">-</font></td>
-    <td height="54"> <p><font size="2">Unix and Windows.</font></p></td>
-  </tr>
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:1'> </span>$db =&amp; ADONewConnection('access');<br>
+<span style='mso-tab-count:1'> </span>$dsn = <strong><span
+style='font-family:"Courier New"'>&quot;Driver={Microsoft Access Driver (*.mdb)};Dbq=d:\\northwind.mdb;Uid=Admin;Pwd=;&quot;;</span></strong></pre><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;Connect($dsn);</pre></div>
+
+<p class=MsoNormal>For Microsoft SQL Server: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$db =&amp; ADONewConnection('odbc_mssql');<br>
+<span style='mso-tab-count:1'> </span>$dsn = <strong><span
+style='font-family:"Courier New"'>&quot;Driver={SQL Server};Server=localhost;Database=northwind;&quot;</span></strong>;<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;Connect($dsn,'userid','password');</pre></div>
+
+<p class=MsoNormal>or if you prefer to use the mssql extension (which is
+limited to mssql 6.5 functionality): </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$db =&amp; ADONewConnection('mssql');<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;Execute('localhost', 'userid', 'password', 'northwind');</pre></div>
+
+<p class=MsoNormal>For DB2: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='mso-tab-count:1'> </span>$dbms = 'db2'; # or 'odbc_db2' if db2 extension not available</pre><pre><span
+style='mso-tab-count:1'> </span>$db =&amp; ADONewConnection($dbms);</pre><pre><span
+style='mso-tab-count:1'> </span>$dsn = &quot;driver={IBM db2 odbc DRIVER};Database=sample;hostname=localhost;port=50000;protocol=TCPIP;&quot;.</pre><pre><span
+style='mso-tab-count:4'> </span>&quot;uid=root; pwd=secret&quot;;<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;Connect($dsn);<br>
+		  # or connect and set schema
+		  $db-&gt;Connect($dsn,null,null,$schema);</pre>
+</div>
+
+<p class=MsoNormal><b>DSN-less Connections with <st1:City w:st="on">ADO</st1:City></b><br>
+If you are using versions of PHP earlier than PHP 4.3.0, DSN-less connections
+only work with Microsoft's <st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>,
+which is Microsoft's COM based API. An example using the ADOdb library and
+Microsoft's <st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>:
+</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>&lt;?php<br>
+<span style='mso-tab-count:1'> </span>include('adodb.inc.php'); <br>
+<span style='mso-tab-count:1'> </span>$db = &amp;ADONewConnection(&quot;ado_mssql&quot;);<br>
+<span style='mso-tab-count:1'> </span>print &quot;&lt;h1&gt;Connecting DSN-less $db-&gt;databaseType...&lt;/h1&gt;&quot;;<br>
+<span style='mso-tab-count:2'> </span><br>
+<span style='mso-tab-count:1'> </span><b>$myDSN=&quot;PROVIDER=MSDASQL;DRIVER={SQL Server};&quot;<br>
+<span style='mso-tab-count:2'> </span>. &quot;SERVER=flipper;DATABASE=ai;UID=sa;PWD=;&quot;<span style='mso-spacerun:yes'> </span>;</b></pre><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;Connect($myDSN);</pre><pre><span
+style='mso-tab-count:1'> </span></pre><pre><span style='mso-tab-count:
+1'> </span>$rs = $db-&gt;Execute(&quot;select * from table&quot;);</pre><pre><span
+style='mso-tab-count:1'> </span>$arr = $rs-&gt;GetArray();</pre><pre><span
+style='mso-tab-count:1'> </span>print_r($arr);</pre><pre>?&gt;</pre></div>
+
+<h2><a name=speed></a>High Speed ADOdb - tuning tips</h2>
+
+<p>ADOdb is a big class library, yet it <a href="http://phplens.com/lens/adodb/">consistently
+beats</a> all other PHP class libraries in performance. This is because it is
+designed in a layered fashion, like an onion, with the fastest functions in the
+innermost layer. Stick to the following functions for best performance:</p>
+
+<div align=center>
+
+<table class=MsoNormalTable border=1 cellpadding=0 width="40%"
+ style='width:40.0%;mso-cellspacing:1.5pt'>
+ <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal align=center style='text-align:center'><b>Innermost Layer</b></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p align=center style='text-align:center'>Connect, PConnect, NConnect<br>
+  Execute, CacheExecute<br>
+  SelectLimit, CacheSelectLimit<br>
+  MoveNext, Close <br>
+  qstr, Affected_Rows, Insert_ID</p>
+  </td>
+ </tr>
+</table>
+
+</div>
+
+<p>The fastest way to access the field data is by accessing the array
+$recordset-&gt;fields directly. Also set the global variables <a
+href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a> = ADODB_FETCH_NUM, and (for
+oci8, ibase/firebird and odbc) <a href="#adodb_countrecs">$ADODB_COUNTRECS</a>
+= false before you connect to your database.</p>
+
+<p>Consider using bind parameters if your database supports it, as it improves
+query plan reuse. Use ADOdb's performance tuning system to identify bottlenecks
+quickly. At the time of writing (Dec 2003), this means oci8 and odbc drivers.</p>
+
+<p>Lastly make sure you have a PHP accelerator cache installed such as APC,
+Turck MMCache, Zend Accelerator or ionCube.</p>
+
+<p>Some examples:</p>
+
+<div align=center>
+
+<table class=MsoNormalTable border=1 cellpadding=0 style='mso-cellspacing:1.5pt'>
+ <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b>Fastest data retrieval using PHP</b></p>
+  </td>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b>Fastest data retrieval using ADOdb extension</b></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;
+  mso-border-alt:solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;
+  background:#EEEEEE'><pre style='background:#EEEEEE'>$rs =&amp; $rs-&gt;Execute($sql);<br>
+while (!$rs-&gt;EOF) {<br>
+  <span style='mso-tab-count:1'> </span>var_dump($rs-&gt;fields);<br>
+  <span style='mso-tab-count:1'> </span>$rs-&gt;MoveNext();<br>
+}</pre></div>
+  </td>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;
+  mso-border-alt:solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;
+  background:#EEEEEE'><pre style='margin-bottom:12.0pt;background:#EEEEEE'>$rs =&amp; $rs-&gt;Execute($sql);<br>
+$array = adodb_getall($rs);<br>
+var_dump($array);<br style='mso-special-character:line-break'>
+  <![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+  <![endif]></pre></div>
+  </td>
+ </tr>
+</table>
+
+</div>
+
+<p><b>Advanced Tips</b> </p>
+
+<p>If you have the <a href="http://adodb.sourceforge.net/#extension">ADOdb C
+extension</a> installed, you can replace your calls to $rs-&gt;MoveNext() with
+adodb_movenext($rs). This doubles the speed of this operation. For retrieving
+entire recordsets at once, use GetArray(), which uses the high speed extension
+function adodb_getall($rs) internally. </p>
+
+<p>Execute() is the default way to run queries. You can use the low-level
+functions _Execute() and _query() to reduce query overhead. Both these
+functions share the same parameters as Execute(). </p>
+
+<p>If you do not have any bind parameters or your database supports binding
+(without emulation), then you can call _Execute() directly. Calling this
+function bypasses bind emulation. Debugging is still supported in _Execute(). </p>
+
+<p>If you do not require debugging facilities nor emulated binding, and do not
+require a recordset to be returned, then you can call _query. This is great for
+inserts, updates and deletes. Calling this function bypasses emulated binding,
+debugging, and recordset handling. Either the resultid, true or false are
+returned by _query(). </p>
+
+<p>For Informix, you can disable scrollable cursors with $db-&gt;cursorType =
+0. </p>
+
+<h2><a name=hack></a>Hacking ADOdb Safely</h2>
+
+<p>You might want to modify ADOdb for your own purposes. Luckily you can still
+maintain backward compatibility by sub-classing ADOdb and using the
+$ADODB_NEWCONNECTION variable. $ADODB_NEWCONNECTION allows you to override the
+behaviour of ADONewConnection(). ADOConnection() checks for this variable and
+will call the function-name stored in this variable if it is defined. </p>
+
+<p>In the following example, new functionality for the connection object is
+placed in the <i>hack_mysql</i> and <i>hack_postgres7</i> classes. The
+recordset class naming convention can be controlled using $rsPrefix. Here we
+set it to 'hack_rs_', which will make ADOdb use <i>hack_rs_mysql</i> and <i>hack_rs_postgres7</i>
+as the recordset classes. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>class hack_mysql extends adodb_mysql {<br>
+var $rsPrefix = 'hack_rs_';<br>
+<span style='mso-spacerun:yes'> </span>/* Your mods here */<br>
+}<br>
+<br>
+class hack_rs_mysql extends ADORecordSet_mysql {<br>
+<span style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'></span>/* Your mods here */<br>
+}<br>
+<br>
+class hack_postgres7 extends adodb_postgres7 {<br>
+var $rsPrefix = 'hack_rs_';<br>
+<span style='mso-spacerun:yes'> </span>/* Your mods here */<br>
+}<br>
+<br>
+class hack_rs_postgres7 extends ADORecordSet_postgres7 {<br>
+<span style='mso-spacerun:yes'></span>/* Your mods here */<br>
+}<br>
+<br>
+$ADODB_NEWCONNECTION = 'hack_factory';<br>
+<br>
+function&amp; hack_factory($driver)<br>
+{<br>
+<span style='mso-tab-count:1'> </span>if ($driver !== 'mysql' &amp;&amp; $driver !== 'postgres7') return false;<br>
+<span style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span>$driver = 'hack_'.$driver;<br>
+<span style='mso-tab-count:1'> </span>$obj = new $driver();<br>
+<span style='mso-tab-count:1'> </span>return $obj;<br>
+}<br>
+<br>
+include_once('adodb.inc.php');</pre></div>
+
+<p>Don't forget to call the constructor of the parent class in your
+constructor. If you want to use the default ADOdb drivers return false in the
+above hack_factory() function. Also you can define your own
+ADORecordSet_empty() class, by defining a class $$this-&gt;rsPrefix.'empty'
+since 4.96/5.02. <a name=php5></a></p>
+
+<h2>PHP5 Features</h2>
+
+<p class=MsoNormal>ADOdb 4.02 or later will transparently determine which
+version of PHP you are using. If PHP5 is detected, the following features become
+available: </p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;margin-bottom:12.0pt;
+     mso-list:l11 level1 lfo5;tab-stops:list 36.0pt'><b>PDO</b>: PDO drivers
+     are available. See the <a href="#pdo">connection examples</a>. Currently
+     PDO drivers are not as powerful as native drivers, and should be treated
+     as experimental.<a name=php5iterators></a></li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l11 level1 lfo5;tab-stops:list 36.0pt'><b>Foreach iterators</b>:
+     This is a very natural way of going through a recordset: </li>
+</ul>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE;
+margin-left:36.0pt;margin-right:0cm'><pre style='background:#EEEEEE'><span
+style='mso-tab-count:1'> </span>$ADODB_FETCH_MODE = ADODB_FETCH_NUM;<br>
+<span style='mso-tab-count:1'> </span>$rs = $db-&gt;Execute($sql);<br>
+<span style='mso-tab-count:1'> </span>foreach($rs as $k =&gt; $row) {<br>
+<span style='mso-tab-count:2'> </span>echo &quot;r1=&quot;.$row[0].&quot; r2=&quot;.$row[1].&quot;&lt;br&gt;&quot;;<br>
+<span style='mso-tab-count:1'> </span>}</pre></div>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l11 level1 lfo5;tab-stops:list 36.0pt'><a name=php5exceptions></a><b>Exceptions</b>:
+     Just include <i>adodb-exceptions.inc.php</i> and you can now catch
+     exceptions on errors as they occur. </li>
+</ul>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE;
+margin-left:36.0pt;margin-right:0cm'><pre style='background:#EEEEEE'><span
+style='mso-tab-count:1'> </span><b>include(&quot;../adodb-exceptions.inc.php&quot;);</b> <br>
+<span style='mso-tab-count:1'> </span>include(&quot;../adodb.inc.php&quot;);<span
+style='mso-tab-count:1'> </span> <br>
+<span style='mso-tab-count:1'> </span>try { <br>
+<span style='mso-tab-count:2'> </span>$db = NewADOConnection(&quot;oci8&quot;); <br>
+<span style='mso-tab-count:2'> </span>$db-&gt;Connect('','scott','bad-password'); <br>
+<span style='mso-tab-count:1'> </span>} catch (exception $e) { <br>
+<span style='mso-tab-count:2'> </span>var_dump($e); <br>
+<span style='mso-tab-count:2'> </span>adodb_backtrace($e-&gt;gettrace());<br>
+<span style='mso-tab-count:1'> </span>} </pre></div>
+
+<p style='margin-left:36.0pt'>Note that reaching EOF is <b>not</b> considered
+an error nor an exception. </p>
+
+<h3><a name=drivers></a>Databases Supported</h3>
+
+<p class=MsoNormal>The <i>name</i> below is the value you pass to
+NewADOConnection($name) to create a connection object for that database. </p>
+
+<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
+ style='width:100.0%;mso-cellspacing:1.5pt'>
+ <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b>Name</b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b>Tested</b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b>Database</b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>RecordCount() usable</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b>Prerequisites</b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b>Operating Systems</b></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:1'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>access</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>B</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Microsoft Access/Jet. You
+  need to create an ODBC DSN.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>ODBC </span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Windows only</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:2'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>ado</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>B</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p><span style='font-size:10.0pt'>Generic <st1:City w:st="on"><st1:place
+   w:st="on">ADO</st1:place></st1:City>, not tuned for specific databases.
+  Allows DSN-less connections. For best performance, use an OLEDB provider.
+  This is the base class for all ado drivers.</span></p>
+  <p><span style='font-size:10.0pt'>You can set $db-&gt;codePage before
+  connecting.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>? depends on database</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><st1:City w:st="on"><st1:place w:st="on"><span
+    style='font-size:10.0pt'>ADO</span></st1:place></st1:City><span
+  style='font-size:10.0pt'> or OLEDB provider</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Windows only</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:3'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>ado_access</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>B</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Microsoft Access/Jet using <st1:City
+  w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>. Allows DSN-less
+  connections. For best performance, use an OLEDB provider.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><st1:City w:st="on"><st1:place w:st="on"><span
+    style='font-size:10.0pt'>ADO</span></st1:place></st1:City><span
+  style='font-size:10.0pt'> or OLEDB provider</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Windows only</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:4'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>ado_mssql</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>B</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Microsoft SQL Server using <st1:City
+  w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>. Allows DSN-less
+  connections. For best performance, use an OLEDB provider.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><st1:City w:st="on"><st1:place w:st="on"><span
+    style='font-size:10.0pt'>ADO</span></st1:place></st1:City><span
+  style='font-size:10.0pt'> or OLEDB provider</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Windows only</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:5;height:40.5pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>db2</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Uses PHP's db2-specific
+  extension for better performance.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>DB2 CLI/ODBC interface</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows. Requires IBM DB2
+  Universal Database client.</span></p>
+  </td>
+ </tr>
  
-	  
-  <tr valign="top"> 
-    <td><b><font size="2">sybase</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Sybase. </font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Sybase client</font></td>
-    <td> <p><font size="2">Unix and Windows.</font></p></td>
-  </tr>
-  
-    <tr valign="top"> 
-    <td><b><font size="2">sybase_ase</font></b></td>
-    <td><font size="2">C</font></td>
-    <td><font size="2">Sybase ASE. </font></td>
-    <td><font size="2">Y/N</font></td>
-    <td><font size="2">Sybase client</font></td>
-    <td> <p><font size="2">Unix and Windows.</font></p></td>
-  </tr>
-  </tbody></table>
-
-<p></p><p>The "Tested" column indicates how extensively the code has been tested 
-  and used. <br>
-  A = well tested and used by many people<br>
-  B = tested and usable, but some features might not be implemented<br>
-  C = user contributed or experimental driver. Might not fully support all of 
-  the latest features of ADOdb. </p>
-<p>The column "RecordCount() usable" indicates whether RecordCount() 
-  return the number of rows, or returns -1 when a SELECT statement is executed. 
-  If this column displays Y/N then the RecordCount() is emulated when the global 
-  variable $ADODB_COUNTRECS=true (this is the default). Note that for large recordsets, 
-  it might be better to disable RecordCount() emulation because substantial amounts 
-  of memory are required to cache the recordset for counting. Also there is a 
-  speed penalty of 40-50% if emulation is required. This is emulated in most databases 
-  except for PostgreSQL and MySQL. This variable is checked every time a query 
-  is executed, so you can selectively choose which recordsets to count.</p>
-<p> 
-</p><hr />
-<h1>Tutorials<a name="quickstart"></a></h1>
-<h3>Example 1: Select Statement<a name="ex1"></a></h3>
-<p>Task: Connect to the Access Northwind DSN, display the first 2 columns of each 
-  row.</p>
-<p>In this example, we create a ADOConnection object, which represents the connection 
-  to the database. The connection is initiated with <a href="#pconnect"><font face="Courier New, Courier, mono">PConnect</font></a>, 
-  which is a persistent connection. Whenever we want to query the database, we 
-  call the <font face="Courier New, Courier, mono">ADOConnection.<a href="#execute">Execute</a>()</font> 
-  function. This returns an ADORecordSet object which is actually a cursor that 
-  holds the current row in the array <font face="Courier New, Courier, mono">fields[]</font>. 
-  We use <font face="Courier New, Courier, mono"><a href="#movenext">MoveNext</a>()</font> 
-  to move from row to row.</p>
-<p>NB: A useful function that is not used in this example is <font face="Courier New, Courier, mono"><a href="#selectlimit">SelectLimit</a></font>, 
-  which allows us to limit the number of rows shown. 
-</p><pre>&lt;?<br><font face="Courier New, Courier, mono"><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> =ADONewConnection('access');	# create a connection<br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind DSN<br>$<font color="#660000">recordSet</font> =$<font color="#660000">conn</font>-&gt;Execute('select * from products');<br>if (!$<font color="#660000">recordSet</font>) <br>	print $<font color="#660000">conn</font>-&gt;ErrorMsg();<br>else<br><b>while</b> (!$<font color="#660000">recordSet</font>-&gt;EOF) {<br>	<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.$<font color="#660000">recordSet</font>-&gt;fields[1].'&lt;BR&gt;';<br>	$<font color="#660000">recordSet</font>-&gt;MoveNext();<br>}</font><font face="Courier New, Courier, mono">
-
-$<font color="#660000">recordSet</font>-&gt;Close(); # optional<br>$<font color="#660000">conn</font>-&gt;Close(); # optional<br></font>
-?&gt;
-</pre>
-<p>The $<font face="Courier New, Courier, mono">recordSet</font> returned stores 
-  the current row in the <font face="Courier New, Courier, mono">$recordSet-&gt;fields</font> 
-  array, indexed by column number (starting from zero). We use the <font face="Courier New, Courier, mono"><a href="#movenext">MoveNext</a>()</font> 
-  function to move to the next row. The <font face="Courier New, Courier, mono">EOF</font> 
-  property is set to true when end-of-file is reached. If an error occurs in Execute(), 
-  we return false instead of a recordset.</p>
-<p>The <code>$recordSet-&gt;fields[]</code> array is generated by the PHP database 
-  extension. Some database extensions only index by number and do not index the 
-  array by field name. To force indexing by name - that is associative arrays 
-  - use the SetFetchMode function. Each recordset saves and uses whatever fetch 
-  mode was set when the recordset was created in Execute() or SelectLimit(). 
-</p><pre>	$db-&gt;SetFetchMode(ADODB_FETCH_NUM);<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$db-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=gt;'v0',[1] =gt;'v1')</i>
-	print_r($rs2-&gt;fields); # shows <i>array(['col1']=gt;'v0',['col2'] =gt;'v1')</i>
-</pre>
-<p> </p>
-<p>To get the number of rows in the select statement, you can use <font face="Courier New, Courier, mono">$recordSet-&gt;<a href="#recordcount">RecordCount</a>()</font>. 
-  Note that it can return -1 if the number of rows returned cannot be determined.</p>
-<h3>Example 2: Advanced Select with Field Objects<a name="ex2"></a></h3>
-<p>Select a table, display the first two columns. If the second column is a date 
-  or timestamp, reformat the date to US format.</p>
-<pre>&lt;?<br><font face="Courier New, Courier, mono"><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> =ADONewConnection('access');	# create a connection<br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br>$<font color="#660000">recordSet</font> =$<font color="#660000">conn</font>-&gt;Execute('select CustomerID,OrderDate from Orders');<br>if (!$<font color="#660000">recordSet</font>) <br>	print $<font color="#660000">conn</font>-&gt;ErrorMsg();<br>else<br><b>while</b> (!$<font color="#660000">recordSet</font>-&gt;EOF) {<br>	$<font color="#660000">fld</font> = <font color="#336600"><b>$</b><font color="#660000">recordSet</font><b>-&gt;FetchField</b></font><font color="#006600">(</font>1<font color="#006600">);</font>
-	$<font color="#660000">type</font> = <font color="#336600"><b>$</b><font color="#660000">recordSet</font><b>-&gt;MetaType</b></font>($fld-&gt;type);<br><br>	<b>if</b> ( $<font color="#660000">type</font> == 'D' || $<font color="#660000">type</font> == 'T') <br>		<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.<br>			<b><font color="#336600">$</font></b><font color="#660000">recordSet</font><b><font color="#336600">-&gt;UserDate</font></b>($<font color="#660000">recordSet</font>-&gt;fields[1],'<b>m/d/Y</b>').'&lt;BR&gt;';<br>	<b>else </b>
-		<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.$<font color="#660000">recordSet</font>-&gt;fields[1].'&lt;BR&gt;';<br><br>	$<font color="#660000">recordSet</font>-&gt;MoveNext();<br>}</font><font face="Courier New, Courier, mono">
-$<font color="#660000">recordSet</font>-&gt;Close(); # optional<br>$<font color="#660000">conn</font>-&gt;Close(); # optional<br></font>
-?&gt;
-</pre>
-<p>In this example, we check the field type of the second column using <font face="Courier New, Courier, mono"><a href="#fetchfield">FetchField</a>().</font> 
-  This returns an object with at least 3 fields.</p>
-<ul>
-  <li><b>name</b>: name of column</li>
-  <li> <b>type</b>: native field type of column</li>
-  <li> <b>max_length</b>: maximum length of field. Some databases such as MySQL 
-    do not return the maximum length of the field correctly. In these cases max_length 
-    will be set to -1.</li>
+ <tr style='mso-yfti-irow:5;height:40.5pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>db2oci</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Based on db2 driver. Allows use of oracle style :0, :1, :2 bind variables. Used with DB2 9.7 or later with PL/SQL mode turned on.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>DB2 CLI/ODBC interface</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows. Requires IBM DB2
+  Universal Database client.</span></p>
+  </td>
+ </tr>
+ 
+ <tr style='mso-yfti-irow:6;height:40.5pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>odbc_db2</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Connects to DB2 using
+  generic ODBC extension.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>DB2 CLI/ODBC interface</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows. <a
+  href="http://www.faqts.com/knowledge_base/view.phtml/aid/6283/fid/14">Unix
+  install hints</a>. I have had reports that the $host and $database params
+  have to be reversed in Connect() when using the CLI interface.</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:7'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>vfp</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Microsoft Visual FoxPro.
+  You need to create an ODBC DSN.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>ODBC</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Windows only</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:8'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>fbsql</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>FrontBase. </span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>?</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:9'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>ibase</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>B</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Interbase 6 or earlier.
+  Some users report you might need to use this<br>
+  $db-&gt;PConnect('localhost:c:/ibase/employee.gdb', &quot;sysdba&quot;,
+  &quot;masterkey&quot;) to connect. Lacks Affected_Rows currently.<br>
+  <br>
+  You can set $db-&gt;role, $db-&gt;dialect, $db-&gt;buffers and
+  $db-&gt;charSet before connecting.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Interbase client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:10'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><i><span style='font-size:10.0pt'>firebird</span></i></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Firebird version of
+  interbase.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Interbase client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:11'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><i><span style='font-size:10.0pt'>borland_ibase</span></i></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Borland version of
+  Interbase 6.5 or later. Very sad that the forks differ.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Interbase client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:12'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>informix</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Generic informix driver.
+  Use this if you are using Informix 7.3 or later.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Informix client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:13'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>informix72</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Informix databases before
+  Informix 7.3 that do no support SELECT FIRST.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Informix client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:14'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>ldap</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>LDAP driver. See this
+  example for usage information.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal>&nbsp;</p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>LDAP extension</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>?</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:15;height:54.75pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>mssql</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p><span style='font-size:10.0pt'>Microsoft SQL Server 7 and later. Works
+  with Microsoft SQL Server 2000 also. Note that date formating is problematic
+  with this driver. For example, the PHP mssql extension does not return the
+  seconds for datetime!</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Mssql client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows. <br>
+  <a href="http://phpbuilder.com/columns/alberto20000919.php3">Unix install
+  howto</a> and <a
+  href="http://linuxjournal.com/article.php?sid=6636&amp;mode=thread&amp;order=0">another
+  one</a>. </span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:16;height:54.75pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>mssqlpo</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p><span style='font-size:10.0pt'>Portable mssql driver. Identical to above mssql
+  driver, except that '||', the concatenation operator, is converted to '+'.
+  Useful for porting scripts from most other sql variants that use ||.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Mssql client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows. <a
+  href="http://phpbuilder.com/columns/alberto20000919.php3"><br>
+  Unix install howto</a>.</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:17;height:54.75pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>mssqlnative</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p><span style='font-size:10.0pt'>Native mssql driver from M'soft. </span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>?</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>?</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:54.75pt'>
+  <p><span style='font-size:10.0pt'>Windows. Tq Garrett Serack of M'soft.</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:18'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><o:p>&nbsp;</o:p></p>
+  </td>
+  <td style='border:none;padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt;color:windowtext'><o:p>&nbsp;</o:p></span></p>
+  </td>
+  <td style='border:none;padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt;color:windowtext'><o:p>&nbsp;</o:p></span></p>
+  </td>
+  <td style='border:none;padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt;color:windowtext'><o:p>&nbsp;</o:p></span></p>
+  </td>
+  <td style='border:none;padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt;color:windowtext'><o:p>&nbsp;</o:p></span></p>
+  </td>
+  <td style='border:none;padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt;color:windowtext'><o:p>&nbsp;</o:p></span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:19'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>mysql</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>MySQL without transaction
+  support. You can also set $db-&gt;clientFlags before connecting.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>MySQL client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:20'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>mysqlt</span></b><span
+  style='font-size:10.0pt'> or <b>maxsql</b></span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p><span style='font-size:10.0pt'>MySQL with transaction support. We
+  recommend using || as the concat operator for best portability. This can be
+  done by running MySQL using: <br>
+  <i>mysqld --ansi</i> or <i>mysqld --sql-mode=PIPES_AS_CONCAT</i></span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>MySQL client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:21'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>oci8</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Oracle 8/9. Has more
+  functionality than <i>oracle</i> driver (eg. Affected_Rows). You might have
+  to putenv('ORACLE_HOME=...') before Connect/PConnect. </span></p>
+  <p><span style='font-size:10.0pt'>There are 2 ways of connecting - with
+  server IP and service name: <br>
+  <i>PConnect('serverip:1521','scott','tiger','service'</i>)<br>
+  or using an entry in TNSNAMES.ORA or ONAMES or HOSTNAMES: <br>
+  <i>PConnect(false, 'scott', 'tiger', $oraname)</i>. </span></p>
+  <p><span style='font-size:10.0pt'>Since 2.31, we support Oracle REF cursor
+  variables directly (see <a href="#executecursor">ExecuteCursor</a>).</span> </p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Oracle client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:22'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>oci805</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Supports reduced Oracle
+  functionality for Oracle 8.0.5. SelectLimit is not as efficient as in the
+  oci8 or oci8po drivers.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Oracle client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:23'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>oci8po</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Oracle 8/9 portable driver.
+  This is nearly identical with the oci8 driver except (a) bind variables in
+  Prepare() use the ? convention, instead of :bindvar, (b) field names use the
+  more common PHP convention of lowercase names. </span></p>
+  <p><span style='font-size:10.0pt'>Use this driver if porting from other
+  databases is important. Otherwise the oci8 driver offers better performance. </span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Oracle client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:24'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>odbc</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Generic ODBC, not tuned for
+  specific databases. To connect, use <br>
+  PConnect('DSN','user','pwd'). This is the base class for all odbc derived
+  drivers.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>? depends on database</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>ODBC</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows. <a
+  href="http://phpbuilder.com/columns/alberto20000919.php3?page=4">Unix hints.</a></span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:25'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>odbc_mssql</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Uses ODBC to connect to
+  MSSQL</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>ODBC</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows. </span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:26'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>odbc_oracle</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Uses ODBC to connect to
+  Oracle</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>ODBC</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows. </span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:27'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>odbtp</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Generic odbtp driver. <a
+  href="http://odbtp.sourceforge.net/">Odbtp</a> is a software for accessing
+  Windows ODBC data sources from other operating systems.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>odbtp</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:28'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>odbtp_unicode</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Odtbp with unicode support</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>odbtp</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:29;height:25.5pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>oracle</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Implements old Oracle 7
+  client API. Use oci8 driver if possible for better performance.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Oracle client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:30;height:25.5pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>netezza</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Netezza driver. Netezza is
+  based on postgres code-base.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>?</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:25.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>?</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:31'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>pdo</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Generic PDO driver for
+  PHP5. </span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>PDO extension and database
+  specific drivers</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows. </span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:32'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>postgres</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Generic PostgreSQL driver.
+  Currently identical to postgres7 driver.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>PostgreSQL client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows. </span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:33'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>postgres64</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>For PostgreSQL 6.4 and
+  earlier which does not support LIMIT internally.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>PostgreSQL client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows. </span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:34'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>postgres7</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>PostgreSQL which supports
+  LIMIT and other version 7 functionality.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>PostgreSQL client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows. </span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:35'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>postgres8</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>A</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>PostgreSQL which supports
+  version 8 functionality.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>PostgreSQL client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Unix and Windows. </span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:36'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>sapdb</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>SAP DB. Should work
+  reliably as based on ODBC driver.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>SAP ODBC client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p><span style='font-size:10.0pt'>?</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:37'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>sqlanywhere</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Sybase SQL Anywhere. Should
+  work reliably as based on ODBC driver.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>SQL Anywhere ODBC client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p><span style='font-size:10.0pt'>?</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:38;height:40.5pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>sqlite</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>B</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>SQLite.</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>-</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows.</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:39;height:40.5pt'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>sqlitepo</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>B</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Portable SQLite driver. This
+  is because assoc mode does not work like other drivers in sqlite. Namely,
+  when selecting (joining) multiple tables, the table names are included in the
+  assoc keys in the &quot;sqlite&quot; driver.</span></p>
+  <p><span style='font-size:10.0pt'>In &quot;sqlitepo&quot; driver, the table
+  names are stripped from the returned column names. When this results in a
+  conflict, the first field get preference. </span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>-</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt;height:40.5pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows.</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:40'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>sybase</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Sybase. </span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Sybase client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows.</span></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:41;mso-yfti-lastrow:yes'>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><b><span style='font-size:10.0pt'>sybase_ase</span></b></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>C</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Sybase ASE. </span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Y/N</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Sybase client</span></p>
+  </td>
+  <td valign=top style='padding:.75pt .75pt .75pt .75pt'>
+  <p><span style='font-size:10.0pt'>Unix and Windows.</span></p>
+  </td>
+ </tr>
+</table>
+
+<p>The &quot;Tested&quot; column indicates how extensively the code has been
+tested and used. <br>
+A = well tested and used by many people<br>
+B = tested and usable, but some features might not be implemented<br>
+C = user contributed or experimental driver. Might not fully support all of the
+latest features of ADOdb. </p>
+
+<p>The column &quot;RecordCount() usable&quot; indicates whether RecordCount()
+return the number of rows, or returns -1 when a SELECT statement is executed.
+If this column displays Y/N then the RecordCount() is emulated when the global
+variable $ADODB_COUNTRECS=true (this is the default). Note that for large
+recordsets, it might be better to disable RecordCount() emulation because
+substantial amounts of memory are required to cache the recordset for counting.
+Also there is a speed penalty of 40-50% if emulation is required. This is
+emulated in most databases except for PostgreSQL and MySQL. This variable is
+checked every time a query is executed, so you can selectively choose which
+recordsets to count.</p>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h1>Tutorials<a name=quickstart></a></h1>
+
+<h3>Example 1: Select Statement<a name=ex1></a></h3>
+
+<p>Task: Connect to the Access Northwind DSN, display the first 2 columns of
+each row.</p>
+
+<p>In this example, we create a ADOConnection object, which represents the
+connection to the database. The connection is initiated with <a href="#pconnect"><span
+style='font-family:"Courier New"'>PConnect</span></a>, which is a persistent
+connection. Whenever we want to query the database, we call the <span
+style='font-family:"Courier New"'>ADOConnection.<a href="#execute">Execute</a>()</span>
+function. This returns an ADORecordSet object which is actually a cursor that
+holds the current row in the array <span style='font-family:"Courier New"'>fields[]</span>.
+We use <span style='font-family:"Courier New"'><a href="#movenext">MoveNext</a>()</span>
+to move from row to row.</p>
+
+<p>NB: A useful function that is not used in this example is <span
+style='font-family:"Courier New"'><a href="#selectlimit">SelectLimit</a></span>,
+which allows us to limit the number of rows shown. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>&lt;?<br>
+<b>include</b>('adodb.inc.php');<span style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span># load code common to ADOdb<br>
+$<span style='color:#660000'>conn</span> = &amp;ADONewConnection('access');<span
+style='mso-tab-count:1'> </span># create a connection<br>
+$<span style='color:#660000'>conn</span>-&gt;PConnect('northwind');<span style='mso-spacerun:yes'> </span># connect to MS-Access, northwind DSN<br>
+$<span style='color:#660000'>recordSet</span> = &amp;$<span style='color:#660000'>conn</span>-&gt;Execute('select * from products');<br>
+if (!$<span style='color:#660000'>recordSet</span>) <br>
+<span style='mso-tab-count:1'> </span>print $<span style='color:#660000'>conn</span>-&gt;ErrorMsg();<br>
+else<br>
+<b>while</b> (!$<span style='color:#660000'>recordSet</span>-&gt;EOF) {<br>
+<span style='mso-tab-count:1'> </span><b>print</b> $<span
+style='color:#660000'>recordSet</span>-&gt;fields[0].' '.$<span
+style='color:#660000'>recordSet</span>-&gt;fields[1].'&lt;BR&gt;';<br>
+<span style='mso-tab-count:1'> </span>$<span style='color:#660000'>recordSet</span>-&gt;MoveNext();<br>
+}</pre><pre><o:p>&nbsp;</o:p></pre><pre>$<span style='color:#660000'>recordSet</span>-&gt;Close(); # optional<br>
+$<span style='color:#660000'>conn</span>-&gt;Close(); # optional<br
+style='mso-special-character:line-break'>
+<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+<![endif]></pre><pre>?&gt;</pre></div>
+
+<p>The $<span style='font-family:"Courier New"'>recordSet</span> returned
+stores the current row in the <span style='font-family:"Courier New"'>$recordSet-&gt;fields</span>
+array, indexed by column number (starting from zero). We use the <span
+style='font-family:"Courier New"'><a href="#movenext">MoveNext</a>()</span>
+function to move to the next row. The <span style='font-family:"Courier New"'>EOF</span>
+property is set to true when end-of-file is reached. If an error occurs in
+Execute(), we return false instead of a recordset.</p>
+
+<p>The <code><span style='font-size:10.0pt'>$recordSet-&gt;fields[]</span></code>
+array is generated by the PHP database extension. Some database extensions only
+index by number and do not index the array by field name. To force indexing by
+name - that is associative arrays - use the SetFetchMode function. Each
+recordset saves and uses whatever fetch mode was set when the recordset was
+created in Execute() or SelectLimit(). </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;SetFetchMode(ADODB_FETCH_NUM);<br>
+<span style='mso-tab-count:1'> </span>$rs1 = $db-&gt;Execute('select * from table');<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>
+<span style='mso-tab-count:1'> </span>$rs2 = $db-&gt;Execute('select * from table');<br>
+<span style='mso-tab-count:1'> </span>print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i></pre><pre><span
+style='mso-tab-count:1'> </span>print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i></pre></div>
+
+<p>To get the number of rows in the select statement, you can use <span
+style='font-family:"Courier New"'>$recordSet-&gt;<a href="#recordcount">RecordCount</a>()</span>.
+Note that it can return -1 if the number of rows returned cannot be determined.</p>
+
+<h3>Example 2: Advanced Select with Field Objects<a name=ex2></a></h3>
+
+<p>Select a table, display the first two columns. If the second column is a
+date or timestamp, reformat the date to <st1:country-region w:st="on"><st1:place
+ w:st="on">US</st1:place></st1:country-region> format.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>&lt;?<br>
+<b>include</b>('adodb.inc.php');<span style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span># load code common to ADOdb<br>
+$<span style='color:#660000'>conn</span> = &amp;ADONewConnection('access');<span
+style='mso-tab-count:1'> </span># create a connection<br>
+$<span style='color:#660000'>conn</span>-&gt;PConnect('northwind');<span style='mso-spacerun:yes'> </span># connect to MS-Access, northwind dsn<br>
+$<span style='color:#660000'>recordSet</span> = &amp;$<span style='color:#660000'>conn</span>-&gt;Execute('select CustomerID,OrderDate from Orders');<br>
+if (!$<span style='color:#660000'>recordSet</span>) <br>
+<span style='mso-tab-count:1'> </span>print $<span style='color:#660000'>conn</span>-&gt;ErrorMsg();<br>
+else<br>
+<b>while</b> (!$<span style='color:#660000'>recordSet</span>-&gt;EOF) {<br>
+<span style='mso-tab-count:1'> </span>$<span style='color:#660000'>fld</span> = <b><span
+style='color:#336600'>$</span></b><span style='color:#660000'>recordSet</span><b><span
+style='color:#336600'>-&gt;FetchField</span></b><span style='color:#006600'>(</span>1<span
+style='color:#006600'>);</span></pre><pre><span style='mso-tab-count:1'> </span>$<span
+style='color:#660000'>type</span> = <b><span style='color:#336600'>$</span></b><span
+style='color:#660000'>recordSet</span><b><span style='color:#336600'>-&gt;MetaType</span></b>($fld-&gt;type);<br>
+<br>
+<span style='mso-tab-count:1'> </span><b>if</b> ( $<span
+style='color:#660000'>type</span> == 'D' || $<span style='color:#660000'>type</span> == 'T') <br>
+<span style='mso-tab-count:2'> </span><b>print</b> $<span
+style='color:#660000'>recordSet</span>-&gt;fields[0].' '.<br>
+<span style='mso-tab-count:3'> </span><b><span
+style='color:#336600'>$</span></b><span style='color:#660000'>recordSet</span><b><span
+style='color:#336600'>-&gt;UserDate</span></b>($<span style='color:#660000'>recordSet</span>-&gt;fields[1],'<b>m/d/Y</b>').'&lt;BR&gt;';<br>
+<span style='mso-tab-count:1'> </span><b>else </b></pre><pre><span
+style='mso-tab-count:2'> </span><b>print</b> $<span
+style='color:#660000'>recordSet</span>-&gt;fields[0].' '.$<span
+style='color:#660000'>recordSet</span>-&gt;fields[1].'&lt;BR&gt;';<br>
+<br>
+<span style='mso-tab-count:1'> </span>$<span style='color:#660000'>recordSet</span>-&gt;MoveNext();<br>
+}</pre><pre>$<span style='color:#660000'>recordSet</span>-&gt;Close(); # optional<br>
+$<span style='color:#660000'>conn</span>-&gt;Close(); # optional<br
+style='mso-special-character:line-break'>
+<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+<![endif]></pre><pre>?&gt;</pre></div>
+
+<p>In this example, we check the field type of the second column using <span
+style='font-family:"Courier New"'><a href="#fetchfield">FetchField</a>().</span>
+This returns an object with at least 3 fields.</p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l6 level1 lfo6;tab-stops:list 36.0pt'><b>name</b>: name of column</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l6 level1 lfo6;tab-stops:list 36.0pt'><b>type</b>: native field
+     type of column</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l6 level1 lfo6;tab-stops:list 36.0pt'><b>max_length</b>: maximum
+     length of field. Some databases such as MySQL do not return the maximum
+     length of the field correctly. In these cases max_length will be set to
+     -1.</li>
 </ul>
-<p>We then use <font face="Courier New, Courier, mono"><a href="#metatype">MetaType</a>()</font> 
-  to translate the native type to a <i>generic</i> type. Currently the following 
-  <i>generic</i> types are defined:</p>
-<ul>
-  <li><b>C</b>: character fields that should be shown in a &lt;input type="text"&gt; 
-    tag.</li>
-  <li><b>X</b>: TeXt, large text fields that should be shown in a &lt;textarea&gt;</li>
-  <li><b>B</b>: Blobs, or Binary Large Objects. Typically images. 
-  </li><li><b>D</b>: Date field</li>
-  <li><b>T</b>: Timestamp field</li>
-  <li><b>L</b>: Logical field (boolean or bit-field)</li>
-  <li><b>I</b>:&nbsp; Integer field</li>
-  <li><b>N</b>: Numeric field. Includes autoincrement, numeric, floating point, 
-    real and integer. </li>
-  <li><b>R</b>: Serial field. Includes serial, autoincrement integers. This works 
-    for selected databases. </li>
+
+<p>We then use <span style='font-family:"Courier New"'><a href="#metatype">MetaType</a>()</span>
+to translate the native type to a <i>generic</i> type. Currently the following <i>generic</i>
+types are defined:</p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>C</b>: character fields
+     that should be shown in a &lt;input type=&quot;text&quot;&gt; tag.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>X</b>: TeXt, large text
+     fields that should be shown in a &lt;textarea&gt;</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>B</b>: Blobs, or Binary
+     Large Objects. Typically images. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>D</b>: Date field</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>T</b>: Timestamp field</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>L</b>: Logical field
+     (boolean or bit-field)</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>I</b>:&nbsp; Integer
+     field</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>N</b>: Numeric field.
+     Includes autoincrement, numeric, floating point, real and integer. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l0 level1 lfo7;tab-stops:list 36.0pt'><b>R</b>: Serial field.
+     Includes serial, autoincrement integers. This works for selected
+     databases. </li>
 </ul>
-<p>If the metatype is of type date or timestamp, then we print it using the user 
-  defined date format with <font face="Courier New, Courier, mono"><a href="#userdate">UserDate</a>(),</font> 
-  which converts the PHP SQL date string format to a user defined one. Another 
-  use for <font face="Courier New, Courier, mono"><a href="#metatype">MetaType</a>()</font> 
-  is data validation before doing an SQL insert or update.</p>
-<h3>Example 3: Inserting<a name="ex3"></a></h3>
-<p>Insert a row to the Orders table containing dates and strings that need to 
-  be quoted before they can be accepted by the database, eg: the single-quote 
-  in the word <i>John's</i>.</p>
-<pre>&lt;?<br><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> =ADONewConnection('access');	# create a connection<br><br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br>$<font color="#660000">shipto</font> = <font color="#006600"><b>$conn-&gt;qstr</b></font>("<i>John's Old Shoppe</i>");<br><br>$<font color="#660000">sql</font> = "insert into orders (customerID,EmployeeID,OrderDate,ShipName) ";<br>$<font color="#660000">sql</font> .= "values ('ANATR',2,".<b><font color="#006600">$conn-&gt;DBDate(</font>time()<font color="#006600">)</font></b><font color="#006600">.</font>",$<font color="#660000">shipto</font>)";<br><br><b>if</b> ($<font color="#660000">conn</font>-&gt;Execute($<font color="#660000">sql</font>) <font color="#336600"><b>=== false</b></font>) {<br>	<b>print</b> 'error inserting: '.<font color="#336600"><b>$conn-&gt;ErrorMsg()</b></font>.'&lt;BR&gt;';<br>}<br>?&gt;<br></pre>
-<p>In this example, we see the advanced date and quote handling facilities of 
-  ADOdb. The unix timestamp (which is a long integer) is appropriately formated 
-  for Access with <font face="Courier New, Courier, mono"><a href="#dbdate">DBDate</a>()</font>, 
-  and the right escape character is used for quoting the <i>John's Old Shoppe</i>, 
-  which is<b> </b><i>John'<b>'</b>s Old Shoppe</i> and not PHP's default <i>John<b>'</b>s 
-  Old Shoppe</i> with <font face="Courier New, Courier, mono"><a href="#qstr">qstr</a>()</font>. 
+
+<p>If the metatype is of type date or timestamp, then we print it using the
+user defined date format with <span style='font-family:"Courier New"'><a
+href="#userdate">UserDate</a>(),</span> which converts the PHP SQL date string
+format to a user defined one. Another use for <span style='font-family:"Courier New"'><a
+href="#metatype">MetaType</a>()</span> is data validation before doing an SQL
+insert or update.</p>
+
+<h3>Example 3: Inserting<a name=ex3></a></h3>
+
+<p>Insert a row to the Orders table containing dates and strings that need to
+be quoted before they can be accepted by the database, eg: the single-quote in
+the word <i>John's</i>.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>&lt;?<br>
+<b>include</b>('adodb.inc.php');<span style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span># load code common to ADOdb<br>
+$<span style='color:#660000'>conn</span> = &amp;ADONewConnection('access');<span
+style='mso-tab-count:1'> </span># create a connection<br>
+<br>
+$<span style='color:#660000'>conn</span>-&gt;PConnect('northwind');<span style='mso-spacerun:yes'> </span># connect to MS-Access, northwind dsn<br>
+$<span style='color:#660000'>shipto</span> = <b><span style='color:#006600'>$conn-&gt;qstr</span></b>(&quot;<i>John's Old Shoppe</i>&quot;);<br>
+<br>
+$<span style='color:#660000'>sql</span> = &quot;insert into orders (customerID,EmployeeID,OrderDate,ShipName) &quot;;<br>
+$<span style='color:#660000'>sql</span> .= &quot;values ('ANATR',2,&quot;.<b><span
+style='color:#006600'>$conn-&gt;DBDate(</span>time()</b><b><span
+style='color:#006600'>)</span></b><span style='color:#006600'>.</span>&quot;,$<span
+style='color:#660000'>shipto</span>)&quot;;<br>
+<br>
+<b>if</b> ($<span style='color:#660000'>conn</span>-&gt;Execute($<span
+style='color:#660000'>sql</span>) <b><span style='color:#336600'>=== false</span></b>) {<br>
+<span style='mso-tab-count:1'> </span><b>print</b> 'error inserting: '.<b><span
+style='color:#336600'>$conn-&gt;ErrorMsg()</span></b>.'&lt;BR&gt;';<br>
+}<br>
+?&gt;</pre></div>
+
+<p>In this example, we see the advanced date and quote handling facilities of
+ADOdb. The unix timestamp (which is a long integer) is appropriately formated
+for Access with <span style='font-family:"Courier New"'><a href="#dbdate">DBDate</a>()</span>,
+and the right escape character is used for quoting the <i>John's Old Shoppe</i>,
+which is<b> </b><i>John'<b>'</b>s Old Shoppe</i> and not PHP's default <i>John<b>'</b>s
+Old Shoppe</i> with <span style='font-family:"Courier New"'><a href="#qstr">qstr</a>()</span>.
 </p>
-<p>Observe the error-handling of the Execute statement. False is returned by<font face="Courier New, Courier, mono"> 
-  <a href="#execute">Execute</a>() </font>if an error occured. The error message 
-  for the last error that occurred is displayed in <font face="Courier New, Courier, mono"><a href="#errormsg">ErrorMsg</a>()</font>. 
-  Note: <i>php_track_errors</i> might have to be enabled for error messages to 
-  be saved.</p>
-<h3> Example 4: Debugging<a name="ex4"></a></h3>
-<pre>&lt;?<br><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#663300">conn</font> =ADONewConnection('access');	# create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br><font>$<font color="#663300">shipto</font> = <b>$conn-&gt;qstr</b>("John's Old Shoppe");<br>$<font color="#663300">sql</font> = "insert into orders (customerID,EmployeeID,OrderDate,ShipName) ";<br>$<font color="#663300">sql</font> .= "values ('ANATR',2,".$<font color="#663300">conn</font>-&gt;FormatDate(time()).",$shipto)";<br><b><font color="#336600">$<font color="#663300">conn</font>-&gt;debug = true;</font></b>
-<b>if</b> ($<font color="#663300">conn</font>-&gt;Execute($sql) <b>=== false</b>) <b>print</b> 'error inserting';</font>
-?&gt;
-</pre>
-<p>In the above example, we have turned on debugging by setting <b>debug = true</b>. 
-  This will display the SQL statement before execution, and also show any error 
-  messages. There is no need to call <font face="Courier New, Courier, mono"><a href="#errormsg">ErrorMsg</a>()</font> 
-  in this case. For displaying the recordset, see the <font face="Courier New, Courier, mono"><a href="#exrs2html">rs2html</a>() 
-  </font>example.</p>
+
+<p>Observe the error-handling of the Execute statement. False is returned by<span
+style='font-family:"Courier New"'> <a href="#execute">Execute</a>() </span>if
+an error occured. The error message for the last error that occurred is
+displayed in <span style='font-family:"Courier New"'><a href="#errormsg">ErrorMsg</a>()</span>.
+Note: <i>php_track_errors</i> might have to be enabled for error messages to be
+saved.</p>
+
+<h3>Example 4: Debugging<a name=ex4></a></h3>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>&lt;?<br>
+<b>include</b>('adodb.inc.php');<span style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span># load code common to ADOdb<br>
+$<span style='color:#663300'>conn</span> = &amp;ADONewConnection('access');<span
+style='mso-tab-count:1'> </span># create a connection<br>
+$<span style='color:#663300'>conn</span>-&gt;PConnect('northwind');<span style='mso-spacerun:yes'> </span># connect to MS-Access, northwind dsn<br>
+$<span style='color:#663300'>shipto</span> = <b>$conn-&gt;qstr</b>(&quot;John's Old Shoppe&quot;);<br>
+$<span style='color:#663300'>sql</span> = &quot;insert into orders (customerID,EmployeeID,OrderDate,ShipName) &quot;;<br>
+$<span style='color:#663300'>sql</span> .= &quot;values ('ANATR',2,&quot;.$<span
+style='color:#663300'>conn</span>-&gt;FormatDate(time()).&quot;,$shipto)&quot;;<br>
+<b><span style='color:#336600'>$</span></b><b><span style='color:#663300'>conn</span></b><b><span
+style='color:#336600'>-&gt;debug = true;</span></b></pre><pre><b>if</b> ($<span
+style='color:#663300'>conn</span>-&gt;Execute($sql) <b>=== false</b>) <b>print</b> 'error inserting';</pre><pre>?&gt;</pre></div>
+
+<p>In the above example, we have turned on debugging by setting <b>debug = true</b>.
+This will display the SQL statement before execution, and also show any error
+messages. There is no need to call <span style='font-family:"Courier New"'><a
+href="#errormsg">ErrorMsg</a>()</span> in this case. For displaying the
+recordset, see the <span style='font-family:"Courier New"'><a href="#exrs2html">rs2html</a>()
+</span>example.</p>
+
 <p>Also see the section on <a href="#errorhandling">Custom Error Handlers</a>.</p>
-<h3>Example 5: MySQL and Menus<a name="ex5"></a></h3>
-<p>Connect to MySQL database <i>agora</i>, and generate a &lt;select&gt; menu 
-  from an SQL statement where the &lt;option&gt; captions are in the 1st column, 
-  and the value to send back to the server is in the 2nd column.</p>
-<pre>&lt;?<br><b>include</b>('adodb.inc.php'); # load code common to ADOdb<br>$<font color="#663300">conn</font> =ADONewConnection('mysql');  # create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br><font>$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers';<br>$<font color="#663300">rs</font> = $<font color="#663300">conn</font>-&gt;Execute($sql);<br><b>print</b> <b><font color="#336600">$<font color="#663300">rs</font>-&gt;GetMenu('GetCust','Mary Rosli');<br>?&gt;</font></b></font></pre>
-<p>Here we define a menu named GetCust, with the menu option 'Mary Rosli' selected. 
-  See <a href="#getmenu"><font face="Courier New, Courier, mono">GetMenu</font></a><font face="Courier New, Courier, mono">()</font>. 
-  We also have functions that return the recordset as an array: <font face="Courier New, Courier, mono"><a href="#getarray">GetArray</a>()</font>, 
-  and as an associative array with the key being the first column: <a href="#getassoc1">GetAssoc</a>().</p>
-<h3>Example 6: Connecting to 2 Databases At Once<a name="ex6"></a></h3>
-<pre>&lt;?<br><b>include</b>('adodb.inc.php');	 # load code common to ADOdb<br>$<font color="#663300">conn1</font> =ADONewConnection('mysql');  # create a mysql connection<br>$<font color="#663300">conn2</font> =ADONewConnection('oracle');  # create a oracle connection<br><br>$conn1-&gt;PConnect($server, $userid, $password, $database);<br>$conn2-&gt;PConnect(false, $ora_userid, $ora_pwd, $oraname);<br><br>$conn1-&gt;Execute('insert ...');<br>$conn2-&gt;Execute('update ...');<br>?&gt;</pre>
-<p> 
-</p><h3>Example 7: Generating Update and Insert SQL<a name="ex7"></a></h3>
-<p>Since ADOdb 4.56, we support <a href="reference.functions.getupdatesql.html#autoexecute">AutoExecute()</a>, 
-which simplifies things by providing an advanced wrapper for GetInsertSQL() and GetUpdateSQL(). For example,
-an INSERT can be carried out with:
 
-<pre>
-    $record["firstname"] = "Bob"; 
-    $record["lastname"] = "Smith"; 
-    $record["created"] = time(); 
-    $insertSQL = $conn->AutoExecute($rs, $record, 'INSERT'); 
-</pre>
+<h3>Example 5: MySQL and Menus<a name=ex5></a></h3>
 
-and an UPDATE with:
-<pre>
-    $record["firstname"] = "Caroline"; 
-    $record["lastname"] = "Smith"; # Update Caroline's lastname from Miranda to Smith 
-    $insertSQL = $conn->AutoExecute($rs, $record, 'UPDATE', 'id = 1'); 
-</pre>
-<p>
-The rest of this section is out-of-date:
-<p>ADOdb 1.31 and later supports two new recordset functions: GetUpdateSQL( ) and 
-GetInsertSQL( ). This allow you to perform a "SELECT * FROM table query WHERE...", 
-make a copy of the $rs-&gt;fields, modify the fields, and then generate the SQL to 
-update or insert into the table automatically. 
-<p> We show how the functions can be used when accessing a table with the following 
-  fields: (ID, FirstName, LastName, Created). 
-</p><p> Before these functions can be called, you need to initialize the recordset 
-  by performing a select on the table. Idea and code by Jonathan Younger jyounger#unilab.com. 
- Since ADOdb 2.42, you can pass a  table name instead of a recordset into 
-GetInsertSQL (in $rs), and it will generate an insert statement for that table.
-</p><p> 
-</p><pre>&lt;?<br>#==============================================<br># SAMPLE GetUpdateSQL() and GetInsertSQL() code<br>#==============================================<br>include('adodb.inc.php');<br>include('tohtml.inc.php');<br><br>#==========================<br># This code tests an insert<br><br>$sql = "SELECT * FROM ADOXYZ WHERE id = -1"; <br># Select an empty record from the database<br><br>$conn =ADONewConnection("mysql");  # create a connection<br>$conn-&gt;debug=1;<br>$conn-&gt;PConnect("localhost", "admin", "", "test"); # connect to MySQL, testdb<br>$rs = $conn-&gt;Execute($sql); # Execute the query and get the empty recordset<br><br>$record = array(); # Initialize an array to hold the record data to insert<br><br># Set the values for the fields in the record<br># Note that field names are case-insensitive<br>$record["firstname"] = "Bob";<br>$record["lastNamE"] = "Smith";<br>$record["creaTed"] = time();<br><br># Pass the empty recordset and the array containing the data to insert<br># into the GetInsertSQL function. The function will process the data and return<br># a fully formatted insert sql statement.<br>$insertSQL = $conn-&gt;GetInsertSQL($rs, $record);<br><br>$conn-&gt;Execute($insertSQL); # Insert the record into the database<br><br>#==========================<br># This code tests an update<br><br>$sql = "SELECT * FROM ADOXYZ WHERE id = 1"; <br># Select a record to update<br><br>$rs = $conn-&gt;Execute($sql); # Execute the query and get the existing record to update<br><br>$record = array(); # Initialize an array to hold the record data to update<br><br># Set the values for the fields in the record<br># Note that field names are case-insensitive<br>$record["firstname"] = "Caroline";<br>$record["LasTnAme"] = "Smith"; # Update Caroline's lastname from Miranda to Smith<br><br># Pass the single record recordset and the array containing the data to update<br># into the GetUpdateSQL function. The function will process the data and return<br># a fully formatted update sql statement with the correct WHERE clause.<br># If the data has not changed, no recordset is returned<br>$updateSQL = $conn-&gt;GetUpdateSQL($rs, $record);<br><br>$conn-&gt;Execute($updateSQL); # Update the record in the database<br>$conn-&gt;Close();<br>?&gt;<br></pre>
-<a name="ADODB_FORCE_TYPE"></a>
-<b>$ADODB_FORCE_TYPE</b><p>
-The behaviour of AutoExecute(), GetUpdateSQL() and GetInsertSQL()  
-when converting empty or null PHP variables to SQL is controlled by the
- global $ADODB_FORCE_TYPE variable. Set it to one of the values below. Default
-  is ADODB_FORCE_VALUE (3):
-</p><pre>0 = ignore empty fields. All empty fields in array are ignored.<br>1 = force null. All empty, php null and string 'null' fields are changed to sql NULL values.<br>2 = force empty. All empty, php null and string 'null' fields are changed to sql empty '' or 0 values.<br>3 = force value. Value is left as it is. Php null and string 'null' are set to sql NULL values and <br>    empty fields '' are set to empty '' sql values.<br><br>define('ADODB_FORCE_IGNORE',0);<br>define('ADODB_FORCE_NULL',1);<br>define('ADODB_FORCE_EMPTY',2);<br>define('ADODB_FORCE_VALUE',3);<br></pre>
-<p>
-Thanks to Niko (nuko#mbnet.fi) for the $ADODB_FORCE_TYPE code.
-</p><p>
-Note: the constant ADODB_FORCE_NULLS is obsolete since 4.52 and is ignored. Set $ADODB_FORCE_TYPE = ADODB_FORCE_NULL
-for equivalent behaviour.
-<p>Since 4.62, the table name to be used can be overridden by setting $rs->tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is called.
-</p><h3>Example 8: Implementing Scrolling with Next and Previous<a name="ex8"></a></h3>
-<p> The following code creates a very simple recordset pager, where you can scroll 
-  from page to page of a recordset.</p>
-<pre>include_once('../adodb.inc.php');<br>include_once('../adodb-pager.inc.php');<br>session_start();<br><br>$db = NewADOConnection('mysql');<br><br>$db-&gt;Connect('localhost','root','','xphplens');<br><br>$sql = "select * from adoxyz ";<br><br>$pager = new ADODB_Pager($db,$sql);<br>$pager-&gt;Render($rows_per_page=5);</pre>
-<p>This will create a basic record pager that looks like this: <a name="scr"></a> 
-</p><p> 
-<table bgcolor="beige" border="1">
-  <tbody><tr> 
-    <td> <a href="#scr"><code>|&lt;</code></a> &nbsp; <a href="#scr"><code>&lt;&lt;</code></a> 
-      &nbsp; <a href="#scr"><code>&gt;&gt;</code></a> &nbsp; <a href="#scr"><code>&gt;|</code></a> 
-      &nbsp; </td>
-  </tr>
-  <tr>
-    <td><table bgcolor="white" border="1" cols="4" width="100%">
-        <tbody><tr><th>ID</th>
-        <th>First Name</th>
-        <th>Last Name</th>
-        <th>Date Created</th>
-        </tr><tr> 
-          <td align="right">36&nbsp;</td>
-          <td>Alan&nbsp;</td>
-          <td>Turing&nbsp;</td>
-          <td>Sat 06, Oct 2001&nbsp;</td>
-        </tr>
-        <tr> 
-          <td align="right">37&nbsp;</td>
-          <td>Serena&nbsp;</td>
-          <td>Williams&nbsp;</td>
-          <td>Sat 06, Oct 2001&nbsp;</td>
-        </tr>
-        <tr> 
-          <td align="right">38&nbsp;</td>
-          <td>Yat Sun&nbsp;</td>
-          <td>Sun&nbsp;</td>
-          <td>Sat 06, Oct 2001&nbsp;</td>
-        </tr>
-        <tr> 
-          <td align="right">39&nbsp;</td>
-          <td>Wai Hun&nbsp;</td>
-          <td>See&nbsp;</td>
-          <td>Sat 06, Oct 2001&nbsp;</td>
-        </tr>
-        <tr> 
-          <td align="right">40&nbsp;</td>
-          <td>Steven&nbsp;</td>
-          <td>Oey&nbsp;</td>
-          <td>Sat 06, Oct 2001&nbsp;</td>
-        </tr>
-      </tbody></table></td>
-  </tr>
-  <tr>
-    <td><font size="-1">Page 8/10</font></td>
-  </tr>
-</tbody></table>
-</p><p>The number of rows to display at one time is controled by the Render($rows) 
-  method. If you do not pass any value to Render(), ADODB_Pager will default to 
-  10 records per page. 
-</p><p>You can control the column titles by modifying your SQL (supported by most 
-  databases): 
-</p><pre>$sql = 'select id as "ID", firstname as "First Name", <br>		  lastname as "Last Name", created as "Date Created" <br>		from adoxyz';</pre>
-<p>The above code can be found in the <i>adodb/tests/testpaging.php</i> example 
-  included with this release, and the class ADODB_Pager in <i>adodb/adodb-pager.inc.php</i>. 
-  The ADODB_Pager code can be adapted by a programmer so that the text links can 
-  be replaced by images, and the dull white background be replaced with more interesting 
-  colors. 
-</p><p>You can also allow display of html by setting $pager-&gt;htmlSpecialChars = false. 
-</p><p>Some of the code used here was contributed by Iv&aacute;n Oliva and Cornel 
-  G. </p>
-<h3><a name="ex9"></a>Example 9: Exporting in CSV or Tab-Delimited Format</h3>
-<p>We provide some helper functions to export in comma-separated-value (CSV) and 
-  tab-delimited formats:</p>
-<pre><b>include_once('/path/to/adodb/toexport.inc.php');</b><br>include_once('/path/to/adodb/adodb.inc.php');<br>
-$db =NewADOConnection('mysql');<br>$db-&gt;Connect($server, $userid, $password, $database);<br><br>$rs = $db-&gt;Execute('select fname as "First Name", surname as "Surname" from table');<br><br>print "&lt;pre&gt;";<br>print <b>rs2csv</b>($rs); # return a string, CSV format<p>print '&lt;hr&gt;';<br><br>$rs-&gt;MoveFirst(); # note, some databases do not support MoveFirst<br>print <b>rs2tab</b>($rs,<i>false</i>); # return a string, tab-delimited<br>						 # false == suppress field names in first line</p>print '&lt;hr&gt;';<br>$rs-&gt;MoveFirst();<br><b>rs2tabout</b>($rs); # send to stdout directly (there is also an rs2csvout function)<br>print "&lt;/pre&gt;";<br><br>$rs-&gt;MoveFirst();<br>$fp = fopen($path, "w");<br>if ($fp) {<br>  <b>rs2csvfile</b>($rs, $fp); # write to file (there is also an rs2tabfile function)<br>  fclose($fp);<br>}<br></pre>
-<p> Carriage-returns or newlines are converted to spaces. Field names are returned 
-  in the first line of text. Strings containing the delimiter character are quoted 
-  with double-quotes. Double-quotes are double-quoted again. This conforms to 
-  Excel import and export guide-lines. 
-</p><p>All the above functions take as an optional last parameter, $addtitles which 
-  defaults to <i>true</i>. When set to <i>false</i> field names in the first line 
-  are suppressed. <br>
-</p><h3>Example 10: Recordset Filters<a name="ex10"></a></h3>
-<p>Sometimes we want to pre-process all rows in a recordset before we use it. 
-  For example, we want to ucwords all text in recordset. 
-</p><pre>include_once('adodb/rsfilter.inc.php');<br>include_once('adodb/adodb.inc.php');<br><br>// ucwords() every element in the recordset<br>function do_ucwords(&amp;$arr,$rs)<br>{<br>	foreach($arr as $k =gt; $v) {<br>		$arr[$k] = ucwords($v);<br>	}<br>}<br><br>$db = NewADOConnection('mysql');<br>$db-&gt;PConnect('server','user','pwd','db');<br><br>$rs = $db-&gt;Execute('select ... from table');<br>$rs = <b>RSFilter</b>($rs,'do_ucwords');<br></pre>
-<p>The <i>RSFilter</i> function takes 2 parameters, the recordset, and the name 
-  of the <i>filter</i> function. It returns the processed recordset scrolled to 
-  the first record. The <i>filter</i> function takes two parameters, the current 
-  row as an array, and the recordset object. For future compatibility, you should 
-  not use the original recordset object. </p>
-<h3>Example 11:<a name="ex11"></a> Smart Transactions</h3>
-The old way of doing transactions required you to use 
-<pre>$conn-&gt;<b>BeginTrans</b>();<br>$ok = $conn-&gt;Execute($sql);<br>if ($ok) $ok = $conn-&gt;Execute($sql2);<br>if (!$ok) $conn-&gt;<b>RollbackTrans</b>();<br>else $conn-&gt;<b>CommitTrans</b>();<br></pre>
-This is very complicated for large projects because you have to track the error 
-status. Smart Transactions is much simpler. You start a smart transaction by calling 
-StartTrans(): 
-<pre>$conn-&gt;<b>StartTrans</b>();<br>$conn-&gt;Execute($sql);<br>$conn-&gt;Execute($Sql2);<br>$conn-&gt;<b>CompleteTrans</b>();<br></pre>
-CompleteTrans() detects when an SQL error occurs, and will Rollback/Commit as 
-appropriate. To specificly force a rollback even if no error occured, use FailTrans(). 
-Note that the rollback is done in CompleteTrans(), and not in FailTrans(). 
-<pre>$conn-&gt;<b>StartTrans</b>();<br>$conn-&gt;Execute($sql);<br>if (!CheckRecords()) $conn-&gt;<strong>FailTrans</strong>();<br>$conn-&gt;Execute($Sql2);<br>$conn-&gt;<b>CompleteTrans</b>();<br></pre>
-<p>You can also check if a transaction has failed, using HasFailedTrans(), which 
-  returns true if FailTrans() was called, or there was an error in the SQL execution. 
-  Make sure you call HasFailedTrans() before you call CompleteTrans(), as it is 
-  only works between StartTrans/CompleteTrans.
-</p><p>Lastly, StartTrans/CompleteTrans is nestable, and only the outermost block 
-  is executed. In contrast, BeginTrans/CommitTrans/RollbackTrans is NOT nestable. 
-</p><pre>$conn-&gt;<strong>StartTrans</strong>();<br>$conn-&gt;Execute($sql);<br>  $conn-&gt;<strong>StartTrans</strong>();    <font color="#006600"># ignored</font>
-  if (!CheckRecords()) $conn-&gt;FailTrans();
-  $conn-&gt;<strong>CompleteTrans</strong>(); <font color="#006600"># ignored</font>
-$conn-&gt;Execute($Sql2);
-$conn-&gt;<strong>CompleteTrans</strong>();<br></pre>
-<p>Note: Savepoints are currently not supported. 
-</p><h2><a name="errorhandling"></a>Using Custom Error Handlers and PEAR_Error</h2>
-<p>ADOdb supports PHP5 exceptions.  Just include <i>adodb-exceptions.inc.php</i> and you can now 
-catch exceptions on errors as they occur.
-</p><pre>	<b>include("../adodb-exceptions.inc.php");</b> <br>	include("../adodb.inc.php");	 <br>	try { <br>		$db = NewADOConnection("oci8://scott:bad-password@mytns/"); <br>	} catch (exception $e) { <br>		var_dump($e); <br>		adodb_backtrace($e-&gt;gettrace());<br>	} <br></pre>
-<p> ADOdb also provides two custom handlers which you can modify for your needs. The 
-  first one is in the <b>adodb-errorhandler.inc.php</b> file. This makes use of 
-  the standard PHP functions <a href="http://php.net/error_reporting">error_reporting</a> 
-  to control what error messages types to display, and <a href="http://php.net/trigger_error">trigger_error</a> 
-  which invokes the default PHP error handler. 
-</p><p> Including the above file will cause <i>trigger_error($errorstring,E_USER_ERROR)</i> 
-  to be called when<br>
-  (a) Connect() or PConnect() fails, or <br>
-  (b) a function that executes SQL statements such as Execute() or SelectLimit() 
-  has an error.<br>
-  (c) GenID() appears to go into an infinite loop. 
-</p><p> The $errorstring is generated by ADOdb and will contain useful debugging information 
-  similar to the error.log data generated below. This file adodb-errorhandler.inc.php 
-  should be included before you create any ADOConnection objects. 
-</p><p> If you define error_reporting(0), no errors will be passed to the error handler. 
-  If you set error_reporting(E_ALL), all errors will be passed to the error handler. 
-  You still need to use <b>ini_set("display_errors", "0" or "1")</b> to control 
-  the display of errors. 
-</p><pre>&lt;?php<br><b>error_reporting(E_ALL); # pass any error messages triggered to error handler<br>include('adodb-errorhandler.inc.php');</b>
-include('adodb.inc.php');
-include('tohtml.inc.php');
-$c = NewADOConnection('mysql');
-$c-&gt;PConnect('localhost','root','','northwind');
-$rs=$c-&gt;Execute('select * from productsz'); #invalid table productsz');
-if ($rs) rs2html($rs);
-?&gt;
-</pre>
-<p> If you want to log the error message, you can do so by defining the following 
-  optional constants ADODB_ERROR_LOG_TYPE and ADODB_ERROR_LOG_DEST. ADODB_ERROR_LOG_TYPE 
-  is the error log message type (see <a href="http://php.net/error_log">error_log</a> 
-  in the PHP manual). In this case we set it to 3, which means log to the file 
-  defined by the constant ADODB_ERROR_LOG_DEST. 
-</p><pre>&lt;?php<br><b>error_reporting(E_ALL); # report all errors<br>ini_set("display_errors", "0"); # but do not echo the errors<br>define('ADODB_ERROR_LOG_TYPE',3);<br>define('ADODB_ERROR_LOG_DEST','C:/errors.log');<br>include('adodb-errorhandler.inc.php');</b>
-include('adodb.inc.php');
-include('tohtml.inc.php');
-
-$c = NewADOConnection('mysql');
-$c-&gt;PConnect('localhost','root','','northwind');
-$rs=$c-&gt;Execute('select * from productsz'); ## invalid table productsz
-if ($rs) rs2html($rs);
-?&gt;
-</pre>
-The following message will be logged in the error.log file: 
-<pre>(2001-10-28 14:20:38) mysql error: [1146: Table 'northwind.productsz' doesn't exist] in<br> EXECUTE("select * from productsz")<br></pre>
-<h3>PEAR_ERROR</h3>
-The second error handler is <b>adodb-errorpear.inc.php</b>. This will create a 
-PEAR_Error derived object whenever an error occurs. The last PEAR_Error object 
-created can be retrieved using ADODB_Pear_Error(). 
-<pre>&lt;?php<br><b>include('adodb-errorpear.inc.php');</b>
-include('adodb.inc.php');
-include('tohtml.inc.php');
-$c = NewADOConnection('mysql');
-$c-&gt;PConnect('localhost','root','','northwind');
-$rs=$c-&gt;Execute('select * from productsz'); #invalid table productsz');
-if ($rs) rs2html($rs);
-else {
-	<b>$e = ADODB_Pear_Error();<br>	echo '&lt;p&gt;',$e-&gt;message,'&lt;/p&gt;';</b>
-}
-?&gt;
-</pre>
-<p> You can use a PEAR_Error derived class by defining the constant ADODB_PEAR_ERROR_CLASS 
-  before the adodb-errorpear.inc.php file is included. For easy debugging, you 
-  can set the default error handler in the beginning of the PHP script to PEAR_ERROR_DIE, 
-  which will cause an error message to be printed, then halt script execution: 
-</p><pre>include('PEAR.php');<br>PEAR::setErrorHandling('PEAR_ERROR_DIE');<br></pre>
-<p> Note that we do not explicitly return a PEAR_Error object to you when an error 
-  occurs. We return false instead. You have to call ADODB_Pear_Error() to get 
-  the last error or use the PEAR_ERROR_DIE technique. 
+<p>Connect to MySQL database <i>agora</i>, and generate a &lt;select&gt; menu
+from an SQL statement where the &lt;option&gt; captions are in the 1st column,
+and the value to send back to the server is in the 2nd column.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>&lt;?<br>
+<b>include</b>('adodb.inc.php'); # load code common to ADOdb<br>
+$<span style='color:#663300'>conn</span> = &amp;ADONewConnection('mysql');<span style='mso-spacerun:yes'> </span># create a connection<br>
+$<span style='color:#663300'>conn</span>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br>
+$<span style='color:#663300'>sql</span> = 'select CustomerName, CustomerID from customers';<br>
+$<span style='color:#663300'>rs</span> = $<span style='color:#663300'>conn</span>-&gt;Execute($sql);<br>
+<b>print</b> <b><span style='color:#336600'>$</span></b><b><span
+style='color:#663300'>rs</span></b><b><span style='color:#336600'>-&gt;GetMenu('GetCust','Mary Rosli');<br>
+?&gt;</span></b></pre></div>
+
+<p>Here we define a menu named GetCust, with the menu option 'Mary Rosli'
+selected. See <a href="#getmenu"><span style='font-family:"Courier New"'>GetMenu</span></a><span
+style='font-family:"Courier New"'>()</span>. We also have functions that return
+the recordset as an array: <span style='font-family:"Courier New"'><a
+href="#getarray">GetArray</a>()</span>, and as an associative array with the
+key being the first column: <a href="#getassoc1">GetAssoc</a>().</p>
+
+<h3>Example 6: Connecting to 2 Databases At Once<a name=ex6></a></h3>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>&lt;?<br>
+<b>include</b>('adodb.inc.php');<span style='mso-tab-count:1'> </span> # load code common to ADOdb<br>
+$<span style='color:#663300'>conn1</span> = &amp;ADONewConnection('mysql');<span style='mso-spacerun:yes'> </span># create a mysql connection<br>
+$<span style='color:#663300'>conn2</span> = &amp;ADONewConnection('oracle');<span style='mso-spacerun:yes'> </span># create a oracle connection<br>
+<br>
+$conn1-&gt;PConnect($server, $userid, $password, $database);<br>
+$conn2-&gt;PConnect(false, $ora_userid, $ora_pwd, $oraname);<br>
+<br>
+$conn1-&gt;Execute('insert ...');<br>
+$conn2-&gt;Execute('update ...');<br>
+?&gt;</pre></div>
+
+<h3>Example 7: Generating Update and Insert SQL<a name=ex7></a></h3>
+
+<p>Since ADOdb 4.56, we support <a
+href="reference.functions.getupdatesql.html#autoexecute">AutoExecute()</a>,
+which simplifies things by providing an advanced wrapper for GetInsertSQL() and
+GetUpdateSQL(). For example, an INSERT can be carried out with: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'> </span>$record[&quot;firstname&quot;] = &quot;Bob&quot;; </pre><pre><span style='mso-spacerun:yes'></span>$record[&quot;lastname&quot;] = &quot;Smith&quot;; </pre><pre><span style='mso-spacerun:yes'></span>$record[&quot;created&quot;] = time(); </pre><pre><span style='mso-spacerun:yes'></span>$insertSQL = $conn-&gt;AutoExecute($rs, $record, 'INSERT'); </pre></div>
+
+<p class=MsoNormal>and an UPDATE with: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'> </span>$record[&quot;firstname&quot;] = &quot;Caroline&quot;; </pre><pre><span style='mso-spacerun:yes'></span>$record[&quot;lastname&quot;] = &quot;Smith&quot;; # Update Caroline's lastname from Miranda to Smith </pre><pre><span style='mso-spacerun:yes'></span>$insertSQL = $conn-&gt;AutoExecute($rs, $record, 'UPDATE', 'id = 1'); </pre></div>
+
+<p>The rest of this section is out-of-date: </p>
+
+<p>ADOdb 1.31 and later supports two new recordset functions: GetUpdateSQL( )
+and GetInsertSQL( ). This allow you to perform a &quot;SELECT * FROM table
+query WHERE...&quot;, make a copy of the $rs-&gt;fields, modify the fields, and
+then generate the SQL to update or insert into the table automatically. </p>
+
+<p>We show how the functions can be used when accessing a table with the
+following fields: (ID, FirstName, LastName, Created). </p>
+
+<p>Before these functions can be called, you need to initialize the recordset by
+performing a select on the table. Idea and code by Jonathan Younger
+jyounger#unilab.com. Since ADOdb 2.42, you can pass a table name instead of a
+recordset into GetInsertSQL (in $rs), and it will generate an insert statement
+for that table. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>&lt;?<br>
+#==============================================<br>
+# SAMPLE GetUpdateSQL() and GetInsertSQL() code<br>
+#==============================================<br>
+include('adodb.inc.php');<br>
+include('tohtml.inc.php');<br>
+<br>
+#==========================<br>
+# This code tests an insert<br>
+<br>
+$sql = &quot;SELECT * FROM ADOXYZ WHERE id = -1&quot;; <br>
+# Select an empty record from the database<br>
+<br>
+$conn = &amp;ADONewConnection(&quot;mysql&quot;);<span style='mso-spacerun:yes'> </span># create a connection<br>
+$conn-&gt;debug=1;<br>
+$conn-&gt;PConnect(&quot;localhost&quot;, &quot;admin&quot;, &quot;&quot;, &quot;test&quot;); # connect to MySQL, testdb<br>
+$rs = $conn-&gt;Execute($sql); # Execute the query and get the empty recordset<br>
+<br>
+$record = array(); # Initialize an array to hold the record data to insert<br>
+<br>
+# Set the values for the fields in the record<br>
+# Note that field names are case-insensitive<br>
+$record[&quot;firstname&quot;] = &quot;Bob&quot;;<br>
+$record[&quot;lastNamE&quot;] = &quot;Smith&quot;;<br>
+$record[&quot;creaTed&quot;] = time();<br>
+<br>
+# Pass the empty recordset and the array containing the data to insert<br>
+# into the GetInsertSQL function. The function will process the data and return<br>
+# a fully formatted insert sql statement.<br>
+$insertSQL = $conn-&gt;GetInsertSQL($rs, $record);<br>
+<br>
+$conn-&gt;Execute($insertSQL); # Insert the record into the database<br>
+<br>
+#==========================<br>
+# This code tests an update<br>
+<br>
+$sql = &quot;SELECT * FROM ADOXYZ WHERE id = 1&quot;; <br>
+# Select a record to update<br>
+<br>
+$rs = $conn-&gt;Execute($sql); # Execute the query and get the existing record to update<br>
+<br>
+$record = array(); # Initialize an array to hold the record data to update<br>
+<br>
+# Set the values for the fields in the record<br>
+# Note that field names are case-insensitive<br>
+$record[&quot;firstname&quot;] = &quot;Caroline&quot;;<br>
+$record[&quot;LasTnAme&quot;] = &quot;Smith&quot;; # Update Caroline's lastname from Miranda to Smith<br>
+<br>
+# Pass the single record recordset and the array containing the data to update<br>
+# into the GetUpdateSQL function. The function will process the data and return<br>
+# a fully formatted update sql statement with the correct WHERE clause.<br>
+# If the data has not changed, no recordset is returned<br>
+$updateSQL = $conn-&gt;GetUpdateSQL($rs, $record);<br>
+<br>
+$conn-&gt;Execute($updateSQL); # Update the record in the database<br>
+$conn-&gt;Close();<br>
+?&gt;</pre></div>
+
+<p class=MsoNormal><a name="ADODB_FORCE_TYPE"></a><b>$ADODB_FORCE_TYPE</b></p>
+
+<p>The behaviour of AutoExecute(), GetUpdateSQL() and GetInsertSQL() when
+converting empty or null PHP variables to SQL is controlled by the global
+$ADODB_FORCE_TYPE variable. Set it to one of the values below. Default is
+ADODB_FORCE_VALUE (3): </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>0 = ignore empty fields. All empty fields in array are ignored.<br>
+1 = force null. All empty, php null and string 'null' fields are changed to sql NULL values.<br>
+2 = force empty. All empty, php null and string 'null' fields are changed to sql empty '' or 0 values.<br>
+3 = force value. Value is left as it is. Php null and string 'null' are set to sql NULL values and <br>
+<span style='mso-spacerun:yes'> </span>empty fields '' are set to empty '' sql values.<br>
+<br>
+define('ADODB_FORCE_IGNORE',0);<br>
+define('ADODB_FORCE_NULL',1);<br>
+define('ADODB_FORCE_EMPTY',2);<br>
+define('ADODB_FORCE_VALUE',3);</pre></div>
+
+<p>Thanks to Niko (nuko#mbnet.fi) for the $ADODB_FORCE_TYPE code. </p>
+
+<p>Note: the constant ADODB_FORCE_NULLS is obsolete since 4.52 and is ignored.
+Set $ADODB_FORCE_TYPE = ADODB_FORCE_NULL for equivalent behaviour. </p>
+
+<p>Since 4.62, the table name to be used can be overridden by setting
+$rs-&gt;tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is
+called. </p>
+
+<h3>Example 8: Implementing Scrolling with Next and Previous<a name=ex8></a></h3>
+
+<p>The following code creates a very simple recordset pager, where you can
+scroll from page to page of a recordset.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>include_once('../adodb.inc.php');<br>
+include_once('../adodb-pager.inc.php');<br>
+session_start();<br>
+<br>
+$db = NewADOConnection('mysql');<br>
+<br>
+$db-&gt;Connect('localhost','root','','xphplens');<br>
+<br>
+$sql = &quot;select * from adoxyz &quot;;<br>
+<br>
+$pager = new ADODB_Pager($db,$sql);<br>
+$pager-&gt;Render($rows_per_page=5);</pre></div>
+
+<p>This will create a basic record pager that looks like this: <a name=scr></a></p>
+
+<table class=MsoNormalTable border=1 cellpadding=0 style='mso-cellspacing:1.5pt;
+ background:beige'>
+ <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><a href="#scr"><code><span style='font-size:10.0pt'>|&lt;</span></code></a>
+  &nbsp; <a href="#scr"><code><span style='font-size:10.0pt'>&lt;&lt;</span></code></a>
+  &nbsp; <a href="#scr"><code><span style='font-size:10.0pt'>&gt;&gt;</span></code></a>
+  &nbsp; <a href="#scr"><code><span style='font-size:10.0pt'>&gt;|</span></code></a>
+  &nbsp; </p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:1'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <table class=MsoNormalTable border=1 cellpadding=0 width="100%"
+   style='width:100.0%;mso-cellspacing:1.5pt;background:white' cols=4>
+   <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=center style='text-align:center'><b>ID<o:p></o:p></b></p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=center style='text-align:center'><b>First Name<o:p></o:p></b></p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=center style='text-align:center'><b>Last Name<o:p></o:p></b></p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=center style='text-align:center'><b>Date Created<o:p></o:p></b></p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:1'>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=right style='text-align:right'>36&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Alan&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Turing&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Sat 06, Oct 2001&nbsp;</p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:2'>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=right style='text-align:right'>37&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Serena&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Williams&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Sat 06, Oct 2001&nbsp;</p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:3'>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=right style='text-align:right'>38&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Yat Sun&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Sun&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Sat 06, Oct 2001&nbsp;</p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:4'>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=right style='text-align:right'>39&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Wai Hun&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>See&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Sat 06, Oct 2001&nbsp;</p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal align=right style='text-align:right'>40&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Steven&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Oey&nbsp;</p>
+    </td>
+    <td style='padding:.75pt .75pt .75pt .75pt'>
+    <p class=MsoNormal>Sat 06, Oct 2001&nbsp;</p>
+    </td>
+   </tr>
+  </table>
+  <p class=MsoNormal><o:p></o:p></p>
+  </td>
+ </tr>
+ <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
+  <td style='padding:.75pt .75pt .75pt .75pt'>
+  <p class=MsoNormal><span style='font-size:10.0pt'>Page 8/10</span></p>
+  </td>
+ </tr>
+</table>
+
+<p>The number of rows to display at one time is controled by the Render($rows)
+method. If you do not pass any value to Render(), ADODB_Pager will default to
+10 records per page. </p>
+
+<p>You can control the column titles by modifying your SQL (supported by most
+databases): </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$sql = 'select id as &quot;ID&quot;, firstname as &quot;First Name&quot;, <br>
+<span style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>lastname as &quot;Last Name&quot;, created as &quot;Date Created&quot; <br>
+<span style='mso-tab-count:2'> </span>from adoxyz';</pre></div>
+
+<p>The above code can be found in the <i>adodb/tests/testpaging.php</i> example
+included with this release, and the class ADODB_Pager in <i>adodb/adodb-pager.inc.php</i>.
+The ADODB_Pager code can be adapted by a programmer so that the text links can
+be replaced by images, and the dull white background be replaced with more
+interesting colors. </p>
+
+<p>You can also allow display of html by setting $pager-&gt;htmlSpecialChars =
+false. </p>
+
+<p>Some of the code used here was contributed by Ivn Oliva and Cornel G. </p>
+
+<h3><a name=ex9></a>Example 9: Exporting in CSV or Tab-Delimited Format</h3>
+
+<p>We provide some helper functions to export in comma-separated-value (CSV)
+and tab-delimited formats:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><b>include_once('/path/to/adodb/toexport.inc.php');</b><br>
+include_once('/path/to/adodb/adodb.inc.php');<br style='mso-special-character:
+line-break'>
+<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
+<![endif]></pre><pre style='background:#EEEEEE'>$db = &amp;NewADOConnection('mysql');<br>
+$db-&gt;Connect($server, $userid, $password, $database);<br>
+<br>
+$rs = $db-&gt;Execute('select fname as &quot;First Name&quot;, surname as &quot;Surname&quot; from table');<br>
+<br>
+print &quot;&lt;pre&gt;&quot;;<br>
+print <b>rs2csv</b>($rs); # return a string, CSV format</pre>
+
+<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
+background:#EEEEEE;border:none;mso-border-alt:solid #DDDDDD .75pt;padding:0cm;
+mso-padding-alt:9.0pt 18.0pt 9.0pt 18.0pt'><span style='font-size:9.0pt;
+font-family:"Courier New"'>print '&lt;hr&gt;';<br>
+<br>
+$rs-&gt;MoveFirst(); # note, some databases do not support MoveFirst<br>
+print <b>rs2tab</b>($rs,<i>false</i>); # return a string, tab-delimited<br>
+<span style='mso-tab-count:6'> </span><span
+style='mso-spacerun:yes'></span># false == suppress field names in first line<o:p></o:p></span></p>
+
+<pre style='background:#EEEEEE'>print '&lt;hr&gt;';<br>
+$rs-&gt;MoveFirst();<br>
+<b>rs2tabout</b>($rs); # send to stdout directly (there is also an rs2csvout function)<br>
+print &quot;&lt;/pre&gt;&quot;;<br>
+<br>
+$rs-&gt;MoveFirst();<br>
+$fp = fopen($path, &quot;w&quot;);<br>
+if ($fp) {<br>
+<span style='mso-spacerun:yes'> </span><b>rs2csvfile</b>($rs, $fp); # write to file (there is also an rs2tabfile function)<br>
+<span style='mso-spacerun:yes'> </span>fclose($fp);<br>
+}</pre></div>
+
+<p>Carriage-returns or newlines are converted to spaces. Field names are
+returned in the first line of text. Strings containing the delimiter character
+are quoted with double-quotes. Double-quotes are double-quoted again. This
+conforms to Excel import and export guide-lines. </p>
+
+<p>All the above functions take as an optional last parameter, $addtitles which
+defaults to <i>true</i>. When set to <i>false</i> field names in the first line
+are suppressed. </p>
+
+<h3>Example 10: Recordset Filters<a name=ex10></a></h3>
+
+<p>Sometimes we want to pre-process all rows in a recordset before we use it.
+For example, we want to ucwords all text in recordset. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>include_once('adodb/rsfilter.inc.php');<br>
+include_once('adodb/adodb.inc.php');<br>
+<br>
+// ucwords() every element in the recordset<br>
+function do_ucwords(&amp;$arr,$rs)<br>
+{<br>
+<span style='mso-tab-count:1'> </span>foreach($arr as $k =&gt; $v) {<br>
+<span style='mso-tab-count:2'> </span>$arr[$k] = ucwords($v);<br>
+<span style='mso-tab-count:1'> </span>}<br>
+}<br>
+<br>
+$db = NewADOConnection('mysql');<br>
+$db-&gt;PConnect('server','user','pwd','db');<br>
+<br>
+$rs = $db-&gt;Execute('select ... from table');<br>
+$rs = <b>RSFilter</b>($rs,'do_ucwords');</pre></div>
+
+<p>The <i>RSFilter</i> function takes 2 parameters, the recordset, and the name
+of the <i>filter</i> function. It returns the processed recordset scrolled to
+the first record. The <i>filter</i> function takes two parameters, the current
+row as an array, and the recordset object. For future compatibility, you should
+not use the original recordset object. </p>
+
+<h3>Example 11:<a name=ex11></a> Smart Transactions</h3>
+
+<p class=MsoNormal>The old way of doing transactions required you to use </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$conn-&gt;<b>BeginTrans</b>();<br>
+$ok = $conn-&gt;Execute($sql);<br>
+if ($ok) $ok = $conn-&gt;Execute($sql2);<br>
+if (!$ok) $conn-&gt;<b>RollbackTrans</b>();<br>
+else $conn-&gt;<b>CommitTrans</b>();</pre></div>
+
+<p class=MsoNormal>This is very complicated for large projects because you have
+to track the error status. Smart Transactions is much simpler. You start a
+smart transaction by calling StartTrans(): </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$conn-&gt;<b>StartTrans</b>();<br>
+$conn-&gt;Execute($sql);<br>
+$conn-&gt;Execute($Sql2);<br>
+$conn-&gt;<b>CompleteTrans</b>();</pre></div>
+
+<p class=MsoNormal>CompleteTrans() detects when an SQL error occurs, and will
+Rollback/Commit as appropriate. To specificly force a rollback even if no error
+occured, use FailTrans(). Note that the rollback is done in CompleteTrans(),
+and not in FailTrans(). </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$conn-&gt;<b>StartTrans</b>();<br>
+$conn-&gt;Execute($sql);<br>
+if (!CheckRecords()) $conn-&gt;<strong><span style='font-family:"Courier New"'>FailTrans</span></strong>();<br>
+$conn-&gt;Execute($Sql2);<br>
+$conn-&gt;<b>CompleteTrans</b>();</pre></div>
+
+<p>You can also check if a transaction has failed, using HasFailedTrans(),
+which returns true if FailTrans() was called, or there was an error in the SQL
+execution. Make sure you call HasFailedTrans() before you call CompleteTrans(),
+as it is only works between StartTrans/CompleteTrans. </p>
+
+<p>Lastly, StartTrans/CompleteTrans is nestable, and only the outermost block
+is executed. In contrast, BeginTrans/CommitTrans/RollbackTrans is NOT nestable.
 </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>$conn-&gt;<strong><span
+style='font-family:"Courier New"'>StartTrans</span></strong>();<br>
+$conn-&gt;Execute($sql);<br>
+<span style='mso-spacerun:yes'> </span>$conn-&gt;<strong><span
+style='font-family:"Courier New"'>StartTrans</span></strong>();<span style='mso-spacerun:yes'> </span><span
+style='color:#006600'># ignored</span></pre><pre><span style='mso-spacerun:yes'> </span>if (!CheckRecords()) $conn-&gt;FailTrans();</pre><pre><span style='mso-spacerun:yes'> </span>$conn-&gt;<strong><span
+style='font-family:"Courier New"'>CompleteTrans</span></strong>(); <span
+style='color:#006600'># ignored</span></pre><pre>$conn-&gt;Execute($Sql2);</pre><pre
+style='background:#EEEEEE'>$conn-&gt;<strong><span style='font-family:"Courier New"'>CompleteTrans</span></strong>();</pre></div>
+
+<p>Note: Savepoints are currently not supported. </p>
+
+<h2><a name=errorhandling></a>Using Custom Error Handlers and PEAR_Error</h2>
+
+<p>ADOdb supports PHP5 exceptions. Just include <i>adodb-exceptions.inc.php</i>
+and you can now catch exceptions on errors as they occur. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span><b>include(&quot;../adodb-exceptions.inc.php&quot;);</b> <br>
+<span style='mso-tab-count:1'> </span>include(&quot;../adodb.inc.php&quot;);<span
+style='mso-tab-count:1'> </span> <br>
+<span style='mso-tab-count:1'> </span>try { <br>
+<span style='mso-tab-count:2'> </span>$db = NewADOConnection(&quot;oci8://scott:bad-password@mytns/&quot;); <br>
+<span style='mso-tab-count:1'> </span>} catch (exception $e) { <br>
+<span style='mso-tab-count:2'> </span>var_dump($e); <br>
+<span style='mso-tab-count:2'> </span>adodb_backtrace($e-&gt;gettrace());<br>
+<span style='mso-tab-count:1'> </span>} </pre></div>
+
+<p>ADOdb also provides two custom handlers which you can modify for your needs.
+The first one is in the <b>adodb-errorhandler.inc.php</b> file. This makes use
+of the standard PHP functions <a href="http://php.net/error_reporting">error_reporting</a>
+to control what error messages types to display, and <a
+href="http://php.net/trigger_error">trigger_error</a> which invokes the default
+PHP error handler. </p>
+
+<p>Including the above file will cause <i>trigger_error($errorstring,E_USER_ERROR)</i>
+to be called when<br>
+(a) Connect() or PConnect() fails, or <br>
+(b) a function that executes SQL statements such as Execute() or SelectLimit()
+has an error.<br>
+(c) GenID() appears to go into an infinite loop. </p>
+
+<p>The $errorstring is generated by ADOdb and will contain useful debugging
+information similar to the error.log data generated below. This file
+adodb-errorhandler.inc.php should be included before you create any
+ADOConnection objects. </p>
+
+<p>If you define error_reporting(0), no errors will be passed to the error
+handler. If you set error_reporting(E_ALL), all errors will be passed to the
+error handler. You still need to use <b>ini_set(&quot;display_errors&quot;,
+&quot;0&quot; or &quot;1&quot;)</b> to control the display of errors. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>&lt;?php<br>
+<b>error_reporting(E_ALL); # pass any error messages triggered to error handler<br>
+include('adodb-errorhandler.inc.php');</b></pre><pre>include('adodb.inc.php');</pre><pre>include('tohtml.inc.php');</pre><pre>$c = NewADOConnection('mysql');</pre><pre>$c-&gt;PConnect('localhost','root','','northwind');</pre><pre>$rs=$c-&gt;Execute('select * from productsz'); #invalid table productsz');</pre><pre>if ($rs) rs2html($rs);</pre><pre>?&gt;</pre></div>
+
+<p>If you want to log the error message, you can do so by defining the
+following optional constants ADODB_ERROR_LOG_TYPE and ADODB_ERROR_LOG_DEST.
+ADODB_ERROR_LOG_TYPE is the error log message type (see <a
+href="http://php.net/error_log">error_log</a> in the PHP manual). In this case
+we set it to 3, which means log to the file defined by the constant
+ADODB_ERROR_LOG_DEST. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>&lt;?php<br>
+<b>error_reporting(E_ALL); # report all errors<br>
+ini_set(&quot;display_errors&quot;, &quot;0&quot;); # but do not echo the errors<br>
+define('ADODB_ERROR_LOG_TYPE',3);<br>
+define('ADODB_ERROR_LOG_DEST','C:/errors.log');<br>
+include('adodb-errorhandler.inc.php');</b></pre><pre>include('adodb.inc.php');</pre><pre>include('tohtml.inc.php');</pre><pre><o:p>&nbsp;</o:p></pre><pre>$c = NewADOConnection('mysql');</pre><pre>$c-&gt;PConnect('localhost','root','','northwind');</pre><pre>$rs=$c-&gt;Execute('select * from productsz'); ## invalid table productsz</pre><pre>if ($rs) rs2html($rs);</pre><pre>?&gt;</pre></div>
+
+<p class=MsoNormal>The following message will be logged in the error.log file: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>(2001-10-28 14:20:38) mysql error: [1146: Table 'northwind.productsz' doesn't exist] in<br>
+<span style='mso-spacerun:yes'></span>EXECUTE(&quot;select * from productsz&quot;)</pre></div>
+
+<h3>PEAR_ERROR</h3>
+
+<p class=MsoNormal>The second error handler is <b>adodb-errorpear.inc.php</b>.
+This will create a PEAR_Error derived object whenever an error occurs. The last
+PEAR_Error object created can be retrieved using ADODB_Pear_Error(). </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>&lt;?php<br>
+<b>include('adodb-errorpear.inc.php');</b></pre><pre>include('adodb.inc.php');</pre><pre>include('tohtml.inc.php');</pre><pre>$c = NewADOConnection('mysql');</pre><pre>$c-&gt;PConnect('localhost','root','','northwind');</pre><pre>$rs=$c-&gt;Execute('select * from productsz'); #invalid table productsz');</pre><pre>if ($rs) rs2html($rs);</pre><pre>else {</pre><pre><span
+style='mso-tab-count:1'> </span><b>$e = ADODB_Pear_Error();<br>
+<span style='mso-tab-count:1'> </span>echo '&lt;p&gt;',$e-&gt;message,'&lt;/p&gt;';</b></pre><pre>}</pre><pre>?&gt;</pre></div>
+
+<p>You can use a PEAR_Error derived class by defining the constant
+ADODB_PEAR_ERROR_CLASS before the adodb-errorpear.inc.php file is included. For
+easy debugging, you can set the default error handler in the beginning of the
+PHP script to PEAR_ERROR_DIE, which will cause an error message to be printed,
+then halt script execution: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>include('PEAR.php');<br>
+PEAR::setErrorHandling('PEAR_ERROR_DIE');</pre></div>
+
+<p>Note that we do not explicitly return a PEAR_Error object to you when an
+error occurs. We return false instead. You have to call ADODB_Pear_Error() to
+get the last error or use the PEAR_ERROR_DIE technique. </p>
+
 <h3>MetaError and MetaErrMsg</h3>
- <p>If you need error messages that work across multiple databases, then use <a href="#metaerror">MetaError()</a>, which returns a virtualized error number, based on PEAR DB's error number system, and <a href=<a href="#metaerrmsg">MetaErrMsg()</a>.
+
+<p>If you need error messages that work across multiple databases, then use <a
+href="#metaerror">MetaError()</a>, which returns a virtualized error number,
+based on PEAR DB's error number system, and <a href="#metaerrmsg">MetaErrMsg()</a>.
+</p>
 
 <h4>Error Messages</h4>
-<p>Error messages are outputted using the static method ADOConnnection::outp($msg,$newline=true). 
-  By default, it sends the messages to the client. You can override this to perform 
-  error-logging. 
-</p><h2><a name="dsn"></a> Data Source Names</h2>
-<p>We now support connecting using PEAR style DSN's. A DSN is a connection string 
-  of the form:</p>
-<p>$dsn = <i>"$driver://$username:$password@$hostname/$databasename"</i>;</p>
+
+<p>Error messages are outputted using the static method
+ADOConnnection::outp($msg,$newline=true). By default, it sends the messages to
+the client. You can override this to perform error-logging. </p>
+
+<h2><a name=dsn></a>Data Source Names</h2>
+
+<p>We now support connecting using PEAR style DSN's. A DSN is a connection
+string of the form:</p>
+
+<p>$dsn = <i>&quot;$driver://$username:$password@$hostname/$databasename&quot;</i>;</p>
+
 <p>An example:</p>
-<pre>   $username = 'root';<br>   $password = '';<br>   $hostname = 'localhost';<br>   $databasename = 'xphplens';<br>   $driver = 'mysql';<br>   $dsn = "$driver://$username:$password@$hostname/$databasename"<br>   $db = NewADOConnection(); <br>   # DB::Connect($dsn) also works if you include 'adodb/adodb-pear.inc.php' at the top<br>   $rs = $db-&gt;query('select firstname,lastname from adoxyz');<br>   $cnt = 0;<br>   while ($arr = $rs-&gt;fetchRow()) {<br>		print_r($arr); print "&lt;br&gt;";<br>   }</pre>
-   <p></p>
-<p>   <a href="#dsnsupport">More info and connection examples</a> on the DSN format.
-
-</p><h2><a name="pear"></a>PEAR Compatibility</h2>
-  We support DSN's (see above), and the following functions:
- <pre><b> DB_Common</b>
- 	query - returns PEAR_Error on error
-	limitQuery - return PEAR_Error on error
-	prepare - does not return PEAR_Error on error
-	execute - does not return PEAR_Error on error
-	setFetchMode - supports ASSOC and ORDERED
-	errorNative
-	quote
-	nextID
-	disconnect
-	
-	getOne
-	getAssoc
-	getRow
-	getCol
-	
-<b> DB_Result</b>
- 	numRows - returns -1 if not supported
-	numCols
-	fetchInto - does not support passing of fetchmode
-	fetchRows - does not support passing of fetchmode
-	free
-</pre>
-<h2><a name="caching"></a>Caching of Recordsets</h2>
-<p>ADOdb now supports caching of recordsets using the CacheExecute( ), CachePageExecute( 
-  ) and CacheSelectLimit( ) functions. There are similar to the non-cache functions, 
-  except that they take a new first parameter, $secs2cache. 
-</p><p> An example: 
-</p><pre><b>include</b>('adodb.inc.php'); # load code common to ADOdb<br>$ADODB_CACHE_DIR = '/usr/ADODB_cache';<br>$<font color="#663300">conn</font> =ADONewConnection('mysql');  # create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br><font>$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers';<br>$<font color="#663300">rs</font> = $<font color="#663300">conn</font>-&gt;CacheExecute(15,$sql);</font></pre>
-<p><font> The first parameter is the number of seconds to cache 
-  the query. Subsequent calls to that query will used the cached version stored 
-  in $ADODB_CACHE_DIR. To force a query to execute and flush the cache, call CacheExecute() 
-  with the first parameter set to zero. Alternatively, use the CacheFlush($sql) 
-  call. </font></p>
-<p><font>For the sake of security, we recommend you set <i>register_globals=off</i> 
-  in php.ini if you are using $ADODB_CACHE_DIR.</font></p>
-<p>In ADOdb 1.80 onwards, the secs2cache parameter is optional in CacheSelectLimit() 
-  and CacheExecute(). If you leave it out, it will use the $connection-&gt;cacheSecs 
-  parameter, which defaults to 60 minutes. 
-</p><pre>	$conn-&gt;Connect(...);<br>	$conn-&gt;cacheSecs = 3600*24; # cache 24 hours<br>	$rs = $conn-&gt;CacheExecute('select * from table');<br></pre>
-<p>Please note that magic_quotes_runtime should be turned off. <a href="http://phplens.com/lens/lensforum/msgs.php?LeNs#LensBM_forummsg">More 
-  info</a>, and do not change $ADODB_FETCH_MODE (or SetFetchMode) 
-  as the cached recordset will use the $ADODB_FETCH_MODE set when the query was executed. <font> 
-<h2><a name="pivot"></a>Pivot Tables</h2>
-</font> </p><p><font>Since ADOdb 2.30, we support the generation of 
-SQL to create pivot tables, also known as cross-tabulations. For further explanation 
-read this DevShed <a href="http://www.devshed.com/Server_Side/MySQL/MySQLWiz/">Cross-Tabulation 
-tutorial</a>. We assume that your database supports the SQL case-when expression. </font></p> 
-<font> 
-<p>In this example, we will use the Northwind database from Microsoft. In the 
-  database, we have a products table, and we want to analyze this table by <i>suppliers 
-  versus product categories</i>. We will place the suppliers on each row, and 
-  pivot on categories. So from the table on the left, we generate the pivot-table 
-  on the right:</p>
-</font> 
-<table align="center" border="0" cellpadding="2" cellspacing="2">
-  <tbody><tr>
-	<td>
-	  <table align="center" border="1" cellpadding="2" cellspacing="2" width="142">
-		<tbody><tr> 
-		  <td><i>Supplier</i></td>
-		  <td><i>Category</i></td>
-		</tr>
-		<tr> 
-		  <td>supplier1</td>
-		  <td>category1</td>
-		</tr>
-		<tr> 
-		  <td>supplier2</td>
-		  			<td>category1</td>
-		</tr>
-		<tr> 
-		  			<td>supplier2</td>
-		  <td>category2</td>
-		</tr>
-	  </tbody></table>
-	</td>
-	<td> <font face="Courier New, Courier, mono">--&gt;</font></td>
-	<td>
-	  <table align="center" border="1" cellpadding="2" cellspacing="2">
-		<tbody><tr> 
-		  <td>&nbsp;</td>
-		  <td><i>category1</i></td>
-		  <td><i>category2</i></td>
-		  <td><i>total</i></td>
-		</tr>
-		<tr> 
-		  <td><i>supplier1</i></td>
-		  <td align="right">1</td>
-		  <td align="right">0</td>
-		  <td align="right">1</td>
-		</tr>
-		<tr> 
-		  <td><i>supplier2</i></td>
-		  <td align="right">1</td>
-		  <td align="right">1</td>
-		  <td align="right">2</td>
-		</tr>
-	  </tbody></table>
-	</td>
-  </tr>
-</tbody></table>
-<font> 
-</font><p><font>The following code will generate the SQL for a cross-tabulation: 
-</font></p><pre><font># Query the main "product" table<br># Set the rows to SupplierName<br># and the columns to the values of Categories<br># and define the joins to link to lookup tables <br># "categories" and "suppliers"<br>#<br> include "adodb/pivottable.inc.php";<br> $sql = PivotTableSQL(<br> 	$gDB,                                      # adodb connection<br> 	'products p ,categories c ,suppliers s',   # tables<br>	'SupplierName',                             # rows (multiple fields allowed)<br>	'CategoryName',                            # column to pivot on <br>	'p.CategoryID = c.CategoryID and s.SupplierID= p.SupplierID' # joins/where<br>);<br></font></pre>
- 
-<p><font> This will generate the following SQL:</font></p>
-<p><code><font size="2">SELECT SupplierName, <br>
-  SUM(CASE WHEN CategoryName='Beverages' THEN 1 ELSE 0 END) AS "Beverages", 
-  <br>
-  SUM(CASE WHEN CategoryName='Condiments' THEN 1 ELSE 0 END) AS "Condiments", 
-  <br>
-  SUM(CASE WHEN CategoryName='Confections' THEN 1 ELSE 0 END) AS "Confections", 
-  <br>
-  SUM(CASE WHEN CategoryName='Dairy Products' THEN 1 ELSE 0 END) AS "Dairy 
-  Products", <br>
-  SUM(CASE WHEN CategoryName='Grains/Cereals' THEN 1 ELSE 0 END) AS "Grains/Cereals", 
-  <br>
-  SUM(CASE WHEN CategoryName='Meat/Poultry' THEN 1 ELSE 0 END) AS "Meat/Poultry", 
-  <br>
-  SUM(CASE WHEN CategoryName='Produce' THEN 1 ELSE 0 END) AS "Produce", 
-  <br>
-  SUM(CASE WHEN CategoryName='Seafood' THEN 1 ELSE 0 END) AS "Seafood", 
-  <br>
-  SUM(1) as Total <br>
-  FROM products p ,categories c ,suppliers s WHERE p.CategoryID = c.CategoryID 
-  and s.SupplierID= p.SupplierID <br>
-  GROUP BY SupplierName</font></code></p>
-<p> You can also pivot on <i>numerical columns</i> and <i>generate totals</i> 
-	by using ranges. <font>This code was revised in ADODB 2.41 
-	and is not backward compatible.</font> The second example shows this:</p>
-<pre> $sql = PivotTableSQL(<br> 	$gDB,                                       # adodb connection<br> 	'products p ,categories c ,suppliers s',    # tables<br>	'SupplierName',                              #<font> rows (multiple fields allowed)</font>
-   array(                                       # column ranges
-	' 0 '      =gt; 'UnitsInStock &lt;= 0',
-	"1 to 5"   =gt; '0 &lt; UnitsInStock and UnitsInStock &lt;= 5',
-	"6 to 10"  =gt; '5 &lt; UnitsInStock and UnitsInStock &lt;= 10',
-	"11 to 15" =gt; '10 &lt; UnitsInStock and UnitsInStock &lt;= 15',
-	"16+"      =gt; '15 &lt; UnitsInStock'
-	),
-	' p.CategoryID = c.CategoryID and s.SupplierID= p.SupplierID', # joins/where
-	'UnitsInStock',                             # sum this field
-	'Sum '                                      # sum label prefix
-);
-</pre> 
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span>$username = 'root';<br>
+<span style='mso-spacerun:yes'> </span>$password = '';<br>
+<span style='mso-spacerun:yes'> </span>$hostname = 'localhost';<br>
+<span style='mso-spacerun:yes'> </span>$databasename = 'xphplens';<br>
+<span style='mso-spacerun:yes'> </span>$driver = 'mysql';<br>
+<span style='mso-spacerun:yes'> </span>$dsn = &quot;$driver://$username:$password@$hostname/$databasename&quot;<br>
+<span style='mso-spacerun:yes'> </span>$db = NewADOConnection(); <br>
+<span style='mso-spacerun:yes'> </span># DB::Connect($dsn) also works if you include 'adodb/adodb-pear.inc.php' at the top<br>
+<span style='mso-spacerun:yes'> </span>$rs = $db-&gt;query('select firstname,lastname from adoxyz');<br>
+<span style='mso-spacerun:yes'> </span>$cnt = 0;<br>
+<span style='mso-spacerun:yes'> </span>while ($arr = $rs-&gt;fetchRow()) {<br>
+<span style='mso-tab-count:2'> </span>print_r($arr); print &quot;&lt;br&gt;&quot;;<br>
+<span style='mso-spacerun:yes'> </span>}</pre></div>
+
+<p><a href="#dsnsupport">More info and connection examples</a> on the DSN
+format. </p>
+
+<h2><a name=pear></a>PEAR Compatibility</h2>
+
+<p class=MsoNormal>We support DSN's (see above), and the following functions: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><b><span style='mso-spacerun:yes'></span>DB_Common</b></pre><pre> <span
+style='mso-tab-count:1'> </span>query - returns PEAR_Error on error</pre><pre><span
+style='mso-tab-count:1'> </span>limitQuery - return PEAR_Error on error</pre><pre><span
+style='mso-tab-count:1'> </span>prepare - does not return PEAR_Error on error</pre><pre><span
+style='mso-tab-count:1'> </span>execute - does not return PEAR_Error on error</pre><pre><span
+style='mso-tab-count:1'> </span>setFetchMode - supports ASSOC and ORDERED</pre><pre><span
+style='mso-tab-count:1'> </span>errorNative</pre><pre><span
+style='mso-tab-count:1'> </span>quote</pre><pre><span style='mso-tab-count:
+1'> </span>nextID</pre><pre><span style='mso-tab-count:1'> </span>disconnect</pre><pre><span
+style='mso-tab-count:1'> </span></pre><pre><span style='mso-tab-count:
+1'> </span>getOne</pre><pre><span style='mso-tab-count:1'> </span>getAssoc</pre><pre><span
+style='mso-tab-count:1'> </span>getRow</pre><pre><span
+style='mso-tab-count:1'> </span>getCol</pre><pre><span
+style='mso-tab-count:1'> </span></pre><pre><b> DB_Result</b></pre><pre> <span
+style='mso-tab-count:1'> </span>numRows - returns -1 if not supported</pre><pre><span
+style='mso-tab-count:1'> </span>numCols</pre><pre><span
+style='mso-tab-count:1'> </span>fetchInto - does not support passing of fetchmode</pre><pre><span
+style='mso-tab-count:1'> </span>fetchRows - does not support passing of fetchmode</pre><pre><span
+style='mso-tab-count:1'> </span>free</pre></div>
+
+<h2><a name=caching></a>Caching of Recordsets</h2>
+
+<p>ADOdb now supports caching of recordsets in the file system using the
+CacheExecute( ), CachePageExecute( ) and CacheSelectLimit( ) functions. There
+are similar to the non-cache functions, except that they take a new first
+parameter, $secs2cache. </p>
+
+<p>An example: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><b>include</b>('adodb.inc.php'); # load code common to ADOdb<br>
+$ADODB_CACHE_DIR = '/usr/ADODB_cache';<br>
+$<span style='color:#663300'>conn</span> = &amp;ADONewConnection('mysql');<span style='mso-spacerun:yes'> </span># create a connection<br>
+$<span style='color:#663300'>conn</span>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br>
+$<span style='color:#663300'>sql</span> = 'select CustomerName, CustomerID from customers';<br>
+$<span style='color:#663300'>rs</span> = $<span style='color:#663300'>conn</span>-&gt;CacheExecute(15,$sql);</pre></div>
+
+<p>The first parameter is the number of seconds to cache the query. Subsequent
+calls to that query will used the cached version stored in $ADODB_CACHE_DIR. To
+force a query to execute and flush the cache, call CacheExecute() with the
+first parameter set to zero. Alternatively, use the CacheFlush($sql) call. </p>
+
+<p>For the sake of security, we recommend you set <i>register_globals=off</i> in
+php.ini if you are using $ADODB_CACHE_DIR.</p>
+
+<p>In ADOdb 1.80 onwards, the secs2cache parameter is optional in
+CacheSelectLimit() and CacheExecute(). If you leave it out, it will use the
+$connection-&gt;cacheSecs parameter, which defaults to 60 minutes. The following
+are equivalent: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'> </span># (1)</pre><pre><span style='mso-spacerun:yes'> </span>$rs = $db-&gt;SelectLimit(30, 'select * from table', 10);</pre><pre><span style='mso-spacerun:yes'> </span></pre><pre><span style='mso-spacerun:yes'></span># (2)</pre><pre><span style='mso-spacerun:yes'> </span>$db-&gt;cacheSsecs = 30;</pre><pre><span style='mso-spacerun:yes'> </span>$rs = $db-&gt;SelectLimit('select * from table', 10);</pre><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span></pre><pre><span
+style='mso-tab-count:1'> </span>$conn-&gt;Connect(...);<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;cacheSecs = 3600*24; # cache 24 hours<br>
+<span style='mso-tab-count:1'> </span>$rs = $conn-&gt;CacheExecute('select * from table');</pre></div>
+
+<p>Please note that magic_quotes_runtime should be turned off. Do not change
+$ADODB_FETCH_MODE (or SetFetchMode) as the cached recordset will use the
+$ADODB_FETCH_MODE set when the query was executed. <a name=memcache></a></p>
+
+<h3><span style='mso-bookmark:memcache'>MemCache support</span></h3>
+
+<p><span style='mso-bookmark:memcache'>You can also share cached recordsets on
+a memcache server. The memcache API supports one or more pooled hosts. Only if
+none of the pooled servers can be contacted will a connect error be generated.
+Example below: </span></p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-bookmark:memcache'><o:p>&nbsp;</o:p></span></pre><pre><span
+style='mso-bookmark:memcache'>$db = NewADOConnection($driver='mysql');</span></pre><pre><span
+style='mso-bookmark:memcache'>$db-&gt;memCache = true;</span></pre><pre><span
+style='mso-bookmark:memcache'>$db-&gt;memCacheHost = array($ip1, $ip2, $ip3); /// $db-&gt;memCacheHost = $ip1; will work too</span></pre><pre><span
+style='mso-bookmark:memcache'>$db-&gt;memCachePort = 11211; /// this is default memCache port</span></pre><pre><span
+style='mso-bookmark:memcache'>$db-&gt;memCacheCompress = false; /// Use 'true' to store the item compressed (uses zlib)</span></pre><pre><span
+style='mso-bookmark:memcache'><o:p>&nbsp;</o:p></span></pre><pre><span
+style='mso-bookmark:memcache'>$db-&gt;Connect(...);</span></pre><pre><span
+style='mso-bookmark:memcache'>$db-&gt;CacheExecute($sql);</span></pre></div>
+
+<p><span style='mso-bookmark:memcache'>More info on memcache can be found at </span><a
+href="http://www.danga.com/memcached/">http://www.danga.com/memcached/</a>. <a
+name=cacheapi></a></p>
+
+<h3><span style='mso-bookmark:cacheapi'>Caching API</span></h3>
+
+<p><span style='mso-bookmark:cacheapi'>There is also a caching API since
+4.99/5.05. Two implementations of the API are already available providing file
+and memcache support. </span></p>
+
+<p><span style='mso-bookmark:cacheapi'>The new API for creating your custom
+caching class uses 2 globals: </span></p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l8 level1 lfo8;tab-stops:list 36.0pt'><span style='mso-bookmark:
+     cacheapi'>$ADODB_CACHE_CLASS: name of caching class </span></li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l8 level1 lfo8;tab-stops:list 36.0pt'><span style='mso-bookmark:
+     cacheapi'>$ADODB_CACHE: instance of $ADODB_CACHE_CLASS </span></li>
+</ul>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-bookmark:cacheapi'><o:p>&nbsp;</o:p></span></pre><pre><span
+style='mso-bookmark:cacheapi'>include &quot;/path/to/adodb.inc.php&quot;;</span></pre><pre><span
+style='mso-bookmark:cacheapi'>$ADODB_CACHE_CLASS = 'MyCacheClass';</span></pre><pre><span
+style='mso-bookmark:cacheapi'><o:p>&nbsp;</o:p></span></pre><pre><span
+style='mso-bookmark:cacheapi'>class MyCacheClass extends ADODB_Cache_File</span></pre><pre><span
+style='mso-bookmark:cacheapi'>{</span></pre><pre><span style='mso-bookmark:
+cacheapi'><span style='mso-tab-count:1'> </span>var $createdir = false; // do not set this to true unless you use temp directories in cache path</span></pre><pre><span
+style='mso-bookmark:cacheapi'><span style='mso-tab-count:1'> </span>function writecache($filename, $contents,$debug=false){...}</span></pre><pre><span
+style='mso-bookmark:cacheapi'><span style='mso-tab-count:1'> </span>function &amp;readcache($filename, &amp;$err, $secs2cache, $rsClass){ ...}</span></pre><pre><span
+style='mso-bookmark:cacheapi'><span style='mso-tab-count:1'> </span> :</span></pre><pre><span
+style='mso-bookmark:cacheapi'>}</span></pre><pre><span style='mso-bookmark:
+cacheapi'><o:p>&nbsp;</o:p></span></pre><pre><span style='mso-bookmark:cacheapi'>$DB = NewADOConnection($driver);</span></pre><pre><span
+style='mso-bookmark:cacheapi'>$DB-&gt;Connect(...);<span style='mso-spacerun:yes'> </span>## MyCacheClass created here and stored in $ADODB_CACHE global variable.</span></pre><pre><span
+style='mso-bookmark:cacheapi'><o:p>&nbsp;</o:p></span></pre><pre><span
+style='mso-bookmark:cacheapi'>$data = $rs-&gt;CacheGetOne($sql); ## MyCacheClass is used here for caching...</span></pre></div>
+
+<span style='mso-bookmark:cacheapi'></span>
+
+<h2><a name=pivot></a>Pivot Tables</h2>
+
+<p>Since ADOdb 2.30, we support the generation of SQL to create pivot tables,
+also known as cross-tabulations. For further explanation read this DevShed <a
+href="http://www.devshed.com/Server_Side/MySQL/MySQLWiz/">Cross-Tabulation tutorial</a>.
+We assume that your database supports the SQL case-when expression. </p>
+
+<p>In this example, we will use the Northwind database from Microsoft. In the
+database, we have a products table, and we want to analyze this table by <i>suppliers
+versus product categories</i>. We will place the suppliers on each row, and
+pivot on categories. So from the table on the left, we generate the pivot-table
+on the right:</p>
+
+<div align=center>
+
+<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
+ mso-padding-alt:1.5pt 1.5pt 1.5pt 1.5pt'>
+ <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
+  <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+  <div align=center>
+  <table class=MsoNormalTable border=1 cellpadding=0 width=142
+   style='width:106.5pt;mso-cellspacing:1.5pt;mso-padding-alt:1.5pt 1.5pt 1.5pt 1.5pt'>
+   <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal><i>Supplier</i></p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal><i>Category</i></p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:1'>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal>supplier1</p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal>category1</p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:2'>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal>supplier2</p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal>category1</p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal>supplier2</p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal>category2</p>
+    </td>
+   </tr>
+  </table>
+  </div>
+  <p class=MsoNormal><o:p></o:p></p>
+  </td>
+  <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+  <p class=MsoNormal><span style='font-family:"Courier New"'>--&gt;</span></p>
+  </td>
+  <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+  <div align=center>
+  <table class=MsoNormalTable border=1 cellpadding=0 style='mso-cellspacing:
+   1.5pt;mso-padding-alt:1.5pt 1.5pt 1.5pt 1.5pt'>
+   <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal>&nbsp;</p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal><i>category1</i></p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal><i>category2</i></p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal><i>total</i></p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:1'>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal><i>supplier1</i></p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal align=right style='text-align:right'>1</p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal align=right style='text-align:right'>0</p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal align=right style='text-align:right'>1</p>
+    </td>
+   </tr>
+   <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal><i>supplier2</i></p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal align=right style='text-align:right'>1</p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal align=right style='text-align:right'>1</p>
+    </td>
+    <td style='padding:1.5pt 1.5pt 1.5pt 1.5pt'>
+    <p class=MsoNormal align=right style='text-align:right'>2</p>
+    </td>
+   </tr>
+  </table>
+  </div>
+  <p class=MsoNormal><o:p></o:p></p>
+  </td>
+ </tr>
+</table>
+
+</div>
+
+<p>The following code will generate the SQL for a cross-tabulation: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'># Query the main &quot;product&quot; table<br>
+# Set the rows to SupplierName<br>
+# and the columns to the values of Categories<br>
+# and define the joins to link to lookup tables <br>
+# &quot;categories&quot; and &quot;suppliers&quot;<br>
+#<br>
+<span style='mso-spacerun:yes'></span>include &quot;adodb/pivottable.inc.php&quot;;<br>
+<span style='mso-spacerun:yes'></span>$sql = PivotTableSQL(<br>
+<span style='mso-spacerun:yes'></span><span style='mso-tab-count:1'> </span>$gDB,<span style='mso-spacerun:yes'> </span># adodb connection<br>
+<span style='mso-spacerun:yes'></span><span style='mso-tab-count:1'> </span>'products p ,categories c ,suppliers s',<span style='mso-spacerun:yes'> </span># tables<br>
+<span style='mso-tab-count:1'> </span>'SupplierName',<span style='mso-spacerun:yes'> </span># rows (multiple fields allowed)<br>
+<span style='mso-tab-count:1'> </span>'CategoryName',<span style='mso-spacerun:yes'> </span># column to pivot on <br>
+<span style='mso-tab-count:1'> </span>'p.CategoryID = c.CategoryID and s.SupplierID= p.SupplierID' # joins/where<br>
+);</pre></div>
+
+<p>This will generate the following SQL:</p>
+
+<p><code><span style='font-size:10.0pt'>SELECT SupplierName, </span></code><span
+style='font-size:10.0pt;font-family:"Courier New"'><br>
+<code>SUM(CASE WHEN CategoryName='Beverages' THEN 1 ELSE 0 END) AS
+&quot;Beverages&quot;, </code><br>
+<code>SUM(CASE WHEN CategoryName='Condiments' THEN 1 ELSE 0 END) AS
+&quot;Condiments&quot;, </code><br>
+<code>SUM(CASE WHEN CategoryName='Confections' THEN 1 ELSE 0 END) AS
+&quot;Confections&quot;, </code><br>
+<code>SUM(CASE WHEN CategoryName='Dairy Products' THEN 1 ELSE 0 END) AS
+&quot;Dairy Products&quot;, </code><br>
+<code>SUM(CASE WHEN CategoryName='Grains/Cereals' THEN 1 ELSE 0 END) AS
+&quot;Grains/Cereals&quot;, </code><br>
+<code>SUM(CASE WHEN CategoryName='Meat/Poultry' THEN 1 ELSE 0 END) AS
+&quot;Meat/Poultry&quot;, </code><br>
+<code>SUM(CASE WHEN CategoryName='Produce' THEN 1 ELSE 0 END) AS
+&quot;Produce&quot;, </code><br>
+<code>SUM(CASE WHEN CategoryName='Seafood' THEN 1 ELSE 0 END) AS
+&quot;Seafood&quot;, </code><br>
+<code>SUM(1) as Total </code><br>
+<code>FROM products p ,categories c ,suppliers s WHERE p.CategoryID =
+c.CategoryID and s.SupplierID= p.SupplierID </code><br>
+<code>GROUP BY SupplierName</code></span></p>
+
+<p>You can also pivot on <i>numerical columns</i> and <i>generate totals</i> by
+using ranges. This code was revised in ADODB 2.41 and is not backward
+compatible. The second example shows this:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span style='mso-spacerun:yes'></span>$sql = PivotTableSQL(<br>
+<span style='mso-spacerun:yes'></span><span style='mso-tab-count:1'> </span>$gDB,<span style='mso-spacerun:yes'> </span># adodb connection<br>
+<span style='mso-spacerun:yes'></span><span style='mso-tab-count:1'> </span>'products p ,categories c ,suppliers s',<span style='mso-spacerun:yes'> </span># tables<br>
+<span style='mso-tab-count:1'> </span>'SupplierName',<span style='mso-spacerun:yes'> </span># rows (multiple fields allowed)</pre><pre><span style='mso-spacerun:yes'> </span>array(<span style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'></span># column ranges</pre><pre><span
+style='mso-tab-count:1'> </span>' 0 '<span style='mso-spacerun:yes'> </span>=&gt; 'UnitsInStock &lt;= 0',</pre><pre><span
+style='mso-tab-count:1'> </span>&quot;1 to 5&quot;<span style='mso-spacerun:yes'> </span>=&gt; '0 &lt; UnitsInStock and UnitsInStock &lt;= 5',</pre><pre><span
+style='mso-tab-count:1'> </span>&quot;6 to 10&quot;<span style='mso-spacerun:yes'> </span>=&gt; '5 &lt; UnitsInStock and UnitsInStock &lt;= 10',</pre><pre><span
+style='mso-tab-count:1'> </span>&quot;11 to 15&quot; =&gt; '10 &lt; UnitsInStock and UnitsInStock &lt;= 15',</pre><pre><span
+style='mso-tab-count:1'> </span>&quot;16+&quot;<span style='mso-spacerun:yes'> </span>=&gt; '15 &lt; UnitsInStock'</pre><pre><span
+style='mso-tab-count:1'> </span>),</pre><pre><span style='mso-tab-count:
+1'> </span>' p.CategoryID = c.CategoryID and s.SupplierID= p.SupplierID', # joins/where</pre><pre><span
+style='mso-tab-count:1'> </span>'UnitsInStock',<span style='mso-spacerun:yes'> </span># sum this field</pre><pre><span
+style='mso-tab-count:1'> </span>'Sum '<span style='mso-spacerun:yes'> </span># sum label prefix</pre><pre>);</pre></div>
+
 <p>Which generates: </p>
-<p> <code> <font size="2">SELECT SupplierName, <br>
-	SUM(CASE WHEN UnitsInStock &lt;= 0 THEN UnitsInStock ELSE 0 END) AS "Sum 
-	0 ", <br>
-	SUM(CASE WHEN 0 &lt; UnitsInStock and UnitsInStock &lt;= 5 THEN UnitsInStock 
-	ELSE 0 END) AS "Sum 1 to 5",<br>
-	SUM(CASE WHEN 5 &lt; UnitsInStock and UnitsInStock &lt;= 10 THEN UnitsInStock 
-	ELSE 0 END) AS "Sum 6 to 10",<br>
-	SUM(CASE WHEN 10 &lt; UnitsInStock and UnitsInStock &lt;= 15 THEN UnitsInStock 
-	ELSE 0 END) AS "Sum 11 to 15", <br>
-	SUM(CASE WHEN 15 &lt; UnitsInStock THEN UnitsInStock ELSE 0 END) AS "Sum 
-	16+", <br>
-	SUM(UnitsInStock) AS "Sum UnitsInStock", <br>
-	SUM(1) as Total,<br>
-	FROM products p ,categories c ,suppliers s WHERE p.CategoryID = c.CategoryID 
-	and s.SupplierID= p.SupplierID <br>
-	GROUP BY SupplierName</font></code><font size="2"><br>
-	</font> </p>
-<font><hr />
-<h1>Class Reference<a name="ref"></a></h1>
+
+<p><code><span style='font-size:10.0pt'>SELECT SupplierName, </span></code><span
+style='font-size:10.0pt;font-family:"Courier New"'><br>
+<code>SUM(CASE WHEN UnitsInStock &lt;= 0 THEN UnitsInStock ELSE 0 END) AS
+&quot;Sum 0 &quot;, </code><br>
+<code>SUM(CASE WHEN 0 &lt; UnitsInStock and UnitsInStock &lt;= 5 THEN
+UnitsInStock ELSE 0 END) AS &quot;Sum 1 to 5&quot;,</code><br>
+<code>SUM(CASE WHEN 5 &lt; UnitsInStock and UnitsInStock &lt;= 10 THEN UnitsInStock
+ELSE 0 END) AS &quot;Sum 6 to 10&quot;,</code><br>
+<code>SUM(CASE WHEN 10 &lt; UnitsInStock and UnitsInStock &lt;= 15 THEN
+UnitsInStock ELSE 0 END) AS &quot;Sum 11 to 15&quot;, </code><br>
+<code>SUM(CASE WHEN 15 &lt; UnitsInStock THEN UnitsInStock ELSE 0 END) AS
+&quot;Sum 16+&quot;, </code><br>
+<code>SUM(UnitsInStock) AS &quot;Sum UnitsInStock&quot;, </code><br>
+<code>SUM(1) as Total,</code><br>
+<code>FROM products p ,categories c ,suppliers s WHERE p.CategoryID =
+c.CategoryID and s.SupplierID= p.SupplierID </code><br>
+<code>GROUP BY SupplierName</code></span></p>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h1>Class Reference<a name=ref></a></h1>
+
 <p>Function parameters with [ ] around them are optional.</p>
-</font> 
+
 <h2>Global Variables</h2>
-<h3><font><a name="adodb_countrecs"></a></font>$ADODB_COUNTRECS</h3>
-<p>If the database driver API does not support counting the number of records 
-	returned in a SELECT statement, the function RecordCount() is emulated when 
-	the global variable $ADODB_COUNTRECS is set to true, which is the default. 
-	We emulate this by buffering the records, which can take up large amounts 
-	of memory for big recordsets. Set this variable to false for the best performance. 
-	This variable is checked every time a query is executed, so you can selectively 
-	choose which recordsets to count.</p>
-<h3><font><a name="adodb_cache_dir"></a>$ADODB_CACHE_DIR</font></h3>
-<font> 
-<p>If you are using recordset caching, this is the directory to save your recordsets 
-  in. Define this before you call any caching functions such as CacheExecute( 
-  ). We recommend setting <i>register_globals=off</i> in php.ini if you use this 
-  feature for security reasons.</p>
-<p>If you are using Unix and apache, you might need to set your cache directory 
-  permissions to something similar to the following:</p>
-</font> 
+
+<h3><a name="adodb_countrecs"></a>$ADODB_COUNTRECS</h3>
+
+<p>If the database driver API does not support counting the number of records
+returned in a SELECT statement, the function RecordCount() is emulated when the
+global variable $ADODB_COUNTRECS is set to true, which is the default. We
+emulate this by buffering the records, which can take up large amounts of
+memory for big recordsets. Set this variable to false for the best performance.
+This variable is checked every time a query is executed, so you can selectively
+choose which recordsets to count.</p>
+
+<h3><a name="adodb_cache_dir"></a>$ADODB_CACHE_DIR</h3>
+
+<p>If you are using recordset caching, this is the directory to save your
+recordsets in. Define this before you call any caching functions such as
+CacheExecute( ). We recommend setting <i>register_globals=off</i> in php.ini if
+you use this feature for security reasons.</p>
+
+<p>If you are using Unix and apache, you might need to set your cache directory
+permissions to something similar to the following:</p>
+
 <p>chown -R apache /path/to/adodb/cache<br>
-  chgrp -R apache /path/to/adodb/cache </p>
-<h3><font><a name="adodb_ansi_padding_off"></a>$ADODB_ANSI_PADDING_OFF</font></h3>
-<p><font>Determines whether to right trim CHAR fields (and also VARCHAR for ibase/firebird).
-Set to true to trim. Default is false. Currently works for oci8po, ibase and firebird 
-drivers. Added in ADOdb 4.01.
-</font></p><h3><font><a name="adodb_lang"></a>$ADODB_LANG</font></h3>
-<p><font>Determines the language used in MetaErrorMsg(). The default is 'en', for English. 
-To find out what languages are supported, see the files 
-in adodb/lang/adodb-$lang.inc.php, where $lang is the supported langauge.
-</font></p><h3><font><a name="adodb_fetch_mode"></a>$ADODB_FETCH_MODE</font></h3>
-<p><font>This is a global variable that determines how arrays are retrieved by recordsets. 
-  The recordset saves this value on creation (eg. in Execute( ) or SelectLimit( 
-  )), and any subsequent changes to $ADODB_FETCH_MODE have no affect on existing 
-  recordsets, only on recordsets created in the future.</font></p>
- <p><font>The following constants are defined:</font></p>
- <p><font>define('ADODB_FETCH_DEFAULT',0);<br>
-  define('ADODB_FETCH_NUM',1);<br>
-  define('ADODB_FETCH_ASSOC',2);<br>
-  define('ADODB_FETCH_BOTH',3); </font></p>
-<font> 
-</font><p><font> An example: 
-</font></p><pre><font>	$ADODB_<b>FETCH_MODE</b> = ADODB_FETCH_NUM;<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$ADODB_<b>FETCH_MODE</b> = ADODB_FETCH_ASSOC;<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=gt;'v0',[1] =gt;'v1')</i>
-	print_r($rs2-&gt;fields); # shows <i>array(['col1']=gt;'v0',['col2'] =gt;'v1')</i>
-</font></pre>
-<p><font> As you can see in the above example, both recordsets store and use different 
-	fetch modes based on the $ADODB_FETCH_MODE setting when the recordset was 
-	created by Execute().</font></p>
-<p><font>If no fetch mode is predefined, the fetch mode defaults to ADODB_FETCH_DEFAULT. 
-	The behaviour of this default mode varies from driver to driver, so do not 
-	rely on ADODB_FETCH_DEFAULT. For portability, we recommend sticking to ADODB_FETCH_NUM 
-	or ADODB_FETCH_ASSOC. Many drivers do not support ADODB_FETCH_BOTH.</font></p>
-<p><font><strong>SetFetchMode Function</strong></font></p>
-<p><font>If you have multiple connection objects, and want to have different fetch modes for each 
-connection, then use <a href="#setfetchmode">SetFetchMode</a>. 
-	Once this function is called for a connection object, that connection object 
-	will ignore the global variable $ADODB_FETCH_MODE and will use the internal 
-	fetchMode property exclusively.</font></p>
-<pre><font>	$db-&gt;SetFetchMode(ADODB_FETCH_NUM);<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$db-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=gt;'v0',[1] =gt;'v1')</i>
-	print_r($rs2-&gt;fields); # shows <i>array(['col1']=gt;'v0',['col2'] =gt;'v1')</i></font></pre>
-<p><font>To retrieve the previous fetch mode, you can use check the $db-&gt;fetchMode 
-	property, or use the return value of SetFetchMode( ). 
-</font></p><p><font><strong><a name="adodb_assoc_case"></a>ADODB_ASSOC_CASE</strong></font></p>
-<p><font>You can control the associative fetch case for certain drivers which behave 
-	differently. For the sybase, oci8po, mssql, odbc and ibase drivers and all 
-	drivers derived from them, ADODB_ASSOC_CASE will by default generate recordsets 
-	where the field name keys are lower-cased. Use the constant ADODB_ASSOC_CASE 
-	to change the case of the keys. There are 3 possible values:</font></p>
-<p><font>0 = assoc lowercase field names. $rs-&gt;fields['orderid']<br>
-	1 = assoc uppercase field names. $rs-&gt;fields['ORDERID']<br>
-	2 = use native-case field names. $rs-&gt;fields['OrderID'] -- this is the 
-	default since ADOdb 2.90</font></p>
-<p><font>To use it, declare it before you incldue adodb.inc.php.</font></p>
-<p><font>define('ADODB_ASSOC_CASE', 2); # use native-case for ADODB_FETCH_ASSOC<br>
-	include('adodb.inc.php'); </font></p>
-<h3><font><a name="force_type"></a>$ADODB_FORCE_TYPE</font></h3>
-<p><font>See the <a href="#ADODB_FORCE_TYPE">GetUpdateSQL tutorial</a>.
-</font></p>
-<h3><font><a name="adodb_auto_quote"></a>$ADODB_QUOTE_FIELDNAMES</font></h3>
-<p><font>Auto-quotes field names when using AutoExecute() when set to true. </font>
+chgrp -R apache /path/to/adodb/cache </p>
+
+<h3><a name="adodb_ansi_padding_off"></a>$ADODB_ANSI_PADDING_OFF</h3>
+
+<p>Determines whether to right trim CHAR fields (and also VARCHAR for
+ibase/firebird). Set to true to trim. Default is false. Currently works for
+oci8po, ibase and firebird drivers. Added in ADOdb 4.01. </p>
+
+<h3><a name="adodb_lang"></a>$ADODB_LANG</h3>
+
+<p>Determines the language used in MetaErrorMsg(). The default is 'en', for
+English. To find out what languages are supported, see the files in
+adodb/lang/adodb-$lang.inc.php, where $lang is the supported langauge. </p>
+
+<h3><a name="adodb_fetch_mode"></a>$ADODB_FETCH_MODE</h3>
+
+<p>This is a global variable that determines how arrays are retrieved by recordsets.
+The recordset saves this value on creation (eg. in Execute( ) or SelectLimit(
+)), and any subsequent changes to $ADODB_FETCH_MODE have no affect on existing
+recordsets, only on recordsets created in the future.</p>
+
+<p>The following constants are defined:</p>
+
+<p>define('ADODB_FETCH_DEFAULT',0);<br>
+define('ADODB_FETCH_NUM',1);<br>
+define('ADODB_FETCH_ASSOC',2);<br>
+define('ADODB_FETCH_BOTH',3); </p>
+
+<p>An example: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:1'> </span>$ADODB_<b>FETCH_MODE</b> = ADODB_FETCH_NUM;<br>
+<span style='mso-tab-count:1'> </span>$rs1 = $db-&gt;Execute('select * from table');<br>
+<span style='mso-tab-count:1'> </span>$ADODB_<b>FETCH_MODE</b> = ADODB_FETCH_ASSOC;<br>
+<span style='mso-tab-count:1'> </span>$rs2 = $db-&gt;Execute('select * from table');<br>
+<span style='mso-tab-count:1'> </span>print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i></pre><pre><span
+style='mso-tab-count:1'> </span>print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i></pre></div>
+
+<p>As you can see in the above example, both recordsets store and use different
+fetch modes based on the $ADODB_FETCH_MODE setting when the recordset was
+created by Execute().</p>
+
+<p>If no fetch mode is predefined, the fetch mode defaults to
+ADODB_FETCH_DEFAULT. The behaviour of this default mode varies from driver to
+driver, so do not rely on ADODB_FETCH_DEFAULT. For portability, we recommend
+sticking to ADODB_FETCH_NUM or ADODB_FETCH_ASSOC. Many drivers do not support
+ADODB_FETCH_BOTH.</p>
+
+<p><strong>SetFetchMode Function</strong></p>
+
+<p>If you have multiple connection objects, and want to have different fetch
+modes for each connection, then use <a href="#setfetchmode">SetFetchMode</a>.
+Once this function is called for a connection object, that connection object
+will ignore the global variable $ADODB_FETCH_MODE and will use the internal
+fetchMode property exclusively.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;SetFetchMode(ADODB_FETCH_NUM);<br>
+<span style='mso-tab-count:1'> </span>$rs1 = $db-&gt;Execute('select * from table');<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>
+<span style='mso-tab-count:1'> </span>$rs2 = $db-&gt;Execute('select * from table');<br>
+<span style='mso-tab-count:1'> </span>print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i></pre><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i></pre></div>
+
+<p>To retrieve the previous fetch mode, you can use check the $db-&gt;fetchMode
+property, or use the return value of SetFetchMode( ). </p>
+
+<p><a name="adodb_assoc_case"></a><strong>ADODB_ASSOC_CASE</strong></p>
+
+<p>You can control the associative fetch case for certain drivers which behave
+differently. For the sybase, oci8po, mssql, odbc and ibase drivers and all
+drivers derived from them, ADODB_ASSOC_CASE will by default generate recordsets
+where the field name keys are lower-cased. Use the constant ADODB_ASSOC_CASE to
+change the case of the keys. There are 3 possible values:</p>
+
+<p>0 = assoc lowercase field names. $rs-&gt;fields['orderid']<br>
+1 = assoc uppercase field names. $rs-&gt;fields['ORDERID']<br>
+2 = use native-case field names. $rs-&gt;fields['OrderID'] -- this is the
+default since ADOdb 2.90</p>
+
+<p>To use it, declare it before you incldue adodb.inc.php.</p>
+
+<p>define('ADODB_ASSOC_CASE', 2); # use native-case for ADODB_FETCH_ASSOC<br>
+include('adodb.inc.php'); </p>
+
+<h3><a name="force_type"></a>$ADODB_FORCE_TYPE</h3>
+
+<p>See the <a href="#ADODB_FORCE_TYPE">GetUpdateSQL tutorial</a>. </p>
+
+<h3><a name="adodb_auto_quote"></a>$ADODB_QUOTE_FIELDNAMES</h3>
+
+<p>Auto-quotes field names when using AutoExecute() when set to true. </p>
+
 <p>&nbsp;</p>
-<hr />
-<h2><font>ADOConnection<a name="adoconnection"></a></font></h2>
-<p><font>Object that performs the connection to the database, executes SQL statements 
-	and has a set of utility functions for standardising the format of SQL statements 
-	for issues such as concatenation and date formats.</font></p>
-<h3><font>ADOConnection Fields</font></h3>
-<p><font><b>databaseType</b>: Name of the database system we are connecting to. Eg. 
-	<b>odbc</b> or <b>mssql</b> or <b>mysql</b>.</font></p>
-<p><font><b>dataProvider</b>: The underlying mechanism used to connect to the database. 
-	Normally set to <b>native</b>, unless using <b>odbc</b> or <b>ado</b>.</font></p>
-<p><font><b>host: </b>Name of server or data source name (DSN) to connect to.</font></p>
-<p><font><b>database</b>: Name of the database or to connect to. If ado is used, it 
-	will hold the ado data provider.</font></p>
-<p><font><b>user</b>: Login id to connect to database. Password is not saved for security 
-	reasons.</font></p>
-<p><font><b>raiseErrorFn</b>: Allows you to define an error handling function. See adodb-errorhandler.inc.php 
-	for an example.</font></p>
-<p><font><b>debug</b>: Set to <i>true</i> to make debug statements to appear.</font></p>
-<p><font><b>concat_operator</b>: Set to '+' or '||' normally. The operator used to concatenate 
-	strings in SQL. Used by the <b><a href="#concat">Concat</a></b> function.</font></p>
-<p><font><b>fmtDate</b>: The format used by the <b><a href="#dbdate">DBDate</a></b> 
-	function to send dates to the database. is '#Y-m-d#' for Microsoft Access, 
-	and ''Y-m-d'' for MySQL.</font></p>
-<p><font><b>fmtTimeStamp: </b>The format used by the <b><a href="#dbtimestamp">DBTimeStamp</a></b> 
-	function to send timestamps to the database. </font></p>
-<p><font><b>true</b>: The value used to represent true.Eg. '.T.'. for Foxpro, '1' for 
-	Microsoft SQL.</font></p>
-<p><font><b>false: </b> The value used to represent false. Eg. '.F.'. for Foxpro, '0' 
-	for Microsoft SQL.</font></p>
-<p><font><b>replaceQuote</b>: The string used to escape quotes. Eg. double single-quotes 
-	for Microsoft SQL, and backslash-quote for MySQL. Used by <a href="#qstr">qstr</a>.</font></p>
-<p><font><b>autoCommit</b>: indicates whether automatic commit is enabled. Default is 
-	true.</font></p>
-<p><font><b>charSet</b>: set the default charset to use. Currently only interbase/firebird supports 
-	this.</font></p>
-<p><font><b>dialect</b>: set the default sql dialect to use. Currently only interbase/firebird 
-	supports this.</font></p>
-	<p><font><b>role</b>: set the role. Currently only interbase/firebird 
-	supports this.</font></p>
-<p><font><b>metaTablesSQL</b>: SQL statement to return a list of available tables. Eg. 
-	<i>SHOW TABLES</i> in MySQL.</font></p>
-<p><font><b>genID</b>: The latest id generated by GenID() if supported by the database.</font></p>
-<p><font><b>cacheSecs</b>: The number of seconds to cache recordsets if CacheExecute() 
-	or CacheSelectLimit() omit the $secs2cache parameter. Defaults to 60 minutes.</font></p>
-<p><font><b>sysDate</b>: String that holds the name of the database function to call 
-	to get the current date. Useful for inserts and updates.</font></p>
-<p><font><b>sysTimeStamp</b>: String that holds the name of the database function to 
-	call to get the current timestamp/datetime value.</font></p>
-<p><font><b>leftOuter</b>: String that holds operator for left outer join, if known. 
-	Otherwise set to false.</font></p>
-<p><font><b>rightOuter</b>: String that holds operator for left outer join, if known. 
-	Otherwise set to false.</font></p>
-<p><font><b>ansiOuter</b>: Boolean that if true indicates that ANSI style outer joins 
-	are permitted. Eg. <i>select * from table1 left join table2 on p1=p2.</i></font></p>
-<p><font><b>connectSID</b>: Boolean that indicates whether to treat the $database parameter 
-	in connects as the SID for the oci8 driver. Defaults to false. Useful for 
-	Oracle 8.0.5 and earlier.</font></p>
-<p><font><b>autoRollback</b>: Persistent connections are auto-rollbacked in PConnect( 
-	) if this is set to true. Default is false.</font></p>
-<hr />
-<h3><font>ADOConnection Main Functions</font></h3>
-<p><font><b>ADOConnection( )</b></font></p>
-<p><font>Constructor function. Do not call this directly. Use ADONewConnection( ) instead.</font></p>
-<p><font><b>Connect<a name="connect"></a>($host,[$user],[$password],[$database])</b></font></p>
-<p><font>Non-persistent connect to data source or server $<b>host</b>, using userid 
-	$<b>user </b>and password $<b>password</b>. If the server supports multiple 
-	databases, connect to database $<b>database</b>. </font></p>
-<p><font>Returns true/false depending on connection success. Since 4.23, null is returned if the extension is not loaded.</font></p>
-<p><font>ADO Note: If you are using a Microsoft ADO and not OLEDB, you can set the $database 
-	parameter to the OLEDB data provider you are using.</font></p>
-<p><font>PostgreSQL: An alternative way of connecting to the database is to pass the 
-	standard PostgreSQL connection string in the first parameter $host, and the 
-	other parameters will be ignored.</font></p>
-<p><font>For Oracle and Oci8, there are two ways to connect. First is to use the TNS 
-	name defined in your local tnsnames.ora (or ONAMES or HOSTNAMES). Place the 
-	name in the $database field, and set the $host field to false. Alternatively, 
-	set $host to the server, and $database to the database SID, this bypassed 
-	tnsnames.ora. 
-</font></p><p><font>Examples: 
-</font></p><pre><font> # $oraname in tnsnames.ora/ONAMES/HOSTNAMES<br> $conn-&gt;Connect(false, 'scott', 'tiger', $oraname); <br> $conn-&gt;Connect('server:1521', 'scott', 'tiger', 'ServiceName'); # bypass tnsnames.ora</font></pre>
-<p><font>There are many examples of connecting to a database.
-See  <a href="#connect_ex">Connection Examples</a> for many examples.
-
-</font></p><p><font><b>PConnect<a name="pconnect"></a>($host,[$user],[$password],[$database])</b></font></p>
-<p><font>Persistent connect to data source or server $<b>host</b>, using userid $<b>user</b> 
-	and password $<b>password</b>. If the server supports multiple databases, 
-	connect to database $<b>database</b>.</font></p>
-<p><font>We now perform a rollback on persistent connection for selected databases since 
-	2.21, as advised in the PHP manual. See change log or source code for which 
-	databases are affected. 
-</font></p><p><font>Returns true/false depending on connection. Since 4.23, 0 is returned if the extension is not loaded.
-See Connect( ) above for more info.</font></p>
-<p><font>Since ADOdb 2.21, we also support autoRollback. If you set:</font></p>
- 
-<pre> $conn =NewADOConnection('mysql');<br> $conn-&gt;autoRollback = true; # default is false<br> $conn-&gt;PConnect(...); # rollback here</pre>
-<p> Then when doing a persistent connection with PConnect( ), ADOdb will 
-  perform a rollback first. This is because it is documented that PHP is 
-  not guaranteed to rollback existing failed transactions when 
-  persistent connections are used. This is implemented in Oracle, 
-  MySQL, PgSQL, MSSQL, ODBC currently. 
-</p><p>Since ADOdb 3.11, you can force non-persistent 
-connections even if PConnect is called by defining the constant 
-ADODB_NEVER_PERSIST  before you call PConnect.
-</p><p>
-Since 4.23, null is returned if the extension is not loaded.
-</p><p><b>NConnect<a name="nconnect"></a>($host,[$user],[$password],[$database])</b></p>
-<p>Always force a new connection. In contrast, PHP sometimes reuses connections 
-	when you use Connect() or PConnect(). Currently works only on mysql (PHP 4.3.0 
-	or later), postgresql and oci8-derived drivers. For other drivers, NConnect() works like 
-	Connect().</p>
-<p><font><b>IsConnected( )<a name="isconnected"></a></b></font></p>
-<p>
-<font>Returns true if connected to database. Added in 4.53.
-
-</font></p><p><font><b>Execute<a name="execute"></a>($sql,$inputarr=false)</b></font></p>
-<p><font>Execute SQL statement $<b>sql</b> and return derived class of ADORecordSet 
-	if successful. Note that a record set is always returned on success, even 
-	if we are executing an insert or update statement. You can also pass in $sql a statement prepared 
-	in <a href="#prepare">Prepare()</a>.</font></p>
-<p><font>Returns derived class of ADORecordSet. Eg. if connecting via mysql, then ADORecordSet_mysql 
-	would be returned. False is returned if there was an error in executing the 
-	sql.</font></p>
-<p><font>The $inputarr parameter can be used for binding variables to parameters. Below 
-	is an Oracle example:</font></p>
-<pre><font> $conn-&gt;Execute("SELECT * FROM TABLE WHERE COND=:val", array('val'=gt; $val));<br> </font></pre>
-<p><font>Another example, using ODBC,which uses the ? convention:</font></p>
-<pre><font>  $conn-&gt;Execute("SELECT * FROM TABLE WHERE COND=?", array($val));<br></font></pre>
-<font><a name="binding"></a>
-<i>Binding variables</i></font><p>
-<font>Variable binding speeds the compilation and caching of SQL statements, leading 
-to higher performance. Currently Oracle, Interbase and ODBC supports variable binding. 
-Interbase/ODBC style ? binding is emulated in databases that do not support binding. 
-Note that you do not have to quote strings if you use binding.
-</font></p><p><font> Variable binding in the odbc, interbase and oci8po drivers. 
-</font></p><pre><font>$rs = $db-&gt;Execute('select * from table where val=?', array('10'));<br></font></pre>
-<font>Variable binding in the oci8 driver: 
-</font><pre><font>$rs = $db-&gt;Execute('select name from table where val=:key', <br>  array('key' =gt; 10));<br></font></pre>
-<font><a name="bulkbind"></a>
-<i>Bulk binding</i>
-</font><p><font>Since ADOdb 3.80, we support bulk binding in Execute(), in which you pass in a 2-dimensional array to
-be bound to an INSERT/UPDATE or DELETE statement.
-</font></p><pre><font>$arr = array(<br>	array('Ahmad',32),<br>	array('Zulkifli', 24),<br>	array('Rosnah', 21)<br>	);<br>$ok = $db-&gt;Execute('insert into table (name,age) values (?,?)',$arr);<br></font></pre>
-<p><font>This provides very high performance as the SQL statement is prepared first. 
-The prepared statement is executed repeatedly for each array row until all rows are completed, 
-or until the first error. Very useful for importing data.
-
-</font></p><p><font><b>CacheExecute<a name="cacheexecute"></a>([$secs2cache,]$sql,$inputarr=false)</b></font></p>
-<p><font>Similar to Execute, except that the recordset is cached for $secs2cache seconds 
-	in the $ADODB_CACHE_DIR directory, and $inputarr only accepts 1-dimensional arrays. 
-	If CacheExecute() is called again with the same $sql, $inputarr, 
-	and also the same database, same userid, and the cached recordset 
-	has not expired, the cached recordset is returned. 
-</font></p><pre><font>  include('adodb.inc.php'); <br>  include('tohtml.inc.php');<br>  $ADODB_<b>CACHE_DIR</b> = '/usr/local/ADOdbcache';<br>  $conn =ADONewConnection('mysql'); <br>  $conn-&gt;PConnect('localhost','userid','password','database');<br>  $rs = $conn-&gt;<b>CacheExecute</b>(15, 'select * from table'); # cache 15 secs<br>  rs2html($rs); /* recordset to html table */  <br></font></pre>
-<p><font> Alternatively, since ADOdb 1.80, the $secs2cache parameter is optional:</font></p>
-<pre><font>	$conn-&gt;Connect(...);<br>   	$conn-&gt;cacheSecs = 3600*24; // cache 24 hours<br>	$rs = $conn-&gt;CacheExecute('select * from table');<br></font></pre>
-<font>If $secs2cache is omitted, we use the value 
-in $connection-&gt;cacheSecs (default is 3600 seconds, or 1 hour). Use CacheExecute() 
-only with SELECT statements. 
-</font><p><font>Performance note: I have done some benchmarks and found that they vary so greatly 
-	that it's better to talk about when caching is of benefit. When your database 
-	server is <i>much slower </i>than your Web server or the database is <i>very 
-	overloaded </i>then ADOdb's caching is good because it reduces the load on 
-	your database server. If your database server is lightly loaded or much faster 
-	than your Web server, then caching could actually reduce performance. </font></p>
-<p><font><b>ExecuteCursor<a name="executecursor"></a>($sql,$cursorName='rs',$parameters=false)</b></font></p>
-<p><font>Execute an Oracle stored procedure, and returns an Oracle REF cursor variable as 
-	a regular ADOdb recordset. Does not work with any other database except oci8. 
-	Thanks to Robert Tuttle for the design.
-</font></p><pre><font>    $db = ADONewConnection("oci8"); <br>    $db-&gt;Connect("foo.com:1521", "uid", "pwd", "FOO"); <br>    $rs = $db-&gt;ExecuteCursor("begin :cursorvar := getdata(:param1); end;", <br>					'cursorvar',<br>					array('param1'=gt;10)); <br>    # $rs is now just like any other ADOdb recordset object<br>    rs2html($rs);</font></pre>
-<p><font>ExecuteCursor() is a helper function that does the following internally: 
-</font></p><pre><font>	$stmt = $db-&gt;Prepare("begin :cursorvar := getdata(:param1); end;", true); <br>	$db-&gt;Parameter($stmt, $cur, 'cursorvar', false, -1, OCI_B_CURSOR);<br>	$rs = $db-&gt;Execute($stmt,$bindarr);<br></font></pre>
-<p><font>ExecuteCursor only accepts 1 out parameter. So if you have 2 out parameters, use:
-</font></p><pre><font>	$vv = 'A%';<br>	$stmt = $db-&gt;PrepareSP("BEGIN list_tabs(:crsr,:tt); END;");<br>	$db-&gt;OutParameter($stmt, $cur, 'crsr', -1, OCI_B_CURSOR);<br>	$db-&gt;OutParameter($stmt, $vv, 'tt', 32); # return varchar(32)<br>	$arr = $db-&gt;GetArray($stmt);<br>	print_r($arr);<br>	echo " val = $vv"; ## outputs 'TEST'<br></font></pre>
-<font>for the following PL/SQL:
-</font><pre><font>	TYPE TabType IS REF CURSOR RETURN TAB%ROWTYPE;<br><br>	PROCEDURE list_tabs(tabcursor IN OUT TabType,tablenames IN OUT VARCHAR) IS<br>	BEGIN<br>		OPEN tabcursor FOR SELECT * FROM TAB WHERE tname LIKE tablenames;<br>		tablenames := 'TEST';<br>	END list_tabs;<br></font></pre>
-<p><font><b>SelectLimit<a name="selectlimit"></a>($sql,$numrows=-1,$offset=-1,$inputarr=false)</b></font></p>
-<p><font>Returns a recordset if successful. Returns false otherwise. Performs a select 
-	statement, simulating PostgreSQL's SELECT statement, LIMIT $numrows OFFSET 
-	$offset clause.</font></p>
-<p><font>In PostgreSQL, SELECT * FROM TABLE LIMIT 3 will return the first 3 records 
-	only. The equivalent is <code>$connection-&gt;SelectLimit('SELECT * FROM TABLE',3)</code>. 
-	This functionality is simulated for databases that do not possess this feature.</font></p>
-<p><font>And SELECT * FROM TABLE LIMIT 3 OFFSET 2 will return records 3, 4 and 5 (eg. 
-	after record 2, return 3 rows). The equivalent in ADOdb is <code>$connection-&gt;SelectLimit('SELECT 
-	* FROM TABLE',3,2)</code>.</font></p>
-<p><font>Note that this is the <i>opposite</i> of MySQL's LIMIT clause. You can also 
-	set <code>$connection-&gt;SelectLimit('SELECT * FROM TABLE',-1,10)</code> to 
-	get rows 11 to the last row.</font></p>
-<p><font>The last parameter $inputarr is for databases that support variable binding 
-	such as Oracle oci8. This substantially reduces SQL compilation overhead. 
-	Below is an Oracle example:</font></p>
-<pre><font> $conn-&gt;SelectLimit("SELECT * FROM TABLE WHERE COND=:val", 100,-1,array('val'=gt; $val));<br> </font></pre>
-<p><font>The oci8po driver (oracle portable driver) uses the more standard bind variable 
-	of ?: 
-</font></p><pre><font> $conn-&gt;SelectLimit("SELECT * FROM TABLE WHERE COND=?", 100,-1,array('val'=gt; $val));<br></font></pre>
-<p><font> 
-</font></p><p><font>Ron Wilson reports that SelectLimit does not work with UNIONs. 
-</font></p><p><font><b>CacheSelectLimit<a name="cacheselectlimit"></a>([$secs2cache,] $sql, $numrows=-1,$offset=-1,$inputarr=false)</b></font></p>
-<p><font>Similar to SelectLimit, except that the recordset returned is cached for $secs2cache 
-	seconds in the $ADODB_CACHE_DIR directory. </font></p>
-<p><font>Since 1.80, $secs2cache has been optional, and you can define the caching time 
-	in $connection-&gt;cacheSecs.</font></p>
- 
-<pre><font>	$conn-&gt;Connect(...);<br>   $conn-&gt;cacheSecs = 3600*24; // cache 24 hours<br>	$rs = $conn-&gt;CacheSelectLimit('select * from table',10);</font></pre>
-<font> 
-</font><p><font><b>CacheFlush<a name="cacheflush"></a>($sql=false,$inputarr=false)</b></font></p>
-<p><font>Flush (delete) any cached recordsets for the SQL statement $sql in $ADODB_CACHE_DIR. 
-</font></p><p><font>If no parameter is passed in, then all adodb_*.cache files are deleted. 
-</font></p>
-  <p>CacheSelectLimit() rewrites the SQL query, so you won't be able to pass the SQL to CacheFlush. In this case,
-   to flush the cached SQL recordset returned by CacheSelectLimit(), set $secs2cache to -1:
-<pre>
-	$db->CacheSelectLimit(-1, $sql, $nrows);
-</pre>
-<p><font> If you want to flush all cached recordsets manually, execute the following 
-	PHP code (works only under Unix): <br>
-	<code> &nbsp; system("rm -f `find ".$ADODB_CACHE_DIR." -name 
-	adodb_*.cache`");</code></font></p>
-<p><font>For general cleanup of all expired files, you should use <a href="http://www.superscripts.com/tutorial/crontab.html">crontab</a> 
-	on Unix, or at.exe on Windows, and a shell script similar to the following:<font face="Courier New, Courier, mono"><br>
-	#------------------------------------------------------ <br>
-	# This particular example deletes files in the TMPPATH <br>
-	# directory with the string ".cache" in their name that <br>
-	# are more than 7 days old. <br>
-	#------------------------------------------------------ <br>
-	AGED=7 <br>
-	find ${TMPPATH} -mtime +$AGED | grep "\.cache" | xargs rm -f <br>
-	</font> </font></p>
-<p><font><b>MetaError<a name="metaerror"></a>($errno=false)</b></font></p>
-<p><font>Returns a virtualized error number, based on PEAR DB's error number system. You might
-need to include adodb-error.inc.php before you call this function. The parameter $errno
-is the native error number you want to convert. If you do not pass any parameter, MetaError
-will call ErrorNo() for you and convert it. If the error number cannot be virtualized, MetaError 
-will return -1 (DB_ERROR).</font></p>
-
-<p><font><b>MetaErrorMsg<a name="metaerrormsg"></a>($errno)</b></font></p>
-<p><font>Pass the error number returned by MetaError() for the equivalent textual error message.</font></p>
-<p><font><b>ErrorMsg<a name="errormsg"></a>()</b></font></p>
-<p><font>Returns the last status or error message. The error message is reset after every 
-call to Execute(). 
-</font></p><p>
-<font>This can return a string even if 
-	no error occurs. In general you do not need to call this function unless an 
-	ADOdb function returns false on an error. </font></p>
-<p><font>Note: If <b>debug</b> is enabled, the SQL error message is always displayed 
-	when the <b>Execute</b> function is called.</font></p>
-<p><font><b>ErrorNo<a name="errorno"></a>()</b></font></p>
-<p><font>Returns the last error number. The error number is reset after every call to Execute(). 
-If 0 is returned, no error occurred.
-</font></p><p>
-<font>Note that old versions of PHP (pre 4.0.6) do 
-	not support error number for ODBC. In general you do not need to call this 
-	function unless an ADOdb function returns false on an error.</font></p>
-<p><font><b>IgnoreErrors<a name="ignoreerrors"></a>($saveErrHandlers)</b></font></p>
-<p>Allows you to ignore errors so that StartTrans()/CompleteTrans() is not affected, nor is the default error handler called if an error occurs.
-Useful when you want to check if a field or table exists in a database without invoking an error if it does not exist.
-<p>Usage:
-<pre>
-$saveErrHandlers = $conn->IgnoreErrors();
-$rs = $conn->Execute("select field from some_table_that_might_not_exist");
-$conn->IgnoreErrors($saveErrHandlers);
-</pre>
-<p>Warning: do not call StartTrans()/CompleteTrans() inside a code block that is using IgnoreErrors().
-<p><font><b>SetFetchMode<a name="setfetchmode"></a>($mode)</b></font></p>
-<p><font>Sets the current fetch mode for the connection and stores 
-	it in $db-&gt;fetchMode. Legal modes are ADODB_FETCH_ASSOC and ADODB_FETCH_NUM. 
-	For more info, see <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a>.</font></p>
-<p><font>Returns the previous fetch mode, which could be false 
-	if SetFetchMode( ) has not been called before.</font></p>
-<font> 
-</font><p><font><b>CreateSequence<a name="createseq"></a>($seqName = 'adodbseq',$startID=1)</b></font></p>
-<p><font>Create a sequence. The next time GenID( ) is called, the value returned will 
-	be $startID. Added in 2.60. 
-</font></p><p><font><b>DropSequence<a name="dropseq"></a>($seqName = 'adodbseq')</b></font></p>
-<p><font>Delete a sequence. Added in 2.60. 
-</font></p><p><font><b>GenID<a name="genid"></a>($seqName = 'adodbseq',$startID=1)</b></font></p>
-<p><font>Generate a sequence number . Works for interbase, 
-	mysql, postgresql, oci8, oci8po, mssql, ODBC based (access,vfp,db2,etc) drivers 
-	currently. Uses $seqName as the name of the sequence. GenID() will automatically 
-	create the sequence for you if it does not exist (provided the userid has 
-	permission to do so). Otherwise you will have to create the sequence yourself. 
-</font></p><p><font> If your database driver emulates sequences, the name of the table is the sequence 
-	name. The table has one column, "id" which should be of type integer, or if 
-	you need something larger - numeric(16). 
-</font></p><p><font> For ODBC and databases that do not support sequences natively (eg mssql, mysql), 
-	we create a table for each sequence. If the sequence has not been defined 
-	earlier, it is created with the starting value set in $startID.</font></p>
-<p><font>Note that the mssql driver's GenID() before 1.90 used to generate 16 byte GUID's.</font></p>
-<p><font><b>UpdateBlob<a name="updateblob"></a>($table,$column,$val,$where)</b></font></p>
-<font>Allows you to store a blob (in $val) into $table into $column in a row at $where. 
-</font><p><font> Usage: 
-</font></p><p><font> 
-</font></p><pre><font>	# for oracle<br>	$conn-&gt;Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, empty_blob())');<br>	$conn-&gt;UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');<br>	<br>	# non oracle databases<br>	$conn-&gt;Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');<br>	$conn-&gt;UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');<br></font></pre>
-<p><font> Returns true if succesful, false otherwise. Supported by MySQL, PostgreSQL, 
-	Oci8, Oci8po and Interbase drivers. Other drivers might work, depending on 
-	the state of development.</font></p>
-<p><font>Note that when an Interbase blob is retrieved using SELECT, it still needs 
-	to be decoded using $connection-&gt;DecodeBlob($blob); to derive the original 
-	value in versions of PHP before 4.1.0. 
-</font></p><p><font>For PostgreSQL, you can store your blob using blob oid's or as a bytea field. 
-	You can use bytea fields but not blob oid's currently with UpdateBlob( ). 
-	Conversely UpdateBlobFile( ) supports oid's, but not bytea data.<br>
-	<br>
-	If you do not pass in an oid, then UpdateBlob() assumes that you are storing 
-	in bytea fields.
-	<p>If you do not have any blob fields, you can improve you can improve general SQL query performance by disabling blob handling with $connection->disableBlobs = true.
-</p></font><p><font><b>UpdateClob<a name="updateclob"></a>($table,$column,$val,$where)</b></font></p>
-<font>Allows you to store a clob (in $val) into $table into $column in a row at $where. 
-Similar to UpdateBlob (see above), but for Character Large OBjects. 
-</font><p><font> Usage:
-</font></p><pre><font>	# for oracle<br>	$conn-&gt;Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, empty_clob())');<br>	$conn-&gt;UpdateBlob('clobtable','clobcol',$clobvalue,'id=1');<br>	<br>	# non oracle databases<br>	$conn-&gt;Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, null)');<br>	$conn-&gt;UpdateBlob('clobtable','clobcol',$clobvalue,'id=1');<br></font></pre>
-<p><font><b>UpdateBlobFile<a name="updateblobfile"></a>($table,$column,$path,$where,$blobtype='BLOB')</b></font></p>
-<p><font>Similar to UpdateBlob, except that we pass in a file path to where the blob 
-	resides.
-</font></p><p><font>For PostgreSQL, if you are using blob oid's, use this interface. This interface 
-	does not support bytea fields.
-</font></p><p><font>Returns true if successful, false otherwise. 
-</font></p><p><font><b>BlobEncode<a name="blobencode" id="blobencode"></a>($blob)</b> 
-</font></p><p><font>Some databases require blob's to be encoded manually before upload. Note if 
-	you use UpdateBlob( ) or UpdateBlobFile( ) the conversion is done automatically 
-	for you and you do not have to call this function. For PostgreSQL, currently, 
-	BlobEncode() can only be used for bytea fields.
-</font></p><p><font>Returns the encoded blob value.
-</font></p><p><font>Note that there is a connection property called <em>blobEncodeType</em> which 
-	has 3 legal values: 
-</font></p><p><font>false - no need to perform encoding or decoding.<br>
-	'I' - blob encoding required, and returned encoded blob is a numeric value 
-	(no need to quote).<br>
-	'C' - blob encoding required, and returned encoded blob is a character value 
-	(requires quoting).
-</font></p><p><font>This is purely for documentation purposes, so that programs that accept multiple 
-	database drivers know what is the right thing to do when processing blobs.
-</font></p><p><font><strong>BlobDecode<a name="blobdecode"></a>($blob, $maxblobsize = false)</strong> 
-</font></p><p><font>Some databases require blob's to be decoded manually after doing a select statement. 
-	If the database does not require decoding, then this function will return 
-	the blob unchanged. Currently BlobDecode is only required for one database, 
-	PostgreSQL, and only if you are using blob oid's (if you are using bytea fields, 
-	we auto-decode for you).</font> The default maxblobsize is set in $connection-&gt;maxblobsize, which 
-	is set to 256K in adodb 4.54. </p><p>
-	In ADOdb 4.54 and later, the blob is the return value. In earlier versions, the blob data is sent to stdout.</p><font>
-</font><p></p><pre><font>$rs = $db-&gt;Execute("select bloboid from postgres_table where id=$key");<br>$blob = $db-&gt;BlobDecode( reset($rs-&gt;fields) );</font></pre>
-<p><font><b>Replace<a name="replace"></a>($table, $arrFields, $keyCols,$autoQuote=false)</b></font></p>
-<p><font>Try to update a record, and if the record is not found, an insert statement 
-	is generated and executed. Returns 0 on failure, 1 if update statement worked, 
-	2 if no record was found and the insert was executed successfully. This differs 
-	from MySQL's replace which deletes the record and inserts a new record. This 
-	also means you cannot update the primary key. The only exception to this is 
-	Interbase and its derivitives, which uses delete and insert because of some 
-	Interbase API limitations. 
-</font></p><p><font>The parameters are $table which is the table name, the $arrFields which is an 
-	associative array where the keys are the field names, and $keyCols is the name 
-	of the primary key, or an array of field names if it is a compound key. If 
-	$autoQuote is set to true, then Replace() will quote all values that are non-numeric; 
-	auto-quoting will not quote nulls. Note that auto-quoting will not work if 
-	you use SQL functions or operators. 
-</font></p><p><font>Examples: 
-</font></p><pre><font># single field primary key<br>$ret = $db-&gt;Replace('atable', <br>	array('id'=gt;1000,'firstname'=gt;'Harun','lastname'=gt;'Al-Rashid'),<br>	'id',$autoquote = true);	<br># generates UPDATE atable SET firstname='Harun',lastname='Al-Rashid' WHERE id=1000<br># or INSERT INTO atable (id,firstname,lastname) VALUES (1000,'Harun','Al-Rashid')<br><br># compound key<br>$ret = $db-&gt;Replace('atable2', <br>	array('firstname'=gt;'Harun','lastname'=gt;'Al-Rashid', 'age' =gt; 33, 'birthday' =gt; 'null'),<br>	array('lastname','firstname'),<br>	$autoquote = true);<br><br># no auto-quoting<br>$ret = $db-&gt;Replace('atable2', <br>	array('firstname'=gt;"'Harun'",'lastname'=gt;"'Al-Rashid'", 'age' =gt; 'null'),<br>	array('lastname','firstname'));	<br></font></pre>
-<p><font><b>AutoExecute<a name="autoexecute"></a>($table, $arrFields, $mode, $where=false, $forceUpdate=true,$magicq=false)</b></font></p>
-<p>Since ADOdb 4.56, you can automatically generate and execute INSERTs and UPDATEs on a given table with this
-function, which is a wrapper for GetInsertSQL() and GetUpdateSQL().
-<p>AutoExecute() inserts or updates $table given an array of $arrFields, where the keys are the field names and the array values are the 
-field values to store. Note that there is some overhead because the table is first queried to extract key information 
-before the SQL is generated. We generate an INSERT or UPDATE based on $mode (see below).
-<p>
-Legal values for $mode are 
-<ul>
-<li>'INSERT' or 1 or DB_AUTOQUERY_INSERT
-<li>'UPDATE' or 2 or DB_AUTOQUERY_UPDATE
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h2>ADOConnection<a name=adoconnection></a></h2>
+
+<p>Object that performs the connection to the database, executes SQL statements
+and has a set of utility functions for standardising the format of SQL
+statements for issues such as concatenation and date formats.</p>
+
+<h3>ADOConnection Fields</h3>
+
+<p><b>databaseType</b>: Name of the database system we are connecting to. Eg. <b>odbc</b>
+or <b>mssql</b> or <b>mysql</b>.</p>
+
+<p><b>dataProvider</b>: The underlying mechanism used to connect to the
+database. Normally set to <b>native</b>, unless using <b>odbc</b> or <b>ado</b>.</p>
+
+<p><b>host: </b>Name of server or data source name (DSN) to connect to.</p>
+
+<p><b>database</b>: Name of the database or to connect to. If ado is used, it
+will hold the ado data provider.</p>
+
+<p><b>user</b>: Login id to connect to database. Password is not saved for
+security reasons.</p>
+
+<p><b>raiseErrorFn</b>: Allows you to define an error handling function. See
+adodb-errorhandler.inc.php for an example.</p>
+
+<p><b>debug</b>: Set to <i>true</i> to make debug statements to appear.</p>
+
+<p><b>concat_operator</b>: Set to '+' or '||' normally. The operator used to
+concatenate strings in SQL. Used by the <b><a href="#concat">Concat</a></b>
+function.</p>
+
+<p><b>fmtDate</b>: The format used by the <b><a href="#dbdate">DBDate</a></b>
+function to send dates to the database. is '#Y-m-d#' for Microsoft Access, and
+''Y-m-d'' for MySQL.</p>
+
+<p><b>fmtTimeStamp: </b>The format used by the <b><a href="#dbtimestamp">DBTimeStamp</a></b>
+function to send timestamps to the database. </p>
+
+<p><b>true</b>: The value used to represent true.Eg. '.T.'. for Foxpro, '1' for
+Microsoft SQL.</p>
+
+<p><b>false: </b>The value used to represent false. Eg. '.F.'. for Foxpro, '0'
+for Microsoft SQL.</p>
+
+<p><b>replaceQuote</b>: The string used to escape quotes. Eg. double
+single-quotes for Microsoft SQL, and backslash-quote for MySQL. Used by <a
+href="#qstr">qstr</a>.</p>
+
+<p><b>autoCommit</b>: indicates whether automatic commit is enabled. Default is
+true.</p>
+
+<p><b>charSet</b>: set the default charset to use. Currently only
+interbase/firebird supports this.</p>
+
+<p><b>dialect</b>: set the default sql dialect to use. Currently only interbase/firebird
+supports this.</p>
+
+<p><b>role</b>: set the role. Currently only interbase/firebird supports this.</p>
+
+<p><b>metaTablesSQL</b>: SQL statement to return a list of available tables.
+Eg. <i>SHOW TABLES</i> in MySQL.</p>
+
+<p><b>genID</b>: The latest id generated by GenID() if supported by the
+database.</p>
+
+<p><b>cacheSecs</b>: The number of seconds to cache recordsets if
+CacheExecute() or CacheSelectLimit() omit the $secs2cache parameter. Defaults
+to 60 minutes.</p>
+
+<p><b>sysDate</b>: String that holds the name of the database function to call
+to get the current date. Useful for inserts and updates.</p>
+
+<p><b>sysTimeStamp</b>: String that holds the name of the database function to
+call to get the current timestamp/datetime value.</p>
+
+<p><b>leftOuter</b>: String that holds operator for left outer join, if known.
+Otherwise set to false.</p>
+
+<p><b>rightOuter</b>: String that holds operator for left outer join, if known.
+Otherwise set to false.</p>
+
+<p><b>ansiOuter</b>: Boolean that if true indicates that ANSI style outer joins
+are permitted. Eg. <i>select * from table1 left join table2 on p1=p2.</i></p>
+
+<p><b>connectSID</b>: Boolean that indicates whether to treat the $database
+parameter in connects as the SID for the oci8 driver. Defaults to false. Useful
+for Oracle 8.0.5 and earlier.</p>
+
+<p><b>autoRollback</b>: Persistent connections are auto-rollbacked in PConnect(
+) if this is set to true. Default is false.</p>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h3>ADOConnection Main Functions</h3>
+
+<p><b>ADOConnection( )</b></p>
+
+<p>Constructor function. Do not call this directly. Use ADONewConnection( )
+instead.</p>
+
+<p><b>Connect<a name=connect></a>($host,[$user],[$password],[$database])</b></p>
+
+<p>Non-persistent connect to data source or server $<b>host</b>, using userid $<b>user
+</b>and password $<b>password</b>. If the server supports multiple databases,
+connect to database $<b>database</b>. </p>
+
+<p>Returns true/false depending on connection success. Since 4.23, null is
+returned if the extension is not loaded.</p>
+
+<p><st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City> Note: If
+you are using a Microsoft ADO and not OLEDB, you can set the $database
+parameter to the OLEDB data provider you are using.</p>
+
+<p>PostgreSQL: An alternative way of connecting to the database is to pass the
+standard PostgreSQL connection string in the first parameter $host, and the
+other parameters will be ignored.</p>
+
+<p>For Oracle and Oci8, there are two ways to connect. First is to use the TNS
+name defined in your local tnsnames.ora (or ONAMES or HOSTNAMES). Place the
+name in the $database field, and set the $host field to false. Alternatively,
+set $host to the server, and $database to the database SID, this bypassed
+tnsnames.ora. </p>
+
+<p>Examples: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'></span># $oraname in tnsnames.ora/ONAMES/HOSTNAMES<br>
+<span style='mso-spacerun:yes'></span>$conn-&gt;Connect(false, 'scott', 'tiger', $oraname); <br>
+<span style='mso-spacerun:yes'></span>$conn-&gt;Connect('server:1521', 'scott', 'tiger', 'ServiceName'); # bypass tnsnames.ora</pre></div>
+
+<p>There are many examples of connecting to a database. See <a
+href="#connect_ex">Connection Examples</a> for many examples. </p>
+
+<p><b>PConnect<a name=pconnect></a>($host,[$user],[$password],[$database])</b></p>
+
+<p>Persistent connect to data source or server $<b>host</b>, using userid $<b>user</b>
+and password $<b>password</b>. If the server supports multiple databases,
+connect to database $<b>database</b>.</p>
+
+<p>We now perform a rollback on persistent connection for selected databases
+since 2.21, as advised in the PHP manual. See change log or source code for
+which databases are affected. </p>
+
+<p>Returns true/false depending on connection. Since 4.23, 0 is returned if the
+extension is not loaded. See Connect( ) above for more info.</p>
+
+<p>Since ADOdb 2.21, we also support autoRollback. If you set:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'></span>$conn = &amp;NewADOConnection('mysql');<br>
+<span style='mso-spacerun:yes'></span>$conn-&gt;autoRollback = true; # default is false<br>
+<span style='mso-spacerun:yes'></span>$conn-&gt;PConnect(...); # rollback here</pre></div>
+
+<p>Then when doing a persistent connection with PConnect( ), ADOdb will perform
+a rollback first. This is because it is documented that PHP is not guaranteed
+to rollback existing failed transactions when persistent connections are used.
+This is implemented in Oracle, MySQL, PgSQL, MSSQL, ODBC currently. </p>
+
+<p>Since ADOdb 3.11, you can force non-persistent connections even if PConnect
+is called by defining the constant ADODB_NEVER_PERSIST before you call
+PConnect. </p>
+
+<p>Since 4.23, null is returned if the extension is not loaded. </p>
+
+<p><b>NConnect<a name=nconnect></a>($host,[$user],[$password],[$database])</b></p>
+
+<p>Always force a new connection. In contrast, PHP sometimes reuses connections
+when you use Connect() or PConnect(). Currently works only on mysql (PHP 4.3.0
+or later), postgresql and oci8-derived drivers. For other drivers, NConnect()
+works like Connect().</p>
+
+<p><b>IsConnected( )</b><a name=isconnected></a></p>
+
+<p>Returns true if connected to database. Added in 4.53. </p>
+
+<p><b>Execute<a name=execute></a>($sql,$inputarr=false)</b></p>
+
+<p>Execute SQL statement $<b>sql</b> and return derived class of ADORecordSet
+if successful. Note that a record set is always returned on success, even if we
+are executing an insert or update statement. You can also pass in $sql a
+statement prepared in <a href="#prepare">Prepare()</a>.</p>
+
+<p>Returns derived class of ADORecordSet. Eg. if connecting via mysql, then
+ADORecordSet_mysql would be returned. False is returned if there was an error
+in executing the sql.</p>
+
+<p>The $inputarr parameter can be used for binding variables to parameters.
+Below is an Oracle example:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'></span>$conn-&gt;Execute(&quot;SELECT * FROM TABLE WHERE COND=:val&quot;, array('val'=&gt; $val));<br>
+<span style='mso-spacerun:yes'></span></pre></div>
+
+<p>Another example, using ODBC,which uses the ? convention:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span>$conn-&gt;Execute(&quot;SELECT * FROM TABLE WHERE COND=?&quot;, array($val));</pre></div>
+
+<p class=MsoNormal><a name=binding></a><i>Binding variables</i></p>
+
+<p>Variable binding speeds the compilation and caching of SQL statements,
+leading to higher performance. Currently Oracle, Interbase and ODBC supports
+variable binding. Interbase/ODBC style ? binding is emulated in databases that
+do not support binding. Note that you do not have to quote strings if you use
+binding. </p>
+
+<p>Variable binding in the odbc, interbase and oci8po drivers. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$rs = $db-&gt;Execute('select * from table where val=?', array('10'));</pre></div>
+
+<p class=MsoNormal>Variable binding in the oci8 driver: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$rs = $db-&gt;Execute('select name from table where val=:key', <br>
+<span style='mso-spacerun:yes'> </span>array('key' =&gt; 10));</pre></div>
+
+<p class=MsoNormal><a name=bulkbind></a><i>Bulk binding</i> </p>
+
+<p>Since ADOdb 3.80, we support bulk binding in Execute(), in which you pass in
+a 2-dimensional array to be bound to an INSERT/UPDATE or DELETE statement. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$arr = array(<br>
+<span style='mso-tab-count:1'> </span>array('Ahmad',32),<br>
+<span style='mso-tab-count:1'> </span>array('Zulkifli', 24),<br>
+<span style='mso-tab-count:1'> </span>array('Rosnah', 21)<br>
+<span style='mso-tab-count:1'> </span>);<br>
+$ok = $db-&gt;Execute('insert into table (name,age) values (?,?)',$arr);</pre></div>
+
+<p>This provides very high performance as the SQL statement is prepared first.
+The prepared statement is executed repeatedly for each array row until all rows
+are completed, or until the first error. Very useful for importing data. </p>
+
+<p><b>CacheExecute<a name=cacheexecute></a>([$secs2cache,]$sql,$inputarr=false)</b></p>
+
+<p>Similar to Execute, except that the recordset is cached for $secs2cache
+seconds in the $ADODB_CACHE_DIR directory, and $inputarr only accepts
+1-dimensional arrays. If CacheExecute() is called again with the same $sql,
+$inputarr, and also the same database, same userid, and the cached recordset
+has not expired, the cached recordset is returned. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span>include('adodb.inc.php'); <br>
+<span style='mso-spacerun:yes'> </span>include('tohtml.inc.php');<br>
+<span style='mso-spacerun:yes'> </span>$ADODB_<b>CACHE_DIR</b> = '/usr/local/ADOdbcache';<br>
+<span style='mso-spacerun:yes'> </span>$conn = &amp;ADONewConnection('mysql'); <br>
+<span style='mso-spacerun:yes'> </span>$conn-&gt;PConnect('localhost','userid','password','database');<br>
+<span style='mso-spacerun:yes'> </span>$rs = $conn-&gt;<b>CacheExecute</b>(15, 'select * from table'); # cache 15 secs<br>
+<span style='mso-spacerun:yes'> </span>rs2html($rs); /* recordset to html table */<span style='mso-spacerun:yes'> </span></pre></div>
+
+<p>Alternatively, since ADOdb 1.80, the $secs2cache parameter is optional:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn-&gt;Connect(...);<br>
+<span style='mso-spacerun:yes'> </span><span style='mso-tab-count:1'> </span>$conn-&gt;cacheSecs = 3600*24; // cache 24 hours<br>
+<span style='mso-tab-count:1'> </span>$rs = $conn-&gt;CacheExecute('select * from table');</pre></div>
+
+<p class=MsoNormal>If $secs2cache is omitted, we use the value in
+$connection-&gt;cacheSecs (default is 3600 seconds, or 1 hour). Use
+CacheExecute() only with SELECT statements. </p>
+
+<p>Performance note: I have done some benchmarks and found that they vary so
+greatly that it's better to talk about when caching is of benefit. When your
+database server is <i>much slower </i>than your Web server or the database is <i>very
+overloaded </i>then ADOdb's caching is good because it reduces the load on your
+database server. If your database server is lightly loaded or much faster than
+your Web server, then caching could actually reduce performance. </p>
+
+<p><b>ExecuteCursor<a name=executecursor></a>($sql,$cursorName='rs',$parameters=false)</b></p>
+
+<p>Execute an Oracle stored procedure, and returns an Oracle REF cursor
+variable as a regular ADOdb recordset. Does not work with any other database
+except oci8. Thanks to Robert Tuttle for the design. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span>$db = ADONewConnection(&quot;oci8&quot;); <br>
+<span style='mso-spacerun:yes'> </span>$db-&gt;Connect(&quot;foo.com:1521&quot;, &quot;uid&quot;, &quot;pwd&quot;, &quot;FOO&quot;); <br>
+<span style='mso-spacerun:yes'> </span>$rs = $db-&gt;ExecuteCursor(&quot;begin :cursorvar := getdata(:param1); end;&quot;, <br>
+<span style='mso-tab-count:5'> </span>'cursorvar',<br>
+<span style='mso-tab-count:5'> </span>array('param1'=&gt;10)); <br>
+<span style='mso-spacerun:yes'> </span># $rs is now just like any other ADOdb recordset object<br>
+<span style='mso-spacerun:yes'> </span>rs2html($rs);</pre></div>
+
+<p>ExecuteCursor() is a helper function that does the following internally: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$stmt = $db-&gt;Prepare(&quot;begin :cursorvar := getdata(:param1); end;&quot;, true); <br>
+<span style='mso-tab-count:1'> </span>$db-&gt;Parameter($stmt, $cur, 'cursorvar', false, -1, OCI_B_CURSOR);<br>
+<span style='mso-tab-count:1'> </span>$rs = $db-&gt;Execute($stmt,$bindarr);</pre></div>
+
+<p>ExecuteCursor only accepts 1 out parameter. So if you have 2 out parameters,
+use: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$vv = 'A%';<br>
+<span style='mso-tab-count:1'> </span>$stmt = $db-&gt;PrepareSP(&quot;BEGIN list_tabs(:crsr,:tt); END;&quot;);<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;OutParameter($stmt, $cur, 'crsr', -1, OCI_B_CURSOR);<br>
+<span style='mso-tab-count:1'> </span>$db-&gt;OutParameter($stmt, $vv, 'tt', 32); # return varchar(32)<br>
+<span style='mso-tab-count:1'> </span>$arr = $db-&gt;GetArray($stmt);<br>
+<span style='mso-tab-count:1'> </span>print_r($arr);<br>
+<span style='mso-tab-count:1'> </span>echo &quot; val = $vv&quot;; ## outputs 'TEST'</pre></div>
+
+<p class=MsoNormal>for the following PL/SQL: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>TYPE TabType IS REF CURSOR RETURN TAB%ROWTYPE;<br>
+<br>
+<span style='mso-tab-count:1'> </span>PROCEDURE list_tabs(tabcursor IN OUT TabType,tablenames IN OUT VARCHAR) IS<br>
+<span style='mso-tab-count:1'> </span>BEGIN<br>
+<span style='mso-tab-count:2'> </span>OPEN tabcursor FOR SELECT * FROM TAB WHERE tname LIKE tablenames;<br>
+<span style='mso-tab-count:2'> </span>tablenames := 'TEST';<br>
+<span style='mso-tab-count:1'> </span>END list_tabs;</pre></div>
+
+<p><b>SelectLimit<a name=selectlimit></a>($sql,$numrows=-1,$offset=-1,$inputarr=false)</b></p>
+
+<p>Returns a recordset if successful. Returns false otherwise. Performs a
+select statement, simulating PostgreSQL's SELECT statement, LIMIT $numrows
+OFFSET $offset clause.</p>
+
+<p>In PostgreSQL, SELECT * FROM TABLE LIMIT 3 will return the first 3 records
+only. The equivalent is <code><span style='font-size:10.0pt'>$connection-&gt;SelectLimit('SELECT
+* FROM TABLE',3)</span></code>. This functionality is simulated for databases
+that do not possess this feature.</p>
+
+<p>And SELECT * FROM TABLE LIMIT 3 OFFSET 2 will return records 3, 4 and 5 (eg.
+after record 2, return 3 rows). The equivalent in ADOdb is <code><span
+style='font-size:10.0pt'>$connection-&gt;SelectLimit('SELECT * FROM TABLE',3,2)</span></code>.</p>
+
+<p>Note that this is the <i>opposite</i> of MySQL's LIMIT clause. You can also
+set <code><span style='font-size:10.0pt'>$connection-&gt;SelectLimit('SELECT *
+FROM TABLE',-1,10)</span></code> to get rows 11 to the last row.</p>
+
+<p>The last parameter $inputarr is for databases that support variable binding
+such as Oracle oci8. This substantially reduces SQL compilation overhead. Below
+is an Oracle example:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'></span>$conn-&gt;SelectLimit(&quot;SELECT * FROM TABLE WHERE COND=:val&quot;, 100,-1,array('val'=&gt; $val));<br>
+<span style='mso-spacerun:yes'></span></pre></div>
+
+<p>The oci8po driver (oracle portable driver) uses the more standard bind
+variable of ?: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'></span>$conn-&gt;SelectLimit(&quot;SELECT * FROM TABLE WHERE COND=?&quot;, 100,-1,array('val'=&gt; $val));</pre></div>
+
+<p>Ron Wilson reports that SelectLimit does not work with UNIONs. </p>
+
+<p><b>CacheSelectLimit<a name=cacheselectlimit></a>([$secs2cache,] $sql,
+$numrows=-1,$offset=-1,$inputarr=false)</b></p>
+
+<p>Similar to SelectLimit, except that the recordset returned is cached for
+$secs2cache seconds in the $ADODB_CACHE_DIR directory. </p>
+
+<p>Since 1.80, $secs2cache has been optional, and you can define the caching
+time in $connection-&gt;cacheSecs.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn-&gt;Connect(...);<br>
+<span style='mso-spacerun:yes'> </span>$conn-&gt;cacheSecs = 3600*24; // cache 24 hours<br>
+<span style='mso-tab-count:1'> </span>$rs = $conn-&gt;CacheSelectLimit('select * from table',10);</pre></div>
+
+<p><b>CacheFlush<a name=cacheflush></a>($sql=false,$inputarr=false)</b></p>
+
+<p>Flush (delete) any cached recordsets for the SQL statement $sql in
+$ADODB_CACHE_DIR. </p>
+
+<p>If no parameter is passed in, then all adodb_*.cache files are deleted. </p>
+
+<p>CacheSelectLimit() rewrites the SQL query, so you won't be able to pass the
+SQL to CacheFlush. In this case, to flush the cached SQL recordset returned by
+CacheSelectLimit(), set $secs2cache to -1: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;CacheSelectLimit(-1, $sql, $nrows);</pre></div>
+
+<p>If you want to flush all cached recordsets manually, execute the following
+PHP code (works only under Unix): <br>
+<code><span style='font-size:10.0pt'>&nbsp; system(&quot;rm -f `find
+&quot;.$ADODB_CACHE_DIR.&quot; -name adodb_*.cache`&quot;);</span></code></p>
+
+<p>For general cleanup of all expired files, you should use <a
+href="http://www.superscripts.com/tutorial/crontab.html">crontab</a> on Unix,
+or at.exe on Windows, and a shell script similar to the following:<span
+style='font-family:"Courier New"'><br>
+#------------------------------------------------------ <br>
+# This particular example deletes files in the TMPPATH <br>
+# directory with the string &quot;.cache&quot; in their name that <br>
+# are more than 7 days old. <br>
+#------------------------------------------------------ <br>
+AGED=7 <br>
+find ${TMPPATH} -mtime +$AGED | grep &quot;\.cache&quot; | xargs rm -f </span></p>
+
+<p><b>MetaError<a name=metaerror></a>($errno=false)</b></p>
+
+<p>Returns a virtualized error number, based on PEAR DB's error number system.
+You might need to include adodb-error.inc.php before you call this function.
+The parameter $errno is the native error number you want to convert. If you do
+not pass any parameter, MetaError will call ErrorNo() for you and convert it.
+If the error number cannot be virtualized, MetaError will return -1 (DB_ERROR).</p>
+
+<p><b>MetaErrorMsg<a name=metaerrormsg></a>($errno)</b></p>
+
+<p>Pass the error number returned by MetaError() for the equivalent textual
+error message.</p>
+
+<p><b>ErrorMsg<a name=errormsg></a>()</b></p>
+
+<p>Returns the last status or error message. The error message is reset after
+every call to Execute(). </p>
+
+<p>This can return a string even if no error occurs. In general you do not need
+to call this function unless an ADOdb function returns false on an error. </p>
+
+<p>Note: If <b>debug</b> is enabled, the SQL error message is always displayed
+when the <b>Execute</b> function is called.</p>
+
+<p><b>ErrorNo<a name=errorno></a>()</b></p>
+
+<p>Returns the last error number. The error number is reset after every call to
+Execute(). If 0 is returned, no error occurred. </p>
+
+<p>Note that old versions of PHP (pre 4.0.6) do not support error number for
+ODBC. In general you do not need to call this function unless an ADOdb function
+returns false on an error.</p>
+
+<p><b>IgnoreErrors<a name=ignoreerrors></a>($saveErrHandlers)</b></p>
+
+<p>Allows you to ignore errors so that StartTrans()/CompleteTrans() is not
+affected, nor is the default error handler called if an error occurs. Useful
+when you want to check if a field or table exists in a database without
+invoking an error if it does not exist. </p>
+
+<p>Usage: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>$saveErrHandlers = $conn-&gt;IgnoreErrors();</pre><pre>$rs = $conn-&gt;Execute(&quot;select field from some_table_that_might_not_exist&quot;);</pre><pre>$conn-&gt;IgnoreErrors($saveErrHandlers);</pre></div>
+
+<p>Warning: do not call StartTrans()/CompleteTrans() inside a code block that
+is using IgnoreErrors(). </p>
+
+<p><b>SetFetchMode<a name=setfetchmode></a>($mode)</b></p>
+
+<p>Sets the current fetch mode for the connection and stores it in
+$db-&gt;fetchMode. Legal modes are ADODB_FETCH_ASSOC and ADODB_FETCH_NUM. For
+more info, see <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a>.</p>
+
+<p>Returns the previous fetch mode, which could be false if SetFetchMode( ) has
+not been called before.</p>
+
+<p><b>CreateSequence<a name=createseq></a>($seqName = 'adodbseq',$startID=1)</b></p>
+
+<p>Create a sequence. The next time GenID( ) is called, the value returned will
+be $startID. Added in 2.60. </p>
+
+<p><b>DropSequence<a name=dropseq></a>($seqName = 'adodbseq')</b></p>
+
+<p>Delete a sequence. Added in 2.60. </p>
+
+<p><b>GenID<a name=genid></a>($seqName = 'adodbseq',$startID=1)</b></p>
+
+<p>Generate a sequence number . Works for interbase, mysql, postgresql, oci8,
+oci8po, mssql, ODBC based (access,vfp,db2,etc) drivers currently. Uses $seqName
+as the name of the sequence. GenID() will automatically create the sequence for
+you if it does not exist (provided the userid has permission to do so).
+Otherwise you will have to create the sequence yourself. </p>
+
+<p>If your database driver emulates sequences, the name of the table is the
+sequence name. The table has one column, &quot;id&quot; which should be of type
+integer, or if you need something larger - numeric(16). </p>
+
+<p>For ODBC and databases that do not support sequences natively (eg mssql,
+mysql), we create a table for each sequence. If the sequence has not been
+defined earlier, it is created with the starting value set in $startID.</p>
+
+<p>Note that the mssql driver's GenID() before 1.90 used to generate 16 byte
+GUID's.</p>
+
+<p><b>UpdateBlob<a name=updateblob></a>($table,$column,$val,$where)</b></p>
+
+<p class=MsoNormal>Allows you to store a blob (in $val) into $table into
+$column in a row at $where. </p>
+
+<p>Usage: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span># for oracle<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, empty_blob())');<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');<br>
+<span style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span># non oracle databases<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');</pre></div>
+
+<p>Returns true if succesful, false otherwise. Supported by MySQL, PostgreSQL,
+Oci8, Oci8po and Interbase drivers. Other drivers might work, depending on the
+state of development.</p>
+
+<p>Note that when an Interbase blob is retrieved using SELECT, it still needs
+to be decoded using $connection-&gt;DecodeBlob($blob); to derive the original
+value in versions of PHP before 4.1.0. </p>
+
+<p>For PostgreSQL, you can store your blob using blob oid's or as a bytea field.
+You can use bytea fields but not blob oid's currently with UpdateBlob( ).
+Conversely UpdateBlobFile( ) supports oid's, but not bytea data.<br>
+<br>
+If you do not pass in an oid, then UpdateBlob() assumes that you are storing in
+bytea fields. </p>
+
+<p>If you do not have any blob fields, you can improve you can improve general
+SQL query performance by disabling blob handling with
+$connection-&gt;disableBlobs = true. </p>
+
+<p><b>UpdateClob<a name=updateclob></a>($table,$column,$val,$where)</b></p>
+
+<p class=MsoNormal>Allows you to store a clob (in $val) into $table into
+$column in a row at $where. Similar to UpdateBlob (see above), but for
+Character Large OBjects. </p>
+
+<p>Usage: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span># for oracle<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, empty_clob())');<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;UpdateBlob('clobtable','clobcol',$clobvalue,'id=1');<br>
+<span style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span># non oracle databases<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, null)');<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;UpdateBlob('clobtable','clobcol',$clobvalue,'id=1');</pre></div>
+
+<p><b>UpdateBlobFile<a name=updateblobfile></a>($table,$column,$path,$where,$blobtype='BLOB')</b></p>
+
+<p>Similar to UpdateBlob, except that we pass in a file path to where the blob
+resides. </p>
+
+<p>For PostgreSQL, if you are using blob oid's, use this interface. This
+interface does not support bytea fields. </p>
+
+<p>Returns true if successful, false otherwise. </p>
+
+<p><b>BlobEncode<a name=blobencode id=blobencode></a>($blob)</b> </p>
+
+<p>Some databases require blob's to be encoded manually before upload. Note if
+you use UpdateBlob( ) or UpdateBlobFile( ) the conversion is done automatically
+for you and you do not have to call this function. For PostgreSQL, currently,
+BlobEncode() can only be used for bytea fields. </p>
+
+<p>Returns the encoded blob value. </p>
+
+<p>Note that there is a connection property called <em>blobEncodeType</em>
+which has 3 legal values: </p>
+
+<p>false - no need to perform encoding or decoding.<br>
+'I' - blob encoding required, and returned encoded blob is a numeric value (no
+need to quote).<br>
+'C' - blob encoding required, and returned encoded blob is a character value
+(requires quoting). </p>
+
+<p>This is purely for documentation purposes, so that programs that accept
+multiple database drivers know what is the right thing to do when processing
+blobs. </p>
+
+<p><strong>BlobDecode<a name=blobdecode></a>($blob, $maxblobsize = false)</strong>
+</p>
+
+<p>Some databases require blob's to be decoded manually after doing a select
+statement. If the database does not require decoding, then this function will
+return the blob unchanged. Currently BlobDecode is only required for one
+database, PostgreSQL, and only if you are using blob oid's (if you are using
+bytea fields, we auto-decode for you). The default maxblobsize is set in
+$connection-&gt;maxblobsize, which is set to 256K in adodb 4.54. </p>
+
+<p>In ADOdb 4.54 and later, the blob is the return value. In earlier versions,
+the blob data is sent to stdout.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$rs = $db-&gt;Execute(&quot;select bloboid from postgres_table where id=$key&quot;);<br>
+$blob = $db-&gt;BlobDecode( reset($rs-&gt;fields) );</pre></div>
+
+<p><b>Replace<a name=replace></a>($table, $arrFields,
+$keyCols,$autoQuote=false)</b></p>
+
+<p>Try to update a record, and if the record is not found, an insert statement
+is generated and executed. Returns 0 on failure, 1 if update statement worked,
+2 if no record was found and the insert was executed successfully. This differs
+from MySQL's replace which deletes the record and inserts a new record. This
+also means you cannot update the primary key. The only exception to this is
+Interbase and its derivitives, which uses delete and insert because of some
+Interbase API limitations. </p>
+
+<p>The parameters are $table which is the table name, the $arrFields which is
+an associative array where the keys are the field names, and $keyCols is the
+name of the primary key, or an array of field names if it is a compound key. If
+$autoQuote is set to true, then Replace() will quote all values that are
+non-numeric; auto-quoting will not quote nulls. Note that auto-quoting will not
+work if you use SQL functions or operators. </p>
+
+<p>Examples: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'># single field primary key<br>
+$ret = $db-&gt;Replace('atable', <br>
+<span style='mso-tab-count:1'> </span>array('id'=&gt;1000,'firstname'=&gt;'Harun','lastname'=&gt;'Al-Rashid'),<br>
+<span style='mso-tab-count:1'> </span>'id',$autoquote = true);<span
+style='mso-tab-count:1'> </span><br>
+# generates UPDATE atable SET firstname='Harun',lastname='Al-Rashid' WHERE id=1000<br>
+# or INSERT INTO atable (id,firstname,lastname) VALUES (1000,'Harun','Al-Rashid')<br>
+<br>
+# compound key<br>
+$ret = $db-&gt;Replace('atable2', <br>
+<span style='mso-tab-count:1'> </span>array('firstname'=&gt;'Harun','lastname'=&gt;'Al-Rashid', 'age' =&gt; 33, 'birthday' =&gt; 'null'),<br>
+<span style='mso-tab-count:1'> </span>array('lastname','firstname'),<br>
+<span style='mso-tab-count:1'> </span>$autoquote = true);<br>
+<br>
+# no auto-quoting<br>
+$ret = $db-&gt;Replace('atable2', <br>
+<span style='mso-tab-count:1'> </span>array('firstname'=&gt;&quot;'Harun'&quot;,'lastname'=&gt;&quot;'Al-Rashid'&quot;, 'age' =&gt; 'null'),<br>
+<span style='mso-tab-count:1'> </span>array('lastname','firstname'));<span
+style='mso-tab-count:1'> </span></pre></div>
+
+<p><b>AutoExecute<a name=autoexecute></a>($table, $arrFields, $mode,
+$where=false, $forceUpdate=true,$magicq=false)</b></p>
+
+<p>Since ADOdb 4.56, you can automatically generate and execute INSERTs and
+UPDATEs on a given table with this function, which is a wrapper for
+GetInsertSQL() and GetUpdateSQL(). </p>
+
+<p>AutoExecute() inserts or updates $table given an array of $arrFields, where
+the keys are the field names and the array values are the field values to
+store. Note that there is some overhead because the table is first queried to
+extract key information before the SQL is generated. We generate an INSERT or
+UPDATE based on $mode (see below). </p>
+
+<p>Legal values for $mode are </p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l5 level1 lfo9;tab-stops:list 36.0pt'>'INSERT' or 1 or DB_AUTOQUERY_INSERT
+     </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l5 level1 lfo9;tab-stops:list 36.0pt'>'UPDATE' or 2 or
+     DB_AUTOQUERY_UPDATE </li>
 </ul>
-<p>You have to define the constants DB_AUTOQUERY_UPDATE and DB_AUTOQUERY_INSERT yourself or include adodb-pear.inc.php.
-<p>The $where clause is required if $mode == 'UPDATE'. If $forceUpdate=false then we will query the 
-database first and check if the field value returned by the query matches the current field value; only if they differ do we update that field.
-<p>Returns true on success, false on error.
-<p>An example of its use is:
-<pre>
-$record["firstName"] = "Carol";
-$record["lasTname"] = "Smith"; 
-$conn->AutoExecute($table,$record,'INSERT');
-# executes <i>"INSERT INTO $table (firstName,lasTname) values ('Carol',Smith')"</i>;
-
-$record["firstName"] = "Carol";
-$record["lasTname"] = "Jones"; 
-$conn->AutoExecute($table,$record,'UPDATE', "lastname like 'Sm%'");
-# executes <i>"UPDATE $table SET firstName='Carol',lasTname='Jones' WHERE lastname like 'Sm%'"</i>;
-</pre>
-<p>Note: One of the strengths of ADOdb's AutoExecute() is that only valid field names for $table are updated. If $arrFields
-contains keys that are invalid field names for $table, they are ignored. There is some overhead in doing this as we have to 
-query the database to get the field names, but given that you are not directly coding the SQL yourself, you probably aren't interested in
-speed at all, but convenience.
-<p>Since 4.62, the table name to be used can be overridden by setting $rs->tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is called.
-<p>Since 4.94, setting the global variable $ADODB_QUOTE_FIELDNAMES to true will force field names to be auto-quoted in AutoExecute(), GetInsertSQL() and GetUpdateSQL(). </p>
-<p><font><b>GetUpdateSQL<a name="getupdatesql"></a>(&amp;$rs, $arrFields, $forceUpdate=false,$magicq=false, $force=null)</b></font></p>
-<p><font>Generate SQL to update a table given a recordset $rs, and the modified fields 
-	of the array $arrFields (which must be an associative array holding the column 
-	names and the new values) are compared with the current recordset. If $forceUpdate 
-	is true, then we also generate the SQL even if $arrFields is identical to 
-	$rs-&gt;fields. Requires the recordset to be associative. $magicq is used 
-	to indicate whether magic quotes are enabled (see qstr()). The field names in the array 
-	are case-insensitive.</font></p>
-<font>	</font><p><font>Since 4.52, we allow you to pass the $force type parameter, and this overrides the <a href="#ADODB_FORCE_TYPE">$ADODB_FORCE_TYPE</a>
-	global variable.
-<p>Since 4.62, the table name to be used can be overridden by setting $rs->tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is called.
-</p></font><p><font><b>GetInsertSQL<a name="getinsertsql"></a>(&amp;$rs, $arrFields,$magicq=false,$force_type=false)</b></font></p>
-<p><font>Generate SQL to insert into a table given a recordset $rs. Requires the query 
-	to be associative. $magicq is used to indicate whether magic quotes are enabled 
-	(for qstr()). The field names in the array are case-insensitive.</font></p>
-<p>
-<font>  Since 2.42, you can pass a  table name instead of a recordset into 
+
+<p>You have to define the constants DB_AUTOQUERY_UPDATE and DB_AUTOQUERY_INSERT
+yourself or include adodb-pear.inc.php. </p>
+
+<p>The $where clause is required if $mode == 'UPDATE'. If $forceUpdate=false
+then we will query the database first and check if the field value returned by
+the query matches the current field value; only if they differ do we update
+that field. </p>
+
+<p>Returns true on success, false on error. </p>
+
+<p>An example of its use is: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>$record[&quot;firstName&quot;] = &quot;Carol&quot;;</pre><pre>$record[&quot;lasTname&quot;] = &quot;Smith&quot;; </pre><pre>$conn-&gt;AutoExecute($table,$record,'INSERT');</pre><pre># executes <i>&quot;INSERT INTO $table (firstName,lasTname) values ('Carol',Smith')&quot;</i>;</pre><pre><o:p>&nbsp;</o:p></pre><pre>$record[&quot;firstName&quot;] = &quot;Carol&quot;;</pre><pre>$record[&quot;lasTname&quot;] = &quot;Jones&quot;; </pre><pre>$conn-&gt;AutoExecute($table,$record,'UPDATE', &quot;lastname like 'Sm%'&quot;);</pre><pre># executes <i>&quot;UPDATE $table SET firstName='Carol',lasTname='Jones' WHERE lastname like 'Sm%'&quot;</i>;</pre></div>
+
+<p>Note: One of the strengths of ADOdb's AutoExecute() is that only valid field
+names for $table are updated. If $arrFields contains keys that are invalid
+field names for $table, they are ignored. There is some overhead in doing this
+as we have to query the database to get the field names, but given that you are
+not directly coding the SQL yourself, you probably aren't interested in speed
+at all, but convenience. </p>
+
+<p>Since 4.62, the table name to be used can be overridden by setting
+$rs-&gt;tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is
+called. </p>
+
+<p>Since 4.94, setting the global variable $ADODB_QUOTE_FIELDNAMES to true will
+force field names to be auto-quoted in AutoExecute(), GetInsertSQL() and
+GetUpdateSQL(). </p>
+
+<p><b>GetUpdateSQL<a name=getupdatesql></a>(&amp;$rs, $arrFields,
+$forceUpdate=false,$magicq=false, $force=null)</b></p>
+
+<p>Generate SQL to update a table given a recordset $rs, and the modified
+fields of the array $arrFields (which must be an associative array holding the
+column names and the new values) are compared with the current recordset. If
+$forceUpdate is true, then we also generate the SQL even if $arrFields is
+identical to $rs-&gt;fields. Requires the recordset to be associative. $magicq
+is used to indicate whether magic quotes are enabled (see qstr()). The field
+names in the array are case-insensitive.</p>
+
+<p>Since 4.52, we allow you to pass the $force type parameter, and this
+overrides the <a href="#ADODB_FORCE_TYPE">$ADODB_FORCE_TYPE</a> global
+variable. </p>
+
+<p>Since 4.62, the table name to be used can be overridden by setting
+$rs-&gt;tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is
+called. </p>
+
+<p><b>GetInsertSQL<a name=getinsertsql></a>(&amp;$rs, $arrFields,$magicq=false,$force_type=false)</b></p>
+
+<p>Generate SQL to insert into a table given a recordset $rs. Requires the
+query to be associative. $magicq is used to indicate whether magic quotes are
+enabled (for qstr()). The field names in the array are case-insensitive.</p>
+
+<p>Since 2.42, you can pass a table name instead of a recordset into
 GetInsertSQL (in $rs), and it will generate an insert statement for that table.
-</font></p><p><font>Since 4.52, we allow you to pass the $force_type parameter, and this overrides the <a href="#ADODB_FORCE_TYPE">$ADODB_FORCE_TYPE</a>
-	global variable.
-<p>Since 4.62, the table name to be used can be overridden by setting $rs->tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is called.
-</p></font><p><font><b>PageExecute<a name="pageexecute"></a>($sql, $nrows, $page, $inputarr=false)</b> 
-</font></p><p><font>Used for pagination of recordset. $page is 1-based. See <a href="#ex8">Example 
-  8</a>.</font></p>
- 
-<p><font><b>CachePageExecute<a name="cachepageexecute"></a>($secs2cache, 
-  $sql, $nrows, $page, $inputarr=false)</b> </font></p>
-<p><font>Used for pagination of recordset. $page is 1-based. See 
-  <a href="#ex8">Example 8</a>. Caching version of PageExecute.</font></p>
-<font> 
-</font><p></p>
-<p><font><b>Close<a name="close"></a>( )</b></font></p>
-<p><font>Close the database connection. PHP4 proudly states that we no longer have to 
-  clean up at the end of the connection because the reference counting mechanism 
-  of PHP4 will automatically clean up for us.</font></p>
-<font>  </font><p><font><b>StartTrans<a name="starttrans"></a>( )</b></font></p>
-<font>  </font><p><font>Start a monitored transaction. As SQL statements are executed, ADOdb will monitor
-  for SQL errors, and if any are detected, when CompleteTrans() is called, we auto-rollback.
-  </font></p><p>
-<font>  </font></p><p><font> To understand why StartTrans() is superior to BeginTrans(), 
-  let us examine a few ways of using BeginTrans().
-  The following is the wrong way to use transactions: 
-</font></p><pre><font>$DB-&gt;BeginTrans();<br>$DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>$DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CommitTrans();<br></font></pre>
-<p><font>because you perform no error checking. It is possible to update table1 and 
-  for the update on table2 to fail. Here is a better way: 
-</font></p><pre><font>$DB-&gt;BeginTrans();<br>$ok = $DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>if ($ok) $ok = $DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>if ($ok) $DB-&gt;CommitTrans();<br>else $DB-&gt;RollbackTrans();<br></font></pre>
-<p><font>Another way is (since ADOdb 2.0): 
-</font></p><pre><font>$DB-&gt;BeginTrans();<br>$ok = $DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>if ($ok) $ok = $DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CommitTrans($ok);<br></font></pre>
-<p><font> Now it is a headache monitoring $ok all over the place. StartTrans() is an
+</p>
+
+<p>Since 4.52, we allow you to pass the $force_type parameter, and this
+overrides the <a href="#ADODB_FORCE_TYPE">$ADODB_FORCE_TYPE</a> global
+variable. </p>
+
+<p>Since 4.62, the table name to be used can be overridden by setting
+$rs-&gt;tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is
+called. </p>
+
+<p><b>PageExecute<a name=pageexecute></a>($sql, $nrows, $page, $inputarr=false)</b>
+</p>
+
+<p>Used for pagination of recordset. $page is 1-based. See <a href="#ex8">Example
+8</a>.</p>
+
+<p><b>CachePageExecute<a name=cachepageexecute></a>($secs2cache, $sql, $nrows,
+$page, $inputarr=false)</b> </p>
+
+<p>Used for pagination of recordset. $page is 1-based. See <a href="#ex8">Example
+8</a>. Caching version of PageExecute.</p>
+
+<p><b>Close<a name=close></a>( )</b></p>
+
+<p>Close the database connection. PHP4 proudly states that we no longer have to
+clean up at the end of the connection because the reference counting mechanism
+of PHP4 will automatically clean up for us.</p>
+
+<p><b>StartTrans<a name=starttrans></a>( )</b></p>
+
+<p>Start a monitored transaction. As SQL statements are executed, ADOdb will
+monitor for SQL errors, and if any are detected, when CompleteTrans() is
+called, we auto-rollback. </p>
+
+<p>To understand why StartTrans() is superior to BeginTrans(), let us examine a
+few ways of using BeginTrans(). The following is the wrong way to use
+transactions: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$DB-&gt;BeginTrans();<br>
+$DB-&gt;Execute(&quot;update table1 set val=$val1 where id=$id&quot;);<br>
+$DB-&gt;Execute(&quot;update table2 set val=$val2 where id=$id&quot;);<br>
+$DB-&gt;CommitTrans();</pre></div>
+
+<p>because you perform no error checking. It is possible to update table1 and
+for the update on table2 to fail. Here is a better way: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$DB-&gt;BeginTrans();<br>
+$ok = $DB-&gt;Execute(&quot;update table1 set val=$val1 where id=$id&quot;);<br>
+if ($ok) $ok = $DB-&gt;Execute(&quot;update table2 set val=$val2 where id=$id&quot;);<br>
+if ($ok) $DB-&gt;CommitTrans();<br>
+else $DB-&gt;RollbackTrans();</pre></div>
+
+<p>Another way is (since ADOdb 2.0): </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$DB-&gt;BeginTrans();<br>
+$ok = $DB-&gt;Execute(&quot;update table1 set val=$val1 where id=$id&quot;);<br>
+if ($ok) $ok = $DB-&gt;Execute(&quot;update table2 set val=$val2 where id=$id&quot;);<br>
+$DB-&gt;CommitTrans($ok);</pre></div>
+
+<p>Now it is a headache monitoring $ok all over the place. StartTrans() is an
 improvement because it monitors all SQL errors for you. This is particularly
-useful if you are calling black-box functions in which SQL queries might be executed.
- Also all BeginTrans, CommitTrans and RollbackTrans calls inside a StartTrans block 
-  will be disabled, so even if the black box function does a commit, it will be ignored.
-</font></p><pre><font>$DB-&gt;StartTrans();<br>CallBlackBox();<br>$DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>$DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CompleteTrans();<br></font></pre>
-<p><font>Note that a StartTrans blocks are nestable, the inner blocks are ignored.
- </font></p><p><font><b>CompleteTrans<a name="completetrans"></a>($autoComplete=true)</b></font></p>
-<font>  </font><p><font>Complete a transaction called with StartTrans(). This function monitors
-  for SQL errors, and will commit if no errors have occured, otherwise it will rollback. 
-  Returns true on commit, false on rollback. If the parameter $autoComplete is true
-  monitor sql errors and commit and rollback as appropriate. Set $autoComplete to false 
-  to force rollback even if no SQL error detected.
-  </font></p><p><font><b>FailTrans<a name="failtrans"></a>( )</b></font></p>
-<font>  </font><p><font>Fail a transaction started with StartTrans(). The rollback will only occur when
-  CompleteTrans() is called.
-    </font></p><p><font><b>HasFailedTrans<a name="hasfailedtrans"></a>( )</b></font></p>
-<font>	</font><p><font>Check whether smart transaction has failed, 
-	eg. returns true if there was an error in SQL execution or FailTrans() was called.
-	If not within smart transaction, returns false.
-</font></p><p><font><b>BeginTrans<a name="begintrans"></a>( )</b></font></p>
-<p><font>Begin a transaction. Turns off autoCommit. Returns true if successful. Some 
-  databases will always return false if transaction support is not available. 
-   Any open transactions will be rolled back when the connection is closed. Among the
-   databases that support transactions are Oracle, PostgreSQL, Interbase, MSSQL, certain
-    versions of MySQL, DB2, Informix, Sybase, etc.</font></p>
-<font> </font><p><font>Note that <a href="#starttrans">StartTrans()</a> and CompleteTrans() is a superior method of 
- handling transactions, available since ADOdb 3.40. For a explanation, see the <a href="#starttrans">StartTrans()</a> documentation.
-
-</font></p><p><font>You can also use the ADOdb <a href="#errorhandling">error handler</a> to die 
-  and rollback your transactions for you transparently. Some buggy database extensions 
-  are known to commit all outstanding tranasactions, so you might want to explicitly 
-  do a $DB-&gt;RollbackTrans() in your error handler for safety. 
- </font></p><h4><font>Detecting Transactions</font></h4>
-<font> </font><p><font>Since ADOdb 2.50, you are able to detect when you are inside a transaction. Check
- that $connection-&gt;transCnt &gt; 0. This variable is incremented whenever BeginTrans() is called,
- and decremented whenever RollbackTrans() or CommitTrans() is called.
-</font></p><p><font><b>CommitTrans<a name="committrans"></a>($ok=true)</b></font></p>
-<p><font>End a transaction successfully. Returns true if successful. If the database 
-  does not support transactions, will return true also as data is always committed. 
-</font></p>
-<p><font>If you pass the parameter $ok=false, the data is rolled back. See example in 
-  BeginTrans().</font></p>
-<p><font><b>RollbackTrans<a name="rollbacktrans"></a>( )</b></font></p>
-<p><font>End a transaction, rollback all changes. Returns true if successful. If the 
-  database does not support transactions, will return false as data is never rollbacked. 
-</font></p>
- 
-<p><font><b>SetTransactionMode<a name="SetTransactionMode"></a>($mode )</b></font></p>
-<p>SetTransactionMode allows you to pass in the transaction mode to use for all subsequent transactions. 
-Note: if you have persistent connections and using mssql or mysql, you might have to explicitly reset your transaction mode at the beginning of each page request. 
-This is only supported in postgresql, mssql, mysql with InnoDB and oci8 currently. For example:
-<pre>
-$db->SetTransactionMode("SERIALIZABLE");
-$db->BeginTrans();
-$db->Execute(...); $db->Execute(...);
-$db->CommiTrans();
-
-$db->SetTransactionMode(""); // restore to default
-$db->StartTrans();
-$db->Execute(...); $db->Execute(...);
-$db->CompleteTrans();
-</pre>
+useful if you are calling black-box functions in which SQL queries might be
+executed. Also all BeginTrans, CommitTrans and RollbackTrans calls inside a
+StartTrans block will be disabled, so even if the black box function does a
+commit, it will be ignored. </p>
 
-<p>Supported values to pass in:
-<ul>
-<li>READ UNCOMMITTED (allows dirty reads, but fastest)
-<li>READ COMMITTED (default postgres, mssql and oci8)
-<li>REPEATABLE READ (default mysql)
-<li>SERIALIZABLE (slowest and most restrictive)
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$DB-&gt;StartTrans();<br>
+CallBlackBox();<br>
+$DB-&gt;Execute(&quot;update table1 set val=$val1 where id=$id&quot;);<br>
+$DB-&gt;Execute(&quot;update table2 set val=$val2 where id=$id&quot;);<br>
+$DB-&gt;CompleteTrans();</pre></div>
+
+<p>Note that a StartTrans blocks are nestable, the inner blocks are ignored. </p>
+
+<p><b>CompleteTrans<a name=completetrans></a>($autoComplete=true)</b></p>
+
+<p>Complete a transaction called with StartTrans(). This function monitors for
+SQL errors, and will commit if no errors have occured, otherwise it will
+rollback. Returns true on commit, false on rollback. If the parameter
+$autoComplete is true monitor sql errors and commit and rollback as
+appropriate. Set $autoComplete to false to force rollback even if no SQL error
+detected. </p>
+
+<p><b>FailTrans<a name=failtrans></a>( )</b></p>
+
+<p>Fail a transaction started with StartTrans(). The rollback will only occur
+when CompleteTrans() is called. </p>
+
+<p><b>HasFailedTrans<a name=hasfailedtrans></a>( )</b></p>
+
+<p>Check whether smart transaction has failed, eg. returns true if there was an
+error in SQL execution or FailTrans() was called. If not within smart
+transaction, returns false. </p>
+
+<p><b>BeginTrans<a name=begintrans></a>( )</b></p>
+
+<p>Begin a transaction. Turns off autoCommit. Returns true if successful. Some
+databases will always return false if transaction support is not available. Any
+open transactions will be rolled back when the connection is closed. Among the
+databases that support transactions are Oracle, PostgreSQL, Interbase, MSSQL,
+certain versions of MySQL, DB2, Informix, Sybase, etc.</p>
+
+<p>Note that <a href="#starttrans">StartTrans()</a> and CompleteTrans() is a
+superior method of handling transactions, available since ADOdb 3.40. For a
+explanation, see the <a href="#starttrans">StartTrans()</a> documentation. </p>
+
+<p>You can also use the ADOdb <a href="#errorhandling">error handler</a> to die
+and rollback your transactions for you transparently. Some buggy database
+extensions are known to commit all outstanding tranasactions, so you might want
+to explicitly do a $DB-&gt;RollbackTrans() in your error handler for safety. </p>
+
+<h4>Detecting Transactions</h4>
+
+<p>Since ADOdb 2.50, you are able to detect when you are inside a transaction.
+Check that $connection-&gt;transCnt &gt; 0. This variable is incremented whenever
+BeginTrans() is called, and decremented whenever RollbackTrans() or
+CommitTrans() is called. </p>
+
+<p><b>CommitTrans<a name=committrans></a>($ok=true)</b></p>
+
+<p>End a transaction successfully. Returns true if successful. If the database
+does not support transactions, will return true also as data is always
+committed. </p>
+
+<p>If you pass the parameter $ok=false, the data is rolled back. See example in
+BeginTrans().</p>
+
+<p><b>RollbackTrans<a name=rollbacktrans></a>( )</b></p>
+
+<p>End a transaction, rollback all changes. Returns true if successful. If the
+database does not support transactions, will return false as data is never
+rollbacked. </p>
+
+<p><b>SetTransactionMode<a name=SetTransactionMode></a>($mode )</b></p>
+
+<p>SetTransactionMode allows you to pass in the transaction mode to use for all
+subsequent transactions. Note: if you have persistent connections and using
+mssql or mysql, you might have to explicitly reset your transaction mode at the
+beginning of each page request. This is only supported in postgresql, mssql,
+mysql with InnoDB and oci8 currently. For example: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>$db-&gt;SetTransactionMode(&quot;SERIALIZABLE&quot;);</pre><pre>$db-&gt;BeginTrans();</pre><pre>$db-&gt;Execute(...); $db-&gt;Execute(...);</pre><pre>$db-&gt;CommiTrans();</pre><pre><o:p>&nbsp;</o:p></pre><pre>$db-&gt;SetTransactionMode(&quot;&quot;); // restore to default</pre><pre>$db-&gt;StartTrans();</pre><pre>$db-&gt;Execute(...); $db-&gt;Execute(...);</pre><pre>$db-&gt;CompleteTrans();</pre></div>
+
+<p>Supported values to pass in: </p>
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l1 level1 lfo10;tab-stops:list 36.0pt'>READ UNCOMMITTED (allows
+     dirty reads, but fastest) </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l1 level1 lfo10;tab-stops:list 36.0pt'>READ COMMITTED (default
+     postgres, mssql and oci8) </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l1 level1 lfo10;tab-stops:list 36.0pt'>REPEATABLE READ (default
+     mysql) </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l1 level1 lfo10;tab-stops:list 36.0pt'>SERIALIZABLE (slowest and
+     most restrictive) </li>
 </ul>
-<p>You can also pass in database specific values such as 'SNAPSHOT' for mssql or 'READ ONLY' for oci8/postgres.
-<p>See transaction levels for <a href=http://www.postgresql.org/docs/8.1/interactive/sql-set-transaction.html>PostgreSQL</a>,
-<a href=http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_10005.htm>Oracle</a>,
-<a href=http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html>MySQL</a>, and
-<a href=http://msdn2.microsoft.com/en-US/ms173763.aspx>MS SQL Server</a>.
-<p><font><b>GetAssoc<a name="getassoc1"></a>($sql,$inputarr=false,$force_array=false,$first2cols=false)</b></font></p>
-<p><font>Returns an associative array for the given query $sql with optional bind parameters 
-  in $inputarr. If the number of columns returned is greater to two, a 2-dimensional 
-  array is returned, with the first column of the recordset becomes the keys 
-  to the rest of the rows. If the columns is equal to two, a 1-dimensional array 
-  is created, where the the keys directly map to the values (unless $force_array 
-  is set to true, when an array is created for each value).
-</font></p><p><font> Examples:<a name="getassocex"></a></font></p>
-
-<p><font>We have the following data in a recordset:</font></p>
-<p><font>row1: Apple, Fruit, Edible<br>
-  row2: Cactus, Plant, Inedible<br>
-  row3: Rose, Flower, Edible</font></p>
-<p><font>GetAssoc will generate the following 2-dimensional associative 
-  array:</font></p>
-<p><font>Apple =gt; array[Fruit, Edible]<br>
-  Cactus =gt; array[Plant, Inedible]<br>
-  Rose =gt; array[Flower,Edible]</font></p>
-<p><font>If the dataset is:</font></p>
-<p><font>row1: Apple, Fruit<br>
+
+<p>You can also pass in database specific values such as 'SNAPSHOT' for mssql
+or 'READ ONLY' for oci8/postgres. </p>
+
+<p>See transaction levels for <a
+href="http://www.postgresql.org/docs/8.1/interactive/sql-set-transaction.html">PostgreSQL</a>,
+<a
+href="http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_10005.htm">Oracle</a>,
+<a href="http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html">MySQL</a>,
+and <a href="http://msdn2.microsoft.com/en-US/ms173763.aspx">MS SQL Server</a>.
+</p>
+
+<p><b>GetAssoc<a name=getassoc1></a>($sql,$inputarr=false,$force_array=false,$first2cols=false)</b></p>
+
+<p>Returns an associative array for the given query $sql with optional bind
+parameters in $inputarr. If the number of columns returned is greater to two, a
+2-dimensional array is returned, with the first column of the recordset becomes
+the keys to the rest of the rows. If the columns is equal to two, a 1-dimensional
+array is created, where the the keys directly map to the values (unless
+$force_array is set to true, when an array is created for each value). </p>
+
+<p>Examples:<a name=getassocex></a></p>
+
+<p>We have the following data in a recordset:</p>
+
+<p>row1: Apple, Fruit, Edible<br>
+row2: Cactus, Plant, Inedible<br>
+row3: Rose, Flower, Edible</p>
+
+<p>GetAssoc will generate the following 2-dimensional associative array:</p>
+
+<p>Apple =&gt; array[Fruit, Edible]<br>
+Cactus =&gt; array[Plant, Inedible]<br>
+Rose =&gt; array[Flower,Edible]</p>
+
+<p>If the dataset is:</p>
+
+<p>row1: Apple, Fruit<br>
 row2: Cactus, Plant<br>
-row3: Rose, Flower </font></p>
-<p><font>GetAssoc will generate the following 1-dimensional associative
-  array (with $force_array==false):</font></p>
-<p><font>Apple =gt; Fruit</font><br>
-  Cactus=gt;Plant<br>
-  Rose=gt;Flower </p>
-<p><font>The function returns:</font></p>
-<p><font>The associative array, or false if an error occurs.</font></p>
-<font>
-<p><b>CacheGetAssoc<a name="cachegetassoc"></a>([$secs2cache,] $sql,$inputarr=false,$force_array=false,$first2cols=false)</b></p>
-</font>
-<p><font>Caching version of <a href="#getassoc1">GetAssoc</a> function above.
-</font></p><p><font><b>GetOne<a name="getone"></a>($sql,$inputarr=false)</b></font></p>
-<p><font>Executes the SQL and returns the first field of the first row. The recordset 
-  and remaining rows are discarded for you automatically. If an error occur, false 
-  is returned; use ErrorNo() or ErrorMsg() to get the error details.
-  Since 4.96, we return null if no records were found.</font></p>
-<p><font><b>GetRow<a name="getrow"></a>($sql,$inputarr=false)</b></font></p>
-<p><font>Executes the SQL and returns the first row as an array. The recordset and remaining 
-  rows are discarded for you automatically. If no data is found, an empty recordset is returned. If an error occurs, false is returned.</font></p>
-<p><font><b>GetAll<a name="getall"></a>($sql,$inputarr=false)</b></font></p>
-
-<p>Executes the SQL and returns the all the rows as a 2-dimensional 
-  array. The recordset is discarded for you automatically. If an error occurs, 
-  false is returned. <i>GetArray</i> is a synonym for <i>GetAll</i>.</p>
- <p><b>GetCol<a name="getcol"></a>($sql,$inputarr=false,$trim=false)</b></p>
-
-<p><font>Executes the SQL and returns all elements of the first column as a 
-1-dimensional array. The recordset is discarded for you automatically. If an error occurs, 
-  false is returned.</font></p>
-<p><font><b>CacheGetOne<a name="cachegetone"></a>([$secs2cache,] 
-  $sql,$inputarr=false), CacheGetRow<a name="cachegetrow"></a>([$secs2cache,] $sql,$inputarr=false), CacheGetAll<a name="cachegetall"></a>([$secs2cache,] 
-  $sql,$inputarr=false), CacheGetCol<a name="cachegetcol"></a>([$secs2cache,] 
-  $sql,$inputarr=false,$trim=false)</b></font></p>
-<font> 
-</font><p><font>Similar to above Get* functions, except that the recordset is serialized and 
-  cached in the $ADODB_CACHE_DIR directory for $secs2cache seconds. Good for speeding 
-  up queries on rarely changing data. Note that the $secs2cache parameter is optional. 
-  If omitted, we use the value in $connection-&gt;cacheSecs (default is 3600 seconds, 
-  or 1 hour).</font></p>
-<p><font><b>Prepare<a name="prepare"></a>($sql )</b></font></p>
- 
-<p><font>Prepares (compiles) an SQL query for repeated execution. Bind parameters
-are denoted by ?, except for the oci8 driver, which uses the traditional Oracle :varname
-convention. 
-  </font></p>
-<p><font>Returns an array containing the original sql statement 
-  in the first array element; the remaining elements of the array are driver dependent. 
-  If there is an error, or we are emulating Prepare( ), we return the original 
-  $sql string. This is because all error-handling has been centralized in Execute( 
-  ).</font></p>
-<p><font>Prepare( ) cannot be used with functions that use SQL 
-  query rewriting techniques, e.g. PageExecute( ) and SelectLimit( ).</font></p>
+row3: Rose, Flower </p>
+
+<p>GetAssoc will generate the following 1-dimensional associative array (with
+$force_array==false):</p>
+
+<p>Apple =&gt; Fruit<br>
+Cactus=&gt;Plant<br>
+Rose=&gt;Flower </p>
+
+<p>The function returns:</p>
+
+<p>The associative array, or false if an error occurs.</p>
+
+<p><b>CacheGetAssoc<a name=cachegetassoc></a>([$secs2cache,] $sql,$inputarr=false,$force_array=false,$first2cols=false)</b></p>
+
+<p>Caching version of <a href="#getassoc1">GetAssoc</a> function above. </p>
+
+<p><b>GetMedian<a name=getmedian></a>($table, $field, $where='')</b></p>
+
+<p>Returns the median value of $field for $table. The $where clause is
+optional. If used, make sure the WHERE is included, as in &quot;WHERE name &gt;
+'A'&quot;. If an error occurs, false is returned. Since ADOdb 5.06 and PHP
+4.991. </p>
+
+<p><b>GetOne<a name=getone></a>($sql,$inputarr=false)</b></p>
+
+<p>Executes the SQL and returns the first field of the first row. The recordset
+and remaining rows are discarded for you automatically. If an error occur,
+false is returned; use ErrorNo() or ErrorMsg() to get the error details. Since
+4.96/5.00, we return null if no records were found. And since 4.991/5.06, you
+can have change the return value if no records are found using the global
+variable $ADODB_GETONE_EOF: $ADODB_GETONE_EOF = false;</p>
+
+<p><b>GetRow<a name=getrow></a>($sql,$inputarr=false)</b></p>
+
+<p>Executes the SQL and returns the first row as an array. The recordset and
+remaining rows are discarded for you automatically. If no records are returned,
+an empty array is returned. If an error occurs, false is returned.</p>
+
+<p><b>GetAll<a name=getall></a>($sql,$inputarr=false)</b></p>
+
+<p>Executes the SQL and returns the all the rows as a 2-dimensional array. The
+recordset is discarded for you automatically. If an error occurs, false is
+returned. <i>GetArray</i> is a synonym for <i>GetAll</i>.</p>
+
+<p><b>GetCol<a name=getcol></a>($sql,$inputarr=false,$trim=false)</b></p>
+
+<p>Executes the SQL and returns all elements of the first column as a
+1-dimensional array. The recordset is discarded for you automatically. If an
+error occurs, false is returned.</p>
+
+<p><b>CacheGetOne<a name=cachegetone></a>([$secs2cache,] $sql,$inputarr=false),
+CacheGetRow<a name=cachegetrow></a>([$secs2cache,] $sql,$inputarr=false),
+CacheGetAll<a name=cachegetall></a>([$secs2cache,] $sql,$inputarr=false),
+CacheGetCol<a name=cachegetcol></a>([$secs2cache,]
+$sql,$inputarr=false,$trim=false)</b></p>
+
+<p>Similar to above Get* functions, except that the recordset is serialized and
+cached in the $ADODB_CACHE_DIR directory for $secs2cache seconds. Good for
+speeding up queries on rarely changing data. Note that the $secs2cache
+parameter is optional. If omitted, we use the value in
+$connection-&gt;cacheSecs (default is 3600 seconds, or 1 hour). </p>
+
+<p><b>Prepare<a name=prepare></a>($sql )</b></p>
+
+<p>Prepares (compiles) an SQL query for repeated execution. Bind parameters are
+denoted by ?, except for the oci8 driver, which uses the traditional Oracle
+:varname convention. </p>
+
+<p>Returns an array containing the original sql statement in the first array
+element; the remaining elements of the array are driver dependent. If there is
+an error, or we are emulating Prepare( ), we return the original $sql string.
+This is because all error-handling has been centralized in Execute( ).</p>
+
+<p>Prepare( ) cannot be used with functions that use SQL query rewriting
+techniques, e.g. PageExecute( ) and SelectLimit( ).</p>
+
 <p>Example:</p>
-<pre><font>$stmt = $DB-&gt;Prepare('insert into table (col1,col2) values (?,?)');<br>for ($i=0; $i &lt; $max; $i++)<br></font>	$DB-&gt;<font>Execute($stmt,array((string) rand(), $i));<br></font></pre>
-<font> 
-</font><p><font>Also see InParameter(), OutParameter() and PrepareSP() below. Only supported internally by interbase, 
-  oci8 and selected ODBC-based drivers, otherwise it is emulated. There is no 
-  performance advantage to using Prepare() with emulation. 
-</font></p><p><font> Important: Due to limitations or bugs in PHP, if you are getting errors when 
-  you using prepared queries, try setting $ADODB_COUNTRECS = false before preparing. 
-  This behaviour has been observed with ODBC. 
-</font></p><p><font><b>IfNull<a name="ifnull"></a>($field, $nullReplacementValue)</b></font></p>
-<p><font>Portable IFNULL function (NVL in Oracle). Returns a string that represents 
-  the function that checks whether a $field is null for the given database, and 
-  if null, change the value returned to $nullReplacementValue. Eg.</font></p>
-<pre><font>$sql = <font color="#993300">'SELECT '</font>.$db-&gt;IfNull('name', <font color="#993300">"'- unknown -'"</font>).<font color="#993300"> ' FROM table'</font>;</font></pre>
-
-<p><font><b>length<a name="length"></a></b></font></p>
-<p><font>This is not a function, but a property. Some databases have "length" and others "len"
-as the function to measure the length of a string. To use this property:
-</font></p><pre><font>  $sql = <font color="#993300">"SELECT "</font>.$db-&gt;length.<font color="#993300">"(field) from table"</font>;<br>  $rs = $db-&gt;Execute($sql);<br></font></pre>
-
-<p><font><b>random<a name="random"></a></b></font></p>
-<p><font>This is not a function, but a property. This is a string that holds the sql to
-generate a random number between 0.0 and 1.0 inclusive.
-
-</font></p><p><font><b>substr<a name="substr"></a></b></font></p>
-<p><font>This is not a function, but a property. Some databases have "substr" and others "substring"
-as the function to retrieve a sub-string. To use this property:
-</font></p><pre><font>  $sql = <font color="#993300">"SELECT "</font>.$db-&gt;substr.<font color="#993300">"(field, $offset, $length) from table"</font>;<br>  $rs = $db-&gt;Execute($sql);<br></font></pre>
-<p><font>For all databases, the 1st parameter of <i>substr</i> is the field, the 2nd is the
-offset (1-based) to the beginning of the sub-string, and the 3rd is the length of the sub-string.
-
-
-</font></p><p><font><b>Param<a name="param"></a>($name)</b></font></p>
-<p><font>Generates a bind placeholder portably. For most databases, the bind placeholder 
-  is "?". However some databases use named bind parameters such as Oracle, eg 
-  ":somevar". This allows us to portably define an SQL statement with bind parameters: 
-</font></p><pre><font>$sql = <font color="#993300">'insert into table (col1,col2) values ('</font>.$DB-&gt;Param('a').<font color="#993300">','</font>.$DB-&gt;Param('b').<font color="#993300">')'</font>;<br><font color="#006600"># generates 'insert into table (col1,col2) values (?,?)'<br># or        'insert into table (col1,col2) values (:a,:b)</font>'<br>$stmt = $DB-&gt;Prepare($sql);<br>$stmt = $DB-&gt;Execute($stmt,array('one','two'));<br></font></pre>
-<font> </font>
-<p></p>
-<p><font><b>PrepareSP</b><b><a name="preparesp"></a></b><b>($sql,
-$cursor=false )</b></font></p>
-<p><font>When calling stored procedures in mssql and oci8 (oracle),
-    and you might want to directly bind to parameters that return values, or
-for special LOB handling. PrepareSP() allows you to do so. </font></p>
-<p><font>Returns the same array or $sql string as Prepare( )
-    above. If you do not need to bind to return values, you should use Prepare(
-  ) instead.</font></p>
-<p><font>The 2nd parameter, $cursor is not used except with oci8.
-    Setting it to true will force OCINewCursor to be called; this is to support
-output REF CURSORs. </font></p>
-<p><font>For examples of usage of PrepareSP( ), see InParameter(
-) below. </font></p>
-<p><font>Note: in the mssql driver, preparing stored procedures
-    requires a special function call, mssql_init( ), which is called by this
-    function. PrepareSP( ) is available in all other drivers, and is emulated
-  by calling Prepare( ). </font></p>
-<p><font><b> InParameter<a name="inparameter"></a>($stmt, $var,
-  $name, $maxLen = 4000, $type = false )</b></font></p>
-<font>Binds a PHP variable as input to a stored procedure variable.
-The parameter <i>$stmt</i> is the value returned by PrepareSP(), <i>$var</i> is
-the PHP variable you want to bind, $name is the name of the stored procedure
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$stmt = $DB-&gt;Prepare('insert into table (col1,col2) values (?,?)');<br>
+for ($i=0; $i &lt; $max; $i++)<br>
+<span style='mso-tab-count:1'> </span>$DB-&gt;Execute($stmt,array((string) rand(), $i));</pre></div>
+
+<p>Also see InParameter(), OutParameter() and PrepareSP() below. Only supported
+internally by interbase, oci8 and selected ODBC-based drivers, otherwise it is
+emulated. There is no performance advantage to using Prepare() with emulation. </p>
+
+<p>Important: Due to limitations or bugs in PHP, if you are getting errors when
+you using prepared queries, try setting $ADODB_COUNTRECS = false before
+preparing. This behaviour has been observed with ODBC. </p>
+
+<p><b>IfNull<a name=ifnull></a>($field, $nullReplacementValue)</b></p>
+
+<p>Portable IFNULL function (NVL in Oracle). Returns a string that represents
+the function that checks whether a $field is null for the given database, and
+if null, change the value returned to $nullReplacementValue. Eg.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$sql = <span style='color:#993300'>'SELECT '</span>.$db-&gt;IfNull('name', <span
+style='color:#993300'>&quot;'- unknown -'&quot;</span>).<span style='color:
+#993300'> ' FROM table'</span>;</pre></div>
+
+<p><b>length</b><a name=length></a></p>
+
+<p>This is not a function, but a property. Some databases have
+&quot;length&quot; and others &quot;len&quot; as the function to measure the
+length of a string. To use this property: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span>$sql = <span
+style='color:#993300'>&quot;SELECT &quot;</span>.$db-&gt;length.<span
+style='color:#993300'>&quot;(field) from table&quot;</span>;<br>
+<span style='mso-spacerun:yes'> </span>$rs = $db-&gt;Execute($sql);</pre></div>
+
+<p><b>random</b><a name=random></a></p>
+
+<p>This is not a function, but a property. This is a string that holds the sql
+to generate a random number between 0.0 and 1.0 inclusive. </p>
+
+<p><b>substr</b><a name=substr></a></p>
+
+<p>This is not a function, but a property. Some databases have
+&quot;substr&quot; and others &quot;substring&quot; as the function to retrieve
+a sub-string. To use this property: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span>$sql = <span
+style='color:#993300'>&quot;SELECT &quot;</span>.$db-&gt;substr.<span
+style='color:#993300'>&quot;(field, $offset, $length) from table&quot;</span>;<br>
+<span style='mso-spacerun:yes'> </span>$rs = $db-&gt;Execute($sql);</pre></div>
+
+<p>For all databases, the 1st parameter of <i>substr</i> is the field, the 2nd
+is the offset (1-based) to the beginning of the sub-string, and the 3rd is the
+length of the sub-string. </p>
+
+<p><b>Param<a name=param></a>($name)</b></p>
+
+<p>Generates a bind placeholder portably. For most databases, the bind
+placeholder is &quot;?&quot;. However some databases use named bind parameters
+such as Oracle, eg &quot;:somevar&quot;. This allows us to portably define an
+SQL statement with bind parameters: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$sql = <span style='color:#993300'>'insert into table (col1,col2) values ('</span>.$DB-&gt;Param('a').<span
+style='color:#993300'>','</span>.$DB-&gt;Param('b').<span style='color:#993300'>')'</span>;<br>
+<span style='color:#006600'># generates 'insert into table (col1,col2) values (?,?)'<br>
+# or<span style='mso-spacerun:yes'> </span>'insert into table (col1,col2) values (:a,:b)</span>'<br>
+$stmt = $DB-&gt;Prepare($sql);<br>
+$stmt = $DB-&gt;Execute($stmt,array('one','two'));</pre></div>
+
+<p><b>PrepareSP<a name=preparesp></a>($sql, $cursor=false )</b></p>
+
+<p>When calling stored procedures in mssql and oci8 (oracle), and you might
+want to directly bind to parameters that return values, or for special LOB
+handling. PrepareSP() allows you to do so. </p>
+
+<p>Returns the same array or $sql string as Prepare( ) above. If you do not
+need to bind to return values, you should use Prepare( ) instead.</p>
+
+<p>The 2nd parameter, $cursor is not used except with oci8. Setting it to true
+will force OCINewCursor to be called; this is to support output REF CURSORs. </p>
+
+<p>For examples of usage of PrepareSP( ), see InParameter( ) below. </p>
+
+<p>Note: in the mssql driver, preparing stored procedures requires a special
+function call, mssql_init( ), which is called by this function. PrepareSP( ) is
+available in all other drivers, and is emulated by calling Prepare( ). </p>
+
+<p><b>InParameter<a name=inparameter></a>($stmt, $var, $name, $maxLen = 4000,
+$type = false )</b></p>
+
+<p class=MsoNormal>Binds a PHP variable as input to a stored procedure
+variable. The parameter <i>$stmt</i> is the value returned by PrepareSP(), <i>$var</i>
+is the PHP variable you want to bind, $name is the name of the stored procedure
 variable. Optional is <i>$maxLen</i>, the maximum length of the data to bind,
-and $type which is database dependant. Consult <a href="http://php.net/mssql_bind">mssql_bind</a> and <a href="http://php.net/ocibindbyname">ocibindbyname</a> docs
-at php.net for more info on legal values for $type. </font>
-<p>
-<font>InParameter() is a wrapper function that calls Parameter()
-with $isOutput=false. The advantage of this function is that it is self-documenting,
+and $type which is database dependant. Consult <a
+href="http://php.net/mssql_bind">mssql_bind</a> and <a
+href="http://php.net/ocibindbyname">ocibindbyname</a> docs at php.net for more
+info on legal values for $type. </p>
+
+<p>InParameter() is a wrapper function that calls Parameter() with
+$isOutput=false. The advantage of this function is that it is self-documenting,
 because the $isOutput parameter is no longer needed. Only for mssql and oci8
-currently. </font></p>
-<p><font>Here is an example using oci8: </font></p>
-<pre><font><font color="green"># For oracle, Prepare and PrepareSP are identical</font>
-$stmt = $db-&gt;PrepareSP(
-	<font color="#993300">"declare RETVAL integer; <br>	begin<br>	:RETVAL := </font><font color="#993300">SP_RUNSOMETHING</font><font color="#993300">(:myid,:group);<br>	end;"</font>);<br>$db-&gt;InParameter($stmt,$id,'myid');<br>$db-&gt;InParameter($stmt,$group,'group',64);<br>$db-&gt;OutParameter($stmt,$ret,'RETVAL');<br>$db-&gt;Execute($stmt);<br></font></pre>
-<p><font> The same example using mssql:</font></p>
-<font> 
-</font><pre><font><font color="green"># @RETVAL = SP_RUNSOMETHING @myid,@group</font>
-$stmt = $db-&gt;PrepareSP(<font color="#993333">'<font color="#993300">SP_RUNSOMETHING</font>'</font>); <br><font color="green"># note that the parameter name does not have @ in front!</font>
-$db-&gt;InParameter($stmt,$id,'myid');
-$db-&gt;InParameter($stmt,$group,'group',64);
-<font color="green"># return value in mssql - RETVAL is hard-coded name</font> <br>$db-&gt;OutParameter($stmt,$ret,'RETVAL');<br>$db-&gt;Execute($stmt); </font></pre>
-
-<p><font>Note that the only difference between the oci8 and mssql implementations is $sql.</font></p>
-<p>
-<font> If $type parameter is set to false, in mssql, $type will be dynamicly determined 
-based on the type of the PHP variable passed <font face="Courier New, Courier, mono">(string 
-=gt; SQLCHAR, boolean =gt;SQLINT1, integer =gt;SQLINT4 or float/double=gt;SQLFLT8)</font>.
-</font></p><p><font> 
-In oci8, $type can be set to OCI_B_FILE (Binary-File), OCI_B_CFILE (Character-File), 
-OCI_B_CLOB (Character-LOB), OCI_B_BLOB (Binary-LOB) and OCI_B_ROWID (ROWID). To 
-pass in a null, use<font face="Courier New, Courier, mono"> $db-&gt;Parameter($stmt, 
-$null=null, 'param')</font>. 
-  </font></p><p><font><b> OutParameter<a name="outparameter"></a>($stmt, $var, $name, 
-  $maxLen = 4000, $type = false )</b></font></p>
-<font>  Binds a PHP variable as output from a stored procedure variable. The parameter <i>$stmt</i>
- is the value returned by PrepareSP(), <i>$var</i> is the PHP variable you want to bind, <i>$name</i>
- is the name of the stored procedure variable. Optional is <i>$maxLen</i>, the maximum length of the
- data to bind, and <i>$type</i> which is database dependant. 
-</font><p>
-<font>  OutParameter() is a wrapper function that calls Parameter() with $isOutput=true. 
-  The advantage of this function is that it is self-documenting, because
-the $isOutput parameter is no longer needed.  Only for mssql 
-  and oci8 currently.
-</font></p><p>
-<font>For an example, see <a href="#inparameter">InParameter</a>.
-
-</font></p><p><font><b> Parameter<a name="parameter"></a>($stmt, $var, $name, $isOutput=false, 
-  $maxLen = 4000, $type = false )</b></font></p>
-<p><font>Note: This function is deprecated, because of the new InParameter() and OutParameter() functions.
-These are superior because they are self-documenting, unlike Parameter().
-</font></p><p><font>Adds a bind parameter suitable for return values or special data handling (eg. 
-  LOBs) after a statement has been prepared using PrepareSP(). Only for mssql 
-  and oci8 currently. The parameters are:<br>
-  <br>
-  $<i><b>stmt</b></i> Statement returned by Prepare() or PrepareSP().<br>
-  $<i><b>var</b></i> PHP variable to bind to. Make sure you pre-initialize it!<br>
-  $<i><b>name</b></i> Name of stored procedure variable name to bind to.<br>
-  [$<i><b>isOutput</b></i>] Indicates direction of parameter 0/false=IN 1=OUT 
-  2= IN/OUT. This is ignored in oci8 as this driver auto-detects the direction.<br>
-  [$<b>maxLen</b>] Maximum length of the parameter variable.<br>
-  [$<b>type</b>] Consult <a href="http://php.net/mssql_bind">mssql_bind</a> and 
-  <a href="http://php.net/ocibindbyname">ocibindbyname</a> docs at php.net for 
-  more info on legal values for type.</font></p>
-<p><font>Lastly, in oci8, bind parameters can be reused without calling PrepareSP( ) 
-  or Parameters again. This is not possible with mssql. An oci8 example:</font></p>
-<pre><font>$id = 0; $i = 0;<br>$stmt = $db-&gt;PrepareSP( <font color="#993300">"update table set val=:i where id=:id"</font>);<br>$db-&gt;Parameter($stmt,$id,'id');<br>$db-&gt;Parameter($stmt,$i, 'i');<br>for ($cnt=0; $cnt &lt; 1000; $cnt++) {<br>	$id = $cnt; <br>	$i = $cnt * $cnt; <font color="green"># works with oci8!</font>
-	$db-&gt;Execute($stmt); <br>}</font></pre>
-<p><font><b>Bind<a name="bind"></a>($stmt, $var, $size=4001, $type=false, $name=false)</b></font></p>
- 
-<p><font>This is a low-level function supported only by the oci8 
-  driver. <b>Avoid using</b> unless you only want to support Oracle. The Parameter( 
-  ) function is the recommended way to go with bind variables.</font></p>
-<p><font>Bind( ) allows you to use bind variables in your sql 
-  statement. This binds a PHP variable to a name defined in an Oracle sql statement 
-  that was previously prepared using Prepare(). Oracle named variables begin with 
-  a colon, and ADOdb requires the named variables be called :0, :1, :2, :3, etc. 
-  The first invocation of Bind() will match :0, the second invocation will match 
-  :1, etc. Binding can provide 100% speedups for insert, select and update statements. 
-  </font></p>
-<p>The other variables, $size sets the buffer size for data storage, $type is 
-  the optional descriptor type OCI_B_FILE (Binary-File), OCI_B_CFILE (Character-File), 
-  OCI_B_CLOB (Character-LOB), OCI_B_BLOB (Binary-LOB) and OCI_B_ROWID (ROWID). 
-  Lastly, instead of using the default :0, :1, etc names, you can define your 
-  own bind-name using $name. 
-</p><p><font>The following example shows 3 bind variables being used: 
-  p1, p2 and p3. These variables are bound to :0, :1 and :2.</font></p>
-<pre>$stmt = $DB-&gt;Prepare("insert into table (col0, col1, col2) values (:0, :1, :2)");<br>$DB-&gt;Bind($stmt, $p1);<br>$DB-&gt;Bind($stmt, $p2);<br>$DB-&gt;Bind($stmt, $p3);<br>for ($i = 0; $i &lt; $max; $i++) { <br>   $p1 = ?; $p2 = ?; $p3 = ?;<br>   $DB-&gt;Execute($stmt);<br>}</pre>
+currently. </p>
+
+<p>Here is an example using oci8: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='color:green'># For oracle, Prepare and PrepareSP are identical</span></pre><pre>$stmt = $db-&gt;PrepareSP(</pre><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span><span
+style='color:#993300'>&quot;declare RETVAL integer; <br>
+<span style='mso-tab-count:1'> </span>begin<br>
+<span style='mso-tab-count:1'> </span>:RETVAL := SP_RUNSOMETHING(:myid,:group);<br>
+<span style='mso-tab-count:1'> </span>end;&quot;</span>);<br>
+$db-&gt;InParameter($stmt,$id,'myid');<br>
+$db-&gt;InParameter($stmt,$group,'group',64);<br>
+$db-&gt;OutParameter($stmt,$ret,'RETVAL');<br>
+$db-&gt;Execute($stmt);</pre></div>
+
+<p>The same example using mssql:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='color:green'># @RETVAL = SP_RUNSOMETHING @myid,@group</span></pre><pre>$stmt = $db-&gt;PrepareSP(<span
+style='color:#993333'>'</span><span style='color:#993300'>SP_RUNSOMETHING</span><span
+style='color:#993333'>'</span>); <br>
+<span style='color:green'># note that the parameter name does not have @ in front!</span></pre><pre>$db-&gt;InParameter($stmt,$id,'myid');</pre><pre>$db-&gt;InParameter($stmt,$group,'group',64);</pre><pre
+style='background:#EEEEEE'><span style='color:green'># return value in mssql - RETVAL is hard-coded name</span> <br>
+$db-&gt;OutParameter($stmt,$ret,'RETVAL');<br>
+$db-&gt;Execute($stmt); </pre></div>
+
+<p>Note that the only difference between the oci8 and mssql implementations is
+$sql.</p>
+
+<p>If $type parameter is set to false, in mssql, $type will be dynamicly
+determined based on the type of the PHP variable passed <span style='font-family:
+"Courier New"'>(string =&gt; SQLCHAR, boolean =&gt;SQLINT1, integer
+=&gt;SQLINT4 or float/double=&gt;SQLFLT8)</span>. </p>
+
+<p>In oci8, $type can be set to OCI_B_FILE (Binary-File), OCI_B_CFILE
+(Character-File), OCI_B_CLOB (Character-LOB), OCI_B_BLOB (Binary-LOB) and
+OCI_B_ROWID (ROWID). To pass in a null, use<span style='font-family:"Courier New"'>
+$db-&gt;Parameter($stmt, $null=null, 'param')</span>. </p>
+
+<p><b>OutParameter<a name=outparameter></a>($stmt, $var, $name, $maxLen = 4000,
+$type = false )</b></p>
+
+<p class=MsoNormal>Binds a PHP variable as output from a stored procedure
+variable. The parameter <i>$stmt</i> is the value returned by PrepareSP(), <i>$var</i>
+is the PHP variable you want to bind, <i>$name</i> is the name of the stored
+procedure variable. Optional is <i>$maxLen</i>, the maximum length of the data
+to bind, and <i>$type</i> which is database dependant. </p>
+
+<p>OutParameter() is a wrapper function that calls Parameter() with
+$isOutput=true. The advantage of this function is that it is self-documenting,
+because the $isOutput parameter is no longer needed. Only for mssql and oci8
+currently. </p>
+
+<p>For an example, see <a href="#inparameter">InParameter</a>. </p>
+
+<p><b>Parameter<a name=parameter></a>($stmt, $var, $name, $isOutput=false,
+$maxLen = 4000, $type = false )</b></p>
+
+<p>Note: This function is deprecated, because of the new InParameter() and
+OutParameter() functions. These are superior because they are self-documenting,
+unlike Parameter(). </p>
+
+<p>Adds a bind parameter suitable for return values or special data handling
+(eg. LOBs) after a statement has been prepared using PrepareSP(). Only for
+mssql and oci8 currently. The parameters are:<br>
+<br>
+$<b><i>stmt</i></b> Statement returned by Prepare() or PrepareSP().<br>
+$<b><i>var</i></b> PHP variable to bind to. Make sure you pre-initialize it!<br>
+$<b><i>name</i></b> Name of stored procedure variable name to bind to.<br>
+[$<b><i>isOutput</i></b>] Indicates direction of parameter 0/false=IN 1=OUT 2=
+IN/OUT. This is ignored in oci8 as this driver auto-detects the direction.<br>
+[$<b>maxLen</b>] Maximum length of the parameter variable.<br>
+[$<b>type</b>] Consult <a href="http://php.net/mssql_bind">mssql_bind</a> and <a
+href="http://php.net/ocibindbyname">ocibindbyname</a> docs at php.net for more
+info on legal values for type.</p>
+
+<p>Lastly, in oci8, bind parameters can be reused without calling PrepareSP( ) or
+Parameters again. This is not possible with mssql. An oci8 example:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre>$id = 0; $i = 0;<br>
+$stmt = $db-&gt;PrepareSP( <span style='color:#993300'>&quot;update table set val=:i where id=:id&quot;</span>);<br>
+$db-&gt;Parameter($stmt,$id,'id');<br>
+$db-&gt;Parameter($stmt,$i, 'i');<br>
+for ($cnt=0; $cnt &lt; 1000; $cnt++) {<br>
+<span style='mso-tab-count:1'> </span>$id = $cnt; <br>
+<span style='mso-tab-count:1'> </span>$i = $cnt * $cnt; <span
+style='color:green'># works with oci8!</span></pre><pre style='background:#EEEEEE'><span
+style='mso-tab-count:1'> </span>$db-&gt;Execute($stmt); <br>
+}</pre></div>
+
+<p><b>Bind<a name=bind></a>($stmt, $var, $size=4001, $type=false, $name=false)</b></p>
+
+<p>This is a low-level function supported only by the oci8 driver. <b>Avoid
+using</b> unless you only want to support Oracle. The Parameter( ) function is
+the recommended way to go with bind variables.</p>
+
+<p>Bind( ) allows you to use bind variables in your sql statement. This binds a
+PHP variable to a name defined in an Oracle sql statement that was previously
+prepared using Prepare(). Oracle named variables begin with a colon, and ADOdb
+requires the named variables be called :0, :1, :2, :3, etc. The first
+invocation of Bind() will match :0, the second invocation will match :1, etc.
+Binding can provide 100% speedups for insert, select and update statements. </p>
+
+<p>The other variables, $size sets the buffer size for data storage, $type is
+the optional descriptor type OCI_B_FILE (Binary-File), OCI_B_CFILE
+(Character-File), OCI_B_CLOB (Character-LOB), OCI_B_BLOB (Binary-LOB) and
+OCI_B_ROWID (ROWID). Lastly, instead of using the default :0, :1, etc names,
+you can define your own bind-name using $name. </p>
+
+<p>The following example shows 3 bind variables being used: p1, p2 and p3.
+These variables are bound to :0, :1 and :2.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$stmt = $DB-&gt;Prepare(&quot;insert into table (col0, col1, col2) values (:0, :1, :2)&quot;);<br>
+$DB-&gt;Bind($stmt, $p1);<br>
+$DB-&gt;Bind($stmt, $p2);<br>
+$DB-&gt;Bind($stmt, $p3);<br>
+for ($i = 0; $i &lt; $max; $i++) { <br>
+<span style='mso-spacerun:yes'> </span>$p1 = ?; $p2 = ?; $p3 = ?;<br>
+<span style='mso-spacerun:yes'> </span>$DB-&gt;Execute($stmt);<br>
+}</pre></div>
+
 <p>You can also use named variables:</p>
-<pre>$stmt = $DB-&gt;Prepare("insert into table (col0, col1, col2) values (:name0, :name1, :name2)");<br>$DB-&gt;Bind($stmt, $p1, "name0");<br>$DB-&gt;Bind($stmt, $p2, "name1");<br>$DB-&gt;Bind($stmt, $p3, "name2");<br>for ($i = 0; $i &lt; $max; $i++) { <br>   $p1 = ?; $p2 = ?; $p3 = ?;<br>   $DB-&gt;Execute($stmt);<br>}</pre>
-<p><b>LogSQL($enable=true)<a name="logsql"></a></b></p>
-Call this method to install a SQL logging and timing function (using fnExecute). 
-Then all SQL statements are logged into an adodb_logsql table in a database. If 
-the adodb_logsql table does not exist, ADOdb will create the table if you have 
-the appropriate permissions. Returns the previous logging value (true for enabled, 
-false for disabled). Here are samples of the DDL for selected databases: 
-<p> 
-</p><pre>		<b>mysql:</b>
-		CREATE TABLE adodb_logsql (
-		  created datetime NOT NULL,
-		  sql0 varchar(250) NOT NULL,
-		  sql1 text NOT NULL,
-		  params text NOT NULL,
-		  tracer text NOT NULL,
-		  timer decimal(16,6) NOT NULL
-		)
-		
-		<b>postgres:</b>
-		CREATE TABLE adodb_logsql (
-		  created timestamp NOT NULL,
-		  sql0 varchar(250) NOT NULL,
-		  sql1 text NOT NULL,
-		  params text NOT NULL,
-		  tracer text NOT NULL,
-		  timer decimal(16,6) NOT NULL
-		)
-		
-		<b>mssql:</b>
-		CREATE TABLE adodb_logsql (
-		  created datetime NOT NULL,
-		  sql0 varchar(250) NOT NULL,
-		  sql1 varchar(4000) NOT NULL,
-		  params varchar(3000) NOT NULL,
-		  tracer varchar(500) NOT NULL,
-		  timer decimal(16,6) NOT NULL
-		)
-		
-		<b>oci8:</b>
-		CREATE TABLE adodb_logsql (
-		  created date NOT NULL,
-		  sql0 varchar(250) NOT NULL,
-		  sql1 varchar(4000) NOT NULL,
-		  params varchar(4000),
-		  tracer varchar(4000),
-		  timer decimal(16,6) NOT NULL
-		)
-</pre>
-Usage: 
-<pre>	$conn-&gt;LogSQL(); // turn on logging<br>	  :<br>	$conn-&gt;Execute(...);<br>	  :<br>	$conn-&gt;LogSQL(false); // turn off logging<br>	<br>	# output summary of SQL logging results<br>	$perf = NewPerfMonitor($conn);<br>	echo $perf-&gt;SuspiciousSQL();<br>	echo $perf-&gt;ExpensiveSQL();<br></pre>
-<p>One limitation of logging is that rollback also prevents SQL from being logged.
-</p><p>
-If you prefer to use another name for the table used to store the SQL, you can override it by calling 
-adodb_perf::table($tablename), where $tablename is the new table name (you will still need to manually
-create the table yourself). An example:
-</p><pre>	include('adodb.inc.php');<br>	include('adodb-perf.inc.php');<br>	adodb_perf::table('my_logsql_table');<br></pre>
-Also see <a href="docs-perf.htm">Performance Monitor</a>. 
-<p><font><b>fnExecute and fnCacheExecute properties<a name="fnexecute" id="fnexecute"></a></b></font></p>
-<p>These two properties allow you to define bottleneck functions for all sql statements 
-  processed by ADOdb. This allows you to perform statistical analysis and query-rewriting 
-  of your sql. 
-</p><p><b>Examples of fnExecute</b></p>
-<p>Here is an example of using fnExecute, to count all cached queries and non-cached 
-  queries, you can do this:</p>
-<pre><font color="#006600"># $db is the connection object</font>
-function CountExecs($db, $sql, $inputarray)
-{
-global $EXECS;
-
-	if (!is_array(inputarray)) $EXECS++;
-	<font color="#006600"># handle 2-dimensional input arrays</font>
-	else if (is_array(reset($inputarray))) $EXECS += sizeof($inputarray);
-	else $EXECS++;
-	
-	<font color="#006600"># in PHP4.4 and PHP5, we need to return a value by reference</font>
-	$null = null;
-	return $null;
-}
-
-<font color="#006600"># $db is the connection object</font>
-function CountCachedExecs($db, $secs2cache, $sql, $inputarray)
-{<br>global $CACHED; $CACHED++;<br>}<br><br>$db = NewADOConnection('mysql');<br>$db-&gt;Connect(...);<br>$db-&gt;<strong>fnExecute</strong> = 'CountExecs';<br>$db-&gt;<strong>fnCacheExecute</strong> = 'CountCachedExecs';<br> :<br> :<br><font color="#006600"># After many sql statements:</font>`<br>printf("&lt;p&gt;Total queries=%d; total cached=%d&lt;/p&gt;",$EXECS+$CACHED, $CACHED);<br></pre>
-<p>The fnExecute function is called before the sql is parsed and executed, so 
-  you can perform a query rewrite. If you are passing in a prepared statement, 
-  then $sql is an array (see <a href="#prepare">Prepare</a>). The fnCacheExecute 
-  function is only called if the recordset returned was cached.<font> 
-  The function parameters match the Execute and CacheExecute functions respectively, 
-  except that $this (the connection object) is passed as the first parameter.</font></p>
-<p>Since ADOdb 3.91, the behaviour of fnExecute varies depending on whether the 
-  defined function returns a value. If it does not return a value, then the $sql 
-  is executed as before. This is useful for query rewriting or counting sql queries. 
-</p><p> On the other hand, you might want to replace the Execute function with one 
-  of your own design. If this is the case, then have your function return a value. 
-  If a value is returned, that value is returned immediately, without any further 
-  processing. This is used internally by ADOdb to implement LogSQL() functionality. 
-</p>
-<p>
-</p><hr />
-<h3><font>ADOConnection Utility Functions</font></h3>
-<p><font><b>BlankRecordSet<a name="blankrecordset"></a>([$queryid])</b></font></p>
-<p><font>No longer available - removed since 1.99.</font></p>
-<p><font><b>Concat<a name="concat"></a>($s1,$s2,....)</b></font></p>
-<p><font>Generates the sql string used to concatenate $s1, $s2, etc together. Uses the 
-  string in the concat_operator field to generate the concatenation. Override 
-  this function if a concatenation operator is not used, eg. MySQL.</font></p>
-<p><font>Returns the concatenated string.</font></p>
-<p><font><b>DBDate<a name="dbdate"></a>($date)</b></font></p>
-<p><font>Format the $<b>date</b> in the format the database accepts - the return string is also quoted. This is used
-when you are sending dates to the database (eg INSERT, UPDATE or where clause of SELECT statement). 
-  The $<b>date</b> parameter can be a Unix integer timestamp or an ISO format 
-  Y-m-d. Uses the fmtDate field, which holds the format to use. If null or false 
-  or '' is passed in, it will be converted to an SQL null.</font></p>
-<p><font>Returns the date as a quoted string.</font></p>
-<pre>
-	$sql = "select * from atable where created > ".$db->DBDate("$year-$month-$day");
-	$db->Execute($sql);
-</pre>
-<p>Note to retrieve a date column in a specific format,  use <a href="#sqldate">SQLDate</a>. </p>
-<p><font><b>BindDate<a name="binddate"></a>($date)</b></font></p>
-<p><font>Format the $<b>date</b> in the bind format the database accepts. Normally
- this means that the date string is not quoted, unlike DBDate, which quotes the string.
-<pre>
-	$sql = "select * from atable where created > ".$db->Param('0');
-	// or
-	$sql = "select * from atable where created > ?";
-	$db->Execute($sql,array($db->BindDate("$year-$month-$day"));
-</pre>
-<p><font><b>DBTimeStamp<a name="dbtimestamp"></a>($ts)</b></font></p>
-<p><font>Format the timestamp $<b>ts</b> in the format the database accepts; this can 
-  be a Unix integer timestamp or an ISO format Y-m-d H:i:s. Uses the fmtTimeStamp 
-  field, which holds the format to use. If null or false or '' is passed in, it 
-  will be converted to an SQL null.</font></p>
-<p><font>Returns the timestamp as a quoted string.</font></p>
-<pre>
-	$sql = "select * from atable where created > ".$db->DBTimeStamp("$year-$month-$day $hr:$min:$secs");
-	$db->Execute($sql);
-</pre>
-<p><font><b>BindTimeStamp<a name="bindtimestamp"></a>($ts)</b></font></p>
-<p><font>Format the timestamp $<b>ts</b> in the bind format the database accepts. Normally
- this means that the timestamp string is not quoted, unlike DBTimeStamp, which quotes the string.
-<pre>
-	$sql = "select * from atable where created > ".$db->Param('0');
-	// or
-	$sql = "select * from atable where created > ?";
-	$db->Execute($sql,array($db->BindTimeStamp("$year-$month-$day $hr:$min:$secs"));
-</pre>
-<p><font><b>qstr<a name="qstr"></a>($s,[$magic_quotes_enabled</b>=false]<b>)</b></font></p>
-<p><font>Quotes a string to be sent to the database. The $<b>magic_quotes_enabled</b> 
-  parameter may look funny, but the idea is if you are quoting a string extracted 
-  from a POST/GET variable, then pass get_magic_quotes_gpc() as the second parameter. 
-  This will ensure that the variable is not quoted twice, once by <i>qstr</i> 
-  and once by the <i>magic_quotes_gpc</i>.</font></p>
-<p><font>Eg.<font face="Courier New, Courier, mono"> $s = $db-&gt;qstr(HTTP_GET_VARS['name'],get_magic_quotes_gpc());</font></font></p>
-<p><font>Returns the quoted string.</font></p>
-<p><font><b>Quote<a name="quote"></a>($s)</b></font></p>
-<p><font>Quotes the string $s, escaping the database specific quote character as appropriate. 
-  Formerly checked magic quotes setting, but this was disabled since 3.31 for 
-  compatibility with PEAR DB. 
-</font></p><p><font><b>Affected_Rows<a name="affected_rows"></a>( )</b></font></p>
-<p><font>Returns the number of rows affected by a update or delete statement. Returns 
-  false if function not supported.</font></p>
-<p><font>Not supported by interbase/firebird currently. </font></p>
-<p><font><b>Insert_ID<a name="inserted_id"></a>( )</b></font></p>
-<p><font>Returns the last autonumbering ID inserted. Returns false if function not supported. 
-</font></p>
-<p><font>Only supported by databases that support auto-increment or object id's, such 
-  as PostgreSQL, MySQL and MS SQL Server currently. PostgreSQL returns the OID, which 
-  can change on a database reload.</font></p>
-<p><font><b>RowLock<a name="rowlock"></a>($table,$where)</b></font></p>
-<p><font>Lock a table row for the duration of a transaction. For example to lock record $id in table1:
-</font></p><pre><font>	$DB-&gt;StartTrans();<br>	$DB-&gt;RowLock("table1","rowid=$id");<br>	$DB-&gt;Execute($sql1);<br>	$DB-&gt;Execute($sql2);<br>	$DB-&gt;CompleteTrans();<br></font></pre>
-<p><font>Supported in db2, interbase, informix, mssql, oci8, postgres, sybase.
-</font></p><p><font><b>MetaDatabases<a name="metadatabases"></a>()</b></font></p>
-<p><font>Returns a list of databases available on the server as an array. You have to 
-  connect to the server first. Only available for ODBC, MySQL and ADO.</font></p>
-<p><font><b>MetaTables<a name="metatables"></a>($ttype = false, $showSchema = false, 
-  $mask=false)</b></font></p>
-<p><font>Returns an array of tables and views for the current database as an array. 
-  The array should exclude system catalog tables if possible. To only show tables, 
-  use $db-&gt;MetaTables('TABLES'). To show only views, use $db-&gt;MetaTables('VIEWS'). 
-  The $showSchema parameter currently works only for DB2, and when set to true, 
-  will add the schema name to the table, eg. "SCHEMA.TABLE". </font></p>
-<p><font>You can define a mask for matching. For example, setting $mask = 'TMP%' will 
-  match all tables that begin with 'TMP'. Currently only mssql, oci8, odbc_mssql 
-  and postgres* support $mask. 
-</font></p><p><font><b>MetaColumns<a name="metacolumns"></a>($table,$notcasesensitive=true)</b></font></p>
-<p><font>Returns an array of ADOFieldObject's, one field object for every column of 
-  $table. A field object is a class instance with (name, type, max_length) defined.
-  Currently Sybase does not recognise date types, and ADO cannot identify 
-  the correct data type (so we default to varchar).   
- </font></p><p><font> The $notcasesensitive parameter determines whether we uppercase or lowercase the table name to normalize it
- (required for some databases). Does not work with MySQL ISAM tables.
- </font></p><p><font>For schema support, pass in the $table parameter, "$schema.$tablename". This is only
- supported for selected databases.
-</font></p><p><font><b>MetaColumnNames<a name="metacolumnames"></a>($table,$numericIndex=false)</b></font></p>
-<p><font>Returns an array of column names for $table. Since ADOdb 4.22, this is an associative array, with the
-keys in uppercase. Set $numericIndex=true if you want the old behaviour of numeric indexes (since 4.23).
-</font></p><p>
-<font>e.g. array('FIELD1' =gt; 'Field1', 'FIELD2'=gt;'Field2')
-</font></p><p>
-</p><p><font><b>MetaPrimaryKeys<a name="metaprimarykeys"></a>($table,
-      $owner=false)</b></font> 
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$stmt = $DB-&gt;Prepare(&quot;insert into table (col0, col1, col2) values (:name0, :name1, :name2)&quot;);<br>
+$DB-&gt;Bind($stmt, $p1, &quot;name0&quot;);<br>
+$DB-&gt;Bind($stmt, $p2, &quot;name1&quot;);<br>
+$DB-&gt;Bind($stmt, $p3, &quot;name2&quot;);<br>
+for ($i = 0; $i &lt; $max; $i++) { <br>
+<span style='mso-spacerun:yes'> </span>$p1 = ?; $p2 = ?; $p3 = ?;<br>
+<span style='mso-spacerun:yes'> </span>$DB-&gt;Execute($stmt);<br>
+}</pre></div>
+
+<p><b>LogSQL($enable=true)</b><a name=logsql></a></p>
+
+<p class=MsoNormal>Call this method to install a SQL logging and timing
+function (using fnExecute). Then all SQL statements are logged into an
+adodb_logsql table in a database. If the adodb_logsql table does not exist,
+ADOdb will create the table if you have the appropriate permissions. Returns
+the previous logging value (true for enabled, false for disabled). Here are
+samples of the DDL for selected databases: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='mso-tab-count:2'> </span><b>mysql:</b></pre><pre><span
+style='mso-tab-count:2'> </span>CREATE TABLE adodb_logsql (</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>created datetime NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>sql0 varchar(250) NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>sql1 text NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>params text NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>tracer text NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>timer decimal(16,6) NOT NULL</pre><pre><span
+style='mso-tab-count:2'> </span>)</pre><pre><span
+style='mso-tab-count:2'> </span></pre><pre><span
+style='mso-tab-count:2'> </span><b>postgres:</b></pre><pre><span
+style='mso-tab-count:2'> </span>CREATE TABLE adodb_logsql (</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>created timestamp NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>sql0 varchar(250) NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>sql1 text NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>params text NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>tracer text NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>timer decimal(16,6) NOT NULL</pre><pre><span
+style='mso-tab-count:2'> </span>)</pre><pre><span
+style='mso-tab-count:2'> </span></pre><pre><span
+style='mso-tab-count:2'> </span><b>mssql:</b></pre><pre><span
+style='mso-tab-count:2'> </span>CREATE TABLE adodb_logsql (</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>created datetime NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>sql0 varchar(250) NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>sql1 varchar(4000) NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>params varchar(3000) NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>tracer varchar(500) NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>timer decimal(16,6) NOT NULL</pre><pre><span
+style='mso-tab-count:2'> </span>)</pre><pre><span
+style='mso-tab-count:2'> </span></pre><pre><span
+style='mso-tab-count:2'> </span><b>oci8:</b></pre><pre><span
+style='mso-tab-count:2'> </span>CREATE TABLE adodb_logsql (</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>created date NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>sql0 varchar(250) NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>sql1 varchar(4000) NOT NULL,</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>params varchar(4000),</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>tracer varchar(4000),</pre><pre><span
+style='mso-tab-count:2'> </span><span style='mso-spacerun:yes'> </span>timer decimal(16,6) NOT NULL</pre><pre><span
+style='mso-tab-count:2'> </span>)</pre></div>
+
+<p class=MsoNormal>Usage: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$conn-&gt;LogSQL(); // turn on logging<br>
+<span style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span>:<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;Execute(...);<br>
+<span style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span>:<br>
+<span style='mso-tab-count:1'> </span>$conn-&gt;LogSQL(false); // turn off logging<br>
+<span style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span># output summary of SQL logging results<br>
+<span style='mso-tab-count:1'> </span>$perf = NewPerfMonitor($conn);<br>
+<span style='mso-tab-count:1'> </span>echo $perf-&gt;SuspiciousSQL();<br>
+<span style='mso-tab-count:1'> </span>echo $perf-&gt;ExpensiveSQL();</pre></div>
+
+<p>One limitation of logging is that rollback also prevents SQL from being
+logged. </p>
+
+<p>If you prefer to use another name for the table used to store the SQL, you
+can override it by calling adodb_perf::table($tablename), where $tablename is
+the new table name (you will still need to manually create the table yourself).
+An example: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>include('adodb.inc.php');<br>
+<span style='mso-tab-count:1'> </span>include('adodb-perf.inc.php');<br>
+<span style='mso-tab-count:1'> </span>adodb_perf::table('my_logsql_table');</pre></div>
+
+<p class=MsoNormal>Also see <a href="docs-perf.htm">Performance Monitor</a>. </p>
+
+<p><b>fnExecute and fnCacheExecute properties</b><a name=fnexecute
+id=fnexecute></a></p>
+
+<p>These two properties allow you to define bottleneck functions for all sql
+statements processed by ADOdb. This allows you to perform statistical analysis
+and query-rewriting of your sql. </p>
+
+<p><b>Examples of fnExecute</b></p>
+
+<p>Here is an example of using fnExecute, to count all cached queries and
+non-cached queries, you can do this:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span
+style='color:#006600'># $db is the connection object</span></pre><pre>function &amp;CountExecs($db, $sql, $inputarray)</pre><pre>{</pre><pre>global $EXECS;</pre><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='mso-tab-count:1'> </span>if (!is_array(inputarray)) $EXECS++;</pre><pre><span
+style='mso-tab-count:1'> </span><span style='color:#006600'># handle 2-dimensional input arrays</span></pre><pre><span
+style='mso-tab-count:1'> </span>else if (is_array(reset($inputarray))) $EXECS += sizeof($inputarray);</pre><pre><span
+style='mso-tab-count:1'> </span>else $EXECS++;</pre><pre><span
+style='mso-tab-count:1'> </span></pre><pre><span style='mso-tab-count:
+1'> </span><span style='color:#006600'># in PHP4.4 and PHP5, we need to return a value by reference</span></pre><pre><span
+style='mso-tab-count:1'> </span>$null = null;</pre><pre><span
+style='mso-tab-count:1'> </span>return $null;</pre><pre>}</pre><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='color:#006600'># $db is the connection object</span></pre><pre>function CountCachedExecs($db, $secs2cache, $sql, $inputarray)</pre><pre
+style='background:#EEEEEE'>{<br>
+global $CACHED; $CACHED++;<br>
+}<br>
+<br>
+$db = NewADOConnection('mysql');<br>
+$db-&gt;Connect(...);<br>
+$db-&gt;<strong><span style='font-family:"Courier New"'>fnExecute</span></strong> = 'CountExecs';<br>
+$db-&gt;<strong><span style='font-family:"Courier New"'>fnCacheExecute</span></strong> = 'CountCachedExecs';<br>
+<span style='mso-spacerun:yes'></span>:<br>
+<span style='mso-spacerun:yes'></span>:<br>
+<span style='color:#006600'># After many sql statements:</span>`<br>
+printf(&quot;&lt;p&gt;Total queries=%d; total cached=%d&lt;/p&gt;&quot;,$EXECS+$CACHED, $CACHED);</pre></div>
+
+<p>The fnExecute function is called before the sql is parsed and executed, so
+you can perform a query rewrite. If you are passing in a prepared statement,
+then $sql is an array (see <a href="#prepare">Prepare</a>). The fnCacheExecute
+function is only called if the recordset returned was cached. The function
+parameters match the Execute and CacheExecute functions respectively, except
+that $this (the connection object) is passed as the first parameter.</p>
+
+<p>Since ADOdb 3.91, the behaviour of fnExecute varies depending on whether the
+defined function returns a value. If it does not return a value, then the $sql
+is executed as before. This is useful for query rewriting or counting sql
+queries. </p>
+
+<p>On the other hand, you might want to replace the Execute function with one
+of your own design. If this is the case, then have your function return a
+value. If a value is returned, that value is returned immediately, without any
+further processing. This is used internally by ADOdb to implement LogSQL()
+functionality. </p>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h3>ADOConnection Utility Functions</h3>
+
+<p><b>BlankRecordSet<a name=blankrecordset></a>([$queryid])</b></p>
+
+<p>No longer available - removed since 1.99.</p>
+
+<p><b>Concat<a name=concat></a>($s1,$s2,....)</b></p>
+
+<p>Generates the sql string used to concatenate $s1, $s2, etc together. Uses
+the string in the concat_operator field to generate the concatenation. Override
+this function if a concatenation operator is not used, eg. MySQL.</p>
+
+<p>Returns the concatenated string.</p>
+
+<p><b>DBDate<a name=dbdate></a>($date)</b></p>
+
+<p>Format the $<b>date</b> in the format the database accepts - the return
+string is also quoted. This is used when you are sending dates to the database
+(eg INSERT, UPDATE or where clause of SELECT statement). The $<b>date</b>
+parameter can be a PHP DateTime object (since ADOdb 5.09), a Unix integer timestamp or an ISO format Y-m-d. Uses the
+fmtDate field, which holds the format to use. If null or false or '' is passed
+in, it will be converted to an SQL null.</p>
+
+<p>Returns the date as a quoted string.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='mso-tab-count:1'> </span>$sql = &quot;select * from atable where created &gt; &quot;.$db-&gt;DBDate(&quot;$year-$month-$day&quot;);</pre><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;Execute($sql);</pre></div>
+
+<p>Note to retrieve a date column in a specific format, use <a href="#sqldate">SQLDate</a>.
 </p>
-<p><font>Returns an array containing column names that are the 
-  primary keys of $table. Supported by mysql, odbc (including db2, odbc_mssql, 
-etc), mssql, postgres, interbase/firebird, oci8 currently. </font></p>
-<p><font>Views (and some tables) have primary keys, but sometimes this information is not available from the
-database. You can define a function  ADODB_View_PrimaryKeys($databaseType, $database, $view, $owner) that
-should return an array containing the fields that make up the primary key. If that function exists,
-it will be called when MetaPrimaryKeys() cannot find a primary key for a table or view.
-</font></p><pre><font>// In this example: dbtype = 'oci8', $db = 'mydb', $view = 'dataView', $owner = false <br>function ADODB_View_PrimaryKeys($dbtype,$db,$view,$owner)<br>{<br>	switch(strtoupper($view)) {<br>	case 'DATAVIEW': return array('DATAID');<br>	default: return false;<br>	}<br>}<br><br>$db = NewADOConnection('oci8');<br>$db-&gt;Connect('localhost','root','','mydb'); <br>$db-&gt;MetaPrimaryKeys('dataView');<br></font></pre>
-<p><font><b>ServerInfo<a name="serverinfo" id="serverinfo"></a>()</b></font> 
+
+<p><b>BindDate<a name=binddate></a>($date)</b></p>
+
+<p>Format the $<b>date</b> in the bind format the database accepts. Normally
+this means that the date string is not quoted, unlike DBDate, which quotes the
+string. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='mso-tab-count:1'> </span>$sql = &quot;select * from atable where created &gt; &quot;.$db-&gt;Param('0');</pre><pre><span
+style='mso-tab-count:1'> </span>// or</pre><pre><span style='mso-tab-count:
+1'> </span>$sql = &quot;select * from atable where created &gt; ?&quot;;</pre><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;Execute($sql,array($db-&gt;BindDate(&quot;$year-$month-$day&quot;));</pre></div>
+
+<p><b>DBTimeStamp<a name=dbtimestamp></a>($ts)</b></p>
+
+<p>Format the timestamp $<b>ts</b> in the format the database accepts; this can
+be a PHP DateTime object (since ADOdb 5.09), a Unix integer timestamp or an ISO format Y-m-d H:i:s. Uses the fmtTimeStamp
+field, which holds the format to use. If null or false or '' is passed in, it
+will be converted to an SQL null.</p>
+
+<p>Returns the timestamp as a quoted string.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='mso-tab-count:1'> </span>$sql = &quot;select * from atable where created &gt; &quot;.$db-&gt;DBTimeStamp(&quot;$year-$month-$day $hr:$min:$secs&quot;);</pre><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;Execute($sql);</pre></div>
+
+<p><b>BindTimeStamp<a name=bindtimestamp></a>($ts)</b></p>
+
+<p>Format the timestamp $<b>ts</b> in the bind format the database accepts.
+Normally this means that the timestamp string is not quoted, unlike
+DBTimeStamp, which quotes the string. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span
+style='mso-tab-count:1'> </span>$sql = &quot;select * from atable where created &gt; &quot;.$db-&gt;Param('0');</pre><pre><span
+style='mso-tab-count:1'> </span>// or</pre><pre><span style='mso-tab-count:
+1'> </span>$sql = &quot;select * from atable where created &gt; ?&quot;;</pre><pre><span
+style='mso-tab-count:1'> </span>$db-&gt;Execute($sql,array($db-&gt;BindTimeStamp(&quot;$year-$month-$day $hr:$min:$secs&quot;));</pre></div>
+
+<p><b>qstr<a name=qstr></a>($s,[$magic_quotes_enabled</b>=false]<b>)</b></p>
+
+<p>Quotes a string to be sent to the database. The $<b>magic_quotes_enabled</b>
+parameter may look funny, but the idea is if you are quoting a string extracted
+from a POST/GET variable, then pass get_magic_quotes_gpc() as the second
+parameter. This will ensure that the variable is not quoted twice, once by <i>qstr</i>
+and once by the <i>magic_quotes_gpc</i>.</p>
+
+<p>Eg.<span style='font-family:"Courier New"'> $s = $db-&gt;qstr(HTTP_GET_VARS['name'],get_magic_quotes_gpc());</span></p>
+
+<p>Returns the quoted string.</p>
+
+<p><b>Quote<a name=quote></a>($s)</b></p>
+
+<p>Quotes the string $s, escaping the database specific quote character as
+appropriate. Formerly checked magic quotes setting, but this was disabled since
+3.31 for compatibility with PEAR DB. </p>
+
+<p><b>Affected_Rows<a name="affected_rows"></a>( )</b></p>
+
+<p>Returns the number of rows affected by a update or delete statement. Returns
+false if function not supported.</p>
+
+<p>Not supported by interbase/firebird currently. </p>
+
+<p><b>Insert_ID<a name="inserted_id"></a>( )</b></p>
+
+<p>Returns the last autonumbering ID inserted. Returns false if function not
+supported. </p>
+
+<p>Only supported by databases that support auto-increment or object id's, such
+as PostgreSQL, MySQL and MS SQL Server currently. PostgreSQL returns the OID,
+which can change on a database reload.</p>
+
+<p><b>RowLock<a name=rowlock></a>($table,$where)</b></p>
+
+<p>Lock a table row for the duration of a transaction. For example to lock
+record $id in table1: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$DB-&gt;StartTrans();<br>
+<span style='mso-tab-count:1'> </span>$DB-&gt;RowLock(&quot;table1&quot;,&quot;rowid=$id&quot;);<br>
+<span style='mso-tab-count:1'> </span>$DB-&gt;Execute($sql1);<br>
+<span style='mso-tab-count:1'> </span>$DB-&gt;Execute($sql2);<br>
+<span style='mso-tab-count:1'> </span>$DB-&gt;CompleteTrans();</pre></div>
+
+<p>Supported in db2, interbase, informix, mssql, oci8, postgres, sybase. </p>
+
+<p><b>MetaDatabases<a name=metadatabases></a>()</b></p>
+
+<p>Returns a list of databases available on the server as an array. You have to
+connect to the server first. Only available for ODBC, MySQL and ADO.</p>
+
+<p><b>MetaTables<a name=metatables></a>($ttype = false, $showSchema = false,
+$mask=false)</b></p>
+
+<p>Returns an array of tables and views for the current database as an array.
+The array should exclude system catalog tables if possible. To only show
+tables, use $db-&gt;MetaTables('TABLES'). To show only views, use
+$db-&gt;MetaTables('VIEWS'). The $showSchema parameter currently works only for
+DB2, and when set to true, will add the schema name to the table, eg.
+&quot;SCHEMA.TABLE&quot;. </p>
+
+<p>You can define a mask for matching. For example, setting $mask = 'TMP%' will
+match all tables that begin with 'TMP'. Currently only mssql, oci8, odbc_mssql
+and postgres* support $mask. </p>
+
+<p><b>MetaColumns<a name=metacolumns></a>($table,$notcasesensitive=true)</b></p>
+
+<p>Returns an array of ADOFieldObject's, one field object for every column of
+$table. A field object is a class instance with (name, type, max_length)
+defined. Currently Sybase does not recognise date types, and ADO cannot
+identify the correct data type (so we default to varchar). </p>
+
+<p>The $notcasesensitive parameter determines whether we uppercase or lowercase
+the table name to normalize it (required for some databases). Does not work
+with MySQL ISAM tables. </p>
+
+<p>For schema support, pass in the $table parameter,
+&quot;$schema.$tablename&quot;. This is only supported for selected databases. </p>
+
+<p><b>MetaColumnNames<a name=metacolumnames></a>($table,$numericIndex=false)</b></p>
+
+<p>Returns an array of column names for $table. Since ADOdb 4.22, this is an
+associative array, with the keys in uppercase. Set $numericIndex=true if you
+want the old behaviour of numeric indexes (since 4.23). </p>
+
+<p>e.g. array('FIELD1' =&gt; 'Field1', 'FIELD2'=&gt;'Field2') </p>
+
+<p><b>MetaPrimaryKeys<a name=metaprimarykeys></a>($table, $owner=false)</b> </p>
+
+<p>Returns an array containing column names that are the primary keys of
+$table. Supported by mysql, odbc (including db2, odbc_mssql, etc), mssql,
+postgres, interbase/firebird, oci8 currently. </p>
+
+<p>Views (and some tables) have primary keys, but sometimes this information is
+not available from the database. You can define a function
+ADODB_View_PrimaryKeys($databaseType, $database, $view, $owner) that should
+return an array containing the fields that make up the primary key. If that
+function exists, it will be called when MetaPrimaryKeys() cannot find a primary
+key for a table or view. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>// In this example: dbtype = 'oci8', $db = 'mydb', $view = 'dataView', $owner = false <br>
+function ADODB_View_PrimaryKeys($dbtype,$db,$view,$owner)<br>
+{<br>
+<span style='mso-tab-count:1'> </span>switch(strtoupper($view)) {<br>
+<span style='mso-tab-count:1'> </span>case 'DATAVIEW': return array('DATAID');<br>
+<span style='mso-tab-count:1'> </span>default: return false;<br>
+<span style='mso-tab-count:1'> </span>}<br>
+}<br>
+<br>
+$db = NewADOConnection('oci8');<br>
+$db-&gt;Connect('localhost','root','','mydb'); <br>
+$db-&gt;MetaPrimaryKeys('dataView');</pre></div>
+
+<p><b>ServerInfo<a name=serverinfo id=serverinfo></a>()</b> </p>
+
+<p>Returns an array of containing two elements 'description' and 'version'. The
+'description' element contains the string description of the database. The
+'version' naturally holds the version number (which is also a string).</p>
+
+<p><b>MetaForeignKeys<a name=metaforeignkeys></a>($table, $owner=false,
+$upper=false)</b> </p>
+
+<p>Returns an associate array of foreign keys, or false if not supported. For
+example, if table employee has a foreign key where employee.deptkey points to
+dept_table.deptid, and employee.posn=posn_table.postionid and
+employee.poscategory=posn_table.category, then
+$conn-&gt;MetaForeignKeys('employee') will return </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>array(<br>
+<span style='mso-tab-count:2'> </span>'dept_table' =&gt; array('deptkey=deptid'),<br>
+<span style='mso-tab-count:2'> </span>'posn_table' =&gt; array('posn=positionid','poscategory=category')<br>
+<span style='mso-tab-count:1'> </span>)</pre></div>
+
+<p>The optional schema or owner can be defined in $owner. If $upper is true,
+then the table names (array keys) are upper-cased. </p>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h2>ADORecordSet<a name=adorecordset></a></h2>
+
+<p>When an SQL statement successfully is executed by <span style='font-family:
+"Courier New"'>ADOConnection-&gt;Execute($sql),</span>an ADORecordSet object is
+returned. This object contains a virtual cursor so we can move from row to row,
+functions to obtain information about the columns and column types, and helper
+functions to deal with formating the results to show to the user.</p>
+
+<h3>ADORecordSet Fields</h3>
+
+<p><b>fields: </b>Array containing the current row. This is not associative,
+but is an indexed array from 0 to columns-1. See also the function <b><a
+href="#fields">Fields</a></b>, which behaves like an associative array.</p>
+
+<p><b>dataProvider</b>: The underlying mechanism used to connect to the
+database. Normally set to <b>native</b>, unless using <b>odbc</b> or <b>ado</b>.</p>
+
+<p><b>blobSize</b>: Maximum size of a char, string or varchar object before it
+is treated as a Blob (Blob's should be shown with textarea's). See the <a
+href="#metatype">MetaType</a> function.</p>
+
+<p><b>sql</b>: Holds the sql statement used to generate this record set.</p>
+
+<p><b>canSeek</b>: Set to true if Move( ) function works.</p>
+
+<p><b>EOF</b>: True if we have scrolled the cursor past the last record.</p>
+
+<h3>ADORecordSet Functions</h3>
+
+<p><b>ADORecordSet( )</b></p>
+
+<p>Constructer. Normally you never call this function yourself.</p>
+
+<p><b>GetAssoc<a name=getassoc></a>([$force_array])</b></p>
+
+<p>Generates an associative array from the recordset. Note that is this
+function is also <a href="#getassoc1">available</a> in the connection object.
+More details can be found there.</p>
+
+<p><b>GetArray<a name=getarray></a>([$number_of_rows])</b></p>
+
+<p>Generate a 2-dimensional array of records from the current cursor position,
+indexed from 0 to $number_of_rows - 1. If $number_of_rows is undefined, till
+EOF.</p>
+
+<p><b>GetRows<a name=getrows></a>([$number_of_rows])</b></p>
+
+<p class=MsoNormal>Generate a 2-dimensional array of records from the current
+cursor position. Synonym for GetArray() for compatibility with Microsoft ADO. </p>
+
+<p><b>GetMenu<a name=getmenu></a>($name, [$default_str=''],
+[$blank1stItem=true], [$multiple_select=false], [$size=0], [$moreAttr=''])</b></p>
+
+<p>Generate a HTML menu
+(&lt;select&gt;&lt;option&gt;&lt;option&gt;&lt;/select&gt;). The first column
+of the recordset (fields[0]) will hold the string to display in the option
+tags. If the recordset has more than 1 column, the second column (fields[1]) is
+the value to send back to the web server.. The menu will be given the name $<i>name</i>.
 </p>
-<p><font>Returns an array of containing two elements 'description' 
-  and 'version'. The 'description' element contains the string description of 
-  the database. The 'version' naturally holds the version number (which is also 
-a string).</font></p>
-<p><font><b>MetaForeignKeys<a name="metaforeignkeys"></a>($table, $owner=false, $upper=false)</b> 
-</font></p><p><font>Returns an associate array of foreign keys, or false if not supported. For 
-  example, if table employee has a foreign key where employee.deptkey points to 
-  dept_table.deptid, and employee.posn=posn_table.postionid and employee.poscategory=posn_table.category, 
-  then $conn-&gt;MetaForeignKeys('employee') will return 
-</font></p><pre><font>	array(<br>		'dept_table' =gt; array('deptkey=deptid'),<br>		'posn_table' =gt; array('posn=positionid','poscategory=category')<br>	)<br></font></pre>
-<p><font>The optional schema or owner can be defined in $owner. If $upper is true, then 
-  the table names (array keys) are upper-cased. 
-</font></p><hr />
-<h2><font>ADORecordSet<a name="adorecordset"></a></font></h2>
-<p><font>When an SQL statement successfully is executed by <font face="Courier New, Courier, mono">ADOConnection-&gt;Execute($sql),</font>an 
-  ADORecordSet object is returned. This object contains a virtual cursor so we 
-  can move from row to row, functions to obtain information about the columns 
-  and column types, and helper functions to deal with formating the results to 
-  show to the user.</font></p>
-<h3><font>ADORecordSet Fields</font></h3>
-<p><font><b>fields: </b>Array containing the current row. This is not associative, but 
-  is an indexed array from 0 to columns-1. See also the function <b><a href="#fields">Fields</a></b>, 
-  which behaves like an associative array.</font></p>
-<p><font><b>dataProvider</b>: The underlying mechanism used to connect to the database. 
-  Normally set to <b>native</b>, unless using <b>odbc</b> or <b>ado</b>.</font></p>
-<p><font><b>blobSize</b>: Maximum size of a char, string or varchar object before it 
-  is treated as a Blob (Blob's should be shown with textarea's). See the <a href="#metatype">MetaType</a> 
-  function.</font></p>
-<p><font><b>sql</b>: Holds the sql statement used to generate this record set.</font></p>
-<p><font><b>canSeek</b>: Set to true if Move( ) function works.</font></p>
-<p><font><b>EOF</b>: True if we have scrolled the cursor past the last record.</font></p>
-<h3><font>ADORecordSet Functions</font></h3>
-<p><font><b>ADORecordSet( )</b></font></p>
-<p><font>Constructer. Normally you never call this function yourself.</font></p>
-<p><font><b>GetAssoc<a name="getassoc"></a>([$force_array])</b></font></p>
-<p><font>Generates an associative array from the recordset. Note that is this function 
-  is also <a href="#getassoc1">available</a> in the connection object. More details 
-  can be found there.</font></p>
-<font> </font>
-<p><font><b>GetArray<a name="getarray"></a>([$number_of_rows])</b></font></p>
-<p><font>Generate a 2-dimensional array of records from the current
-    cursor position, indexed from 0 to $number_of_rows - 1. If $number_of_rows
-  is undefined, till EOF.</font></p>
-<p><font><b>GetRows<a name="getrows"></a>([$number_of_rows])</b></font></p>
-<font>Generate a 2-dimensional array of records from the current
-cursor position. Synonym for GetArray() for compatibility with Microsoft ADO. </font>
-<p><font> <b>GetMenu<a name="getmenu"></a>($name, [$default_str=''],
-  [$blank1stItem=true], [$multiple_select=false], [$size=0], [$moreAttr=''])</b></font></p>
-<p><font>Generate a HTML menu (&lt;select&gt;&lt;option&gt;&lt;option&gt;&lt;/select&gt;).
-    The first column of the recordset (fields[0]) will hold the string to display
-    in the option tags. If the recordset has more than 1 column, the second column
-    (fields[1]) is the value to send back to the web server.. The menu will be
-given the name $<i>name</i>. </font></p>
-<p><font> If $<i>default_str</i> is defined, then if $<i>default_str</i> ==
-    fields[0], that field is selected. If $<i>blank1stItem</i> is true, the first
-    option is empty. You can also set the first option strings by setting $blank1stItem
-  = "$value:$text".</font></p>
-<p><font>$<i>Default_str</i> can be array for a multiple select
-listbox.</font></p>
-<p><font>To get a listbox, set the $<i>size</i> to a non-zero
-    value (or pass $default_str as an array). If $<i>multiple_select</i> is true
-    then a listbox will be generated with $<i>size</i> items (or if $size==0,
-    then 5 items) visible, and we will return an array to a server. Lastly use
-  $<i>moreAttr </i> to add additional attributes such as javascript or styles. </font></p>
-<p><font>Menu Example 1: <code>GetMenu('menu1','A',true)</code> will
-    generate a menu:
-    <select name="menu1"><option> </option><option value="1" selected="selected">A </option><option value="2">B </option><option value="3">C </option></select>
-for the data (A,1), (B,2), (C,3). Also see <a href="#ex5">example 5</a>.</font></p>
-<p><font>Menu Example 2: For the same data, <code>GetMenu('menu1',array('A','B'),false)</code> will
-    generate a menu with both A and B selected: <br>
-    <select name="menu1" multiple="multiple" size="3"><option value="1" selected="selected">A </option><option value="2" selected="selected">B </option><option value="3">C </option></select>
-</font></p>
-<p><font> <b>GetMenu2<a name="getmenu2"></a>($name, [$default_str=''],
-  [$blank1stItem=true], [$multiple_select=false], [$size=0], [$moreAttr=''])</b></font></p>
-<p><font>This is nearly identical to GetMenu, except that the
-  $<i>default_str</i> is matched to fields[1] (the option values).</font></p>
-<p><font>Menu Example 3: Given the data in menu example 2, <code>GetMenu2('menu1',array('1','2'),false)</code> will
-    generate a menu with both A and B selected in menu example 2, but this time
-    the selection is based on the 2nd column, which holds the values to return
-to the Web server. </font></p>
-<p><font><b>UserDate<a name="userdate"></a>($str, [$fmt])</b></font></p>
-<p><font>Converts the date string $<i>str</i> to another format.
-    The date format is Y-m-d, or Unix timestamp format. The default $<i>fmt</i> is
-Y-m-d.</font></p>
-<p><font><b>UserTimeStamp<a name="usertimestamp"></a>($str, [$fmt])</b></font></p>
-<p><font>Converts the timestamp string $<b>str</b> to another
-    format. The timestamp format is Y-m-d H:i:s, as in '2002-02-28 23:00:12',
-    or Unix timestamp format. UserTimeStamp calls UnixTimeStamp to parse $<i>str</i>,
-and $<i>fmt</i> defaults to Y-m-d H:i:s if not defined. </font></p>
-<p><font><b>UnixDate<a name="unixdate"></a>($str)</b></font></p>
-<p><font>Parses the date string $<b>str</b> and returns it in
-    unix mktime format (eg. a number indicating the seconds after January 1st,
-    1970). Expects the date to be in Y-m-d H:i:s format, except for Sybase and
-    Microsoft SQL Server, where M d Y is also accepted (the 3 letter month strings
-  are controlled by a global array, which might need localisation).</font></p>
-<p><font>This function is available in both ADORecordSet and
-ADOConnection since 1.91.</font></p>
-<p><font><b>UnixTimeStamp<a name="unixtimestamp"></a>($str)</b></font></p>
-<p><font>Parses the timestamp string $<b>str</b> and returns
-    it in unix mktime format (eg. a number indicating the seconds after January
-    1st, 1970). Expects the date to be in "Y-m-d, H:i:s" (1970-12-24, 00:00:00)
-    or "Y-m-d H:i:s" (1970-12-24 00:00:00) or "YmdHis" (19701225000000) format,
-    except for Sybase and Microsoft SQL Server, where "M d Y h:i:sA" (Dec 25
-    1970 00:00:00AM) is also accepted (the 3 letter month strings are controlled
-by a global array, which might need localisation).</font></p>
-<font> 
-</font><p><font>This function is available in both ADORecordSet
-    and ADOConnection since 1.91. </font></p>
-<p><font><b>OffsetDate<a name="OffsetDate"></a>($dayFraction,
-  $basedate=false)</b></font></p>
-<p><font>Returns a string with the native SQL functions to calculate
-    future and past dates based on $basedate in a portable fashion. If $basedate
-    is not defined, then the current date (at 12 midnight) is used. Returns the
-  SQL string that performs the calculation when passed to Execute(). </font></p>
-<p><font>For example, in Oracle, to find the date and time that
-  is 2.5 days from today, you can use:</font></p>
-<pre><font># get date one week from now<br>$fld = $conn-&gt;OffsetDate(7); // returns "(trunc(sysdate)+7")</font></pre>
-<pre><font># get date and time that is 60 hours from current date and time<br>$fld = $conn-&gt;OffsetDate(2.5, $conn-&gt;sysTimeStamp);	// returns "(sysdate+2.5)"<br><br>$conn-&gt;Execute("UPDATE TABLE SET dodate=$fld WHERE ID=$id");</font></pre>
-<p><font> This function is available for mysql, mssql, oracle, oci8 and postgresql drivers 
-  since 2.13. It might work with other drivers provided they allow performing
-  numeric day arithmetic on dates.</font></p>
-<font> </font>
-<p><font><b>SQLDate<a name="sqldate"></a>($dateFormat, $basedate=false)</b></font></p>
-<font>Returns a string which contains the native SQL functions
-to format a date or date column $basedate. This is used when retrieving date columns in SELECT statements.
-For sending dates to the database (eg. in UPDATE, INSERT or the where clause of SELECT statements) 
-use <a href="#dbdate">DBDate</a>. It uses a case-sensitive
-$dateFormat, which supports: </font>
-<pre><font> 
-  Y: 4-digit Year
-  Q: Quarter (1-4)
-  M: Month (Jan-Dec)
-  m: Month (01-12)
-  d: Day (01-31)
-  H: Hour (00-23)
-  h: Hour (1-12)
-  i: Minute (00-59)
-  s: Second (00-60)
-  A: AM/PM indicator
-  w: day of week (0-6 or 1-7 depending on DB)
-  l: day of week (as string - lowercase L)
-  W: week in year (0..53 for MySQL, 1..53 for PostgreSQL and Oracle)
-  </font></pre>
-<p><font>All other characters are treated as strings. You can
-    also use \ to escape characters. Available on selected databases, including
-mysql, postgresql, mssql, oci8 and DB2. </font></p>
-<p><font>This is useful in writing portable sql statements that
-    GROUP BY on dates. For example to display total cost of goods sold broken
-by quarter (dates are stored in a field called postdate): </font></p>
-<pre><font> $sqlfn = $db-&gt;SQLDate('Y-\QQ','postdate'); # get sql that formats postdate to output 2002-Q1<br> $sql = "SELECT $sqlfn,SUM(cogs) FROM table GROUP BY $sqlfn ORDER BY 1 desc";<br> </font></pre>
-<p><font><b>MoveNext<a name="movenext"></a>( )</b></font></p>
-<p><font>Move the internal cursor to the next row. The <i>$this-&gt;fields</i> array
-    is automatically updated. Returns false if unable to do so (normally because
-EOF has been reached), otherwise true. </font></p>
-<p><font> If EOF is reached, then the $this-&gt;fields array
-    is set to false (this was only implemented consistently in ADOdb 3.30). For
-    the pre-3.30 behaviour of $this-&gt;fields (at EOF), set the global variable
-  $ADODB_COMPAT_FETCH = true.</font></p>
-<p><font>Example:</font></p>
-<pre><font>$rs = $db-&gt;Execute($sql);<br>if ($rs) <br>	while (!$rs-&gt;EOF) {<br> 		ProcessArray($rs-&gt;fields);	<br>		$rs-&gt;MoveNext();<br>	} </font></pre>
-<p><font><b>Move<a name="move"></a>($to)</b></font></p>
-<p><font>Moves the internal cursor to a specific row $<b>to</b>.
-    Rows are zero-based eg. 0 is the first row. The <b>fields</b> array is automatically
-    updated. For databases that do not support scrolling internally, ADOdb will
-    simulate forward scrolling. Some databases do not support backward scrolling.
-    If the $<b>to</b> position is after the EOF, $<b>to</b> will move to the
-    end of the RecordSet for most databases. Some obscure databases using odbc
-  might not behave this way.</font></p>
-<p><font>Note: This function uses <i>absolute positioning</i>,
-unlike Microsoft's ADO.</font></p>
-<p><font>Returns true or false. If false, the internal cursor
-    is not moved in most implementations, so AbsolutePosition( ) will return
-  the last cursor position before the Move( ). </font></p>
-<p><font><b>MoveFirst<a name="movefirst"></a>()</b></font></p>
-<p><font>Internally calls Move(0). Note that some databases do
-not support this function.</font></p>
-<p><font><b>MoveLast<a name="movelast"></a>()</b></font></p>
-<p><font>Internally calls Move(RecordCount()-1). Note that some
-  databases do not support this function.</font></p>
-<p><font><b>GetRowAssoc</b><a name="getrowassoc"></a>($toUpper=true)</font></p>
-<p><font>Returns an associative array containing the current
-    row. The keys to the array are the column names. The column names are upper-cased
-  for easy access. To get the next row, you will still need to call MoveNext(). </font></p>
-<p><font>For example:<br>
-Array ( [ID] =gt; 1 [FIRSTNAME] =gt; Caroline [LASTNAME] =gt; Miranda [CREATED]
-=gt; 2001-07-05 ) </font></p>
-<p><font>Note: do not use GetRowAssoc() with $ADODB_FETCH_MODE
-    = ADODB_FETCH_ASSOC. Because they have the same functionality, they will
-  interfere with each other.</font></p>
-<font> 
-</font><p><font><b>AbsolutePage<a name="absolutepage"></a>($page=-1) </b></font></p>
-<p><font>Returns the current page. Requires PageExecute()/CachePageExecute() to be called. 
-  See <a href="#ex8">Example 8</a>.</font></p>
-<font>
-<p><b>AtFirstPage<a name="atfirstpage">($status='')</a></b></p>
-<p>Returns true if at first page (1-based). Requires PageExecute()/CachePageExecute()
-  to be called. See <a href="#ex8">Example 8</a>.</p>
-<p><b>AtLastPage<a name="atlastpage">($status='')</a></b></p>
-<p>Returns true if at last page (1-based). Requires PageExecute()/CachePageExecute()
-  to be called. See <a href="#ex8">Example 8</a>.</p>
-<p><b>Fields</b><a name="fields"></a>(<b>$colname</b>)</p>
+
+<p>If $<i>default_str</i> is defined, then if $<i>default_str</i> == fields[0],
+that field is selected. If $<i>blank1stItem</i> is true, the first option is
+empty. You can also set the first option strings by setting $blank1stItem =
+&quot;$value:$text&quot;.</p>
+
+<p>$<i>Default_str</i> can be array for a multiple select listbox.</p>
+
+<p>To get a listbox, set the $<i>size</i> to a non-zero value (or pass
+$default_str as an array). If $<i>multiple_select</i> is true then a listbox
+will be generated with $<i>size</i> items (or if $size==0, then 5 items)
+visible, and we will return an array to a server. Lastly use $<i>moreAttr </i>to
+add additional attributes such as javascript or styles. </p>
+
+<p>Menu Example 1: <code><span style='font-size:10.0pt'>GetMenu('menu1','A',true)</span></code>
+will generate a menu: <SELECT NAME="menu1">
+<OPTION>
+<OPTION SELECTED VALUE="1">A
+<OPTION VALUE="2">B
+<OPTION VALUE="3">C
+</SELECT>for
+the data (A,1), (B,2), (C,3). Also see <a href="#ex5">example 5</a>.</p>
+
+<p>Menu Example 2: For the same data, <code><span style='font-size:10.0pt'>GetMenu('menu1',array('A','B'),false)</span></code>
+will generate a menu with both A and B selected: <br>
+<SELECT MULTIPLE NAME="menu1" SIZE="3">
+<OPTION SELECTED VALUE="1">A
+<OPTION SELECTED VALUE="2">B
+<OPTION VALUE="3">C
+</SELECT></p>
+
+<p><b>GetMenu2<a name=getmenu2></a>($name, [$default_str=''],
+[$blank1stItem=true], [$multiple_select=false], [$size=0], [$moreAttr=''])</b></p>
+
+<p>This is nearly identical to GetMenu, except that the $<i>default_str</i> is
+matched to fields[1] (the option values).</p>
+
+<p>Menu Example 3: Given the data in menu example 2, <code><span
+style='font-size:10.0pt'>GetMenu2('menu1',array('1','2'),false)</span></code>
+will generate a menu with both A and B selected in menu example 2, but this
+time the selection is based on the 2nd column, which holds the values to return
+to the Web server. </p>
+
+<p><b>UserDate<a name=userdate></a>($str, [$fmt])</b></p>
+
+<p>Converts the date string $<i>str</i> to another format. The date format is
+Y-m-d, or Unix timestamp format. The default $<i>fmt</i> is Y-m-d.</p>
+
+<p><b>UserTimeStamp<a name=usertimestamp></a>($str, [$fmt])</b></p>
+
+<p>Converts the timestamp string $<b>str</b> to another format. The timestamp
+format is Y-m-d H:i:s, as in '2002-02-28 23:00:12', or Unix timestamp format.
+UserTimeStamp calls UnixTimeStamp to parse $<i>str</i>, and $<i>fmt</i>
+defaults to Y-m-d H:i:s if not defined. </p>
+
+<p><b>UnixDate<a name=unixdate></a>($str)</b></p>
+
+<p>Parses the date string $<b>str</b> and returns it in unix mktime format (eg.
+a number indicating the seconds after January 1st, 1970). Expects the date to
+be in Y-m-d H:i:s format, except for Sybase and Microsoft SQL Server, where M d
+Y is also accepted (the 3 letter month strings are controlled by a global
+array, which might need localisation).</p>
+
+<p>This function is available in both ADORecordSet and ADOConnection since
+1.91.</p>
+
+<p><b>UnixTimeStamp<a name=unixtimestamp></a>($str)</b></p>
+
+<p>Parses the timestamp string $<b>str</b> and returns it in unix mktime format
+(eg. a number indicating the seconds after January 1st, 1970). Expects the date
+to be in &quot;Y-m-d, H:i:s&quot; (1970-12-24, 00:00:00) or &quot;Y-m-d
+H:i:s&quot; (1970-12-24 00:00:00) or &quot;YmdHis&quot; (19701225000000)
+format, except for Sybase and Microsoft SQL Server, where &quot;M d Y
+h:i:sA&quot; (Dec 25 1970 00:00:00AM) is also accepted (the 3 letter month
+strings are controlled by a global array, which might need localisation).</p>
+
+<p>This function is available in both ADORecordSet and ADOConnection since
+1.91. </p>
+
+<p><b>OffsetDate<a name=OffsetDate></a>($dayFraction, $basedate=false)</b></p>
+
+<p>Returns a string with the native SQL functions to calculate future and past
+dates based on $basedate in a portable fashion. If $basedate is not defined,
+then the current date (at 12 midnight) is used. Returns the SQL string that
+performs the calculation when passed to Execute(). </p>
+
+<p>For example, in Oracle, to find the date and time that is 2.5 days from
+today, you can use:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'># get date one week from now<br>
+$fld = $conn-&gt;OffsetDate(7); // returns &quot;(trunc(sysdate)+7&quot;)</pre><pre># get date and time that is 60 hours from current date and time<br>
+$fld = $conn-&gt;OffsetDate(2.5, $conn-&gt;sysTimeStamp);<span
+style='mso-tab-count:1'> </span>// returns &quot;(sysdate+2.5)&quot;<br>
+<br>
+$conn-&gt;Execute(&quot;UPDATE TABLE SET dodate=$fld WHERE ID=$id&quot;);</pre></div>
+
+<p>This function is available for mysql, mssql, oracle, oci8 and postgresql
+drivers since 2.13. It might work with other drivers provided they allow
+performing numeric day arithmetic on dates.</p>
+
+<p><b>SQLDate<a name=sqldate></a>($dateFormat, $basedate=false)</b></p>
+
+<p class=MsoNormal>Returns a string which contains the native SQL functions to
+format a date or date column $basedate. This is used when retrieving date
+columns in SELECT statements. For sending dates to the database (eg. in UPDATE,
+INSERT or the where clause of SELECT statements) use <a href="#dbdate">DBDate</a>.
+It uses a case-sensitive $dateFormat, which supports: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><span style='mso-spacerun:yes'></span></pre><pre><span style='mso-spacerun:yes'> </span>Y: 4-digit Year</pre><pre><span style='mso-spacerun:yes'> </span>Q: Quarter (1-4)</pre><pre><span style='mso-spacerun:yes'> </span>M: Month (Jan-Dec)</pre><pre><span style='mso-spacerun:yes'> </span>m: Month (01-12)</pre><pre><span style='mso-spacerun:yes'> </span>d: Day (01-31)</pre><pre><span style='mso-spacerun:yes'> </span>H: Hour (00-23)</pre><pre><span style='mso-spacerun:yes'> </span>h: Hour (1-12)</pre><pre><span style='mso-spacerun:yes'> </span>i: Minute (00-59)</pre><pre><span style='mso-spacerun:yes'> </span>s: Second (00-60)</pre><pre><span style='mso-spacerun:yes'> </span>A: AM/PM indicator</pre><pre><span style='mso-spacerun:yes'> </span>w: day of week (0-6 or 1-7 depending on DB)</pre><pre><span style='mso-spacerun:yes'> </span>l: day of week (as string - lowercase L)</pre><pre><span style='mso-spacerun:yes'> </span>W: week in year (0..53 for MySQL, 1..53 for PostgreSQL and Oracle)</pre><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span></pre></div>
+
+<p>All other characters are treated as strings. You can also use \ to escape
+characters. Available on selected databases, including mysql, postgresql,
+mssql, oci8 and DB2. </p>
+
+<p>This is useful in writing portable sql statements that GROUP BY on dates.
+For example to display total cost of goods sold broken by quarter (dates are
+stored in a field called postdate): </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'></span>$sqlfn = $db-&gt;SQLDate('Y-\QQ','postdate'); # get sql that formats postdate to output 2002-Q1<br>
+<span style='mso-spacerun:yes'></span>$sql = &quot;SELECT $sqlfn,SUM(cogs) FROM table GROUP BY $sqlfn ORDER BY 1 desc&quot;;<br>
+<span style='mso-spacerun:yes'></span></pre></div>
+
+<p><b>MoveNext<a name=movenext></a>( )</b></p>
+
+<p>Move the internal cursor to the next row. The <i>$this-&gt;fields</i> array
+is automatically updated. Returns false if unable to do so (normally because
+EOF has been reached), otherwise true. </p>
+
+<p>If EOF is reached, then the $this-&gt;fields array is set to false (this was
+only implemented consistently in ADOdb 3.30). For the pre-3.30 behaviour of
+$this-&gt;fields (at EOF), set the global variable $ADODB_COMPAT_FETCH = true.</p>
+
+<p>Example:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$rs = $db-&gt;Execute($sql);<br>
+if ($rs) <br>
+<span style='mso-tab-count:1'> </span>while (!$rs-&gt;EOF) {<br>
+<span style='mso-spacerun:yes'></span><span style='mso-tab-count:2'> </span>ProcessArray($rs-&gt;fields);<span
+style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:2'> </span>$rs-&gt;MoveNext();<br>
+<span style='mso-tab-count:1'> </span>} </pre></div>
+
+<p><b>Move<a name=move></a>($to)</b></p>
+
+<p>Moves the internal cursor to a specific row $<b>to</b>. Rows are zero-based
+eg. 0 is the first row. The <b>fields</b> array is automatically updated. For
+databases that do not support scrolling internally, ADOdb will simulate forward
+scrolling. Some databases do not support backward scrolling. If the $<b>to</b>
+position is after the EOF, $<b>to</b> will move to the end of the RecordSet for
+most databases. Some obscure databases using odbc might not behave this way.</p>
+
+<p>Note: This function uses <i>absolute positioning</i>, unlike Microsoft's
+ADO.</p>
+
+<p>Returns true or false. If false, the internal cursor is not moved in most
+implementations, so AbsolutePosition( ) will return the last cursor position
+before the Move( ). </p>
+
+<p><b>MoveFirst<a name=movefirst></a>()</b></p>
+
+<p>Internally calls Move(0). Note that some databases do not support this function.</p>
+
+<p><b>MoveLast<a name=movelast></a>()</b></p>
+
+<p>Internally calls Move(RecordCount()-1). Note that some databases do not
+support this function.</p>
+
+<p><b>GetRowAssoc</b><a name=getrowassoc></a>($toUpper=true)</p>
+
+<p>Returns an associative array containing the current row. The keys to the
+array are the column names. The column names are upper-cased for easy access.
+To get the next row, you will still need to call MoveNext(). </p>
+
+<p>For example:<br>
+Array ( [ID] =&gt; 1 [FIRSTNAME] =&gt; Caroline [LASTNAME] =&gt; Miranda
+[CREATED] =&gt; 2001-07-05 ) </p>
+
+<p>Note: do not use GetRowAssoc() with $ADODB_FETCH_MODE = ADODB_FETCH_ASSOC.
+Because they have the same functionality, they will interfere with each other.</p>
+
+<p><b>AbsolutePage<a name=absolutepage></a>($page=-1) </b></p>
+
+<p>Returns the current page. Requires PageExecute()/CachePageExecute() to be
+called. See <a href="#ex8">Example 8</a>.</p>
+
+<p><b>AtFirstPage<a name=atfirstpage>($status='')</a></b><span
+style='mso-bookmark:atfirstpage'></span></p>
+
+<p>Returns true if at first page (1-based). Requires
+PageExecute()/CachePageExecute() to be called. See <a href="#ex8">Example 8</a>.</p>
+
+<p><b>AtLastPage<a name=atlastpage>($status='')</a></b><span style='mso-bookmark:
+atlastpage'></span></p>
+
+<p>Returns true if at last page (1-based). Requires
+PageExecute()/CachePageExecute() to be called. See <a href="#ex8">Example 8</a>.</p>
+
+<p><b>Fields</b><a name=fields></a>(<b>$colname</b>)</p>
+
 <p>Returns the value of the associated column $<b>colname</b> for the current
-  row. The column name is case-insensitive.</p>
-<p>This is a convenience function. For higher performance, use <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a>. </p>
-<p><b>FetchRow</b><a name="fetchrow"></a>()</p> 
-</font><p><font>Returns array containing current row, or false
-    if EOF. FetchRow( ) internally moves to the next record after returning the
-    current row. </font></p>
-<p><font>Warning: Do not mix using FetchRow() with MoveNext().</font></p>
-<p><font>Usage:</font></p>
-<pre><font>$rs = $db-&gt;Execute($sql);<br>if ($rs)<br>	while ($arr = $rs-&gt;FetchRow()) {<br>	   &nbsp;&nbsp;# process $arr	<br>	}</font></pre>
-<p><font><b>FetchInto</b><a name="fetchinto"></a>(<b>&amp;$array</b>)</font></p>
-<p><font> Sets $array to the current row. Returns PEAR_Error
-    object if EOF, 1 if ok (DB_OK constant). If PEAR is undefined, false is returned
-    when EOF. FetchInto( ) internally moves to the next record after returning
-  the current row. </font></p>
-<p><font> FetchRow() is easier to use. See above.</font></p>
-<font> </font>
-<p><font><b>FetchField<a name="fetchfield"></a>($column_number)</b></font></p>
-<p><font>Returns an object containing the <b>name</b>, <b>type</b> and <b>max_length</b> of
-    the associated field. If the max_length cannot be determined reliably, it
-    will be set to -1. The column numbers are zero-based. See <a href="#ex2">example
-  2.</a></font></p>
-<p><font><b>FieldCount<a name="fieldcount"></a>( )</b></font></p>
-<p><font>Returns the number of fields (columns) in the record
-set.</font></p>
-<p><font><b>RecordCount<a name="recordcount"></a>( )</b></font></p>
-<p><font>Returns the number of rows in the record set. If the
-    number of records returned cannot be determined from the database driver
-    API, we will buffer all rows and return a count of the rows after all the
-    records have been retrieved. This buffering can be disabled (for performance
-    reasons) by setting the global variable $ADODB_COUNTRECS = false. When disabled,
-    RecordCount( ) will return -1 for certain databases. See the supported databases
-  list above for more details. </font></p>
-<p><font> RowCount is a synonym for RecordCount.</font></p>
-<p><font><b>PO_RecordCount<a name="po_recordcount"></a>($table,
-$where)</b></font></p>
-<p><font>Returns the number of rows in the record set. If the
-    database does not support this, it will perform a SELECT COUNT(*) on the
-    table $table, with the given $where condition to return an estimate of the
-  recordset size.</font></p>
-<p><font>$numrows = $rs-&gt;PO_RecordCount("articles_table", "group=$group");</font></p>
-<font><b> NextRecordSet<a name="nextrecordset" id="nextrecordset"></a>()</b> </font>
-<p><font>For databases that allow multiple recordsets to be returned
-    in one query, this function allows you to switch to the next recordset. Currently
-  only supported by mssql driver.</font></p>
-<pre><font>$rs = $db-&gt;Execute('execute return_multiple_rs');<br>$arr1 = $rs-&gt;GetArray();<br>$rs-&gt;NextRecordSet();<br>$arr2 = $rs-&gt;GetArray();</font></pre>
-<p><font><b>FetchObject<a name="fetchobject"></a>($toupper=true)</b></font></p>
-<p><font>Returns the current row as an object. If you set $toupper
-    to true, then the object fields are set to upper-case. Note: The newer FetchNextObject()
-  is the recommended way of accessing rows as objects. See below.</font></p>
-<p><font><b>FetchNextObject<a name="fetchnextobject"></a>($toupper=true)</b></font></p>
-<p><font>Gets the current row as an object and moves to the next
-    row automatically. Returns false if at end-of-file. If you set $toupper to
-  true, then the object fields are set to upper-case. Note that for some drivers such as mssql, you need to SetFetchMode(ADODB_FETCH_ASSOC) or SetFetchMode(ADODB_FETCH_BOTH).</font></p>
-<pre><font>$rs = $db-&gt;Execute('select firstname,lastname from table');<br>if ($rs) {<br>	while ($o = $rs-&gt;FetchNextObject()) {<br>		print "$o-&gt;FIRSTNAME, $o-&gt;LASTNAME&lt;BR&gt;";<br>	}<br>}<br></font></pre>
-<p><font>There is some trade-off in speed in using FetchNextObject().
-If performance is important, you should access rows with the <code>fields[]</code> array. <b>FetchObj<a name="fetchobj" id="fetchobj"></a>()</b> </font></p>
-<p><font>Returns the current record as an object. Fields are
-    not upper-cased, unlike FetchObject.  
-</font></p>
-<p><font><b>FetchNextObj<a name="fetchnextobj" id="fetchnextobj"></a>()</b> </font></p>
-<p><font>Returns the current record as an object and moves to
-    the next record. If EOF, false is returned. Fields are not upper-cased, unlike
-  FetctNextObject. </font></p>
-<font>
-<p><b>CurrentRow<a name="currentrow"></a>( )</b></p>
+row. The column name is case-insensitive.</p>
+
+<p>This is a convenience function. For higher performance, use <a
+href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a>. </p>
+
+<p><b>FetchRow</b><a name=fetchrow></a>()</p>
+
+<p>Returns array containing current row, or false if EOF. FetchRow( )
+internally moves to the next record after returning the current row. </p>
+
+<p>Warning: Do not mix using FetchRow() with MoveNext().</p>
+
+<p>Usage:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$rs = $db-&gt;Execute($sql);<br>
+if ($rs)<br>
+<span style='mso-tab-count:1'> </span>while ($arr = $rs-&gt;FetchRow()) {<br>
+<span style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span>&nbsp;&nbsp;# process $arr<span
+style='mso-tab-count:1'> </span><br>
+<span style='mso-tab-count:1'> </span>}</pre></div>
+
+<p><b>FetchInto</b><a name=fetchinto></a>(<b>&amp;$array</b>)</p>
+
+<p>Sets $array to the current row. Returns PEAR_Error object if EOF, 1 if ok
+(DB_OK constant). If PEAR is undefined, false is returned when EOF. FetchInto(
+) internally moves to the next record after returning the current row. </p>
+
+<p>FetchRow() is easier to use. See above.</p>
+
+<p><b>FetchField<a name=fetchfield></a>($column_number)</b></p>
+
+<p>Returns an object containing the <b>name</b>, <b>type</b> and <b>max_length</b>
+of the associated field. If the max_length cannot be determined reliably, it
+will be set to -1. The column numbers are zero-based. See <a href="#ex2">example
+2.</a></p>
+
+<p><b>FieldCount<a name=fieldcount></a>( )</b></p>
+
+<p>Returns the number of fields (columns) in the record set.</p>
+
+<p><b>RecordCount<a name=recordcount></a>( )</b></p>
+
+<p>Returns the number of rows in the record set. If the number of records
+returned cannot be determined from the database driver API, we will buffer all
+rows and return a count of the rows after all the records have been retrieved.
+This buffering can be disabled (for performance reasons) by setting the global
+variable $ADODB_COUNTRECS = false. When disabled, RecordCount( ) will return -1
+for certain databases. See the supported databases list above for more details.
+</p>
+
+<p>RowCount is a synonym for RecordCount.</p>
+
+<p><b>PO_RecordCount<a name="po_recordcount"></a>($table, $where)</b></p>
+
+<p>Returns the number of rows in the record set. If the database does not
+support this, it will perform a SELECT COUNT(*) on the table $table, with the
+given $where condition to return an estimate of the recordset size.</p>
+
+<p>$numrows = $rs-&gt;PO_RecordCount(&quot;articles_table&quot;,
+&quot;group=$group&quot;);</p>
+
+<p class=MsoNormal><b>NextRecordSet<a name=nextrecordset id=nextrecordset></a>()</b>
+</p>
+
+<p>For databases that allow multiple recordsets to be returned in one query,
+this function allows you to switch to the next recordset. Currently only
+supported by mssql driver.</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$rs = $db-&gt;Execute('execute return_multiple_rs');<br>
+$arr1 = $rs-&gt;GetArray();<br>
+$rs-&gt;NextRecordSet();<br>
+$arr2 = $rs-&gt;GetArray();</pre></div>
+
+<p><b>FetchObject<a name=fetchobject></a>($toupper=true)</b></p>
+
+<p>Returns the current row as an object. If you set $toupper to true, then the
+object fields are set to upper-case. Note: The newer FetchNextObject() is the
+recommended way of accessing rows as objects. See below.</p>
+
+<p><b>FetchNextObject<a name=fetchnextobject></a>($toupper=true)</b></p>
+
+<p>Gets the current row as an object and moves to the next row automatically.
+Returns false if at end-of-file. If you set $toupper to true, then the object
+fields are set to upper-case. Note that for some drivers such as mssql, you
+need to SetFetchMode(ADODB_FETCH_ASSOC) or SetFetchMode(ADODB_FETCH_BOTH).</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'>$rs = $db-&gt;Execute('select firstname,lastname from table');<br>
+if ($rs) {<br>
+<span style='mso-tab-count:1'> </span>while ($o = $rs-&gt;FetchNextObject()) {<br>
+<span style='mso-tab-count:2'> </span>print &quot;$o-&gt;FIRSTNAME, $o-&gt;LASTNAME&lt;BR&gt;&quot;;<br>
+<span style='mso-tab-count:1'> </span>}<br>
+}</pre></div>
+
+<p>There is some trade-off in speed in using FetchNextObject(). If performance
+is important, you should access rows with the <code><span style='font-size:
+10.0pt'>fields[]</span></code> array. <b>FetchObj<a name=fetchobj id=fetchobj></a>()</b>
+</p>
+
+<p>Returns the current record as an object. Fields are not upper-cased, unlike
+FetchObject. </p>
+
+<p><b>FetchNextObj<a name=fetchnextobj id=fetchnextobj></a>()</b> </p>
+
+<p>Returns the current record as an object and moves to the next record. If
+EOF, false is returned. Fields are not upper-cased, unlike FetctNextObject. </p>
+
+<p><b>CurrentRow<a name=currentrow></a>( )</b></p>
+
 <p>Returns the current row of the record set. 0 is the first row.</p>
-<p><b>AbsolutePosition<a name="abspos"></a>( )</b></p>
-<p>Synonym for <b>CurrentRow</b> for compatibility with ADO. Returns the current
-  row of the record set. 0 is the first row.</p>
-<p><b>MetaType<a name="metatype"></a>($nativeDBType[,$field_max_length],[$fieldobj])</b></p>
+
+<p><b>AbsolutePosition<a name=abspos></a>( )</b></p>
+
+<p>Synonym for <b>CurrentRow</b> for compatibility with ADO. Returns the
+current row of the record set. 0 is the first row.</p>
+
+<p><b>MetaType<a name=metatype></a>($nativeDBType[,$field_max_length],[$fieldobj])</b></p>
+
 <p>Determine what <i>generic</i> meta type a database field type is given its
-  native type $<b>nativeDBType</b> as a string and the length of the field $<b>field_max_length</b>.
-  Note that field_max_length can be -1 if it is not known. The field object returned
-  by FetchField() can be passed in $<b>fieldobj</b> or as the 1st parameter <b>$nativeDBType</b>.
-  This is useful for databases such as <i>mysql</i> which has additional properties
-  in the field object such as <i>primary_key</i>. </p>
-<p>Uses the field <b>blobSize</b> and compares it with $<b>field_max_length</b> to
-  determine whether the character field is actually a blob.</p>
-For example, $db-&gt;MetaType('char') will return 'C'.
+native type $<b>nativeDBType</b> as a string and the length of the field $<b>field_max_length</b>.
+Note that field_max_length can be -1 if it is not known. The field object
+returned by FetchField() can be passed in $<b>fieldobj</b> or as the 1st
+parameter <b>$nativeDBType</b>. This is useful for databases such as <i>mysql</i>
+which has additional properties in the field object such as <i>primary_key</i>.
+</p>
+
+<p>Uses the field <b>blobSize</b> and compares it with $<b>field_max_length</b>
+to determine whether the character field is actually a blob.</p>
+
+<p class=MsoNormal>For example, $db-&gt;MetaType('char') will return 'C'. </p>
+
 <p>Returns:</p>
-<ul>
-  <li><b>C</b>: Character fields that should be shown in a &lt;input type="text"&gt; tag. </li>
-  <li><b>X</b>: Clob (character large objects), or large text fields that should
-    be shown in a &lt;textarea&gt;</li>
-  <li><b>D</b>: Date field</li>
-  <li><b>T</b>: Timestamp field</li>
-  <li><b>L</b>: Logical field (boolean or bit-field)</li>
-  <li><b>N</b>: Numeric field. Includes decimal, numeric, floating point, and
-    real. </li>
-  <li><b>I</b>:&nbsp; Integer field. </li>
-  <li><b>R</b>: Counter or Autoincrement field. Must be numeric.</li>
-  <li><b>B</b>: Blob, or binary large objects. </li>
-</ul> 
-</font><p><font> Since ADOdb 3.0, MetaType accepts $fieldobj
-    as the first parameter, instead of $nativeDBType. </font></p>
-<font> </font>
-<p><font><b>Close( )<a name="rsclose"></a></b></font></p>
-<p><font>Closes the recordset, cleaning all memory and resources
-associated with the recordset. </font></p>
-<p>
-<font>If memory management is not an issue, you do not need to
-call this function as recordsets are closed for you by PHP at the end of the
-script. SQL statements such as INSERT/UPDATE/DELETE do not really return a recordset,
-so you do not have to call Close() for such SQL statements.</font></p>
-<hr />
-<h3><font>function rs2html<a name="rs2html"></a>($adorecordset,[$tableheader_attributes],
-  [$col_titles])</font></h3>
-<p><font>This is a standalone function (rs2html = recordset to
-    html) that is similar to PHP's <i>odbc_result_all</i> function, it prints
-    a ADORecordSet, $<b>adorecordset</b> as a HTML table. $<b>tableheader_attributes</b> allow
-    you to control the table <i>cellpadding</i>, <i>cellspacing</i> and <i>border</i> attributes.
-    Lastly you can replace the database column names with your own column titles
-    with the array $<b>col_titles</b>. This is designed more as a quick debugging
-  mechanism, not a production table recordset viewer.</font></p>
-<p><font>You will need to include the file <i>tohtml.inc.php</i>.</font></p>
-<p><font>Example of rs2html:<b><font color="#336600"><a name="exrs2html"></a></font></b></font></p>
-<pre><font><b><font color="#336600">&lt;?<br>include('tohtml.inc.php')</font></b>; # load code common to ADOdb <br><b>include</b>('adodb.inc.php'); # load code common to ADOdb <br>$<font color="#663300">conn</font> =ADONewConnection('mysql');   # create a connection <br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br>$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers'; <br>$<font color="#663300">rs</font>   = $<font color="#663300">conn</font>-&gt;Execute($sql); <br><font color="#336600"><b>rs2html</b></font><b>($<font color="#663300">rs</font>,'<i>border=2 cellpadding=3</i>',array('<i>Customer Name','Customer ID</i>'));<br>?&gt;</b></font></pre>
-<hr />
-<h3><font>Differences between this ADOdb library and Microsoft
-ADO<a name="adodiff"></a></font></h3>
-<ol>
-<font>
-<li>ADOdb only supports recordsets created by a connection object. Recordsets
-  cannot be created independently.</li>
-<li>ADO properties are implemented as functions in ADOdb. This makes it easier
-  to implement any enhanced ADO functionality in the future.</li>
-<li>ADOdb's <font face="Courier New, Courier, mono">ADORecordSet-&gt;Move()</font> uses
-  absolute positioning, not relative. Bookmarks are not supported.</li>
-<li><font face="Courier New, Courier, mono">ADORecordSet-&gt;AbsolutePosition() </font>cannot
-  be used to move the record cursor.</li>
-<li>ADO Parameter objects are not supported. Instead we have the ADOConnection::<a href="#parameter">Parameter</a>(
-  ) function, which provides a simpler interface for calling preparing parameters
-  and calling stored procedures.</li>
-<li>Recordset properties for paging records are available, but implemented as
-  in <a href="#ex8">Example 8</a>.</li>
-</font></ol>
-<hr />
-<h1><font>Database Driver Guide<a name="driverguide"></a></font></h1>
-<p><font>This describes how to create a class to connect to a
-    new database. To ensure there is no duplication of work, kindly email me
-  at jlim#natsoft.com.my if you decide to create such a class.</font></p>
-<p><font>First decide on a name in lower case to call the database
-  type. Let's say we call it xbase. </font></p>
-<p><font>Then we need to create two classes ADODB_xbase and ADORecordSet_xbase
-  in the file adodb-xbase.inc.php.</font></p>
-<p><font>The simplest form of database driver is an adaptation
-    of an existing ODBC driver. Then we just need to create the class <i>ADODB_xbase
-    extends ADODB_odbc</i> to support the new <b>date</b> and <b>timestamp</b> formats,
-    the <b>concatenation</b> operator used, <b>true</b> and <b>false</b>. For
-    the<i> ADORecordSet_xbase extends ADORecordSet_odbc </i>we need to change
-  the <b>MetaType</b> function. See<b> adodb-vfp.inc.php</b> as an example.</font></p>
-<p><font>More complicated is a totally new database driver that
-    connects to a new PHP extension. Then you will need to implement several
-    functions. Fortunately, you do not have to modify most of the complex code.
-    You only need to override a few stub functions. See <b>adodb-mysql.inc.php</b> for
-  example.</font></p>
-<p><font>The default date format of ADOdb internally is YYYY-MM-DD
-    (Ansi-92). All dates should be converted to that format when passing to an
-    ADOdb date function. See Oracle for an example how we use ALTER SESSION to
-  change the default date format in _pconnect _connect.</font></p>
-<p><font><b>ADOConnection Functions to Override</b></font></p>
-<p><font>Defining a constructor for your ADOConnection derived
-  function is optional. There is no need to call the base class constructor.</font></p>
-<p><font>_<b>connect</b>: Low level implementation of Connect.
-  Returns true or false. Should set the _<b>connectionID</b>.</font></p>
-<p><font>_<b>pconnect:</b> Low level implemention of PConnect.
-  Returns true or false. Should set the _<b>connectionID</b>.</font></p>
-<p><font>_<b>query</b>: Execute a query. Returns the queryID,
-or false.</font></p>
-<p><font>_<b>close: </b>Close the connection -- PHP should clean
-up all recordsets. </font></p>
-<p><font><b>ErrorMsg</b>: Stores the error message in the private
-variable _errorMsg. </font></p>
-<p><font><b>ADOConnection Fields to Set</b></font></p>
-<p><font>_<b>bindInputArray</b>: Set to true if binding of parameters
-  for SQL inserts and updates is allowed using ?, eg. as with ODBC.</font></p>
-<p><font><b>fmtDate</b></font></p>
-<p><font><b>fmtTimeStamp</b></font></p>
-<p><font><b>true</b></font></p>
-<p><font><b>false</b></font></p>
-<p><font><b>concat_operator</b></font></p>
-<p><font><b>replaceQuote</b></font></p>
-<p><font><b>hasLimit</b> support SELECT * FROM TABLE LIMIT 10
-of MySQL.</font></p>
-<p><font><b>hasTop</b> support Microsoft style SELECT TOP 10
-* FROM TABLE.</font></p>
-<p><font><b>ADORecordSet Functions to Override</b></font></p>
-<p><font>You will need to define a constructor for your ADORecordSet
-  derived class that calls the parent class constructor.</font></p>
-<p><font><b>FetchField: </b> as documented above in ADORecordSet</font></p>
-<p><font>_<b>initrs</b>: low level initialization of the recordset:
-    setup the _<b>numOfRows</b> and _<b>numOfFields</b> fields -- called by the
-  constructor.</font></p>
-<p><font>_<b>seek</b>: seek to a particular row. Do not load
-    the data into the fields array. This is done by _fetch. Returns true or false.
-    Note that some implementations such as Interbase do not support seek. Set
-  canSeek to false.</font></p>
-<p><font>_<b>fetch</b>: fetch a row using the database extension
-    function and then move to the next row. Sets the <b>fields</b> array. If
-    the parameter $ignore_fields is true then there is no need to populate the <b>fields</b> array,
-  just move to the next row. then Returns true or false.</font></p>
-<p><font>_<b>close</b>: close the recordset</font></p>
-<p><font><b>Fields</b>: If the array row returned by the PHP
-    extension is not an associative one, you will have to override this. See
-    adodb-odbc.inc.php for an example. For databases such as MySQL and MSSQL
-    where an associative array is returned, there is no need to override this
-  function.</font></p>
-<p><font><b>ADOConnection Fields to Set</b></font></p>
-<p><font>canSeek: Set to true if the _seek function works.</font></p>
-<h2><font>Optimizing PHP</font></h2>
-    For info on tuning PHP, read this article on <a href="http://phplens.com/lens/php-book/optimizing-debugging-php.php">Optimizing
-  PHP</a>. </font></p>
-
-<h2><font>Change Log<a name="Changes"></a><a name="changes"></a><a name="changelog"></a></font></h2>
-
-<p><a name="4.98"></a><b>4.98/5.04 13 Feb 2008</b>
-<p> Fixed adodb_mktime problem which causes a performance bottleneck in $hrs.
-<p>Added mysqli support to adodb_getcount().
-<p>Removed MYSQLI_TYPE_CHAR from MetaType().
-
-<p><a name="4.97"></a><b>4.97/5.03 22 Jan 2008</b>
-<p>Active Record: $ADODB_ASSOC_CASE=1 did not work properly. Fixed. 
-<p>Modified Fields() in recordset class to support display null fields in FetchNextObject().
-<p>In ADOdb5, active record implementation, we now support column names with spaces in them - we autoconvert the spaces to _ using
- __set(). Thx Daniel Cook. http://phplens.com/lens/lensforum/msgs.php?id=17200
-<p>Removed $arg3 from mysqli SelectLimit. See http://phplens.com/lens/lensforum/msgs.php?id=16243. Thx Zsolt Szeberenyi.
-<p>Changed oci8 FetchField, which returns the max_length of BLOB/CLOB/NCLOB as 4000 (incorrectly) to -1.
-<p>CacheExecute would sometimes return an error on Windows if it was unable to lock the cache file. This is harmless
-and has been changed to a warning that can be ignored. Also adodb_write_file() code revised.
-<p>ADOdb perf code changed to only log sql if execution time >= 0.05 seconds. New $ADODB_PERF_MIN variable holds min sql timing. 
-Any SQL with timing value below this and is not causing an error is not logged.
-<p>Also adodb_backtrace() now traces 1 level deeper as sometimes actual culprit function is not displayed.
-<p>Fixed a group by problem with adodb_getcount() for db's which are not postgres/oci8 based.
-<p>Changed mssql driver Parameter() from SQLCHAR to SQLVARCHAR: case 'string': $type = SQLVARCHAR; break.
-<p>Problem with mssql driver in php5 (for adodb 5.03) because some functions are not static. Fixed.
-
-
-<p><a name="4.96"></a><b>4.96/5.02 24 Sept 2007</b>
-p>Fix adodb count optimisation. Preg_match did not work properly. Also rewrote the ORDER BY stripping code in _adodb_getcount(), adodb-lib.inc.php.
-<p>SelectLimit for oci8 not optimal for large recordsets when offset=0. Changed $nrows check.
-<p>Active record optimizations. 
-Added support for assoc arrays in Set().
-<p>Now GetOne returns null if EOF (no records found), and false if error occurs. Use ErrorMsg()/ErrorNo() to get the error.
-<p>Added BIT data type support to adodb-ado.inc.php and adodb-ado5.inc.php.
-<p>Ldap driver did not return actual ldap error messages. Fixed.
-<p>Implemented GetRandRow($sql, $inputarr). Optimized for Oci8.
-<p>Changed adodb5 active record to use static SetDatabaseAdapter() and removed php4 constructor. Bas van Beek bas.vanbeek#gmail.com.
-<p>Also in adodb5, changed adodb-session2 to use static function declarations in class. Thx Daniel Berlin.
-<p>Added "Clear SQL Log" to bottom of Performance screen.
-<p>Sessions2 code echo'ed directly to the screen in debug mode. Now uses ADOConnection::outp().
-<p>In mysql/mysqli, qstr(null) will return the string "null" instead of empty quoted string "''".
-<p>postgresql optimizeTable in perf-postgres.inc.php added by Daniel Berlin (mail#daniel-berlin.de)
-<p>Added 5.2.1 compat code for oci8.
-<p>Changed @@identity to SCOPE_IDENTITY() for multiple mssql drivers. Thx  Stefano Nari.
-<p>Code sanitization introduced in 4.95 caused problems in European locales (as float 3.2 was typecast to 3,2). Now we only sanitize if is_numeric fails.
-<p>Added support for customizing ADORecordset_empty using $this->rsPrefix.'empty'. By Josh Truwin.
-<p>Added proper support for ALterColumnSQL for Postgresql in datadict code. Thx. Josh Truwin. 
+
+<ul type=disc>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>C</b>: Character fields
+     that should be shown in a &lt;input type=&quot;text&quot;&gt; tag. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>X</b>: Clob (character
+     large objects), or large text fields that should be shown in a
+     &lt;textarea&gt;</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>D</b>: Date field</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>T</b>: Timestamp field</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>L</b>: Logical field
+     (boolean or bit-field)</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>N</b>: Numeric field.
+     Includes decimal, numeric, floating point, and real. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>I</b>:&nbsp; Integer
+     field. </li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>R</b>: Counter or
+     Autoincrement field. Must be numeric.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l7 level1 lfo11;tab-stops:list 36.0pt'><b>B</b>: Blob, or binary
+     large objects. </li>
+</ul>
+
+<p>Since ADOdb 3.0, MetaType accepts $fieldobj as the first parameter, instead
+of $nativeDBType. </p>
+
+<p><b>Close( )</b><a name=rsclose></a></p>
+
+<p>Closes the recordset, cleaning all memory and resources associated with the
+recordset. </p>
+
+<p>If memory management is not an issue, you do not need to call this function
+as recordsets are closed for you by PHP at the end of the script. SQL
+statements such as INSERT/UPDATE/DELETE do not really return a recordset, so you
+do not have to call Close() for such SQL statements.</p>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h3>function rs2html<a name=rs2html></a>($adorecordset,[$tableheader_attributes],
+[$col_titles])</h3>
+
+<p>This is a standalone function (rs2html = recordset to html) that is similar
+to PHP's <i>odbc_result_all</i> function, it prints a ADORecordSet, $<b>adorecordset</b>
+as a HTML table. $<b>tableheader_attributes</b> allow you to control the table <i>cellpadding</i>,
+<i>cellspacing</i> and <i>border</i> attributes. Lastly you can replace the
+database column names with your own column titles with the array $<b>col_titles</b>.
+This is designed more as a quick debugging mechanism, not a production table
+recordset viewer.</p>
+
+<p>You will need to include the file <i>tohtml.inc.php</i>.</p>
+
+<p>Example of rs2html:<a name=exrs2html></a></p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><b><span style='color:#336600'>&lt;?<br>
+include('tohtml.inc.php')</span></b>; # load code common to ADOdb <br>
+<b>include</b>('adodb.inc.php'); # load code common to ADOdb <br>
+$<span style='color:#663300'>conn</span> = &amp;ADONewConnection('mysql');<span style='mso-spacerun:yes'> </span># create a connection <br>
+$<span style='color:#663300'>conn</span>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br>
+$<span style='color:#663300'>sql</span> = 'select CustomerName, CustomerID from customers'; <br>
+$<span style='color:#663300'>rs</span><span style='mso-spacerun:yes'> </span>= $<span
+style='color:#663300'>conn</span>-&gt;Execute($sql); <br>
+<b><span style='color:#336600'>rs2html</span>($</b><b><span style='color:#663300'>rs</span>,'<i>border=2 cellpadding=3</i>',array('<i>Customer Name','Customer ID</i>'));<br>
+?&gt;</b></pre></div>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h3>Differences between this ADOdb library and Microsoft ADO<a name=adodiff></a></h3>
+
+<ol start=1 type=1>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l10 level1 lfo12;tab-stops:list 36.0pt'>ADOdb only supports
+     recordsets created by a connection object. Recordsets cannot be created
+     independently.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l10 level1 lfo12;tab-stops:list 36.0pt'>ADO properties are implemented
+     as functions in ADOdb. This makes it easier to implement any enhanced ADO
+     functionality in the future.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l10 level1 lfo12;tab-stops:list 36.0pt'>ADOdb's <span
+     style='font-family:"Courier New"'>ADORecordSet-&gt;Move()</span> uses
+     absolute positioning, not relative. Bookmarks are not supported.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l10 level1 lfo12;tab-stops:list 36.0pt'><span style='font-family:
+     "Courier New"'>ADORecordSet-&gt;AbsolutePosition() </span>cannot be used
+     to move the record cursor.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l10 level1 lfo12;tab-stops:list 36.0pt'>ADO Parameter objects are
+     not supported. Instead we have the ADOConnection::<a href="#parameter">Parameter</a>(
+     ) function, which provides a simpler interface for calling preparing
+     parameters and calling stored procedures.</li>
+ <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
+     mso-list:l10 level1 lfo12;tab-stops:list 36.0pt'>Recordset properties for
+     paging records are available, but implemented as in <a href="#ex8">Example
+     8</a>.</li>
+</ol>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<h1>Database Driver Guide<a name=driverguide></a></h1>
+
+<p>This describes how to create a class to connect to a new database. To ensure
+there is no duplication of work, kindly email me at jlim#natsoft.com if you
+decide to create such a class.</p>
+
+<p>First decide on a name in lower case to call the database type. Let's say we
+call it xbase. </p>
+
+<p>Then we need to create two classes ADODB_xbase and ADORecordSet_xbase in the
+file adodb-xbase.inc.php.</p>
+
+<p>The simplest form of database driver is an adaptation of an existing ODBC
+driver. Then we just need to create the class <i>ADODB_xbase extends ADODB_odbc</i>
+to support the new <b>date</b> and <b>timestamp</b> formats, the <b>concatenation</b>
+operator used, <b>true</b> and <b>false</b>. For the<i> ADORecordSet_xbase
+extends ADORecordSet_odbc </i>we need to change the <b>MetaType</b> function.
+See<b> adodb-vfp.inc.php</b> as an example.</p>
+
+<p>More complicated is a totally new database driver that connects to a new PHP
+extension. Then you will need to implement several functions. Fortunately, you
+do not have to modify most of the complex code. You only need to override a few
+stub functions. See <b>adodb-mysql.inc.php</b> for example.</p>
+
+<p>The default date format of ADOdb internally is YYYY-MM-DD (Ansi-92). All
+dates should be converted to that format when passing to an ADOdb date
+function. See Oracle for an example how we use ALTER SESSION to change the
+default date format in _pconnect _connect.</p>
+
+<p><b>ADOConnection Functions to Override</b></p>
+
+<p>Defining a constructor for your ADOConnection derived function is optional.
+There is no need to call the base class constructor.</p>
+
+<p>_<b>connect</b>: Low level implementation of Connect. Returns true or false.
+Should set the _<b>connectionID</b>.</p>
+
+<p>_<b>pconnect:</b> Low level implemention of PConnect. Returns true or false.
+Should set the _<b>connectionID</b>.</p>
+
+<p>_<b>query</b>: Execute a query. Returns the queryID, or false.</p>
+
+<p>_<b>close: </b>Close the connection -- PHP should clean up all recordsets. </p>
+
+<p><b>ErrorMsg</b>: Stores the error message in the private variable _errorMsg.
+</p>
+
+<p><b>ADOConnection Fields to Set</b></p>
+
+<p>_<b>bindInputArray</b>: Set to true if binding of parameters for SQL inserts
+and updates is allowed using ?, eg. as with ODBC.</p>
+
+<p><b>fmtDate</b></p>
+
+<p><b>fmtTimeStamp</b></p>
+
+<p><b>true</b></p>
+
+<p><b>false</b></p>
+
+<p><b>concat_operator</b></p>
+
+<p><b>replaceQuote</b></p>
+
+<p><b>hasLimit</b> support SELECT * FROM TABLE LIMIT 10 of MySQL.</p>
+
+<p><b>hasTop</b> support Microsoft style SELECT TOP 10 * FROM TABLE.</p>
+
+<p><b>ADORecordSet Functions to Override</b></p>
+
+<p>You will need to define a constructor for your ADORecordSet derived class
+that calls the parent class constructor.</p>
+
+<p><b>FetchField: </b>as documented above in ADORecordSet</p>
+
+<p>_<b>initrs</b>: low level initialization of the recordset: setup the _<b>numOfRows</b>
+and _<b>numOfFields</b> fields -- called by the constructor.</p>
+
+<p>_<b>seek</b>: seek to a particular row. Do not load the data into the fields
+array. This is done by _fetch. Returns true or false. Note that some
+implementations such as Interbase do not support seek. Set canSeek to false.</p>
+
+<p>_<b>fetch</b>: fetch a row using the database extension function and then
+move to the next row. Sets the <b>fields</b> array. If the parameter
+$ignore_fields is true then there is no need to populate the <b>fields</b>
+array, just move to the next row. then Returns true or false.</p>
+
+<p>_<b>close</b>: close the recordset</p>
+
+<p><b>Fields</b>: If the array row returned by the PHP extension is not an
+associative one, you will have to override this. See adodb-odbc.inc.php for an
+example. For databases such as MySQL and MSSQL where an associative array is
+returned, there is no need to override this function.</p>
+
+<p><b>ADOConnection Fields to Set</b></p>
+
+<p>canSeek: Set to true if the _seek function works.</p>
+
+<h2>Optimizing PHP</h2>
+
+<p class=MsoNormal>For info on tuning PHP, read this article on <a
+href="http://phplens.com/lens/php-book/optimizing-debugging-php.php">Optimizing
+PHP</a>. </p>
+
+<h2>Change Log<a name=changes></a><a name=changelog></a></h2>
+<p><a name=5.10></a><b>5.10 10 Nov 2009</b> </p>
+<p>Fixed memcache to properly support $rs->timeCreated.
+<p>adodb-ado.inc.php: Added BigInt support for PHP5. Will return float instead to support large numbers. Thx nasb#mail.goo.ne.jp.
+<p>adodb-mysqli.inc.php: mysqli_multi_query is now turned off by default. To turn it on, use $conn->multiQuery = true; This is because of the risks of sql injection. See http://phplens.com/lens/lensforum/msgs.php?id=18144
+<p>New db2oci driver for db2 9.7 when using PL/SQL mode. Allows oracle style :0, :1, :2 bind parameters which are remapped to ? ? ?.
+<p>adodb-db2.inc.php: fixed bugs in MetaTables. SYS owner field not checked properly. Also in $conn->Connect($dsn, null, null, $schema) and PConnect($dsn, null, null, $schema), we do a SET SCHEMA=$schema if successful connection.
+<p>adodb-mysqli.inc.php: Now $rs->Close() closes all pending next resultsets. Thx Clifton mesmackgod#gmail.com
+<p>Moved _CreateCache() from PConnect()/Connect() to CacheExecute(). Suggested by Dumka.
+<p>Many bug fixes to adodb-pdo_sqlite.inc.php and new datadict-sqlite.inc.php. Thx Andrei B. [andreutz#mymail.ro]
+<p>Removed usage of split (deprecated in php 5.3). Thx david#horizon-nigh.org.
+<p>Fixed RowLock() parameters to comply with PHP5 strict mode in multiple drivers.
+<p><a name=5.09></a><b>5.09 25 June 2009</b> </p>
+<p>Active Record: You can force column names to be quoted in INSERT and UPDATE statements, typically because you are using reserved words as column names by setting
+ADODB_Active_Record::$_quoteNames = true;
+<p>Added memcache and cachesecs to DSN. e.g.
+<pre>
+	# we have a memcache servers mem1,mem2 on port 8888, compression=off and cachesecs=120
+	$dsn = 'mysql://user:pwd@localhost/mydb?memcache=mem1,mem2:8888:0&cachesecs=120';
+</pre>
+<p>Fixed up MetaColumns and MetaPrimaryIndexes() for php 5.3 compat. Thx http://adodb.pastebin.com/m52082b16
+<p>The postgresql driver's OffsetDate() apparently does not work with postgres 8.3. Fixed.
+<p>Added support for magic_quotes_sybase in qstr() and addq(). Thanks Eloy and Sam Moffat.
+<p>The oci8 driver did not handle LOBs properly when binding. Fixed. See http://phplens.com/lens/lensforum/msgs.php?id=17991.
+<p>Datadict: In order to support TIMESTAMP with subsecond accuracy, added to datadict the new TS type. Supported by mssql, postgresql and oci8 (oracle).
+Also changed oci8 $conn->sysTimeStamp to use 'SYSTIMESTAMP' instead of 'SYSDATE'. Should be backwards compat.
+<p>Added support for PHP 5.1+ DateTime objects in DBDate and DBTimeStamp. This means that dates and timestamps will be managed by DateTime objects if you are running PHP 5.1+.
+<p>Added new property to postgres64 driver to support returning I if type is unique int called $db->uniqueIisR, defaulting to true. See http://phplens.com/lens/lensforum/msgs.php?id=17963
+<p>Added support for bindarray in adodb_GetActiveRecordsClass with SelectLimit in adodb-active-record.inc.php.
+<p>Transactions now allowed in ado_access driver. Thx to  petar.petrov.georgiev#gmail.com.
+<p>Sessions2 garbage collection is now much more robust. We perform ORDER BY to prevent deadlock in adodb-sessions2.inc.php.
+<p>Fixed typo in pdo_sqlite driver.
+<p><a name=5.08a></a><b>5.08a 17 Apr 2009</b> </p>
+<p>Fixes wrong version number string.
+<p>Incorrect + in adodb-datadict.inc.php removed.
+<p>Fixes missing OffsetDate() function in pdo. Thx paul#mantisforge.org. 
+<p><a name=5.08></a><b>5.08 17 Apr 2009</b> </p>
+<p>adodb-sybase.inc.php driver. Added $conn->charSet support. Thx Luis Henrique Mulinari (luis.mulinari#gmail.com)
+<p>adodb-ado5.inc.php. Fixed some bind param issues. Thx Jirka Novak. 
+<p>adodb-ado5.inc.php. Now has improved error handling.
+<p>Fixed typo in adodb-xmlschema03.inc.php. See XMLS_EXISTING_DATA, line 1501. Thx james johnson.
+<p>Made $inputarr optional for _query() in all drivers.
+<p>Fixed spelling mistake in flushall() in adodb.inc.ophp.
+<p>Fixed handling of quotes in adodb_active_record::doquote. Thx Jonathan Hohle (jhohle#godaddy.com).
+<p>Added new index parameter to adodb_active_record::setdatabaseadaptor. Thx Jonathan Hohle
+<p>Fixed & readcache() reference compat problem with php 5.3 in adodb.Thx Jonathan Hohle.
+<p>Some minor $ADODB_CACHE_CLASS definition issues in adodb.inc.php.
+<p>Added Reset() function to adodb_active_record. Thx marcus.
+<p>Minor dsn fix for pdo_sqlite in adodb.inc.php. Thx Sergey Chvalyuk.
+<p>Fixed adodb-datadict _CreateSuffix() inconsistencies. Thx Chris Miller.
+<p>Option to delete old fields $dropOldFlds in datadict ChangeTableSQL($table, $flds, $tableOptions, $dropOldFlds=false) added. Thx  Philipp Niethammer.
+<p>Memcache caching did not expire properly. Fixed.
+<p>MetaForeignKeys for postgres7 driver changed from adodb_movenext to $rs->MoveNext (also in 4.99)
+<p>Added support for ldap and ldaps url format in ldap driver. E.g. ldap://host:port/dn?attributes?scope?filter?extensions
+<p><a name=5.07></a><b>5.07 26 Dec 2008</b> </p>
+
+<p>BeginTrans/CommitTrans/RollbackTrans return true/false correctly on
+success/failure now for mssql, odbc, oci8, mysqlt, mysqli, postgres, pdo. </p>
+
+<p>Replace() now quotes all non-null values including numeric ones. </p>
+
+<p>Postgresql qstr() now returns booleans as <b>true</b> and <b>false</b>
+without quotes. </p>
+
+<p>MetaForeignKeys in mysql and mysqli drivers had this problem: A table can
+have two foreign keys pointing to the same column in the same table. The
+original code will incorrectly report only the last column. Fixed.
+https://sourceforge.net/tracker/index.php?func=detail&amp;aid=2287278&amp;group_id=42718&amp;atid=433976
+</p>
+
+<p>Passing in full ado connection string in $argHostname with ado drivers was
+failing in adodb5 due to bug. Fixed. </p>
+
+<p>Fixed memcachelib flushcache and flushall bugs. Also fixed possible
+timeCreated = 0 problem in readcache. (Also in adodb 4.992). Thanks AlexB_UK
+(alexbarnes#hotmail.com). </p>
+
+<p>Fixed a notice in adodb-sessions2.inc.php, in _conn(). Thx bober
+m.derlukiewicz#rocktech.remove_me.pl; </p>
+
+<p>ADOdb Active Record: Fixed some issues with incompatible fetch modes
+(ADODB_FETCH_ASSOC) causing problems in UpdateActiveTable(). </p>
+
+<p>ADOdb Active Record: Added support for functions that support predefining
+one-to-many relationships:<br>
+&nbsp; <i>ClassHasMany ClassBelongsTo TableHasMany TableBelongsTo
+TableKeyHasMany TableKeyBelongsTo</i>. <br>
+You can also define your child/parent class in these functions, instead of the
+default ADODB_Active_Record. Thx Arialdo Martini &amp; Chris R for idea. </p>
+
+<p>ADOdb Active Record: HasMany hardcoded primary key to &quot;id&quot;. Fixed.
+</p>
+
+<p>Many pdo and pdo-sqlite fixes from Sid Dunayer [sdunayer#interserv.com]. </p>
+
+<p>CacheSelectLimit not working for mssql. Fixed. Thx AlexB. </p>
+
+<p>The rs2html function did not display hours in timestamps correctly. Now 24hr
+clock used.</p>
+
+<p>Changed ereg* functions to use preg* functions as ereg* is deprecated in PHP 5.3. Modified sybase and postgresql drivers.</p>
+
+<p><a name=5.06></a><b>5.06 16 Oct 2008</b> </p>
+
+<p>Added driver adodb-pdo_sqlite.inc.php. Thanks Diogo Toscano
+(diogo#scriptcase.net) for the code. </p>
+
+<p>Added support for <a href="docs-active-record.htm#onetomany">one-to-many relationships</a>
+with BelongsTo() and HasMany() in adodb_active_record. </p>
+
+<p>Added BINARY type to mysql.inc.php (also in 4.991). </p>
+
+<p>Added support for SelectLimit($sql,-1,100) in oci8. (also in 4.991). </p>
+
+<p>New $conn-&gt;GetMedian($table, $field, $where='') to get median account no.
+(also in 4.991) </p>
+
+<p>The rs2html() function in tohtml.inc.php did not handle dates with ':' in it
+properly. Fixed. (also in 4.991) </p>
+
+<p>Added support for connecting to oci8 using $DB-&gt;Connect($ip, $user, $pwd,
+&quot;SID=$sid&quot;); (also in 4.991) </p>
+
+<p>Added mysql type 'VAR_STRING' to MetaType(). (also in 4.991) </p>
+
+<p>The session and session2 code supports setfetchmode assoc properly now (also
+in 4.991). </p>
+
+<p>Added concat support to pdo. Thx Andrea Baron. </p>
+
+<p>Changed db2 driver to use format &quot;Y-m-d H-i-s&quot; for datetime
+instead of &quot;Y-m-d-H-i-s&quot; which was legacy from odbc_db2 conversion. </p>
+
+<p>Removed vestigal break on adodb_tz_offset in adodb-time.inc.php. </p>
+
+<p>MetaForeignKeys did not work for views in MySQL 5. Fixed. </p>
+
+<p>Changed error handling in GetActiveRecordsClass. </p>
+
+<p>Added better support for using existing driver when $ADODB_NEWCONNECTION
+function returns false. </p>
+
+<p>In _CreateSuffix in adodb-datadict.inc.php, adding unsigned variable for
+mysql. </p>
+
+<p>In adodb-xmlschema03.inc.php, changed addTableOpt to include db name. </p>
+
+<p>If bytea blob in postgresql is null, empty string was formerly returned. Now
+null is returned. </p>
+
+<p>Changed db2 driver CreateSequence to support $start parameter. </p>
+
+<p>rs2html() now does not add nbsp to end if length of string &gt; 0 </p>
+
+<p>The oci8po FetchField() now only lowercases field names if ADODB_ASSOC_CASE
+is set to 0. </p>
+
+<p>New mssqlnative drivers for php. TQ Garrett Serack of M'soft. <a
+href="http://www.microsoft.com/downloads/details.aspx?FamilyId=61BF87E0-D031-466B-B09A-6597C21A2E2A&amp;displaylang=en">Download</a>
+mssqlnative extension. Note that this is still in beta. </p>
+
+<p>Fixed bugs in memcache support. </p>
+
+<p>You can now change the return value of GetOne if no records are found using
+the global variable $ADODB_GETONE_EOF. The default is null. To change it back
+to the pre-4.99/5.00 behaviour of false, set $ADODB_GETONE_EOF = false; </p>
+
+<p>In Postgresql 8.2/8.3 MetaForeignkeys did not work. Fixed William Kolodny
+William.Kolodny#gt-t.net </p>
+
+<p><a name=5.05></a><b>4.990/5.05 11 Jul 2008</b> </p>
+
+<p>Added support for multiple recordsets in mysqli &quot;Geisel Sierote&quot;
+geisel#4up.com.br. See http://phplens.com/lens/lensforum/msgs.php?id=15917 </p>
+
+<p>Malcolm Cook added new Reload() function to Active Record. See
+http://phplens.com/lens/lensforum/msgs.php?id=17474 </p>
+
+<p>Thanks Zoltan Monori [monzol#fotoprizma.hu] for bug fixes in iterator,
+SelectLimit, GetRandRow, etc. </p>
+
+<p>Under heavy loads, the performance monitor for oci8 disables Ixora views. </p>
+
+<p>Fixed sybase driver SQLDate to use str_replace(). Also for adodb5, changed
+sybase driver UnixDate and UnixTimeStamp calls to static. </p>
+
+<p>Changed oci8 lob handler to use &amp; reference
+$this-&gt;_refLOBs[$numlob]['VAR'] = &amp;$var. </p>
+
+<p>We now strtolower the get_class() function in PEAR::isError() for php5
+compat. </p>
+
+<p>CacheExecute did not retrieve cache recordsets properly for 5.04 (worked in
+4.98). Fixed. </p>
+
+<p>New ADODB_Cache_File class for file caching defined in adodb.inc.php. </p>
+
+<p>Farsi language file contribution by Peyman Hooshmandi Raad
+(phooshmand#gmail.com) </p>
+
+<p>New API for creating your custom caching class which is stored in
+$ADODB_CACHE: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>include &quot;/path/to/adodb.inc.php&quot;;</pre><pre>$ADODB_CACHE_CLASS = 'MyCacheClass';</pre><pre><o:p>&nbsp;</o:p></pre><pre>class MyCacheClass extends ADODB_Cache_File</pre><pre>{</pre><pre><span
+style='mso-tab-count:1'> </span>function writecache($filename, $contents,$debug=false){...}</pre><pre><span
+style='mso-tab-count:1'> </span>function &amp;readcache($filename, &amp;$err, $secs2cache, $rsClass){ ...}</pre><pre><span
+style='mso-tab-count:1'> </span> :</pre><pre>}</pre><pre><o:p>&nbsp;</o:p></pre><pre>$DB = NewADOConnection($driver);</pre><pre>$DB-&gt;Connect(...);<span style='mso-spacerun:yes'> </span>## MyCacheClass created here and stored in $ADODB_CACHE global variable.</pre><pre><o:p>&nbsp;</o:p></pre><pre>$data = $rs-&gt;CacheGetOne($sql); ## MyCacheClass is used here for caching...</pre></div>
+
+<p>Memcache supports multiple pooled hosts now. Only if none of the pooled
+servers can be contacted will a connect error be generated. Usage example
+below: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>$db = NewADOConnection($driver);</pre><pre>$db-&gt;memCache = true; /// should we use memCache instead of caching in files</pre><pre>$db-&gt;memCacheHost = array($ip1, $ip2, $ip3); /// $db-&gt;memCacheHost = $ip1; still works</pre><pre>$db-&gt;memCachePort = 11211; /// this is default memCache port</pre><pre>$db-&gt;memCacheCompress = false; /// Use 'true' to store the item compressed (uses zlib)</pre><pre><o:p>&nbsp;</o:p></pre><pre>$db-&gt;Connect(...);</pre><pre>$db-&gt;CacheExecute($sql);</pre></div>
+
+<p><a name=4.98></a><b>4.98/5.04 13 Feb 2008</b> </p>
+
+<p>Fixed adodb_mktime problem which causes a performance bottleneck in $hrs. </p>
+
+<p>Added mysqli support to adodb_getcount(). </p>
+
+<p>Removed MYSQLI_TYPE_CHAR from MetaType(). </p>
+
+<p><a name=4.97></a><b>4.97/5.03 22 Jan 2008</b> </p>
+
+<p>Active Record: $ADODB_ASSOC_CASE=1 did not work properly. Fixed. </p>
+
+<p>Modified Fields() in recordset class to support display null fields in
+FetchNextObject(). </p>
+
+<p>In ADOdb5, active record implementation, we now support column names with
+spaces in them - we autoconvert the spaces to _ using __set(). Thx Daniel Cook.
+http://phplens.com/lens/lensforum/msgs.php?id=17200 </p>
+
+<p>Removed $arg3 from mysqli SelectLimit. See
+http://phplens.com/lens/lensforum/msgs.php?id=16243. Thx Zsolt Szeberenyi. </p>
+
+<p>Changed oci8 FetchField, which returns the max_length of BLOB/CLOB/NCLOB as
+4000 (incorrectly) to -1. </p>
+
+<p>CacheExecute would sometimes return an error on Windows if it was unable to
+lock the cache file. This is harmless and has been changed to a warning that
+can be ignored. Also adodb_write_file() code revised. </p>
+
+<p>ADOdb perf code changed to only log sql if execution time &gt;= 0.05
+seconds. New $ADODB_PERF_MIN variable holds min sql timing. Any SQL with timing
+value below this and is not causing an error is not logged. </p>
+
+<p>Also adodb_backtrace() now traces 1 level deeper as sometimes actual culprit
+function is not displayed. </p>
+
+<p>Fixed a group by problem with adodb_getcount() for db's which are not
+postgres/oci8 based. </p>
+
+<p>Changed mssql driver Parameter() from SQLCHAR to SQLVARCHAR: case 'string':
+$type = SQLVARCHAR; break. </p>
+
+<p>Problem with mssql driver in php5 (for adodb 5.03) because some functions
+are not static. Fixed. </p>
+
+<p><a name=4.96></a><b>4.96/5.02 24 Sept 2007</b> </p>
+
+<p>ADOdb perf for oci8 now has non-table-locking code when clearing the sql.
+Slower but better transparency. Added in 4.96a and 5.02a. </p>
+
+<p>Fix adodb count optimisation. Preg_match did not work properly. Also rewrote
+the ORDER BY stripping code in _adodb_getcount(), adodb-lib.inc.php. </p>
+
+<p>SelectLimit for oci8 not optimal for large recordsets when offset=0. Changed
+$nrows check. </p>
+
+<p>Active record optimizations. Added support for assoc arrays in Set(). </p>
+
+<p>Now GetOne returns null if EOF (no records found), and false if error
+occurs. Use ErrorMsg()/ErrorNo() to get the error. </p>
+
+<p>Also CacheGetRow and CacheGetCol will return false if error occurs, or empty
+array() if EOF, just like GetRow and GetCol. </p>
+
+<p>Datadict now allows changing of types which are not resizable, eg. VARCHAR
+to TEXT in ChangeTableSQL. -- Mateo Tibaquir </p>
+
+<p>Added BIT data type support to adodb-ado.inc.php and adodb-ado5.inc.php. </p>
+
+<p>Ldap driver did not return actual ldap error messages. Fixed. </p>
+
+<p>Implemented GetRandRow($sql, $inputarr). Optimized for Oci8. </p>
+
+<p>Changed adodb5 active record to use static SetDatabaseAdapter() and removed
+php4 constructor. Bas van Beek bas.vanbeek#gmail.com. </p>
+
+<p>Also in adodb5, changed adodb-session2 to use static function declarations
+in class. Thx Daniel <st1:State w:st="on"><st1:place w:st="on">Berlin</st1:place></st1:State>.
+</p>
+
+<p>Added &quot;Clear SQL Log&quot; to bottom of Performance screen. </p>
+
+<p>Sessions2 code echo'ed directly to the screen in debug mode. Now uses
+ADOConnection::outp(). </p>
+
+<p>In mysql/mysqli, qstr(null) will return the string &quot;null&quot; instead
+of empty quoted string &quot;''&quot;. </p>
+
+<p>postgresql optimizeTable in perf-postgres.inc.php added by Daniel Berlin
+(mail#daniel-berlin.de) </p>
+
+<p>Added 5.2.1 compat code for oci8. </p>
+
+<p>Changed @@identity to SCOPE_IDENTITY() for multiple mssql drivers. Thx
+Stefano Nari. </p>
+
+<p>Code sanitization introduced in 4.95 caused problems in European locales (as
+float 3.2 was typecast to 3,2). Now we only sanitize if is_numeric fails. </p>
+
+<p>Added support for customizing ADORecordset_empty using
+$this-&gt;rsPrefix.'empty'. By Josh Truwin. </p>
+
+<p>Added proper support for ALterColumnSQL for Postgresql in datadict code.
+Thx. Josh Truwin. </p>
+
 <p>Added better support for MetaType() in mysqli when using an array recordset.
+</p>
+
+<p>Changed parser for pgsql error messages in adodb-error.inc.php to
+case-insensitive regex. </p>
+
+<p><a name=4.95></a><b>4.95/5.01 17 May 2007</b> </p>
+
+<p>CacheFlush debug outp() passed in invalid parameters. Fixed. </p>
+
+<p>Added Thai language file for adodb. Thx Trirat Petchsingh rosskouk#gmail.com
+and Marcos Pont</p>
+
+<p>Added zerofill checking support to MetaColumns for mysql and mysqli. </p>
+
+<p>CacheFlush no longer deletes all files/directories. Only *.cache files
+deleted.</p>
+
+<p>DB2 timestamp format changed to var $fmtTimeStamp =
+&quot;'Y-m-d-H:i:s'&quot;;</p>
 
-<p><a name="5.01"></a><b>4.95/5.01 17 May 2007</b>
-<p>CacheFlush debug outp() passed in invalid parameters. Fixed.
-<p>Added Thai language file for adodb. Thx Trirat Petchsingh rosskouk#gmail.com and Marcos Pont</p>
-<p>Added zerofill checking support to MetaColumns for mysql and mysqli.
-<p>CacheFlush no longer deletes all files/directories. Only *.cache files deleted.</p>
-<p>DB2 timestamp format changed to var $fmtTimeStamp = "'Y-m-d-H:i:s'";</p>
 <p>Added some code sanitization to AutoExecute in adodb-lib.inc.php.</p>
-<p>Due to typo, all connections in adodb-oracle.inc.php would become persistent, even non-persistent ones. Fixed.</p>
-<P>Oci8 DBTimeStamp uses 24 hour time for input now, so you can perform string comparisons between 2 DBTimeStamp values.</P>
+
+<p>Due to typo, all connections in adodb-oracle.inc.php would become
+persistent, even non-persistent ones. Fixed.</p>
+
+<p>Oci8 DBTimeStamp uses 24 hour time for input now, so you can perform string
+comparisons between 2 DBTimeStamp values.</p>
+
 <p>Some PHP4.4 compat issues fixed in adodb-session2.inc.php</p>
-<p>For ADOdb 5.01, fixed some adodb-datadict.inc.php MetaType compat issues with PHP5.
-<p>The $argHostname was wiped out in adodb-ado5.inc.php. Fixed.
-<p>Adodb5 version, added iterator support for adodb_recordset_empty.
-<p><a name="5.00"></a><b>5.00 5 Feb 2007</b>
-<p>Experimental PHP5 version - conforms to E_STRICT (PHP 5.1.6 version), 
-added static to functions outp(), UnixTimeStamp(), UnixDate(), and removed object references: =&amp; changed to =. Otherwise code is the same as 4.94.</p>
-<p><a name="4.94"></a><b>4.94 23 Jan 2007</b>
-<p>Active Record: $ADODB_ASSOC_CASE=2 did not work properly. Fixed. Thx gmane#auxbuss.com.
+
+<p>For ADOdb 5.01, fixed some adodb-datadict.inc.php MetaType compat issues
+with PHP5. </p>
+
+<p>The $argHostname was wiped out in adodb-ado5.inc.php. Fixed. </p>
+
+<p>Adodb5 version, added iterator support for adodb_recordset_empty. </p>
+
+<p>Adodb5 version,more error checking code now will use exceptions if
+available. </p>
+
+<p><a name=4.94></a><b>4.94 23 Jan 2007</b> </p>
+
+<p>Active Record: $ADODB_ASSOC_CASE=2 did not work properly. Fixed. Thx
+gmane#auxbuss.com. </p>
+
 <p>mysqli had bugs in BeginTrans() and EndTrans(). Fixed.</p>
-<p>Improved error handling when no database is connected for oci8. Thx Andy Hassall.</p>
-<p>Names longer than 30 chars in oci8 datadict will be changed to random name. Thx Eugenio. http://phplens.com/lens/lensforum/msgs.php?id=16182
-<p>Added var $upperCase = 'ucase' to access and ado_access drivers. Thx Renato De Giovanni renato#cria.org.br</p>
-<p>Postgres64 driver, if preparing plan failed in _query, did not handle error properly. Fixed. See http://phplens.com/lens/lensforum/msgs.php?id=16131.
-<p>Fixed  GetActiveRecordsClass() reference bug. See http://phplens.com/lens/lensforum/msgs.php?id=16120
-<p>
 
-Added handling of nulls in adodb-ado_mssql.inc.php for qstr(). Thx to Felix Rabinovich.
-<p>
+<p>Improved error handling when no database is connected for oci8. Thx Andy
+Hassall.</p>
+
+<p>Names longer than 30 chars in oci8 datadict will be changed to random name.
+Thx Eugenio. http://phplens.com/lens/lensforum/msgs.php?id=16182 </p>
+
+<p>Added var $upperCase = 'ucase' to access and ado_access drivers. Thx Renato
+De Giovanni renato#cria.org.br</p>
+
+<p>Postgres64 driver, if preparing plan failed in _query, did not handle error
+properly. Fixed. See http://phplens.com/lens/lensforum/msgs.php?id=16131. </p>
+
+<p>Fixed GetActiveRecordsClass() reference bug. See
+http://phplens.com/lens/lensforum/msgs.php?id=16120 </p>
+
+<p>Added handling of nulls in adodb-ado_mssql.inc.php for qstr(). Thx to Felix
+Rabinovich. </p>
+
+<p>Adodb-dict contributions by Gaetano: <br>
++ Support for INDEX in data-dict. Example: idx_ev1. The ability to define
+indexes using the INDEX keyword was added in ADOdb 4.94. The following example
+features mutiple indexes, including a compound index idx_ev1. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'> </span>event_id I(11) NOTNULL AUTOINCREMENT PRIMARY,</pre><pre><span style='mso-spacerun:yes'> </span>event_type I(4) NOTNULL<span style='mso-spacerun:yes'> </span><b>INDEX idx_evt</b>,</pre><pre><span style='mso-spacerun:yes'> </span>event_start_date T DEFAULT NULL <b>INDEX id_esd</b>,</pre><pre><span style='mso-spacerun:yes'> </span>event_end_date T DEFAULT '0000-00-00 00:00:00' <b>INDEX id_eted</b>,</pre><pre><span style='mso-spacerun:yes'> </span>event_parent I(11) UNSIGNED NOTNULL DEFAULT 0 <b>INDEX id_evp</b>,</pre><pre><span style='mso-spacerun:yes'> </span>event_owner I(11) DEFAULT 0 <b>INDEX idx_ev1</b>,</pre><pre><span style='mso-spacerun:yes'> </span>event_project I(11) DEFAULT 0 <b>INDEX idx_ev1</b>,</pre><pre><span style='mso-spacerun:yes'> </span>event_times_recuring I(11) UNSIGNED NOTNULL DEFAULT 0,</pre><pre><span style='mso-spacerun:yes'> </span>event_icon C(20) DEFAULT 'obj/event',</pre><pre><span style='mso-spacerun:yes'> </span>event_description X</pre></div>
+
+<p class=MsoNormal><br>
++ Prevents the generated SQL from including double drop-sequence statements for
+REPLACE case of tables with autoincrement columns (on those dbs that emulate it
+via sequences) <br>
++ makes any date defined as DEFAULT value for D and T columns work
+cross-database, not just the &quot;sysdate&quot; value (as long as it is
+specified using adodb standard format). See above example. </p>
+
+<p>Fixed pdo's GetInsertID() support. Thx Ricky Su. </p>
+
+<p>oci8 Prepare() now sets error messages if an error occurs. </p>
+
+<p>Added 'PT_BR' to SetDateLocale() -- brazilian portugese. </p>
+
+<p>charset in oci8 was not set correctly on *Connect() </p>
+
+<p>ADOConnection::Transpose() now appends as first column the field names. </p>
+
+<p>Added $ADODB_QUOTE_FIELDNAMES. If set to true, will autoquote field names in
+AutoExecute(),GetInsertSQL(), GetUpdateSQL(). </p>
+
+<p>Transpose now adds the field names as the first column after transposition. </p>
+
+<p>Added === check in ADODB_SetDatabaseAdapter for $db,
+adodb-active-record.inc.php. Thx Christian Affolter. </p>
+
+<p>Added ErrorNo() to adodb-active-record.inc.php. Thx ante#novisplet.com. </p>
+
+<p><a name=4.93></a><b>4.93 10 Oct 2006</b> </p>
+
+<p>Added support for multiple database connections in performance monitoring
+code (adodb-perf.inc.php). Now all sql in multiple database connections can be
+saved into one database ($ADODB_LOG_CONN). </p>
+
+<p>Added MetaIndexes() to odbc_mssql. </p>
+
+<p>Added connection property $db-&gt;null2null = 'null'. In
+autoexecute/getinsertsql/getupdatesql, this value will be converted to a null.
+Set this to a funny invalid value if you do not want null conversion. See
+http://phplens.com/lens/lensforum/msgs.php?id=15902. </p>
+
+<p>Path disclosure problem in mysqli fixed. Thx Andy. </p>
+
+<p>Fixed typo in session_schema2.xml. </p>
+
+<p>Changed INT in oci8 to return correct precision in $fld-&gt;max_length,
+MetaColumns(). <st1:place w:st="on"><st1:PlaceName w:st="on">Thx</st1:PlaceName>
+ <st1:PlaceName w:st="on">Eloy</st1:PlaceName> <st1:PlaceName w:st="on">Lafuente</st1:PlaceName>
+ <st1:PlaceType w:st="on">Plaza</st1:PlaceType></st1:place>. </p>
 
-Adodb-dict contributions by Gaetano:
-<br>
-+ Support for INDEX in data-dict. Example:
-idx_ev1. The ability to define indexes using the INDEX keyword was added in ADOdb 4.94. The following example features mutiple indexes, including a compound index idx_ev1. 
-<pre>
-  event_id I(11) NOTNULL AUTOINCREMENT PRIMARY,
-  event_type I(4) NOTNULL  <b>INDEX idx_evt</b>,
-  event_start_date T DEFAULT NULL <b>INDEX id_esd</b>,
-  event_end_date T DEFAULT '0000-00-00 00:00:00' <b>INDEX id_eted</b>,
-  event_parent I(11) UNSIGNED NOTNULL DEFAULT 0 <b>INDEX id_evp</b>,
-  event_owner I(11) DEFAULT 0 <b>INDEX idx_ev1</b>,
-  event_project I(11) DEFAULT 0 <b>INDEX idx_ev1</b>,
-  event_times_recuring I(11) UNSIGNED NOTNULL DEFAULT 0,
-  event_icon C(20) DEFAULT 'obj/event',
-  event_description X
-</pre>
-<br>
-+ Prevents the generated SQL from including double drop-sequence statements for REPLACE case of tables with autoincrement columns (on those dbs that emulate it via sequences)
-<br>
-+ makes any date defined as DEFAULT value for D and T columns work cross-database, not just the "sysdate" value (as long as it is specified using adodb standard format). See above example.
-<p>Fixed pdo's GetInsertID() support. Thx Ricky Su.
-<p>oci8 Prepare() now sets error messages if an error occurs.
-<p>Added 'PT_BR' to SetDateLocale() -- brazilian portugese.
-<p>charset in oci8 was not set correctly on *Connect()
-<p>ADOConnection::Transpose() now appends as first column the field names.
-<p>Added $ADODB_QUOTE_FIELDNAMES. If set to true, will autoquote field names in AutoExecute(),GetInsertSQL(), GetUpdateSQL().
-<p>Transpose now adds the field names as the first column after transposition.
-<p>Added === check in ADODB_SetDatabaseAdapter for $db, adodb-active-record.inc.php. Thx Christian Affolter.
-<p>Added ErrorNo() to adodb-active-record.inc.php. Thx ante#novisplet.com.
-
-
-
-<p><a name="4.93"></a><b>4.93 10 Oct 2006</b>
-<p>Added support for multiple database connections in performance monitoring code (adodb-perf.inc.php). Now all sql in multiple database connections can be saved into one database ($ADODB_LOG_CONN).
-<p>Added MetaIndexes() to odbc_mssql.
-<p>Added connection property $db->null2null = 'null'. In autoexecute/getinsertsql/getupdatesql, this value will be converted to a null. Set this to a funny invalid value if you do not want null conversion. See http://phplens.com/lens/lensforum/msgs.php?id=15902.
-<p>Path disclosure problem in mysqli fixed. Thx Andy.
-<p>Fixed typo in session_schema2.xml.
-<p>Changed INT in oci8 to return correct precision in $fld->max_length, MetaColumns(). Thx Eloy Lafuente Plaza.
 <p>Patched postgres64 _connect to handle serverinfo(). see http://phplens.com/lens/lensforum/msgs.php?id=15887.
-<p>Added pdo fix for null columns. See http://phplens.com/lens/lensforum/msgs.php?id=15889
-<p>For stored procedures, missing connection id now passed into mssql_query(). Thx Ecsy (ecsy#freemail.hu).
-
-<p><a name="4.92a"></a><b>4.92a 30 Aug 2006</b>
-<p>Syntax error in postgres7 driver. Thx Eloy Lafuente Plaza. 
-<p>Minor bug fixes - adodb informix 10 types added to adodb.inc.php. Thx Fernando Ortiz.
-
-<p><a name="4.92"></a><b>4.92 29 Aug 2006</b>
-
-<p>Better odbtp date support.
-<P>Added IgnoreErrors() to bypass default error handling.
-<p>The _adodb_getcount() function in adodb-lib.inc.php, some ORDER BY bug fixes.
-<p>For ibase and firebird, set  $sysTimeStamp = "CURRENT_TIMESTAMP".
-<p>Fixed postgres connection bug: http://phplens.com/lens/lensforum/msgs.php?id=11057.
-<p>Changed CacheSelectLimit() to flush cache when $secs2cache==-1 due to complaints from other users. 
-<p>Added support for using memcached with CacheExecute/CacheSelectLimit. Requires memcache module PECL extension. Usage:
-<pre>
-$db = NewADOConnection($driver);
-$db->memCache = true; /// should we use memCache instead of caching in files
-$db->memCacheHost = 126.0.1.1; /// memCache host
-$db->memCachePort = 11211; /// this is default memCache port
-$db->memCacheCompress = false; /// Use 'true' to store the item compressed (uses zlib)
-
-$db->Connect(...);
-$db->CacheExecute($sql);
-</pre>
-<p>Implemented Transpose() for recordsets. Recordset must be retrieved using ADODB_FETCH_NUM. First column becomes the 
-column name.
-<pre>
-$DB = NewADOConnection('mysql');
-$DB->Connect(...);
-$DB->SetFetchMode(ADODB_FETCH_NUM);
-$rs = $DB->Execute('select productname,productid,unitprice from products limit 10');
-$rs2 = $DB->Transpose($rs);
-rs2html($rs2);
-</pre>
-<p><a name="4.91"></a><b>4.91 2 Aug 2006</b>
-<p>Major session code rewrite .... See session docs.
-<p>PDO bindinputarray was not set properly for MySQL (changed from true to false).
-<p>Changed CacheSelectLimit() to re-cache when $secs2cache==0. This is one way to flush the cache when SelectLimit is called.
-<p>Added to quotes to mysql  and mysqli: "SHOW COLUMNS FROM `%s`";
-<p>Removed accidental optgroup handling in GetMenu().
-<a>Fixed ibase _BlobDecode for php5 compat, and also mem alloc issues for small blobs, thx salvatori#interia.pl
-<p>Mysql driver OffsetDate() speedup, useful for adodb-sessions.
-<p>Fix for GetAssoc() PHP5 compat. See http://phplens.com/lens/lensforum/msgs.php?id=15425
-<p>Active Record - If inserting a record and the value of a primary key field is null, then we do not insert that field in as we assume it is an auto-increment field. Needed by mssql.
+</p>
+
+<p>Added pdo fix for null columns. See
+http://phplens.com/lens/lensforum/msgs.php?id=15889 </p>
+
+<p>For stored procedures, missing connection id now passed into mssql_query().
+Thx Ecsy (ecsy#freemail.hu). </p>
+
+<p><a name=4.92a></a><b>4.92a 30 Aug 2006</b> </p>
+
+<p>Syntax error in postgres7 driver. <st1:place w:st="on"><st1:PlaceName w:st="on">Thx</st1:PlaceName>
+ <st1:PlaceName w:st="on">Eloy</st1:PlaceName> <st1:PlaceName w:st="on">Lafuente</st1:PlaceName>
+ <st1:PlaceType w:st="on">Plaza</st1:PlaceType></st1:place>. </p>
+
+<p>Minor bug fixes - adodb informix 10 types added to adodb.inc.php. Thx
+Fernando Ortiz. </p>
+
+<p><a name=4.92></a><b>4.92 29 Aug 2006</b> </p>
+
+<p>Better odbtp date support. </p>
+
+<p>Added IgnoreErrors() to bypass default error handling. </p>
+
+<p>The _adodb_getcount() function in adodb-lib.inc.php, some ORDER BY bug
+fixes. </p>
+
+<p>For ibase and firebird, set $sysTimeStamp = &quot;CURRENT_TIMESTAMP&quot;. </p>
+
+<p>Fixed postgres connection bug:
+http://phplens.com/lens/lensforum/msgs.php?id=11057. </p>
+
+<p>Changed CacheSelectLimit() to flush cache when $secs2cache==-1 due to
+complaints from other users. </p>
+
+<p>Added support for using memcached with CacheExecute/CacheSelectLimit.
+Requires memcache module PECL extension. Usage: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>$db = NewADOConnection($driver);</pre><pre>$db-&gt;memCache = true; /// should we use memCache instead of caching in files</pre><pre>$db-&gt;memCacheHost = &quot;126.0.1.1&quot;; /// memCache host</pre><pre>$db-&gt;memCachePort = 11211; /// this is default memCache port</pre><pre>$db-&gt;memCacheCompress = false; /// Use 'true' to store the item compressed (uses zlib)</pre><pre><o:p>&nbsp;</o:p></pre><pre>$db-&gt;Connect(...);</pre><pre>$db-&gt;CacheExecute($sql);</pre></div>
+
+<p>Implemented Transpose() for recordsets. Recordset must be retrieved using
+ADODB_FETCH_NUM. First column becomes the column name. </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>$DB = NewADOConnection('mysql');</pre><pre>$DB-&gt;Connect(...);</pre><pre>$DB-&gt;SetFetchMode(ADODB_FETCH_NUM);</pre><pre>$rs = $DB-&gt;Execute('select productname,productid,unitprice from products limit 10');</pre><pre>$rs2 = $DB-&gt;Transpose($rs);</pre><pre>rs2html($rs2);</pre></div>
+
+<p><a name=4.91></a><b>4.91 2 Aug 2006</b> </p>
+
+<p>Major session code rewrite .... See session docs. </p>
+
+<p>PDO bindinputarray was not set properly for MySQL (changed from true to
+false). </p>
+
+<p>Changed CacheSelectLimit() to re-cache when $secs2cache==0. This is one way
+to flush the cache when SelectLimit is called. </p>
+
+<p>Added to quotes to mysql and mysqli: &quot;SHOW COLUMNS FROM `%s`&quot;; </p>
+
+<p>Removed accidental optgroup handling in GetMenu(). Fixed ibase _BlobDecode
+for php5 compat, and also mem alloc issues for small blobs, thx
+salvatori#interia.pl </p>
+
+<p>Mysql driver OffsetDate() speedup, useful for adodb-sessions. </p>
+
+<p>Fix for GetAssoc() PHP5 compat. See
+http://phplens.com/lens/lensforum/msgs.php?id=15425 </p>
+
+<p>Active Record - If inserting a record and the value of a primary key field
+is null, then we do not insert that field in as we assume it is an
+auto-increment field. Needed by mssql. </p>
+
 <p>Changed postgres7 MetaForeignKeys() see http://phplens.com/lens/lensforum/msgs.php?id=15531
-<p>DB2 will now return db2_conn_errormsg() when it is a connection error. 
-<p><a name="4.90"></a><b>4.90 8 June 2006</b>
-<p>Changed adodb_countrec() in adodb-lib.inc.php to allow LIMIT to be used as a speedup to reduce no of records counted.
-<p>Added support for transaction modes for postgres and oci8 with SetTransactionMode(). 
-These transaction modes affect all subsequent transactions of that connection.
-<p>Thanks to Halmai Csongor for suggestion.
-<p>Removed $off = $fieldOffset - 1 line in db2 driver, FetchField(). Tx Larry Menard.
-<p>Added support for PHP5 objects as Execute() bind parameters using __toString (eg. Simple-XML). Thx Carl-Christian Salvesen.
-<p>Rounding in tohtml.inc.php did not work properly. Fixed.
-<p>MetaIndexes in postgres fails when fields are deleted then added in again because the attnum has gaps in it. 
-See http://sourceforge.net/tracker/index.php?func=detail&aid=1451245&group_id=42718&atid=433976. Fixed.
-<p>MetaForeignkeys in mysql and mysqli did not work when fetchMode==ADODB_FETCH_ASSOC used. Fixed.
-<p>Reference error in AutoExecute() fixed.
-<p>Added macaddr postgres type to MetaType. Maps to 'C'.
-<p>Added to _connect() in adodb-ado5.inc.php support for $database and $dataProvider parameters.  Thx Larry Menard.
-<p>Added support for sequences in adodb-ado_mssql.inc.php. Thx Larry Menard.
-<p>Added ADODB_SESSION_READONLY.
-<p>Added session expiryref support to crc32 mode, and in LOB code.
-<p>Clear _errorMsg in postgres7 driver, so that ErrorMsg() displays properly when no error occurs.
-<p>Added BindDate and BindTimeStamp
-<p><a name="4.81"></a><b>4.81 3 May 2006</b>
-<p>Fixed variable ref errors in adodb-ado5.inc.php in _query().
-<p>Mysqli setcharset fix using method_exists().
-<p>The adodb-perf.inc.php CreateLogTable() code now works for user-defined table names.
-<p>Error in ibase_blob_open() fixed. See http://phplens.com/lens/lensforum/msgs.php?id=14997
-<p><a name="4.80"></a><b>4.80 8 Mar 2006</b>
-<p>Added activerecord support.
-<p>Added mysql $conn->compat323 = true if you want MySQL 3.23 compat enabled. Fixes GetOne() Select-Limit problems.
-<p>Added adodb-xmlschema03.inc.php to support XML Schema version 3 and updated adodb-datadict.htm docs.
-<p>Better memory management in Execute. Thx Mike Fedyk.
-<p><a name="4.72"></a><b>4.72 21 Feb 2006</b>
-<p>Added 'new' DSN parameter for NConnect().
-<p>Pager now sanitizes $PHP_SELF to protect against XSS. Thx to James Bercegay and others.
-<p>ADOConnection::MetaType changed to setup $rs->connection correctly. 
-<p>New native DB2 driver contributed by Larry Menard, Dan Scott, Andy Staudacher, Bharat Mediratta.
-<p>The mssql CreateSequence() did not BEGIN TRANSACTION correctly. Fixed. Thx Sean Lee.
-<p>The _adodb_countrecs() function in adodb-lib.inc.php has been revised to handle more ORDER BY variations.
-<p><a name="4.71"></a><b>4.71 24 Jan 2006</b>
-<p>Fixes postgresql security issue related to binary strings. Thx to Andy Staudacher.
-<p>Several DSN bugs found:
-<p>1. Fix bugs in DSN connections introduced in 4.70 when underscores are found in the DSN. 
-<p>2. DSN with _ did not work properly in PHP5 (fine in PHP4). Fixed.
-<p>3. Added support for PDO DSN connections in NewADOConnection(), and database parameter in PDO::Connect().
-<p>The oci8 datetime flag not correctly implemented in ADORecordSet_array. Fixed.
-<p>Added BlobDelete() to postgres, as a counterpoint to UpdateBlobFile().
-<p>Fixed GetInsertSQL() to support oci8po.
-<p>Fixed qstr() issue with postgresql with \0 in strings.
-<p>Fixed some datadict driver loading issues in _adodb_getdriver(). 
-<p>Added register shutdown function session_write_close in adodb-session.inc.php for PHP 5 compat. See http://phplens.com/lens/lensforum/msgs.php?id=14200.
-<p><a name="4.70"></a><b>4.70 6 Jan 2006</b>
-<p>Many fixes from Danila Ulyanov  to ibase, oci8, postgres, mssql, odbc_oracle, odbtp, etc drivers.
-<p>Changed usage of binary hint in adodb-session.inc.php for mysql. See 
-http://phplens.com/lens/lensforum/msgs.php?id=14160
-<p>Fixed invalid variable reference problem in undomq(), adodb-perf.inc.php.
-<p>Fixed http://phplens.com/lens/lensforum/msgs.php?id=14254 in adodb-perf.inc.php, _DBParameter() settings of fetchmode was wrong.
-<p>Fixed security issues in server.php and tmssql.php discussed by Andreas Sandblad in a Secunia security advisory. Added $ACCEPTIP = 127.0.0.1
-and changed suggested root password to something more secure.
-<p>Changed pager to close recordset after RenderLayout().
-<p><a name="4.68"></a><b>4.68 25 Nov  2005</b>
-<p>PHP 5 compat for mysqli. MetaForeignKeys repeated twice and MYSQLI_BINARY_FLAG missing.
-<p>PHP 5.1 support for postgresql bind parameters using ? did not work if >= 10 parameters. Fixed. Thx to Stanislav Shramko.
-<p>Lots of PDO improvements.
-<p>Spelling error fixed in mysql MetaForeignKeys, $associative parameter.
-<p><a name="4.67"></a><b>4.67 16 Nov  2005</b>
-<p>Postgresql not_null flag not set to false correctly. Thx Cristian MARIN.
+</p>
+
+<p>DB2 will now return db2_conn_errormsg() when it is a connection error. </p>
+
+<p><a name=4.90></a><b>4.90 8 June 2006</b> </p>
+
+<p>Changed adodb_countrec() in adodb-lib.inc.php to allow LIMIT to be used as a
+speedup to reduce no of records counted. </p>
+
+<p>Added support for transaction modes for postgres and oci8 with
+SetTransactionMode(). These transaction modes affect all subsequent
+transactions of that connection. </p>
+
+<p>Thanks to Halmai Csongor for suggestion. </p>
+
+<p>Removed $off = $fieldOffset - 1 line in db2 driver, FetchField(). Tx Larry
+Menard. </p>
+
+<p>Added support for PHP5 objects as Execute() bind parameters using __toString
+(eg. Simple-XML). Thx Carl-Christian Salvesen. </p>
+
+<p>Rounding in tohtml.inc.php did not work properly. Fixed. </p>
+
+<p>MetaIndexes in postgres fails when fields are deleted then added in again
+because the attnum has gaps in it. See
+http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1451245&amp;group_id=42718&amp;atid=433976.
+Fixed. </p>
+
+<p>MetaForeignkeys in mysql and mysqli did not work when
+fetchMode==ADODB_FETCH_ASSOC used. Fixed. </p>
+
+<p>Reference error in AutoExecute() fixed. </p>
+
+<p>Added macaddr postgres type to MetaType. Maps to 'C'. </p>
+
+<p>Added to _connect() in adodb-ado5.inc.php support for $database and
+$dataProvider parameters. Thx Larry Menard. </p>
+
+<p>Added support for sequences in adodb-ado_mssql.inc.php. Thx Larry Menard. </p>
+
+<p>Added ADODB_SESSION_READONLY. </p>
+
+<p>Added session expiryref support to crc32 mode, and in LOB code. </p>
+
+<p>Clear _errorMsg in postgres7 driver, so that ErrorMsg() displays properly
+when no error occurs. </p>
+
+<p>Added BindDate and BindTimeStamp </p>
+
+<p><a name=4.81></a><b>4.81 3 May 2006</b> </p>
+
+<p>Fixed variable ref errors in adodb-ado5.inc.php in _query(). </p>
+
+<p>Mysqli setcharset fix using method_exists(). </p>
+
+<p>The adodb-perf.inc.php CreateLogTable() code now works for user-defined
+table names. </p>
+
+<p>Error in ibase_blob_open() fixed. See
+http://phplens.com/lens/lensforum/msgs.php?id=14997 </p>
+
+<p><a name=4.80></a><b>4.80 8 Mar 2006</b> </p>
+
+<p>Added activerecord support. </p>
+
+<p>Added mysql $conn-&gt;compat323 = true if you want MySQL 3.23 compat
+enabled. Fixes GetOne() Select-Limit problems. </p>
+
+<p>Added adodb-xmlschema03.inc.php to support XML Schema version 3 and updated
+adodb-datadict.htm docs. </p>
+
+<p>Better memory management in Execute. Thx Mike Fedyk. </p>
+
+<p><a name=4.72></a><b>4.72 21 Feb 2006</b> </p>
+
+<p>Added 'new' DSN parameter for NConnect(). </p>
+
+<p>Pager now sanitizes $PHP_SELF to protect against XSS. Thx to James Bercegay
+and others. </p>
+
+<p>ADOConnection::MetaType changed to setup $rs-&gt;connection correctly. </p>
+
+<p>New native DB2 driver contributed by Larry Menard, Dan Scott, Andy
+Staudacher, Bharat Mediratta. </p>
+
+<p>The mssql CreateSequence() did not BEGIN TRANSACTION correctly. Fixed. Thx
+Sean Lee. </p>
+
+<p>The _adodb_countrecs() function in adodb-lib.inc.php has been revised to
+handle more ORDER BY variations. </p>
+
+<p><a name=4.71></a><b>4.71 24 Jan 2006</b> </p>
+
+<p>Fixes postgresql security issue related to binary strings. Thx to Andy
+Staudacher. </p>
+
+<p>Several DSN bugs found: </p>
+
+<p>1. Fix bugs in DSN connections introduced in 4.70 when underscores are found
+in the DSN. </p>
+
+<p>2. DSN with _ did not work properly in PHP5 (fine in PHP4). Fixed. </p>
+
+<p>3. Added support for PDO DSN connections in NewADOConnection(), and database
+parameter in PDO::Connect(). </p>
+
+<p>The oci8 datetime flag not correctly implemented in ADORecordSet_array.
+Fixed. </p>
+
+<p>Added BlobDelete() to postgres, as a counterpoint to UpdateBlobFile(). </p>
+
+<p>Fixed GetInsertSQL() to support oci8po. </p>
+
+<p>Fixed qstr() issue with postgresql with \0 in strings. </p>
+
+<p>Fixed some datadict driver loading issues in _adodb_getdriver(). </p>
+
+<p>Added register shutdown function session_write_close in
+adodb-session.inc.php for PHP 5 compat. See
+http://phplens.com/lens/lensforum/msgs.php?id=14200. </p>
+
+<p><a name=4.70></a><b>4.70 6 Jan 2006</b> </p>
+
+<p>Many fixes from Danila Ulyanov to ibase, oci8, postgres, mssql, odbc_oracle,
+odbtp, etc drivers. </p>
+
+<p>Changed usage of binary hint in adodb-session.inc.php for mysql. See
+http://phplens.com/lens/lensforum/msgs.php?id=14160 </p>
+
+<p>Fixed invalid variable reference problem in undomq(), adodb-perf.inc.php. </p>
+
+<p>Fixed http://phplens.com/lens/lensforum/msgs.php?id=14254 in
+adodb-perf.inc.php, _DBParameter() settings of fetchmode was wrong. </p>
+
+<p>Fixed security issues in server.php and tmssql.php discussed by Andreas
+Sandblad in a Secunia security advisory. Added $ACCEPTIP = 127.0.0.1 and
+changed suggested root password to something more secure. </p>
+
+<p>Changed pager to close recordset after RenderLayout(). </p>
+
+<p><a name=4.68></a><b>4.68 25 Nov 2005</b> </p>
+
+<p>PHP 5 compat for mysqli. MetaForeignKeys repeated twice and
+MYSQLI_BINARY_FLAG missing. </p>
+
+<p>PHP 5.1 support for postgresql bind parameters using ? did not work if &gt;=
+10 parameters. Fixed. Thx to Stanislav Shramko. </p>
+
+<p>Lots of PDO improvements. </p>
+
+<p>Spelling error fixed in mysql MetaForeignKeys, $associative parameter. </p>
+
+<p><a name=4.67></a><b>4.67 16 Nov 2005</b> </p>
+
+<p>Postgresql not_null flag not set to false correctly. Thx Cristian MARIN. </p>
+
 <p>We now check in Replace() if key is in fieldArray. Thx Sbastien Vanvelthem.
-<p>_file_get_contents() function was missing in xmlschema. fixed.
-<p>Added week in year support to SQLDate(), using 'W' flag. Thx Spider.
-<p>In sqlite metacolumns was repeated twice, causing PHP 5 problems. Fixed.
-<p>Made debug output XHTML compliant. 
-<p><a name="4.66"></a><b>4.66 28 Sept  2005</b>
-<p>ExecuteCursor() in oci8 did not clean up properly on failure. Fixed.
-<p>Updated xmlschema.dtd, by "Alec Smecher" asmecher#smecher.bc.ca
-<p>Hardened SelectLimit, typecasting nrows and offset to integer.
-<p>Fixed misc bugs in AutoExecute() and GetInsertSQL().
-<p>Added $conn->database as the property holding the database name. The older $conn->databaseName is retained for backward
-compat.
-<p>Changed _adodb_backtrace() compat check to use function_exists().
-<p>Bug in postgresql MetaIndexes fixed. Thx Kevin Jamieson. 
-<p>Improved OffsetDate for MySQL, reducing rounding error.
-<p>Metacolumns added to sqlite. Thx Mark Newnham.
-<p>PHP 4.4 compat fixes for GetAssoc().
-<p>Added postgresql bind support for php 5.1. Thx Cristiano da Cunha Duarte
+</p>
+
+<p>_file_get_contents() function was missing in xmlschema. fixed. </p>
+
+<p>Added week in year support to SQLDate(), using 'W' flag. Thx Spider. </p>
+
+<p>In sqlite metacolumns was repeated twice, causing PHP 5 problems. Fixed. </p>
+
+<p>Made debug output XHTML compliant. </p>
+
+<p><a name=4.66></a><b>4.66 28 Sept 2005</b> </p>
+
+<p>ExecuteCursor() in oci8 did not clean up properly on failure. Fixed. </p>
+
+<p>Updated xmlschema.dtd, by &quot;Alec Smecher&quot; asmecher#smecher.bc.ca </p>
+
+<p>Hardened SelectLimit, typecasting nrows and offset to integer. </p>
+
+<p>Fixed misc bugs in AutoExecute() and GetInsertSQL(). </p>
+
+<p>Added $conn-&gt;database as the property holding the database name. The
+older $conn-&gt;databaseName is retained for backward compat. </p>
+
+<p>Changed _adodb_backtrace() compat check to use function_exists(). </p>
+
+<p>Bug in postgresql MetaIndexes fixed. Thx Kevin Jamieson. </p>
+
+<p>Improved OffsetDate for MySQL, reducing rounding error. </p>
+
+<p>Metacolumns added to sqlite. Thx Mark Newnham. </p>
+
+<p>PHP 4.4 compat fixes for GetAssoc(). </p>
+
+<p>Added postgresql bind support for php 5.1. Thx Cristiano da Cunha Duarte </p>
+
 <p>OffsetDate() fixes for postgresql, typecasting strings to date or timestamp.
-<p>DBTimeStamp formats for mssql, odbc_mssql and postgresql made to conform with other db's.
-<p>Changed PDO constants from PDO_ to PDO:: to support latest spec.
-<p><a name="4.65"></a><b>4.65 22 July  2005</b>
-<p>Reverted 'X' in mssql datadict to 'TEXT' to be compat with mssql driver. However now you can 
-set $datadict->typeX = 'varchar(4000)' or 'TEXT' or 'CLOB' for mssql and oci8 drivers. 
-<p>Added charset support when using DSN for Oracle.
-<p>_adodb_getmenu did not use fieldcount() to get number of fields. Fixed.
-<p>MetaForeignKeys() for mysql/mysqli contributed by Juan Carlos Gonzalez.
-<p>MetaDatabases() now correctly returns an array for mysqli driver. Thx Cristian MARIN.
-<p>CompleteTrans(false) did not return false. Fixed. Thx to JMF.
-<p>AutoExecute() did not work with Oracle. Fixed. Thx Jos Moreira.
-<p>MetaType() added to connection object.
-<p>More PHP 4.4 reference return fixes. Thx Ryan C Bonham and others.
-
-<p><a name="4.64"></a><b>4.64 20 June 2005</b>
-<p>In datadict, if the default field value is set to '', then it is not applied when the field is created. Fixed by Eugenio.
-<p>MetaPrimaryKeys for postgres did not work because of true/false change in 4.63. Fixed.
-<p>Tested ocifetchstatement in oci8. Rejected at the end.
-<p>Added port to dsn handling. Supported in postgres, mysql, mysqli,ldap.
-<p>Added  'w' and 'l' to mysqli SQLDate().
-<p>Fixed error handling in ldap _connect() to be more consistent. Also added ErrorMsg() handling to ldap.
-<p>Added support for union in _adodb_getcount, adodb-lib.inc.php for postgres and oci8.
-<p>rs2html() did not work with null dates properly.
-<p>PHP 4.4 reference return fixes.
-
-<p><a name="4.63"></a><b>4.63  18 May 2005</b>
+</p>
+
+<p>DBTimeStamp formats for mssql, odbc_mssql and postgresql made to conform
+with other db's. </p>
+
+<p>Changed PDO constants from PDO_ to PDO:: to support latest spec. </p>
+
+<p><a name=4.65></a><b>4.65 22 July 2005</b> </p>
+
+<p>Reverted 'X' in mssql datadict to 'TEXT' to be compat with mssql driver.
+However now you can set $datadict-&gt;typeX = 'varchar(4000)' or 'TEXT' or
+'CLOB' for mssql and oci8 drivers. </p>
+
+<p>Added charset support when using DSN for Oracle. </p>
+
+<p>_adodb_getmenu did not use fieldcount() to get number of fields. Fixed. </p>
+
+<p>MetaForeignKeys() for mysql/mysqli contributed by Juan Carlos Gonzalez. </p>
+
+<p>MetaDatabases() now correctly returns an array for mysqli driver. Thx
+Cristian MARIN. </p>
+
+<p>CompleteTrans(false) did not return false. Fixed. Thx to JMF. </p>
+
+<p>AutoExecute() did not work with Oracle. Fixed. Thx Jos Moreira. </p>
+
+<p>MetaType() added to connection object. </p>
+
+<p>More PHP 4.4 reference return fixes. Thx Ryan C Bonham and others. </p>
+
+<p><a name=4.64></a><b>4.64 20 June 2005</b> </p>
+
+<p>In datadict, if the default field value is set to '', then it is not applied
+when the field is created. Fixed by Eugenio. </p>
+
+<p>MetaPrimaryKeys for postgres did not work because of true/false change in
+4.63. Fixed. </p>
+
+<p>Tested ocifetchstatement in oci8. Rejected at the end. </p>
+
+<p>Added port to dsn handling. Supported in postgres, mysql, mysqli,ldap. </p>
+
+<p>Added 'w' and 'l' to mysqli SQLDate(). </p>
+
+<p>Fixed error handling in ldap _connect() to be more consistent. Also added
+ErrorMsg() handling to ldap. </p>
+
+<p>Added support for union in _adodb_getcount, adodb-lib.inc.php for postgres
+and oci8. </p>
+
+<p>rs2html() did not work with null dates properly. </p>
+
+<p>PHP 4.4 reference return fixes. </p>
+
+<p><a name=4.63></a><b>4.63 18 May 2005</b> </p>
+
 <p>Added $nrows<0 check to mysqli's SelectLimit().
 <p>Added OptimizeTable() and OptimizeTables() in adodb-perf.inc.php. By Markus Staab.
 <p>PostgreSQL inconsistencies fixed. true and false set to TRUE and FALSE, and boolean type in datadict-postgres.inc.php set
@@ -3207,426 +6908,860 @@ to 'L' => 'BOOLEAN'. Thx Kevin Jamieson.
 <p>Added null check to UserTimeStamp().
 <p>Fixed typo in mysqlt driver in adorecordset. Thx to Andy Staudacher.
 <p>GenID() had a bug in the raiseErrorFn handling. Fixed. Thx Marcos Pont.
-<p>Datadict name quoting now handles ( ) in index fields correctly - they aren't part of the index field.
-<p>Performance monitoring: (1) oci8 Ixora checks moved down; (2) expensive sql changed so that only those sql with 
-count(*)>1 are shown; (3) changed sql1 field to a length+crc32 checksum - this breaks backward compat.
-<p>We remap firebird15 to firebird in data dictionary.
-
-<p><a name="4.62"></a><b>4.62  2 Apr 2005</b>
-<p>Added 'w' (dow as 0-6 or 1-7) and 'l' (dow as string) for SQLDate for oci8, postgres and mysql.
-<p>Rolled back MetaType() changes for mysqli done in prev version.
-<p>Datadict change by chris, cblin#tennaxia.com data mappings from:
-<pre>
-oci8:  X->varchar(4000) XL->CLOB
-mssql: X->XL->TEXT
-mysql: X->XL->LONGTEXT
-fbird: X->XL->varchar(4000)
-</pre>
-<p>to:
-<pre>
-oci8:  X->varchar(4000) XL->CLOB
-mssql: X->VARCHAR(4000) XL->TEXT
-mysql: X->TEXT          XL->LONGTEXT
-fbird: X->VARCHAR(4000) XL->VARCHAR(32000)
-</pre>
-<p>Added $connection->disableBlobs to postgresql to improve performance when no bytea is used (2-5% improvement).
-<p>Removed all HTTP_* vars.
-<p>Added $rs->tableName to be set before calling AutoExecute().
-<p>Alex Rootoff rootoff#pisem.net contributed ukrainian language file.
-<p>Added new mysql_option() support using $conn->optionFlags array.
-<p>Added support for ldap_set_option() using the $LDAP_CONNECT_OPTIONS global variable. Contributed by Josh Eldridge.
-<p>Added LDAP_* constant definitions to ldap.
-<p>Added support for boolean bind variables. We use $conn->false and $conn->true to hold values to set false/true to.
-<p>We now do not close the session connection in adodb-session.inc.php as other objects could be using this connection.
-<p>We now strip off \0 at end of Ixora SQL strings in $perf->tohtml() for oci8.
-<p><a name="4.61"></a><b>4.61 23 Feb 2005</b>
-<p>MySQLi added support for mysqli_connect_errno() and mysqli_connect_error().
-<p>Massive improvements to alpha PDO driver.
-<p>Quote string bind parameters logged by performance monitor for easy type checking. Thx Jason Judge.
-<p>Added support for $role when connecting with Interbase/firebird.
-<p>Added support for enum recognition in MetaColumns() mysql and mysqli. Thx Amedeo Petrella.
-<p>The sybase_ase driver contributed by Interakt Online. Thx Cristian Marin cristic#interaktonline.com.
-<p>Removed not_null, has_default, and default_value from ADOFieldObject.
-<p>Sessions code, fixed quoting of keys when handling LOBs in session write() function.
-<p>Sessions code, added adodb_session_regenerate_id(), to reduce risk of session hijacking by changing session cookie dynamically. Thx Joe Li.
-<p>Perf monitor, polling for CPU did not work for PHP 4.3.10 and 5.0.0-5.0.3 due to PHP bugs, so we special case these versions.
-<p>Postgresql, UpdateBlob() added code to handle type==CLOB.
-<p><a name="4.60"></a><b>4.60 24 Jan 2005</b>
-<p>Implemented PEAR DB's autoExecute(). Simplified design because I don't like using constants when
-strings work fine.
-<p>_rs2serialize will now update $rs->sql and $rs->oldProvider.
-<p>Added autoExecute().
-<p>Added support for postgres8 driver. Currently just remapped to postgres7 driver.
-<p>Changed oci8 _query(), so that OCIBindByName() sets the length to -1 if element size is > 4000. This provides better support
-for LONGs.
-<p>Added SetDateLocale() support for netherlands (Nl).
-<p>Spelling error in pivot code ($iff should be $iif).
-</p><p>mysql insert_id() did not work with mysql 3.x. Fixed.
-</p><p>"\r\n" not converted to spaces correctly in exporting data. Fixed.
-</p><p>_nconnect() in mysqli did not return value correctly. Fixed.
-</p><p>Arne Eckmann contributed danish language file.
-</p><p>Added clone() support to FetchObject() for PHP5.<br>
+<p>Datadict name quoting now handles ( ) in index fields correctly - they aren't part of the index field. ></p>
+
+<p>Performance monitoring: (1) oci8 Ixora checks moved down; (2) expensive sql
+changed so that only those sql with count(*)&gt;1 are shown; (3) changed sql1
+field to a length+crc32 checksum - this breaks backward compat. </p>
+
+<p>We remap firebird15 to firebird in data dictionary. </p>
+
+<p><a name=4.62></a><b>4.62 2 Apr 2005</b> </p>
+
+<p>Added 'w' (dow as 0-6 or 1-7) and 'l' (dow as string) for SQLDate for oci8,
+postgres and mysql. </p>
+
+<p>Rolled back MetaType() changes for mysqli done in prev version. </p>
+
+<p>Datadict change by chris, cblin#tennaxia.com data mappings from: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>oci8:<span style='mso-spacerun:yes'> </span>X-&gt;varchar(4000) XL-&gt;CLOB</pre><pre>mssql: X-&gt;XL-&gt;TEXT</pre><pre>mysql: X-&gt;XL-&gt;LONGTEXT</pre><pre>fbird: X-&gt;XL-&gt;varchar(4000)</pre></div>
+
+<p>to: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre><o:p>&nbsp;</o:p></pre><pre>oci8:<span style='mso-spacerun:yes'> </span>X-&gt;varchar(4000) XL-&gt;CLOB</pre><pre>mssql: X-&gt;VARCHAR(4000) XL-&gt;TEXT</pre><pre>mysql: X-&gt;TEXT<span style='mso-spacerun:yes'> </span>XL-&gt;LONGTEXT</pre><pre>fbird: X-&gt;VARCHAR(4000) XL-&gt;VARCHAR(32000)</pre></div>
+
+<p>Added $connection-&gt;disableBlobs to postgresql to improve performance when
+no bytea is used (2-5% improvement). </p>
+
+<p>Removed all HTTP_* vars. </p>
+
+<p>Added $rs-&gt;tableName to be set before calling AutoExecute(). </p>
+
+<p>Alex Rootoff rootoff#pisem.net contributed ukrainian language file. </p>
+
+<p>Added new mysql_option() support using $conn-&gt;optionFlags array. </p>
+
+<p>Added support for ldap_set_option() using the $LDAP_CONNECT_OPTIONS global
+variable. Contributed by Josh Eldridge. </p>
+
+<p>Added LDAP_* constant definitions to ldap. </p>
+
+<p>Added support for boolean bind variables. We use $conn-&gt;false and
+$conn-&gt;true to hold values to set false/true to. </p>
+
+<p>We now do not close the session connection in adodb-session.inc.php as other
+objects could be using this connection. </p>
+
+<p>We now strip off \0 at end of Ixora SQL strings in $perf-&gt;tohtml() for
+oci8. </p>
+
+<p><a name=4.61></a><b>4.61 23 Feb 2005</b> </p>
+
+<p>MySQLi added support for mysqli_connect_errno() and mysqli_connect_error(). </p>
+
+<p>Massive improvements to alpha PDO driver. </p>
+
+<p>Quote string bind parameters logged by performance monitor for easy type
+checking. Thx Jason Judge. </p>
+
+<p>Added support for $role when connecting with Interbase/firebird. </p>
+
+<p>Added support for enum recognition in MetaColumns() mysql and mysqli. Thx
+Amedeo Petrella. </p>
+
+<p>The sybase_ase driver contributed by Interakt Online. Thx Cristian Marin
+cristic#interaktonline.com. </p>
+
+<p>Removed not_null, has_default, and default_value from ADOFieldObject. </p>
+
+<p>Sessions code, fixed quoting of keys when handling LOBs in session write()
+function. </p>
+
+<p>Sessions code, added adodb_session_regenerate_id(), to reduce risk of
+session hijacking by changing session cookie dynamically. Thx Joe Li. </p>
+
+<p>Perf monitor, polling for CPU did not work for PHP 4.3.10 and 5.0.0-5.0.3
+due to PHP bugs, so we special case these versions. </p>
+
+<p>Postgresql, UpdateBlob() added code to handle type==CLOB. </p>
+
+<p><a name=4.60></a><b>4.60 24 Jan 2005</b> </p>
+
+<p>Implemented PEAR DB's autoExecute(). Simplified design because I don't like
+using constants when strings work fine. </p>
+
+<p>_rs2serialize will now update $rs-&gt;sql and $rs-&gt;oldProvider. </p>
+
+<p>Added autoExecute(). </p>
+
+<p>Added support for postgres8 driver. Currently just remapped to postgres7
+driver. </p>
+
+<p>Changed oci8 _query(), so that OCIBindByName() sets the length to -1 if
+element size is &gt; 4000. This provides better support for LONGs. </p>
+
+<p>Added SetDateLocale() support for <st1:country-region w:st="on"><st1:place
+ w:st="on">netherlands</st1:place></st1:country-region> (Nl). </p>
+
+<p>Spelling error in pivot code ($iff should be $iif). </p>
+
+<p>mysql insert_id() did not work with mysql 3.x. Fixed. </p>
+
+<p>&quot;\r\n&quot; not converted to spaces correctly in exporting data. Fixed.
 </p>
-<p>Removed SQL_CUR_USE_ODBC from odbc_mssql.<br>
+
+<p>_nconnect() in mysqli did not return value correctly. Fixed. </p>
+
+<p>Arne Eckmann contributed danish language file. </p>
+
+<p>Added clone() support to FetchObject() for PHP5.</p>
+
+<p>Removed SQL_CUR_USE_ODBC from odbc_mssql.</p>
+
+<p><a name=4.55></a><b>4.55 5 Jan 2005</b> </p>
+
+<p>Found bug in Execute() with bind params for db's that do not support binding
+natively. </p>
+
+<p>DropSequence() now correctly uses default parameter. </p>
+
+<p>Now Execute() ignores locale for floats, so 1.23 is NEVER converted to 1,23.
 </p>
-<p><a name="4.55"></a><b>4.55 5 Jan 2005</b>
-</p><p>Found bug in Execute() with bind params for db's that do not support binding natively.
-</p><p>DropSequence() now correctly uses default parameter.
-</p><p>Now Execute() ignores locale for floats, so 1.23 is NEVER converted to 1,23.
-</p><p>SetFetchMode() not properly saved in adodb-perf, suspicious sql and expensive sql. Fixed.
-</p><p>Added INET to postgresql metatypes. Thx motzel.
-</p><p>Allow oracle hints to work when counting with _adodb_getcount in adodb-lib.inc.php. Thx Chris Wrye.
-</p><p>Changed mysql insert_id() to use SELECT LAST_INSERT_ID().
-</p><p>If alter col in datadict does not modify col type/size of actual
-col, then it is removed from alter col code. By Mark Newham. Not
-perfect as MetaType() !== ActualType().
-</p><p>Added handling of view fields in metacolumns() for postgresql. Thx Renato De Giovanni.
-</p><p>Added to informix MetaPrimaryKeys and MetaColumns fixes for null bit. Thx to Cecilio Albero.
-</p><p>Removed obsolete connection_timeout() from perf code.
-</p><p>Added support for arrayClass in adodb-csv.inc.php.
-</p><p>RSFilter now accepts methods of the form $array($obj, 'methodname'). Thx to blake#near-time.com.
-</p><p>Changed CacheFlush to $cmd = 'rm -rf '.$ADODB_CACHE_DIR.'/[0-9a-f][0-9a-f]/'; 
-</p><p>For better cursor concurrency, added code to free ref cursors in
-oci8 when $rs-&gt;Close() is called. Note that CLose() is called
-internally by the Get* functions too.
-</p><p>Added IIF support for access when pivoting.  Thx Volodia Krupach.
-</p><p>Added mssql datadict support for timestamp. Thx Alexios.
-</p><p>Informix pager fix. By Mario Ramirez.
-</p><p>ADODB_TABLE_REGEX now includes ':'. By Mario Ramirez.
-</p><p>Mark Newnham contributed MetaIndexes for oci8 and db2.
-</p><p><a name="4.54"></a><b>4.54 5 Nov 2004</b>
-</p><p>
-Now you can set $db-&gt;charSet = ?? before doing a Connect() in oci8.
-</p><p>
-Added adodbFetchMode to sqlite.
-</p><p>
-Perf code, added a string typecast to substr in adodb_log_sql().
-</p><p>
-Postgres: Changed BlobDecode() to use po_loread, added new $maxblobsize parameter, and now it returns the blob instead
-of sending it to stdout - make sure to mention that as a compat warning.
-Also added $db-&gt;IsOID($oid) function; uses a heuristic, not guaranteed to work 100%.
-</p><p>
-Contributed arabic language file by "El-Shamaa, Khaled" k.el-shamaa#cgiar.org
-</p><p>
-PHP5 exceptions did not handle @ protocol properly. Fixed.
-</p><p>
-Added ifnull handling for postgresql (using coalesce).
-</p><p>
-Added  metatables() support for Postgresql 8.0 (no longer uses pg_% dictionary tables).
-</p><p>
-Improved Sybase ErrorMsg() function. By Gaetano Giunta.
-</p><p>
-Improved oci8 SelectLimit() to use Prepare(). By Cristiano Duarte.
-</p><p>
-Type-cast $row parameter in ifx_fetch_row() to int. Thx stefan bodgan.
-</p><p>Ralf becker contributed improvements in postgresql, sapdb, mysql data dictionary handling:<br>
-- MySql and Postgres MetaType was reporting every int column which was 
-part of a primary key and unique as serial<br>
+
+<p>SetFetchMode() not properly saved in adodb-perf, suspicious sql and
+expensive sql. Fixed. </p>
+
+<p>Added INET to postgresql metatypes. Thx motzel. </p>
+
+<p>Allow oracle hints to work when counting with _adodb_getcount in
+adodb-lib.inc.php. Thx Chris Wrye. </p>
+
+<p>Changed mysql insert_id() to use SELECT LAST_INSERT_ID(). </p>
+
+<p>If alter col in datadict does not modify col type/size of actual col, then
+it is removed from alter col code. By Mark Newham. Not perfect as MetaType()
+!== ActualType(). </p>
+
+<p>Added handling of view fields in metacolumns() for postgresql. Thx Renato De
+Giovanni. </p>
+
+<p>Added to informix MetaPrimaryKeys and MetaColumns fixes for null bit. Thx to
+Cecilio Albero. </p>
+
+<p>Removed obsolete connection_timeout() from perf code. </p>
+
+<p>Added support for arrayClass in adodb-csv.inc.php. </p>
+
+<p>RSFilter now accepts methods of the form $array($obj, 'methodname'). Thx to
+blake#near-time.com. </p>
+
+<p>Changed CacheFlush to $cmd = 'rm -rf
+'.$ADODB_CACHE_DIR.'/[0-9a-f][0-9a-f]/'; </p>
+
+<p>For better cursor concurrency, added code to free ref cursors in oci8 when
+$rs-&gt;Close() is called. Note that CLose() is called internally by the Get*
+functions too. </p>
+
+<p>Added IIF support for access when pivoting. Thx Volodia Krupach. </p>
+
+<p>Added mssql datadict support for timestamp. Thx Alexios. </p>
+
+<p>Informix pager fix. By Mario Ramirez. </p>
+
+<p>ADODB_TABLE_REGEX now includes ':'. By Mario Ramirez. </p>
+
+<p>Mark Newnham contributed MetaIndexes for oci8 and db2. </p>
+
+<p><a name=4.54></a><b>4.54 5 Nov 2004</b> </p>
+
+<p>Now you can set $db-&gt;charSet = ?? before doing a Connect() in oci8. </p>
+
+<p>Added adodbFetchMode to sqlite. </p>
+
+<p>Perf code, added a string typecast to substr in adodb_log_sql(). </p>
+
+<p>Postgres: Changed BlobDecode() to use po_loread, added new $maxblobsize
+parameter, and now it returns the blob instead of sending it to stdout - make
+sure to mention that as a compat warning. Also added $db-&gt;IsOID($oid)
+function; uses a heuristic, not guaranteed to work 100%. </p>
+
+<p>Contributed arabic language file by &quot;El-Shamaa, Khaled&quot;
+k.el-shamaa#cgiar.org </p>
+
+<p>PHP5 exceptions did not handle @ protocol properly. Fixed. </p>
+
+<p>Added ifnull handling for postgresql (using coalesce). </p>
+
+<p>Added metatables() support for Postgresql 8.0 (no longer uses pg_%
+dictionary tables). </p>
+
+<p>Improved Sybase ErrorMsg() function. By Gaetano Giunta. </p>
+
+<p>Improved oci8 SelectLimit() to use Prepare(). By Cristiano Duarte. </p>
+
+<p>Type-cast $row parameter in ifx_fetch_row() to int. Thx stefan bodgan. </p>
+
+<p>Ralf becker contributed improvements in postgresql, sapdb, mysql data
+dictionary handling:<br>
+- MySql and Postgres MetaType was reporting every int column which was part of
+a primary key and unique as serial<br>
 - Postgres was not reporting the scale of decimal types<br>
 - MaxDB was padding the defaults of none-string types with spaces<br>
-- MySql now correctly converts enum columns to varchar
-</p><p>
-Ralf also changed Postgresql datadict:<br>
-- you cant add NOT NULL columns in postgres in one go, they need to be 
-added as NULL and then altered to NOT NULL<br>
-- AlterColumnSQL could not change a varchar column with numbers into an 
-integer column, postgres need an explicit conversation<br>
-- a re-created sequence was not set to the correct value, if the name 
-was the old name (no implicit sequence), now always the new name of the 
-implicit sequence is used<br>
-</p><p>Sergio Strampelli added extra $intoken check to Lens_ParseArgs() in datadict code.
-</p><p><a name="4.53"></a><b>4.53 28 Sept 2004</b>
-</p><p>FetchMode cached in recordset is sometimes mapped to native db fetchMode. Normally this does not matter,
-but when using cached recordsets, we need to switch back to using adodb fetchmode.  So we cache this
-in $rs-&gt;adodbFetchMode if it differs from the db's fetchMode.
-</p><p>For informix we now set canSeek = false driver because stefan bodgan tells me that seeking doesn't work. 
-</p><p>SetDateLocale() never worked till now ;-) Thx david#tomato.it
-</p><p>Set $_bindInputArray = true in sapdb driver. Required for clob support.
-</p><p>Fixed some PEAR::DB emulation issues with isError() and isWarning. Thx to Gert-Rainer Bitterlich.
-</p><p>Empty() used in getupdatesql without strlen() check. Fixed.</p>
-<p>Added unsigned detection to mysql and mysqli drivers. Thx to dan cech.
-</p><p>Added hungarian language file. Thx to Hal&aacute;szv&aacute;ri G&aacute;bor.
-</p><p>Improved fieldname-type formatting of datadict SQL generated (adding $widespacing parameter to _GenField).
-</p><p>Datadict oci8 DROP CONSTRAINTS misspelt. Fixed. Thx Mark Newnham.
-</p><p>Changed odbtp to dynamically change databaseType based on connection, eg. from 'odbtp' to 'odbtp_mssql' when connecting
-to mssql database.
-</p><p>In datadict, MySQL I4 was wrongly mapped to MEDIUMINT, which is actually I3. Fixed.
-</p><p>Fixed mysqli MetaType() recognition. Mysqli returns numeric types unlike mysql extension. Thx Francesco Riosa.
-</p><p>VFP odbc driver curmode set wrongly, causing problems with memo fields. Fixed.
-</p><p>Odbc driver did not recognize odbc version 2 driver date types properly. Fixed. Thx Bostjan.
-</p><p>ChangeTableSQL() fixes to datadict-db2.inc.php by Mark Newnham.
-</p><p>Perf monitoring with odbc improved. Now we try in perf code to manually set the sysTimeStamp using date() if sysTimeStamp
-is empty.
-</p><p>All ADO errors are thrown as exceptions in PHP5. 
-So we added exception handling to ado in PHP5 by creating new adodb-ado5.inc.php driver.
-</p><p>Added IsConnected(). Returns true if connection object connected. By Luca.Gioppo.
-</p><p>"Ralf Becker"
-RalfBecker#digitalROCK.de contributed new sapdb data-dictionary driver
-and a large patch that implements field and table renaming for oracle,
-mssql, postgresql, mysql and sapdb. See the new RenameTableSQL() and
-RenameColumnSQL() functions.
-</p><p>We now check ExecuteCursor to see if PrepareSP was initially called.
-</p><p>Changed oci8 datadict to use MODIFY for $dd-&gt;alterCol. Thx Mark Newnham.
-</p><p><a name="4.52"></a><b>4.52  10 Aug 2004</b>
-</p><p>Bug found in Replace() when performance logging enabled, introduced in ADOdb 4.50. Fixed.
-</p><p>Replace() checks update stmt. If update stmt fails, we now return immediately. Thx to alex.
-</p><p>Added support for $ADODB_FORCE_TYPE in GetUpdateSQL/GetInsertSQL. Thx to niko.
-</p><p>Added ADODB_ASSOC_CASE support to postgres/postgres7 driver.
-</p><p>Support for DECLARE stmt in oci8. Thx Lochbrunner.
-</p><p><a name="4.51"></a><b>4.51  29 July  2004</b>
-</p><p>Added adodb-xmlschema 1.0.2. Thx dan and richard.
-</p><p>Added new adorecordset_ext_* classes. If ADOdb extension installed for mysql, mysqlt and oci8 
-(but not oci8po),  we use the superfast ADOdb extension code for movenext.
-</p><p>Added schema support to mssql and odbc_mssql MetaPrimaryKeys().
-</p><p>Patched MSSQL driver to support PHP NULL and Boolean values 
-while binding the input array parameters in the _query() function. By Stephen Farmer.
-</p><p>Added support for clob's for mssql,  UpdateBlob(). Thx to gfran#directa.com.br
-</p><p>Added normalize support for postgresql (true=lowercase table name, or false=case-sensitive table names) 
-to MetaColumns($table, $normalize=true).
-</p><p>PHP5 variant dates in ADO not working. Fixed in adodb-ado.inc.php.
-</p><p>Constant ADODB_FORCE_NULLS was not working properly for many releases (for GetUpdateSQL). Fixed. 
-Also GetUpdateSQL strips off ORDER BY now - thx Elieser Le&atilde;o.
-</p><p>Perf Monitor for oci8 now dynamically highlights optimizer_* params if too high/low.
-</p><p>Added dsn support to NewADOConnection/ADONewConnection.
-</p><p>Fixed out of page bounds bug in _adodb_pageexecute_all_rows() Thx to "Sergio Strampelli" sergio#rir.it
-</p><p>Speedup of movenext for mysql and oci8 drivers.
-</p><p>Moved debugging code _adodb_debug_execute() to adodb-lib.inc.php.
-</p><p>Fixed postgresql bytea detection bug. See http://phplens.com/lens/lensforum/msgs.php?id=9849.
-</p><p>Fixed ibase datetimestamp typo in PHP5. Thx stefan.
-</p><p>Removed whitespace at end of odbtp drivers.
-</p><p>Added db2 metaprimarykeys fix.
-</p><p>Optimizations to MoveNext() for mysql and oci8. Misc speedups to Get* functions.
-</p><p><a name="4.50"></a><b>4.50  6 July  2004</b>
-</p><p>Bumped it to 4.50 to avoid confusion with PHP 4.3.x series.
-</p><p>Added db2 metatables and metacolumns extensions.
-</p><p>Added alpha PDO driver. Very buggy, only works with odbc.
-</p><p>Tested mysqli. Set poorAffectedRows = true. Cleaned up movenext() and _fetch().
-</p><p>PageExecute does not work properly with php5 (return val not a variable). Reported Dmytro Sychevsky sych#php.com.ua.  Fixed.
-</p><p>MetaTables() for mysql, $showschema parameter was not backward compatible with older versions of adodb. Fixed.
-</p><p>Changed mysql GetOne() to work with mysql 3.23 when using with non-select stmts (e.g. SHOW TABLES).
-</p><p>Changed TRIG_ prefix to a variable in datadict-oci8.inc.php. Thx to Luca.Gioppo#csi.it.
-</p><p>New to adodb-time code. We allow you to define your own daylights savings function, 
-adodb_daylight_sv for pre-1970 dates. If the function is defined 
-(somewhere in an include), then you can correct 
-for daylights savings. See http://phplens.com/phpeverywhere/node/view/16#daylightsavings
-for more info.
-</p><p>New sqlitepo driver. This is because assoc mode does not work like other drivers in sqlite.
-   Namely, when selecting (joining) multiple tables, in assoc mode the table
-   	  names are included in the assoc keys in the "sqlite" driver.
-	  In "sqlitepo" driver, the table names are stripped from the returned column names. 
-	  When this results in a conflict,  the first field get preference.
-	Contributed by Herman Kuiper  herman#ozuzo.net  
-</p><p>Added $forcenull parameter to GetInsertSQL/GetUpdateSQL. Idea by Marco Aurelio Silva.
-</p><p>More XHTML changes for GetMenu. By Jeremy Evans.
-</p><p>Fixes some ibase date issues. Thx to stefan bogdan.
-</p><p>Improvements to mysqli driver to support $ADODB_COUNTRECS.
-</p><p>Fixed adodb-csvlib.inc.php problem when reading stream from socket. We need to poll stream continiously.
-</p><p><a name="4.23"></a><b>4.23  16 June   2004</b>
-</p><p>
-New interbase/firebird fixes thx to Lester Caine.
-Driver fixes a problem with getting field names in the result array, and 
-corrects a couple of data conversions. Also we default to dialect3 for firebird.
-Also ibase sysDate property was wrong. Changed to cast as timestamp.
-</p><p>
-The datadict driver is set up to give quoted tables and fields as this 
-was the only way round reserved words being used as field names in 
-TikiWiki. TikiPro is tidying that up, and I hope to be able to produce a 
-build of THAT which uses what I consider proper UPPERCASE field and 
-table names. The conversion of TikiWiki to ADOdb helped in that, but 
-until the database is completely tidied up in TikiPro ...
-</p><p>Modified _gencachename() to include fetchmode in name hash.
-This means you should clear your cache directory after installing this release as the 
-cache name algorithm has changed.
-</p><p>Now Cache* functions work in safe
-mode, because we do not create sub-directories in the $ADODB_CACHE_DIR
-in safe mode. In non-safe mode we still create sub-directories. Done by
-modifying _gencachename().
-</p><p>Added $gmt parameter (true/false)
-to UserDate and UserTimeStamp in connection class, to force conversion
-of input (in local time) to be converted to UTC/GMT.
-</p><p>Mssql datadict did not support INT types properly (no size param allowed). 
-Added _GetSize() to datadict-mssql.inc.php.
-</p><p>For borland_ibase, BeginTrans(), changed:<br>
-</p><pre>   $this-&gt;_transactionID = $this-&gt;_connectionID;</pre>
-to<br>
-<pre>   $this-&gt;_transactionID = ibase_trans($this-&gt;ibasetrans, $this-&gt;_connectionID);</pre>
-		
-<p>Fixed typo in mysqi_field_seek(). Thx to Sh4dow (sh4dow#php.pl).
-</p><p>LogSQL did not work with Firebird/Interbase. Fixed.
-</p><p>Postgres: made errorno() handling more consistent. Thx to Michael Jahn, Michael.Jahn#mailbox.tu-dresden.de.
-</p><p>Added informix patch to better support metatables, metacolumns by "Cecilio Albero" c-albero#eos-i.com
-</p><p>Cyril Malevanov contributed patch to oci8 to support passing of LOB parameters:
-</p><pre>	$text = 'test test test';<br>	$sql = "declare rs clob; begin :rs := lobinout(:sa0); end;";<br>	$stmt = $conn -&gt; PrepareSP($sql);<br>	$conn -&gt; InParameter($stmt,$text,'sa0', -1, OCI_B_CLOB);<br>	$rs = '';<br>	$conn -&gt; OutParameter($stmt,$rs,'rs', -1, OCI_B_CLOB);<br>	$conn -&gt; Execute($stmt);<br>	echo "return = ".$rs."&lt;br&gt;";<br></pre>
-As he says, the LOBs limitations are:
-<pre> - use OCINewDescriptor before binding<br> - if Param is IN, uses save() before each execute. This is done automatically for you.<br> - if Param is OUT, uses load() after each execute. This is done automatically for you.<br> - when we bind $var as LOB, we create new descriptor and return it as a<br>   Bind Result, so if we want to use OUT parameters, we have to store<br>   somewhere &amp;$var to load() data from LOB to it.<br> - IN OUT params are not working now (should not be a big problem to fix it)<br> - now mass binding not working too (I've wrote about it before)<br></pre>
-<p>Simplified Connect() and PConnect() error handling.
-</p><p>When extension not loaded, Connect() and PConnect() will return null. On connect error, the fns will return false.
-</p><p>CacheGetArray() added to code.
-</p><p>Added Init() to adorecordset_empty().
-</p><p>Changed postgres64 driver, MetaColumns() to not strip off quotes in default value if :: detected (type-casting of default).
-</p><p>Added test: if (!defined('ADODB_DIR')) die(). Useful to prevent hackers from detecting file paths.
-</p><p>Changed metaTablesSQL to ignore Postgres 7.4 information schemas (sql_*).
-</p><p>New polish language file by  Grzegorz Pacan
-</p><p>Added support for UNION in _adodb_getcount().
-</p><p>Added security check for ADODB_DIR to limit path disclosure issues. Requested by postnuke team.
-</p><p>Added better error message support to oracle driver. Thx to Gaetano Giunta.
-</p><p>Added showSchema support to mysql.
-</p><p>Bind in oci8 did not handle $name=false properly. Fixed.
-</p><p>If extension not loaded, Connect(), PConnect(), NConnect() will return null.
-</p><p><b>4.22  15 Apr   2004</b>
-</p><p>Moved docs to own adodb/docs folder.
-</p><p>Fixed session bug when quoting compressed/encrypted data in Replace().
-</p><p>Netezza Driver and LDAP drivers contributed by Josh Eldridge.
-</p><p>GetMenu now uses rtrim() on values instead of trim().
-</p><p>Changed MetaColumnNames to return an associative array, keys being the field names in uppercase.
-</p><p>Suggested fix to adodb-ado.inc.php affected_rows to support PHP5 variants. Thx to Alexios Fakos.
-</p><p>Contributed bulgarian language file by Valentin Sheiretsky valio#valio.eu.org.
-</p><p>Contributed romanian language file by stefan bogdan.
-</p><p>GetInsertSQL now checks for table name (string) in $rs, and will create a recordset for that
-table automatically. Contributed by Walt Boring. Also added OCI_B_BLOB in bind on Walt's request - hope
-it doesn't break anything :-)
-</p><p>Some minor postgres speedups in _initrs().
-</p><p> ChangeTableSQL checks now if MetaColumns returns empty. Thx Jason Judge.
-</p><p>Added ADOConnection::Time(), returns current database time in unix timestamp format, or false.
-</p><p><b>4.21 20 Mar 2004</b>
-</p><p>We no longer in SelectLimit for VFP driver add SELECT TOP X unless an ORDER BY exists.
-</p><p>Pim Koeman contributed dutch language file adodb-nl.inc.php.
-</p><p>Rick Hickerson added CLOB support to db2 datadict.
-</p><p>Added odbtp driver. Thx to "stefan bogdan" sbogdan#rsb.ro.
-</p><p>Changed PrepareSP() 2nd parameter, $cursor, to default to true (formerly false). Fixes oci8 backward
-compat problems with OUT params.
-</p><p>Fixed month calculation error in adodb-time.inc.php. 2102-June-01 appeared as 2102-May-32.
-</p><p>Updated PHP5 RC1 iterator support. API changed, hasMore() renamed to valid().
-</p><p>Changed internal format of serialized cache recordsets. As we store a version number, this should be
-backward compatible.
-</p><p>Error handling when driver file not found was flawed in ADOLoadCode(). Fixed.
-</p><p><b>4.20 27 Feb 2004</b>
-</p><p>Updated to AXMLS 1.01.
-</p><p>MetaForeignKeys for postgres7 modified by Edward Jaramilla, works on pg 7.4.
-</p><p>Now numbers accepts function calls or sequences for GetInsertSQL/GetUpdateSQL numeric fields.
-</p><p>Changed quotes of 'delete from $perf_table' to "". Thx Kehui (webmaster#kehui.net)
-</p><p>Added ServerInfo() for ifx, and putenv trim fix. Thx Fernando Ortiz.
-</p><p>Added addq(), which is analogous to addslashes().
-</p><p>Tested with php5b4. Fix some php5 compat problems with exceptions and sybase.
-</p><p>Carl-Christian Salvesen added patch to mssql _query to support binds greater than 4000 chars.
-</p><p>Mike suggested patch to PHP5 exception handler. $errno must be numeric.
-</p><p>Added double quotes (") to ADODB_TABLE_REGEX.
-</p><p>For oci8, Prepare(...,$cursor),
-$cursor's meaning was accidentally inverted in 4.11. This causes
-problems with ExecuteCursor() too, which calls Prepare() internally.
-Thx to William Lovaton.
-</p><p>Now dateHasTime property in connection object renamed to datetime for consistency. This could break bc.
-</p><p>Csongor Halmai reports that db2 SelectLimit with input array is not working. Fixed..
-</p><p><b>4.11 27 Jan 2004</b>
-</p><p>Csongor Halmai reports db2 binding not working. Reverted back to emulated binding.
-</p><p>Dan Cech modifies datadict code. Adds support for DropIndex. Minor cleanups.
-</p><p>Table misspelt in perf-oci8.inc.php. Changed v$conn_cache_advice to v$db_cache_advice. Reported by Steve W.
-</p><p>UserTimeStamp and DBTimeStamp did not handle YYYYMMDDHHMMSS format properly. Reported by Mike Muir. Fixed.
-</p><p>Changed oci8 Prepare(). Does not auto-allocate OCINewCursor automatically, unless 2nd param is set to true.
-This will break backward compat, if Prepare/Execute is used instead of ExecuteCursor. Reported by Chris Jones.
-</p><p>Added InParameter() and OutParameter(). Wrapper functions to Parameter(), but nicer because they
-are self-documenting.
-</p><p>Added 'R' handling in ActualType() to datadict-mysql.inc.php
-</p><p>Added ADOConnection::SerializableRS($rs). Returns a recordset that can be serialized in a session.
-</p><p>Added "Run SQL" to performance UI().
-</p><p>Misc spelling corrections in adodb-mysqli.inc.php, adodb-oci8.inc.php and datadict-oci8.inc.php, from Heinz Hombergs.
-</p><p>MetaIndexes() for ibase contributed by Heinz Hombergs.
-</p><p><b>4.10 12 Jan 2004</b>
-</p><p>Dan Cech contributed extensive changes to data dictionary to support name quoting (with `), and drop table/index.
-</p><p>Informix added cursorType property. Default remains IFX_SCROLL, but you can change to 0 (non-scrollable cursor) for performance.
-</p><p>Added ADODB_View_PrimaryKeys() for returning view primary keys to MetaPrimaryKeys().
-</p><p>Simplified chinese file, adodb-cn.inc.php from cysoft.
-</p><p>Added check for ctype_alnum in adodb-datadict.inc.php. Thx to Jason Judge.
-</p><p>Added connection parameter to ibase Prepare(). Fix by Daniel Hassan.
-</p><p>Added nameQuote for quoting identifiers and names to connection obj. Requested by Jason Judge. Also the
-data dictionary parser now detects `field name` and generates column names with spaces correctly.
-</p><p>BOOL type not recognised correctly as L. Fixed.
-</p><p>Fixed paths in ADODB_DIR for session files, and back-ported it to 4.05 (15 Dec 2003)
-</p><p>Added Schema to postgresql MetaTables. Thx to col#gear.hu
-</p><p>Empty postgresql recordsets that had blob fields did not set EOF properly. Fixed.
-</p><p>CacheSelectLimit internal parameters to SelectLimit were wrong. Thx to Nio.
-</p><p>Modified adodb_pr() and adodb_backtrace() to support command-line usage (eg. no html).
-</p><p>Fixed some fr and it lang errors. Thx to Gaetano G.
-</p><p>Added contrib directory, with adodb rs to xmlrpc convertor by Gaetano G.
-</p><p>Fixed array recordset bugs when _skiprow1 is true. Thx to Gaetano G.
-</p><p>Fixed pivot table code when count is false.
-</p><p>
-
-</p><p><b>4.05 13 Dec 2003 </b>
-</p><p>Added MetaIndexes to data-dict code - thx to Dan Cech.
-</p><p>Rewritten session code by Ross Smith. Moved code to adodb/session directory.
-</p><p>Added function exists check on connecting to most drivers, so we don't crash with the unknown function error.
-</p><p>Smart Transactions failed with GenID() when it no seq table has been created because the sql
-	statement fails. Fix by Mark Newnham.
-</p><p>Added $db-&gt;length, which holds name of function that returns strlen.
-</p><p>Fixed error handling for bad driver in ADONewConnection - passed too few params to error-handler.
-</p><p>Datadict did not handle types like 16.0 properly in _GetSize. Fixed.
-</p><p>Oci8 driver SelectLimit() bug &amp;= instead of = used. Thx to Swen Th&uuml;mmler.
-</p><p>Jesse Mullan suggested not flushing outp when output buffering enabled. Due to Apache 2.0 bug. Added.
-</p><p>MetaTables/MetaColumns return ref bug with PHP5 fixed in adodb-datadict.inc.php.
-</p><p>New mysqli driver contributed by Arjen de Rijke. Based on adodb 3.40 driver.
-Then jlim added BeginTrans, CommitTrans, RollbackTrans, IfNull, SQLDate. Also fixed return ref bug.
-</p><p>$ADODB_FLUSH added, if true then force flush in debugging outp. Default is false.  In earlier
-versions, outp defaulted to flush, which is not compat with apache 2.0.
-</p><p>Mysql driver's GenID() function did not work when when sql logging is on. Fixed.
-</p><p>$ADODB_SESSION_TBL not declared as global var. Not available if adodb-session.inc.php included in function. Fixed.
-</p><p>The input array not passed to Execute() in _adodb_getcount(). Fixed.
-</p><p><b>4.04 13 Nov 2003 </b>
-</p><p>Switched back to foreach - faster than list-each.
-</p><p>Fixed bug in ado driver - wiping out $this-&gt;fields with date fields.
-</p><p>Performance Monitor, View SQL, Explain Plan did not work if strlen($SQL)&gt;max($_GET length). Fixed.
-</p><p>Performance monitor, oci8 driver added memory sort ratio.
-</p><p>Added random property, returns SQL to generate a floating point number between 0 and 1;
-</p><p><b>4.03 6 Nov 2003 </b>
-</p><p>The path to adodb-php4.inc.php and adodb-iterators.inc.php was not setup properly.
-</p><p>Patched SQLDate in interbase to support hours/mins/secs. Thx to ari kuorikoski.
-</p><p>Force autorollback for pgsql persistent connections - 
-apparently pgsql did not autorollback properly before 4.3.4. See http://bugs.php.net/bug.php?id=25404
-</p><p><b>4.02 5 Nov 2003 </b>
-</p><p>Some errors in adodb_error_pg() fixed. Thx to Styve.
-</p><p>Spurious Insert_ID() error was generated by LogSQL(). Fixed.
-</p><p>Insert_ID was interfering with Affected_Rows() and Replace()  when LogSQL() enabled. Fixed.
-</p><p>More foreach loops optimized with list/each.
-</p><p>Null dates not handled properly in ADO driver (it becomes 31 Dec 1969!).
-</p><p>Heinz Hombergs contributed patches for mysql MetaColumns - adding scale, made
-interbase MetaColumns work with firebird/interbase, and added lang/adodb-de.inc.php.
-</p><p>Added INFORMIXSERVER environment variable.
-</p><p>Added $ADODB_ANSI_PADDING_OFF for interbase/firebird.
-</p><p>PHP 5 beta 2 compat check. Foreach (Iterator) support. Exceptions support.
-</p><p><b>4.01 23 Oct 2003 </b>
-</p><p>Fixed bug in rs2html(), tohtml.inc.php, that generated blank table cells.
-</p><p>Fixed insert_id() incorrectly generated when logsql() enabled.
-</p><p>Modified PostgreSQL _fixblobs to use list/each instead of foreach.
-</p><p>Informix ErrorNo() implemented correctly.
-</p><p>Modified several places to use list/each, including GetRowAssoc().
-</p><p>Added UserTimeStamp() to connection class.
-</p><p>Added $ADODB_ANSI_PADDING_OFF for oci8po.
-</p><p><b>4.00 20 Oct 2003 </b>
-</p><p>Upgraded adodb-xmlschema to 1 Oct 2003 snapshot.
-</p><p>Fix to rs2html warning message. Thx to Filo.
-</p><p>Fix for odbc_mssql/mssql SQLDate(), hours was wrong.
-</p><p>Added MetaColumns and MetaPrimaryKeys for sybase. Thx to Chris Phillipson.
-</p><p>Added autoquoting to datadict for MySQL and PostgreSQL. Suggestion by Karsten Dambekalns  
-</p><p><b>3.94 11 Oct 2003 </b>
-</p><p>Create trigger in datadict-oci8.inc.php did not work, because all cr/lf's must be removed. 
-</p><p>ErrorMsg()/ErrorNo() did not work for many databases when logging enabled. Fixed.
-</p><p>Removed global variable $ADODB_LOGSQL as it does not work properly with multiple connections.
-</p><p>Added SQLDate support for sybase. Thx to Chris Phillipson
-</p><p>Postgresql checking of pgsql resultset resource was incorrect. Fix by Bharat Mediratta bharat#menalto.com.
-Same patch applied to  _insertid and _affectedrows for adodb-postgres64.inc.php.
-</p><p>Added support for NConnect for postgresql.
-</p><p>Added Sybase data dict support. Thx to Chris Phillipson  
-</p><p>Extensive improvements in $perf-&gt;UI(), eg. Explain now opens in new window, we show scripts
-which call sql, etc.
-</p><p>Perf Monitor UI works with magic quotes enabled.
-</p><p>rsPrefix was declared twice. Removed.
-</p><p>Oci8 stored procedure support, eg. "begin func(); end;" was incorrect in _query. Fixed.
-</p><p>Tiraboschi Massimiliano contributed italian language file.
-</p><p>Fernando Ortiz, fortiz#lacorona.com.mx, contributed informix performance monitor.
-</p><p>Added _varchar (varchar arrays) support for postgresql. Reported by PREVOT St&eacute;phane.<hr />
-<p><strong>0.10 Sept 9 2000</strong> First release 
-</p><h3><strong>Old change log history moved to <a href="old-changelog.htm">old-changelog.htm</a>. 
-  </strong></h3>
+- MySql now correctly converts enum columns to varchar </p>
+
+<p>Ralf also changed Postgresql datadict:<br>
+- you cant add NOT NULL columns in postgres in one go, they need to be added as
+NULL and then altered to NOT NULL<br>
+- AlterColumnSQL could not change a varchar column with numbers into an integer
+column, postgres need an explicit conversation<br>
+- a re-created sequence was not set to the correct value, if the name was the
+old name (no implicit sequence), now always the new name of the implicit
+sequence is used</p>
+
+<p>Sergio Strampelli added extra $intoken check to Lens_ParseArgs() in datadict
+code. </p>
+
+<p><a name=4.53></a><b>4.53 28 Sept 2004</b> </p>
+
+<p>FetchMode cached in recordset is sometimes mapped to native db fetchMode.
+Normally this does not matter, but when using cached recordsets, we need to
+switch back to using adodb fetchmode. So we cache this in
+$rs-&gt;adodbFetchMode if it differs from the db's fetchMode. </p>
+
+<p>For informix we now set canSeek = false driver because stefan bodgan tells
+me that seeking doesn't work. </p>
+
+<p>SetDateLocale() never worked till now ;-) Thx david#tomato.it </p>
+
+<p>Set $_bindInputArray = true in sapdb driver. Required for clob support. </p>
+
+<p>Fixed some PEAR::DB emulation issues with isError() and isWarning. Thx to
+Gert-Rainer Bitterlich. </p>
+
+<p>Empty() used in getupdatesql without strlen() check. Fixed.</p>
+
+<p>Added unsigned detection to mysql and mysqli drivers. Thx to dan cech. </p>
+
+<p>Added hungarian language file. Thx to Halszvri Gbor. </p>
+
+<p>Improved fieldname-type formatting of datadict SQL generated (adding
+$widespacing parameter to _GenField). </p>
+
+<p>Datadict oci8 DROP CONSTRAINTS misspelt. Fixed. Thx Mark Newnham. </p>
+
+<p>Changed odbtp to dynamically change databaseType based on connection, eg.
+from 'odbtp' to 'odbtp_mssql' when connecting to mssql database. </p>
+
+<p>In datadict, MySQL I4 was wrongly mapped to MEDIUMINT, which is actually I3.
+Fixed. </p>
+
+<p>Fixed mysqli MetaType() recognition. Mysqli returns numeric types unlike
+mysql extension. Thx Francesco Riosa. </p>
+
+<p>VFP odbc driver curmode set wrongly, causing problems with memo fields.
+Fixed. </p>
+
+<p>Odbc driver did not recognize odbc version 2 driver date types properly.
+Fixed. Thx Bostjan. </p>
+
+<p>ChangeTableSQL() fixes to datadict-db2.inc.php by Mark Newnham. </p>
+
+<p>Perf monitoring with odbc improved. Now we try in perf code to manually set
+the sysTimeStamp using date() if sysTimeStamp is empty. </p>
+
+<p>All <st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>
+errors are thrown as exceptions in PHP5. So we added exception handling to ado
+in PHP5 by creating new adodb-ado5.inc.php driver. </p>
+
+<p>Added IsConnected(). Returns true if connection object connected. By
+Luca.Gioppo. </p>
+
+<p>&quot;Ralf Becker&quot; RalfBecker#digitalROCK.de contributed new sapdb
+data-dictionary driver and a large patch that implements field and table
+renaming for oracle, mssql, postgresql, mysql and sapdb. See the new RenameTableSQL()
+and RenameColumnSQL() functions. </p>
+
+<p>We now check ExecuteCursor to see if PrepareSP was initially called. </p>
+
+<p>Changed oci8 datadict to use MODIFY for $dd-&gt;alterCol. Thx Mark Newnham. </p>
+
+<p><a name=4.52></a><b>4.52 10 Aug 2004</b> </p>
+
+<p>Bug found in Replace() when performance logging enabled, introduced in ADOdb
+4.50. Fixed. </p>
+
+<p>Replace() checks update stmt. If update stmt fails, we now return
+immediately. Thx to alex. </p>
+
+<p>Added support for $ADODB_FORCE_TYPE in GetUpdateSQL/GetInsertSQL. Thx to
+niko. </p>
+
+<p>Added ADODB_ASSOC_CASE support to postgres/postgres7 driver. </p>
+
+<p>Support for DECLARE stmt in oci8. Thx Lochbrunner. </p>
+
+<p><a name=4.51></a><b>4.51 29 July 2004</b> </p>
+
+<p>Added adodb-xmlschema 1.0.2. Thx dan and richard. </p>
+
+<p>Added new adorecordset_ext_* classes. If ADOdb extension installed for
+mysql, mysqlt and oci8 (but not oci8po), we use the superfast ADOdb extension
+code for movenext. </p>
+
+<p>Added schema support to mssql and odbc_mssql MetaPrimaryKeys(). </p>
+
+<p>Patched MSSQL driver to support PHP NULL and Boolean values while binding
+the input array parameters in the _query() function. By Stephen Farmer. </p>
+
+<p>Added support for clob's for mssql, UpdateBlob(). Thx to
+gfran#directa.com.br </p>
+
+<p>Added normalize support for postgresql (true=lowercase table name, or
+false=case-sensitive table names) to MetaColumns($table, $normalize=true). </p>
+
+<p>PHP5 variant dates in <st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>
+not working. Fixed in adodb-ado.inc.php. </p>
+
+<p>Constant ADODB_FORCE_NULLS was not working properly for many releases (for
+GetUpdateSQL). Fixed. Also GetUpdateSQL strips off ORDER BY now - thx Elieser
+Leo. </p>
+
+<p>Perf Monitor for oci8 now dynamically highlights optimizer_* params if too
+high/low. </p>
+
+<p>Added dsn support to NewADOConnection/ADONewConnection. </p>
+
+<p>Fixed out of page bounds bug in _adodb_pageexecute_all_rows() Thx to
+&quot;Sergio Strampelli&quot; sergio#rir.it </p>
+
+<p>Speedup of movenext for mysql and oci8 drivers. </p>
+
+<p>Moved debugging code _adodb_debug_execute() to adodb-lib.inc.php. </p>
+
+<p>Fixed postgresql bytea detection bug. See
+http://phplens.com/lens/lensforum/msgs.php?id=9849. </p>
+
+<p>Fixed ibase datetimestamp typo in PHP5. Thx stefan. </p>
+
+<p>Removed whitespace at end of odbtp drivers. </p>
+
+<p>Added db2 metaprimarykeys fix. </p>
+
+<p>Optimizations to MoveNext() for mysql and oci8. Misc speedups to Get*
+functions. </p>
+
+<p><a name=4.50></a><b>4.50 6 July 2004</b> </p>
+
+<p>Bumped it to 4.50 to avoid confusion with PHP 4.3.x series. </p>
+
+<p>Added db2 metatables and metacolumns extensions. </p>
+
+<p>Added alpha PDO driver. Very buggy, only works with odbc. </p>
+
+<p>Tested mysqli. Set poorAffectedRows = true. Cleaned up movenext() and
+_fetch(). </p>
+
+<p>PageExecute does not work properly with php5 (return val not a variable).
+Reported Dmytro Sychevsky sych#php.com.ua. Fixed. </p>
+
+<p>MetaTables() for mysql, $showschema parameter was not backward compatible
+with older versions of adodb. Fixed. </p>
+
+<p>Changed mysql GetOne() to work with mysql 3.23 when using with non-select
+stmts (e.g. SHOW TABLES). </p>
+
+<p>Changed TRIG_ prefix to a variable in datadict-oci8.inc.php. Thx to
+Luca.Gioppo#csi.it. </p>
+
+<p>New to adodb-time code. We allow you to define your own daylights savings
+function, adodb_daylight_sv for pre-1970 dates. If the function is defined
+(somewhere in an include), then you can correct for daylights savings. See
+http://phplens.com/phpeverywhere/node/view/16#daylightsavings for more info. </p>
+
+<p>New sqlitepo driver. This is because assoc mode does not work like other
+drivers in sqlite. Namely, when selecting (joining) multiple tables, in assoc
+mode the table names are included in the assoc keys in the &quot;sqlite&quot;
+driver. In &quot;sqlitepo&quot; driver, the table names are stripped from the
+returned column names. When this results in a conflict, the first field get
+preference. Contributed by Herman Kuiper herman#ozuzo.net </p>
+
+<p>Added $forcenull parameter to GetInsertSQL/GetUpdateSQL. Idea by Marco
+Aurelio Silva. </p>
+
+<p>More XHTML changes for GetMenu. By Jeremy Evans. </p>
+
+<p>Fixes some ibase date issues. Thx to stefan bogdan. </p>
+
+<p>Improvements to mysqli driver to support $ADODB_COUNTRECS. </p>
+
+<p>Fixed adodb-csvlib.inc.php problem when reading stream from socket. We need
+to poll stream continiously. </p>
+
+<p><a name=4.23></a><b>4.23 16 June 2004</b> </p>
+
+<p>New interbase/firebird fixes thx to Lester Caine. Driver fixes a problem
+with getting field names in the result array, and corrects a couple of data
+conversions. Also we default to dialect3 for firebird. Also ibase sysDate
+property was wrong. Changed to cast as timestamp. </p>
+
+<p>The datadict driver is set up to give quoted tables and fields as this was
+the only way round reserved words being used as field names in TikiWiki.
+TikiPro is tidying that up, and I hope to be able to produce a build of THAT
+which uses what I consider proper UPPERCASE field and table names. The
+conversion of TikiWiki to ADOdb helped in that, but until the database is
+completely tidied up in TikiPro ... </p>
+
+<p>Modified _gencachename() to include fetchmode in name hash. This means you
+should clear your cache directory after installing this release as the cache
+name algorithm has changed. </p>
+
+<p>Now Cache* functions work in safe mode, because we do not create
+sub-directories in the $ADODB_CACHE_DIR in safe mode. In non-safe mode we still
+create sub-directories. Done by modifying _gencachename(). </p>
+
+<p>Added $gmt parameter (true/false) to UserDate and UserTimeStamp in
+connection class, to force conversion of input (in local time) to be converted
+to UTC/GMT. </p>
+
+<p>Mssql datadict did not support INT types properly (no size param allowed).
+Added _GetSize() to datadict-mssql.inc.php. </p>
+
+<p>For borland_ibase, BeginTrans(), changed:</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span>$this-&gt;_transactionID = $this-&gt;_connectionID;</pre></div>
+
+<p class=MsoNormal>to</p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'> </span>$this-&gt;_transactionID = ibase_trans($this-&gt;ibasetrans, $this-&gt;_connectionID);</pre></div>
+
+<p>Fixed typo in mysqi_field_seek(). Thx to Sh4dow (sh4dow#php.pl). </p>
+
+<p>LogSQL did not work with Firebird/Interbase. Fixed. </p>
+
+<p>Postgres: made errorno() handling more consistent. Thx to Michael Jahn,
+Michael.Jahn#mailbox.tu-dresden.de. </p>
+
+<p>Added informix patch to better support metatables, metacolumns by
+&quot;Cecilio Albero&quot; c-albero#eos-i.com </p>
+
+<p>Cyril Malevanov contributed patch to oci8 to support passing of LOB
+parameters: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-tab-count:1'> </span>$text = 'test test test';<br>
+<span style='mso-tab-count:1'> </span>$sql = &quot;declare rs clob; begin :rs := lobinout(:sa0); end;&quot;;<br>
+<span style='mso-tab-count:1'> </span>$stmt = $conn -&gt; PrepareSP($sql);<br>
+<span style='mso-tab-count:1'> </span>$conn -&gt; InParameter($stmt,$text,'sa0', -1, OCI_B_CLOB);<br>
+<span style='mso-tab-count:1'> </span>$rs = '';<br>
+<span style='mso-tab-count:1'> </span>$conn -&gt; OutParameter($stmt,$rs,'rs', -1, OCI_B_CLOB);<br>
+<span style='mso-tab-count:1'> </span>$conn -&gt; Execute($stmt);<br>
+<span style='mso-tab-count:1'> </span>echo &quot;return = &quot;.$rs.&quot;&lt;br&gt;&quot;;</pre></div>
+
+<p class=MsoNormal>As he says, the LOBs limitations are: </p>
+
+<div style='mso-element:para-border-div;border:solid #DDDDDD 1.0pt;mso-border-alt:
+solid #DDDDDD .75pt;padding:9.0pt 18.0pt 9.0pt 18.0pt;background:#EEEEEE'><pre
+style='background:#EEEEEE'><span style='mso-spacerun:yes'></span>- use OCINewDescriptor before binding<br>
+<span style='mso-spacerun:yes'></span>- if Param is IN, uses save() before each execute. This is done automatically for you.<br>
+<span style='mso-spacerun:yes'></span>- if Param is OUT, uses load() after each execute. This is done automatically for you.<br>
+<span style='mso-spacerun:yes'></span>- when we bind $var as LOB, we create new descriptor and return it as a<br>
+<span style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'></span>Bind Result, so if we want to use OUT parameters, we have to store<br>
+<span style='mso-spacerun:yes'> </span>somewhere &amp;$var to load() data from LOB to it.<br>
+<span style='mso-spacerun:yes'></span>- IN OUT params are not working now (should not be a big problem to fix it)<br>
+<span style='mso-spacerun:yes'></span>- now mass binding not working too (I've wrote about it before)</pre></div>
+
+<p>Simplified Connect() and PConnect() error handling. </p>
+
+<p>When extension not loaded, Connect() and PConnect() will return null. On
+connect error, the fns will return false. </p>
+
+<p>CacheGetArray() added to code. </p>
+
+<p>Added Init() to adorecordset_empty(). </p>
+
+<p>Changed postgres64 driver, MetaColumns() to not strip off quotes in default
+value if :: detected (type-casting of default). </p>
+
+<p>Added test: if (!defined('ADODB_DIR')) die(). Useful to prevent hackers from
+detecting file paths. </p>
+
+<p>Changed metaTablesSQL to ignore Postgres 7.4 information schemas (sql_*). </p>
+
+<p>New polish language file by Grzegorz Pacan </p>
+
+<p>Added support for <st1:place w:st="on">UNION</st1:place> in
+_adodb_getcount(). </p>
+
+<p>Added security check for ADODB_DIR to limit path disclosure issues.
+Requested by postnuke team. </p>
+
+<p>Added better error message support to oracle driver. Thx to Gaetano Giunta. </p>
+
+<p>Added showSchema support to mysql. </p>
+
+<p>Bind in oci8 did not handle $name=false properly. Fixed. </p>
+
+<p>If extension not loaded, Connect(), PConnect(), NConnect() will return null.
+</p>
+
+<p><b>4.22 15 Apr 2004</b> </p>
+
+<p>Moved docs to own adodb/docs folder. </p>
+
+<p>Fixed session bug when quoting compressed/encrypted data in Replace(). </p>
+
+<p>Netezza Driver and LDAP drivers contributed by Josh Eldridge. </p>
+
+<p>GetMenu now uses rtrim() on values instead of trim(). </p>
+
+<p>Changed MetaColumnNames to return an associative array, keys being the field
+names in uppercase. </p>
+
+<p>Suggested fix to adodb-ado.inc.php affected_rows to support PHP5 variants.
+Thx to Alexios Fakos. </p>
+
+<p>Contributed bulgarian language file by Valentin Sheiretsky
+valio#valio.eu.org. </p>
+
+<p>Contributed romanian language file by stefan bogdan. </p>
+
+<p>GetInsertSQL now checks for table name (string) in $rs, and will create a
+recordset for that table automatically. Contributed by Walt Boring. Also added
+OCI_B_BLOB in bind on Walt's request - hope it doesn't break anything :-) </p>
+
+<p>Some minor postgres speedups in _initrs(). </p>
+
+<p>ChangeTableSQL checks now if MetaColumns returns empty. Thx Jason Judge. </p>
+
+<p>Added ADOConnection::Time(), returns current database time in unix timestamp
+format, or false. </p>
+
+<p><b>4.21 20 Mar 2004</b> </p>
+
+<p>We no longer in SelectLimit for VFP driver add SELECT TOP X unless an ORDER
+BY exists. </p>
+
+<p>Pim Koeman contributed dutch language file adodb-nl.inc.php. </p>
+
+<p>Rick Hickerson added CLOB support to db2 datadict. </p>
+
+<p>Added odbtp driver. Thx to &quot;stefan bogdan&quot; sbogdan#rsb.ro. </p>
+
+<p>Changed PrepareSP() 2nd parameter, $cursor, to default to true (formerly
+false). Fixes oci8 backward compat problems with OUT params. </p>
+
+<p>Fixed month calculation error in adodb-time.inc.php. 2102-June-01 appeared
+as 2102-May-32. </p>
+
+<p>Updated PHP5 RC1 iterator support. API changed, hasMore() renamed to
+valid(). </p>
+
+<p>Changed internal format of serialized cache recordsets. As we store a
+version number, this should be backward compatible. </p>
+
+<p>Error handling when driver file not found was flawed in ADOLoadCode().
+Fixed. </p>
+
+<p><b>4.20 27 Feb 2004</b> </p>
+
+<p>Updated to AXMLS 1.01. </p>
+
+<p>MetaForeignKeys for postgres7 modified by Edward Jaramilla, works on pg 7.4.
+</p>
+
+<p>Now numbers accepts function calls or sequences for
+GetInsertSQL/GetUpdateSQL numeric fields. </p>
+
+<p>Changed quotes of 'delete from $perf_table' to &quot;&quot;. Thx Kehui
+(webmaster#kehui.net) </p>
+
+<p>Added ServerInfo() for ifx, and putenv trim fix. Thx Fernando Ortiz. </p>
+
+<p>Added addq(), which is analogous to addslashes(). </p>
+
+<p>Tested with php5b4. Fix some php5 compat problems with exceptions and
+sybase. </p>
+
+<p>Carl-Christian Salvesen added patch to mssql _query to support binds greater
+than 4000 chars. </p>
+
+<p>Mike suggested patch to PHP5 exception handler. $errno must be numeric. </p>
+
+<p>Added double quotes (&quot;) to ADODB_TABLE_REGEX. </p>
+
+<p>For oci8, Prepare(...,$cursor), $cursor's meaning was accidentally inverted
+in 4.11. This causes problems with ExecuteCursor() too, which calls Prepare()
+internally. Thx to William Lovaton. </p>
+
+<p>Now dateHasTime property in connection object renamed to datetime for
+consistency. This could break bc. </p>
+
+<p>Csongor Halmai reports that db2 SelectLimit with input array is not working.
+Fixed.. </p>
+
+<p><b>4.11 27 Jan 2004</b> </p>
+
+<p>Csongor Halmai reports db2 binding not working. Reverted back to emulated
+binding. </p>
+
+<p>Dan Cech modifies datadict code. Adds support for DropIndex. Minor cleanups.
+</p>
+
+<p>Table misspelt in perf-oci8.inc.php. Changed v$conn_cache_advice to
+v$db_cache_advice. Reported by Steve W. </p>
+
+<p>UserTimeStamp and DBTimeStamp did not handle YYYYMMDDHHMMSS format properly.
+Reported by Mike Muir. Fixed. </p>
+
+<p>Changed oci8 Prepare(). Does not auto-allocate OCINewCursor automatically,
+unless 2nd param is set to true. This will break backward compat, if
+Prepare/Execute is used instead of ExecuteCursor. Reported by Chris Jones. </p>
+
+<p>Added InParameter() and OutParameter(). Wrapper functions to Parameter(),
+but nicer because they are self-documenting. </p>
+
+<p>Added 'R' handling in ActualType() to datadict-mysql.inc.php </p>
+
+<p>Added ADOConnection::SerializableRS($rs). Returns a recordset that can be
+serialized in a session. </p>
+
+<p>Added &quot;Run SQL&quot; to performance UI(). </p>
+
+<p>Misc spelling corrections in adodb-mysqli.inc.php, adodb-oci8.inc.php and
+datadict-oci8.inc.php, from Heinz Hombergs. </p>
+
+<p>MetaIndexes() for ibase contributed by Heinz Hombergs. </p>
+
+<p><b>4.10 12 Jan 2004</b> </p>
+
+<p>Dan Cech contributed extensive changes to data dictionary to support name
+quoting (with `), and drop table/index. </p>
+
+<p>Informix added cursorType property. Default remains IFX_SCROLL, but you can
+change to 0 (non-scrollable cursor) for performance. </p>
+
+<p>Added ADODB_View_PrimaryKeys() for returning view primary keys to
+MetaPrimaryKeys(). </p>
+
+<p>Simplified chinese file, adodb-cn.inc.php from cysoft. </p>
+
+<p>Added check for ctype_alnum in adodb-datadict.inc.php. Thx to Jason Judge. </p>
+
+<p>Added connection parameter to ibase Prepare(). Fix by Daniel Hassan. </p>
+
+<p>Added nameQuote for quoting identifiers and names to connection obj.
+Requested by Jason Judge. Also the data dictionary parser now detects `field
+name` and generates column names with spaces correctly. </p>
+
+<p>BOOL type not recognised correctly as L. Fixed. </p>
+
+<p>Fixed paths in ADODB_DIR for session files, and back-ported it to 4.05 (15
+Dec 2003) </p>
+
+<p>Added Schema to postgresql MetaTables. Thx to col#gear.hu </p>
+
+<p>Empty postgresql recordsets that had blob fields did not set EOF properly.
+Fixed. </p>
+
+<p>CacheSelectLimit internal parameters to SelectLimit were wrong. Thx to Nio. </p>
+
+<p>Modified adodb_pr() and adodb_backtrace() to support command-line usage (eg.
+no html). </p>
+
+<p>Fixed some fr and it lang errors. Thx to Gaetano G. </p>
+
+<p>Added contrib directory, with adodb rs to xmlrpc convertor by Gaetano G. </p>
+
+<p>Fixed array recordset bugs when _skiprow1 is true. Thx to Gaetano G. </p>
+
+<p>Fixed pivot table code when count is false. </p>
+
+<p><b>4.05 13 Dec 2003 </b></p>
+
+<p>Added MetaIndexes to data-dict code - thx to Dan Cech. </p>
+
+<p>Rewritten session code by Ross Smith. Moved code to adodb/session directory.
+</p>
+
+<p>Added function exists check on connecting to most drivers, so we don't crash
+with the unknown function error. </p>
+
+<p>Smart Transactions failed with GenID() when it no seq table has been created
+because the sql statement fails. Fix by Mark Newnham. </p>
+
+<p>Added $db-&gt;length, which holds name of function that returns strlen. </p>
+
+<p>Fixed error handling for bad driver in ADONewConnection - passed too few
+params to error-handler. </p>
+
+<p>Datadict did not handle types like 16.0 properly in _GetSize. Fixed. </p>
+
+<p>Oci8 driver SelectLimit() bug &amp;= instead of =&amp; used. Thx to Swen
+Thmmler. </p>
+
+<p>Jesse Mullan suggested not flushing outp when output buffering enabled. Due
+to Apache 2.0 bug. Added. </p>
+
+<p>MetaTables/MetaColumns return ref bug with PHP5 fixed in
+adodb-datadict.inc.php. </p>
+
+<p>New mysqli driver contributed by Arjen de Rijke. Based on adodb 3.40 driver.
+Then jlim added BeginTrans, CommitTrans, RollbackTrans, IfNull, SQLDate. Also
+fixed return ref bug. </p>
+
+<p>$ADODB_FLUSH added, if true then force flush in debugging outp. Default is
+false. In earlier versions, outp defaulted to flush, which is not compat with
+apache 2.0. </p>
+
+<p>Mysql driver's GenID() function did not work when when sql logging is on.
+Fixed. </p>
+
+<p>$ADODB_SESSION_TBL not declared as global var. Not available if
+adodb-session.inc.php included in function. Fixed. </p>
+
+<p>The input array not passed to Execute() in _adodb_getcount(). Fixed. </p>
+
+<p><b>4.04 13 Nov 2003 </b></p>
+
+<p>Switched back to foreach - faster than list-each. </p>
+
+<p>Fixed bug in ado driver - wiping out $this-&gt;fields with date fields. </p>
+
+<p>Performance Monitor, View SQL, Explain Plan did not work if
+strlen($SQL)&gt;max($_GET length). Fixed. </p>
+
+<p>Performance monitor, oci8 driver added memory sort ratio. </p>
+
+<p>Added random property, returns SQL to generate a floating point number
+between 0 and 1; </p>
+
+<p><b>4.03 6 Nov 2003 </b></p>
+
+<p>The path to adodb-php4.inc.php and adodb-iterators.inc.php was not setup
+properly. </p>
+
+<p>Patched SQLDate in interbase to support hours/mins/secs. Thx to ari
+kuorikoski. </p>
+
+<p>Force autorollback for pgsql persistent connections - apparently pgsql did
+not autorollback properly before 4.3.4. See http://bugs.php.net/bug.php?id=25404
+</p>
+
+<p><b>4.02 5 Nov 2003 </b></p>
+
+<p>Some errors in adodb_error_pg() fixed. Thx to Styve. </p>
+
+<p>Spurious Insert_ID() error was generated by LogSQL(). Fixed. </p>
+
+<p>Insert_ID was interfering with Affected_Rows() and Replace() when LogSQL()
+enabled. Fixed. </p>
+
+<p>More foreach loops optimized with list/each. </p>
+
+<p>Null dates not handled properly in <st1:City w:st="on"><st1:place w:st="on">ADO</st1:place></st1:City>
+driver (it becomes 31 Dec 1969!). </p>
+
+<p>Heinz Hombergs contributed patches for mysql MetaColumns - adding scale,
+made interbase MetaColumns work with firebird/interbase, and added
+lang/adodb-de.inc.php. </p>
+
+<p>Added INFORMIXSERVER environment variable. </p>
+
+<p>Added $ADODB_ANSI_PADDING_OFF for interbase/firebird. </p>
+
+<p>PHP 5 beta 2 compat check. Foreach (Iterator) support. Exceptions support. </p>
+
+<p><b>4.01 23 Oct 2003 </b></p>
+
+<p>Fixed bug in rs2html(), tohtml.inc.php, that generated blank table cells. </p>
+
+<p>Fixed insert_id() incorrectly generated when logsql() enabled. </p>
+
+<p>Modified PostgreSQL _fixblobs to use list/each instead of foreach. </p>
+
+<p>Informix ErrorNo() implemented correctly. </p>
+
+<p>Modified several places to use list/each, including GetRowAssoc(). </p>
+
+<p>Added UserTimeStamp() to connection class. </p>
+
+<p>Added $ADODB_ANSI_PADDING_OFF for oci8po. </p>
+
+<p><b>4.00 20 Oct 2003 </b></p>
+
+<p>Upgraded adodb-xmlschema to 1 Oct 2003 snapshot. </p>
+
+<p>Fix to rs2html warning message. Thx to Filo. </p>
+
+<p>Fix for odbc_mssql/mssql SQLDate(), hours was wrong. </p>
+
+<p>Added MetaColumns and MetaPrimaryKeys for sybase. Thx to Chris Phillipson. </p>
+
+<p>Added autoquoting to datadict for MySQL and PostgreSQL. Suggestion by
+Karsten Dambekalns </p>
+
+<p><b>3.94 11 Oct 2003 </b></p>
+
+<p>Create trigger in datadict-oci8.inc.php did not work, because all cr/lf's
+must be removed. </p>
+
+<p>ErrorMsg()/ErrorNo() did not work for many databases when logging enabled.
+Fixed. </p>
+
+<p>Removed global variable $ADODB_LOGSQL as it does not work properly with
+multiple connections. </p>
+
+<p>Added SQLDate support for sybase. Thx to Chris Phillipson </p>
+
+<p>Postgresql checking of pgsql resultset resource was incorrect. Fix by Bharat
+Mediratta bharat#menalto.com. Same patch applied to _insertid and _affectedrows
+for adodb-postgres64.inc.php. </p>
+
+<p>Added support for NConnect for postgresql. </p>
+
+<p>Added Sybase data dict support. Thx to Chris Phillipson </p>
+
+<p>Extensive improvements in $perf-&gt;UI(), eg. Explain now opens in new
+window, we show scripts which call sql, etc. </p>
+
+<p>Perf Monitor UI works with magic quotes enabled. </p>
+
+<p>rsPrefix was declared twice. Removed. </p>
+
+<p>Oci8 stored procedure support, eg. &quot;begin func(); end;&quot; was
+incorrect in _query. Fixed. </p>
+
+<p>Tiraboschi Massimiliano contributed italian language file. </p>
+
+<p>Fernando Ortiz, fortiz#lacorona.com.mx, contributed informix performance
+monitor. </p>
+
+<p>Added _varchar (varchar arrays) support for postgresql. Reported by PREVOT
+Stphane.</p>
+
+<div class=MsoNormal align=center style='text-align:center'>
+
+<hr size=2 width="100%" align=center>
+
+</div>
+
+<p><strong>0.10 Sept 9 2000</strong> First release </p>
+
+<h3><strong>Old change log history moved to <a href="old-changelog.htm">old-changelog.htm</a>.
+</strong></h3>
+
 <p>&nbsp;</p>
-<p>  
-</p></body></html>
\ No newline at end of file
+
+</div>
+
+</body>
+
+</html>
diff --git a/third_party/adodb/docs/docs-datadict.htm b/third_party/adodb/docs/docs-datadict.htm
index 4b4cbda..df2c49a 100644
--- a/third_party/adodb/docs/docs-datadict.htm
+++ b/third_party/adodb/docs/docs-datadict.htm
@@ -20,8 +20,8 @@
 </head>
 <body style="background-color: rgb(255, 255, 255);">
 <h2>ADOdb Data Dictionary Library for PHP</h2>
-<p>V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (<a
- href="mailto:jlim#natsoft.com.my">jlim#natsoft.com.my</a>).<br>
+<p>V5.06 16 Oct 2008  (c) 2000-2009 John Lim (<a
+ href="mailto:jlim#natsoft.com">jlim#natsoft.com</a>).<br>
 AXMLS (c) 2004 ars Cognita, Inc</p>
 <p><font size="1">This software is dual licensed using BSD-Style and
 LGPL. This means you can use it in compiled proprietary and commercial
@@ -38,7 +38,7 @@ system for defining databases. You can contact them at
 dcech#phpwerx.net and richtl#arscognita.com.</p>
 <p>Currently the following databases are supported:</p>
 <p> <b>Well-tested:</b> PostgreSQL, MySQL, Oracle, MSSQL.<br>
-<b>Beta-quality:</b> DB2, Informix, Sybase, Interbase, Firebird.<br>
+<b>Beta-quality:</b> DB2, Informix, Sybase, Interbase, Firebird, SQLite.<br>
 <b>Alpha-quality:</b> MS Access (does not support DEFAULT values) and
 generic ODBC.
 </p>
@@ -93,7 +93,8 @@ field. Each row has this format:</p>
 field type can be a portable type codes or the actual type for that
 database.</p>
 <p>Legal portable type codes include:</p>
-<pre>  C:  Varchar, capped to 255 characters.<br>  X:  Larger varchar, capped to 4000 characters (to be compatible with Oracle). <br>  XL: For Oracle, returns CLOB, otherwise the largest varchar size.<br><br>  C2: Multibyte varchar<br>  X2: Multibyte varchar (largest size)<br><br>  B:  BLOB (binary large object)<br><br>  D:  Date (some databases do not support this, and we return a datetime type)<br>  T:  Datetime or Timestamp<br>  L:  Integer field suitable for storing booleans (0 or 1)<br>  I:  Integer (mapped to I4)<br>  I1: 1-byte integer<br>  I2: 2-byte integer<br>  I4: 4-byte integer<br>  I8: 8-byte integer<br>  F:  Floating point number<br>  N:  Numeric or decimal number<br></pre>
+<pre>  C:  Varchar, capped to 255 characters.<br>  X:  Larger varchar, capped to 4000 characters (to be compatible with Oracle). <br>  XL: For Oracle, returns CLOB, otherwise the largest varchar size.<br><br>  C2: Multibyte varchar<br>  X2: Multibyte varchar (largest size)<br><br>  B:  BLOB (binary large object)<br><br>  D:  Date (some databases do not support this, and we return a datetime type)<br>  T:  Datetime or Timestamp accurate to the second.<br>  TS: Datetime or Timestamp supporting Sub-second accuracy.<br>       Supported by Oracle, PostgreSQL and SQL Server currently. <br>       Otherwise equivalent to T.<br>
+  L:  Integer field suitable for storing booleans (0 or 1)<br>  I:  Integer (mapped to I4)<br>  I1: 1-byte integer<br>  I2: 2-byte integer<br>  I4: 4-byte integer<br>  I8: 8-byte integer<br>  F:  Floating point number<br>  N:  Numeric or decimal number<br></pre>
 <p>The $colsize field represents the size of the field. If a decimal
 number is used, then it is assumed that the number following the dot is
 the precision, so 6.2 means a number of size 6 digits and 2 decimal
@@ -136,7 +137,7 @@ for postgresql:
 <pre>  $taboptarray = array('constraints' =gt; ', FOREIGN KEY (col1) REFERENCES reftable (refcol)');</pre>
 <h4>function DropTableSQL($tabname)</h4>
 <p>Returns the SQL to drop the specified table.</p>
-<h4>function ChangeTableSQL($tabname, $flds)</h4>
+<h4>function ChangeTableSQL($tabname, $flds, $tableOptions=false, $dropOldFlds=false)</h4>
 <p>Checks to see if table exists, if table does not exist, behaves like
 CreateTableSQL. If table exists, generates appropriate ALTER TABLE
 MODIFY COLUMN commands if field already exists, or ALTER TABLE ADD
@@ -144,6 +145,7 @@ $column if field does not exist.</p>
 <p>The class must be connected to the database for ChangeTableSQL to
 detect the existence of the table. Idea and code contributed by Florian
 Buzin.</p>
+<p>Old fields not defined in $flds are not dropped by default. To drop old fields, set $dropOldFlds to true.
 <h4>function RenameTableSQL($tabname,$newname)</h4>
 <p>Rename a table.  Returns the an array of strings, which is the SQL required to rename a table. Since ADOdb 4.53. Contributed by Ralf Becker.</p>
 <h4> function RenameColumnSQL($tabname,$oldcolumn,$newcolumn,$flds='')</h4>
diff --git a/third_party/adodb/docs/docs-oracle.htm b/third_party/adodb/docs/docs-oracle.htm
index c91a8db..3ee27aa 100644
--- a/third_party/adodb/docs/docs-oracle.htm
+++ b/third_party/adodb/docs/docs-oracle.htm
@@ -1,542 +1,542 @@
-<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
-<html>
-<head>
-<style>
-pre {
-  background-color: #eee;
-  padding: 0.75em 1.5em;
-  font-size: 12px;
-  border: 1px solid #ddd;
-}
-.greybg {
-  background-color: #eee;
-  padding: 0.75em 1.5em;
-  font-size: 12px;
-  border: 1px solid #ddd;
-}
-.style1 {color: #660000}
-</style>
-<title>ADOdb with PHP and Oracle</title>
-<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
-</style>
-</head>
-
-<body>
-<table width=100%><tr><td>
-<h2>Using ADOdb with PHP and Oracle: an advanced tutorial</h2>
-</td><td><div align="right"><img src=cute_icons_for_site/adodb.gif width="88" height="31"></div></tr></table>
-<p><font size="1">(c)2004-2005 John Lim. All rights reserved.</font></p>
-<h3>1. Introduction</h3>
-<p>Oracle is the most popular commercial database used with PHP. There are many ways of accessing Oracle databases in PHP. These include:</p>
-<ul>
-  <li>The oracle extension</li>
-  <li>The oci8 extension</li>
-  <li>PEAR DB library</li>
-  <li>ADOdb library</li>
-</ul>
-<p>The wide range of choices is confusing to someone just starting with Oracle and PHP. I will briefly summarize the differences, and  show you the advantages of using <a href="http://adodb.sourceforge.net/">ADOdb</a>. </p>
-<p>First we have the C extensions which provide low-level access to Oracle functionality. These C extensions are precompiled into PHP, or linked in dynamically when the web server starts up. Just in case you need it, here's a <a href=http://www.oracle.com/technology/tech/opensource/php/apache/inst_php_apache_linux.html>guide to installing Oracle and PHP on Linux</a>.</p>
-<table width="75%" border="1" align="center">
-  <tr valign="top">
-    <td nowrap><b>Oracle extension</b></td>
-    <td>Designed for Oracle 7 or earlier. This is obsolete.</td>
-  </tr>
-  <tr valign="top">
-    <td nowrap><b>Oci8 extension</b></td>
-    <td> Despite it's name, which implies it is only for Oracle 8i, this is the standard method for accessing databases running Oracle 8i, 9i or 10g (and later).</td>
-  </tr>
-</table>
-<p>Here is an example of using the oci8 extension to query the <i>emp</i> table of the <i>scott</i> schema with bind parameters:
-<pre>
-$conn = OCILogon("scott","tiger", $tnsName); 
-
-$stmt = OCIParse($conn,"select * from emp where empno > :emp order by empno"); 
-$emp = 7900;
-OCIBindByName($stmt, ':emp', $emp);
-$ok = OCIExecute($stmt);
-while (OCIFetchInto($stmt,$arr)) {
-	print_r($arr);
-	echo "&lt;hr>";	
-} 
-</pre>
-<p>This generates the following output:
-<div class=greybg>
-Array ( [0] => 7902 [1] => FORD [2] => ANALYST [3] => 7566 [4] => 03/DEC/81 [5] => 3000 [7] => 20 ) 
-<hr />
-  Array ( [0] => 7934 [1] => MILLER [2] => CLERK [3] => 7782 [4] => 23/JAN/82 [5] => 1300 [7] => 10 )
-</div>
-<p>We also have  many higher level PHP libraries that allow you to simplify the above code. The most popular are <a href="http://pear.php.net/">PEAR DB</a> and <a href="http://adodb.sourceforge.net/">ADOdb</a>.  Here are some of the differences between these libraries:</p>
-<table width="75%" border="1" align="center">
-  <tr>
-    <td><b>Feature</b></td>
-    <td><b>PEAR DB 1.6</b></td>
-    <td><b>ADOdb 4.52</b></td>
-  </tr>
-  <tr valign="top">
-    <td>General Style</td>
-    <td>Simple, easy to use. Lacks Oracle specific functionality.</td>
-    <td>Has multi-tier design. Simple high-level design for beginners, and also lower-level advanced Oracle functionality.</td>
-  </tr>
-  <tr valign="top">
-    <td>Support for Prepare</td>
-    <td>Yes, but only on one statement, as the last prepare overwrites previous prepares.</td>
-    <td>Yes (multiple simultaneous prepare's allowed)</td>
-  </tr>
-  <tr valign="top">
-    <td>Support for LOBs</td>
-    <td>No</td>
-    <td>Yes, using update semantics</td>
-  </tr>
-  <tr valign="top">
-    <td>Support for REF Cursors</td>
-    <td>No</td>
-    <td>Yes</td>
-  </tr>
-  <tr valign="top">
-    <td>Support for IN Parameters</td>
-    <td>Yes</td>
-    <td>Yes</td>
-  </tr>
-  <tr valign="top">
-    <td>Support for OUT Parameters</td>
-    <td>No</td>
-    <td>Yes</td>
-  </tr>
-  <tr valign="top">
-    <td>Schema creation using XML</td>
-    <td>No</td>
-    <td>Yes, including ability to define tablespaces and constraints</td>
-  </tr>
-  <tr valign="top">
-    <td>Provides database portability features</td>
-    <td>No</td>
-    <td>Yes, has some ability to abstract features that differ between databases such as dates, bind parameters, and data types.</td>
-  </tr>
-  <tr valign="top">
-    <td>Performance monitoring and tracing</td>
-    <td>No</td>
-    <td>Yes. SQL can be traced and linked to web page it was executed on. Explain plan support included.</td>
-  </tr>
-  <tr valign="top">
-    <td>Recordset caching for frequently used queries</td>
-    <td>No</td>
-    <td>Yes. Provides great speedups for SQL involving complex <i>where, group-by </i>and <i>order-by</i> clauses.</td>
-  </tr>
-  <tr valign="top">
-    <td>Popularity</td>
-    <td>Yes, part of PEAR release</td>
-    <td>Yes, many open source projects are using this software, including PostNuke, Xaraya, Mambo, Tiki Wiki.</td>
-  </tr>
-  <tr valign="top">
-    <td>Speed</td>
-    <td>Medium speed.</td>
-    <td>Very high speed. Fastest database abstraction library available for PHP. <a href="http://phplens.com/lens/adodb/">Benchmarks are available</a>.</td>
-  </tr>
-  <tr valign="top">
-    <td>High Speed Extension available</td>
-    <td>No</td>
-    <td>Yes. You can install the optional ADOdb extension, which reimplements the most frequently used parts of ADOdb as fast C code. Note that the source code version of ADOdb runs just fine without this extension, and only makes use of the extension if detected.</td>
-  </tr>
-</table>
-<p> PEAR DB is good enough for simple web apps. But if you need more power, you can see ADOdb offers more sophisticated functionality. The rest of this article will concentrate on using ADOdb with Oracle. You can find out more about <a href="#connecting">connecting to Oracle</a> later in this guide.</p>
-<h4>ADOdb Example</h4>
-<p>In ADOdb, the above oci8 example querying the <i>emp</i> table could be written as:</p>
-<pre>
-include "/path/to/adodb.inc.php";
-$db = NewADOConnection("oci8");
-$db->Connect($tnsName, "scott", "tiger");
-
-$rs = $db->Execute("select * from emp where empno>:emp order by empno", 
-                    array('emp' => 7900));
-while ($arr = $rs->FetchRow()) {
-    print_r($arr);
-	echo "&lt;hr>";
-}
-</pre>
-<p>The Execute( ) function returns a recordset object, and you can retrieve the rows returned using $recordset-&gt;FetchRow( ). </p>
-<p>If we ignore the initial connection preamble, we can see the ADOdb version is much easier and simpler:</p>
-<table width="100%" border="1">
-  <tr valign="top" bgcolor="#FFFFFF">
-    <td width="50%" bgcolor="#e0e0e0"><b>Oci8</b></td>
-    <td bgcolor="#e0e0e0"><b>ADOdb</b></td>
-  </tr>
-  <tr valign="top" bgcolor="#CCCCCC">
-    <td><pre><font size="1">$stmt = <b>OCIParse</b>($conn,
-       "select * from emp where empno > :emp"); 
-$emp = 7900;
-<b>OCIBindByName</b>($stmt, ':emp', $emp);
-$ok = <b>OCIExecute</b>($stmt);
-
-while (<b>OCIFetchInto</b>($stmt,$arr)) {
-	print_r($arr);
-	echo "&lt;hr>";	
-} </font></pre></td>
-    <td><pre><font size="1">$recordset = $db-><b>Execute</b>("select * from emp where empno>:emp", 
-                           array('emp' => 7900));
-
-while ($arr = $recordset-><b>FetchRow</b>()) {
-	print_r($arr);
-	echo "&lt;hr>";
-}</font></pre></td>
-  </tr>
-</table>
-<p>&nbsp;</p>
-<h3>2. ADOdb Query Semantics</h3>
-<p>You can also query the database using the standard Microsoft ADO MoveNext( ) metaphor. The data array for the current row is stored in the <i>fields</i> property of the recordset object, $rs.
-MoveNext( ) offers the highest performance among all the techniques for iterating through a recordset:
-<pre>
-$rs = $db->Execute("select * from emp where empno>:emp", array('emp' => 7900));
-while (!$rs->EOF) {
-	print_r($rs->fields);
-	$rs->MoveNext();
-}
-</pre>
-<p>And if you are interested in having the data returned in a 2-dimensional array, you can use:
-<pre>
-$arr = $db->GetArray("select * from emp where empno>:emp", array('emp' => 7900));
-</pre>
-<p>Now to obtain only the first row as an array:
-<pre>
-$arr = $db->GetRow("select * from emp where empno=:emp", array('emp' => 7900));
-</pre>
-<p>Or to retrieve only the first field of the first row:
-<pre>
-$arr = $db->GetOne("select ename from emp where empno=:emp", array('emp' => 7900));
-</pre>
-<p>For easy pagination support, we provide the SelectLimit function. The following will perform a select query, limiting it to 100 rows, starting from row 201 (row 1 being the 1st row):
-<pre>
-$offset = 200; $limitrows = 100;
-$rs = $db->SelectLimit('select * from table', $limitrows, $offset);
-</pre>
-<p>The $offset parameter is optional.
-<h4>Array Fetch Mode</h4>
-<p>When data is being returned in an array, you can choose the type of array the data is returned in. 
-<ol>
-  <li> Numeric indexes - use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_NUM).</font></li>
-  <li>Associative indexes - the keys of the array are the names of the fields (in upper-case). Use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_ASSOC)</font><font face="Courier New, Courier, mono">.</font></li>
-  <li>Both numeric and associative indexes - use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_BOTH).</font></li>
-</ol>
-<p>The default is ADODB_FETCH_BOTH for Oracle.</p>
-<h4><b>Caching</b></h4>
-<p>You can define a database cache directory using $ADODB_CACHE_DIR, and cache the results of frequently used queries that rarely change. This is particularly useful for SQL with complex where clauses and group-by's and order-by's. It is also good for relieving heavily-loaded database servers.</p>
-<p>This example will cache the following select statement for 3600 seconds (1 hour):</p>
-<pre>
-$ADODB_CACHE_DIR = '/var/adodb/tmp';
-$rs = $db->CacheExecute(3600, "select names from allcountries order by 1");
-</pre>
-There are analogous CacheGetArray(
-), CacheGetRow( ),  CacheGetOne( ) and CacheSelectLimit( )  functions. The first parameter is the number of seconds to cache. You can also pass a bind array as a 3rd parameter (not shown above).
-<p>There is an alternative syntax for the caching functions. The first parameter is omitted, and you set the cacheSecs
- property of the connection object:
-<pre>
-$ADODB_CACHE_DIR = '/var/adodb/tmp';
-$connection->cacheSecs = 3600;
-$rs = $connection->CacheExecute($sql, array('id' => 1));
-</pre>
-<h3>&nbsp;</h3>
-<h3>3. Using Prepare( ) For Frequently Used Statements</h3>
-<p>Prepare( ) is  for compiling frequently used  SQL statement for reuse. For example, suppose we have a large array which needs to be inserted into an Oracle database. The following will result in a massive speedup in query execution (at least 20-40%), as the SQL statement only needs to be compiled once:</p>
-<pre>
-$stmt = $db->Prepare('insert into table (field1, field2) values (:f1, :f2)');
-foreach ($arrayToInsert as $key => $value) {
-	$db->Execute($stmt, array('f1' => $key, 'f2' => $val);
-}
-</pre>
-<p>&nbsp;</p>
-<h3>4. Working With LOBs</h3>
-<p>Oracle treats data which is more than 4000 bytes in length specially. These are called Large Objects, or LOBs for short. Binary LOBs are BLOBs, and character LOBs are CLOBs. In most Oracle libraries, you need to do a lot of work to process LOBs, probably because Oracle designed it to work in systems with little memory. ADOdb tries to make things easy by assuming the LOB can fit into main memory. </p>
-<p>ADOdb will transparently handle LOBs  in <i>select</i> statements. The LOBs are automatically converted to PHP variables without any special coding.</p>
-<p>For updating records with LOBs, the functions UpdateBlob( ) and UpdateClob( ) are provided. Here's a BLOB example. The parameters should be self-explanatory:
-<pre>
-$ok = $db->Execute("insert into aTable (id, name, ablob) 
-                                values (aSequence.nextVal, 'Name', null)");
-if (!$ok) return LogError($db-&gt;ErrorMsg());
-<font color="#006600"># params: $tableName, $blobFieldName, $blobValue, $whereClause</font>
-$db->UpdateBlob('aTable', 'ablob', $blobValue, 'id=aSequence.currVal');
-</pre>
-<p>and the analogous CLOB example:
-<pre>
-$ok = $db->Execute("insert into aTable (id, name, aclob) 
-                                values (aSequence.nextVal, 'Name', null)");
-if (!$ok) return LogError($db-&gt;ErrorMsg());
-$db->UpdateClob('aTable', 'aclob', $clobValue, 'id=aSequence.currVal');
-</pre>
-<p>Note that LogError( ) is a user-defined function, and not part of ADOdb.
-<p>Inserting LOBs is more complicated. Since ADOdb 4.55, we allow you to do this
-  (assuming that the <em>photo</em> field is a BLOB, and we want to store $blob_data into
-  this field, and the primary key is the <em>id</em> field):
-<pre>
-	$sql = <span class="style1">"INSERT INTO photos ( ID, photo) ".
-			"VALUES ( :id, empty_blob() )".
-			" RETURNING photo INTO :xx"</span>;
-
- 		$stmt = $db->PrepareSP($sql);
-		$db->InParameter($stmt, $<strong>id</strong>, <span class="style1">'id'</span>);
-		$blob = $db->InParameter($stmt, $<strong>blob_data</strong>, <span class="style1">'xx'</span>,-1, OCI_B_BLOB);
-		$db->StartTrans();
-		$ok = $db->Execute($stmt);
-		$db->CompleteTrans();
-</pre> 
-<p>
-<h3>5. REF CURSORs</h3>
-<p>Oracle recordsets can be passed around as variables called REF Cursors. For example, in PL/SQL, we could define a function <i>open_tab</i> that returns a REF CURSOR in the first parameter:</p>
-<pre>
-TYPE TabType IS REF CURSOR RETURN TAB%ROWTYPE;
-
-PROCEDURE open_tab (tabcursor IN OUT TabType,tablenames IN VARCHAR) IS
-	BEGIN
-		OPEN tabcursor FOR SELECT * FROM TAB WHERE tname LIKE tablenames;
-	END open_tab;
-</pre>
-<p>In ADOdb, we could access this REF Cursor using the ExecuteCursor() function. The following will find
- all table names that begin with 'A' in the current schema:
-<pre>
-$rs = $db->ExecuteCursor("BEGIN open_tab(:refc,'A%'); END;",'refc');
-while ($arr = $rs->FetchRow()) print_r($arr);
-</pre>
-<p>The first parameter is the PL/SQL statement, and the second parameter is the name of the REF Cursor.
-</p>
-<p>&nbsp;</p>
-<h3>6. In and Out Parameters</h3>
-<p>The following PL/SQL
-stored procedure  requires an input  variable, and returns a result into an output variable:
-<pre>
-PROCEDURE data_out(input IN VARCHAR, output OUT VARCHAR) IS
-	BEGIN
-		output := 'I love '||input;
-	END;
-</pre>
-<p>The following ADOdb code allows you to call the stored procedure:</p>
-<pre>
-$stmt = $db->PrepareSP("BEGIN adodb.data_out(:a1, :a2); END;");
-$input = 'Sophia Loren';
-$db->InParameter($stmt,$input,'a1');
-$db->OutParameter($stmt,$output,'a2');
-$ok = $db->Execute($stmt);
-if ($ok) echo ($output == 'I love Sophia Loren') ? 'OK' : 'Failed';
-</pre>
-<p>PrepareSP( ) is a special function that knows about bind parameters.
-The main limitation currently is that IN OUT parameters do not work.
-<h4>Bind Parameters and REF CURSORs</h4>
-<p>We could also rewrite the REF CURSOR example to use InParameter (requires ADOdb 4.53 or later):
-<pre>
-$stmt = $db->PrepareSP("BEGIN adodb.open_tab(:refc,:tabname); END;");
-$input = 'A%';
-$db->InParameter($stmt,$input,'tabname');
-$rs = $db->ExecuteCursor($stmt,'refc');
-while ($arr = $rs->FetchRow()) print_r($arr);
-</pre>
-<h4>Bind Parameters and LOBs</h4>
-<p>You can also operate on LOBs. In this example, we have IN and OUT parameters using CLOBs. 
-<pre>
-	$text = 'test test test';
-	$sql = "declare rs clob; begin :rs := lobinout(:sa0); end;";
-	$stmt = $conn -> PrepareSP($sql);
-	$conn -> InParameter($stmt,$text,'sa0', -1, OCI_B_CLOB); # -1 means variable length
-	$rs = '';
-	$conn -> OutParameter($stmt,$rs,'rs', -1, OCI_B_CLOB);
-	$conn -> Execute($stmt);
-	echo "return = ".$rs."&lt;br>";
-</pre>
-<p>Similarly, you can use the constant OCI_B_BLOB to indicate that you are using BLOBs.
-<h4>Reusing Bind Parameters with CURSOR_SHARING=FORCE</h4>
-<p>Many web programmers do not care to use bind parameters, and prefer to enter the SQL directly. So instead of:</p>
-<pre>
-$arr = $db->GetArray("select * from emp where empno>:emp", array('emp' => 7900));
-</pre>
-<p>They prefer  entering the values inside the SQL:
-<pre>
-$arr = $db->GetArray("select * from emp where empno>7900");
-</pre>
-<p>This reduces Oracle performance because Oracle will reuse compiled SQL which is identical to previously compiled SQL. The above example with the values inside the SQL
-is unlikely to be reused. As an optimization, from Oracle 8.1 onwards, you can set the following session parameter after you login:
-<pre>
-ALTER SESSION SET CURSOR_SHARING=FORCE
-</pre>
-<p>This will force Oracle to convert all such variables (eg. the 7900 value) into constant bind parameters, improving SQL reuse.</p>
-<p>More <a href="http://phplens.com/adodb/code.initialization.html#speed">speedup tips</a>.</p>
-<p>&nbsp;</p>
-<h3>7. Dates and Datetime in ADOdb</h3>
-<p>There are two things you need to know about dates in ADOdb. </p>
-<p>First, to ensure cross-database compability, ADOdb assumes that dates are returned in ISO format (YYYY-MM-DD H24:MI:SS).</p>
-<p>Secondly, since Oracle treats dates and datetime as the same data type, we decided not to display the time in the default date format. So on login, ADOdb will set the NLS_DATE_FORMAT to 'YYYY-MM-DD'. If you prefer to show the date and time by default, do this:</p>
-<pre>
-$db = NewADOConnection('oci8');
-$db->NLS_DATE_FORMAT =  'RRRR-MM-DD HH24:MI:SS';
-$db->Connect($tns, $user, $pwd);
-</pre>
-<p>Or execute:</p>
-<pre>$sql = quot;ALTER SESSION SET NLS_DATE_FORMAT = 'RRRR-MM-DD HH24:MI:SS'&quot;;
-$db-&gt;Execute($sql);
-</pre>
-<p>If you are not concerned about date portability and do not use ADOdb's portability layer, you can use your preferred date format instead.
-<p>
-<h3>8. Database Portability Layer</h3>
-<p>ADOdb provides the following functions for portably generating SQL functions 
-  as strings to be merged into your SQL statements:</p>
-<table width="75%" border="1" align=center>
-  <tr> 
-    <td width=30%><b>Function</b></td>
-    <td><b>Description</b></td>
-  </tr>
-  <tr> 
-    <td>DBDate($date)</td>
-    <td>Pass in a UNIX timestamp or ISO date and it will convert it to a date 
-      string formatted for INSERT/UPDATE</td>
-  </tr>
-  <tr> 
-    <td>DBTimeStamp($date)</td>
-    <td>Pass in a UNIX timestamp or ISO date and it will convert it to a timestamp 
-      string formatted for INSERT/UPDATE</td>
-  </tr>
-  <tr> 
-    <td>SQLDate($date, $fmt)</td>
-    <td>Portably generate a date formatted using $fmt mask, for use in SELECT 
-      statements.</td>
-  </tr>
-  <tr> 
-    <td>OffsetDate($date, $ndays)</td>
-    <td>Portably generate a $date offset by $ndays.</td>
-  </tr>
-  <tr> 
-    <td>Concat($s1, $s2, ...)</td>
-    <td>Portably concatenate strings. Alternatively, for mssql use mssqlpo driver, 
-      which allows || operator.</td>
-  </tr>
-  <tr> 
-    <td>IfNull($fld, $replaceNull)</td>
-    <td>Returns a string that is the equivalent of MySQL IFNULL or Oracle NVL.</td>
-  </tr>
-  <tr>
-    <td>Param($name)</td>
-    <td>Generates bind placeholders, using ? or named conventions as appropriate.</td>
-  </tr>
-  <tr><td>$db->sysDate</td><td>Property that holds the SQL function that returns today's date</td>
-</tr>
-<tr><td>$db->sysTimeStamp</td><td>Property that holds the SQL function that returns the current
-timestamp (date+time).
-</td>
-</tr>
-<tr>
-<td>$db->concat_operator</td><td>Property that holds the concatenation operator
-</td>
-</tr>
-<tr><td>$db->length</td><td>Property that holds the name of the SQL strlen function.
-</td></tr>
-
-<tr><td>$db->upperCase</td><td>Property that holds the name of the SQL strtoupper function.
-</td></tr>
-<tr><td>$db->random</td><td>Property that holds the SQL to generate a random number between 0.00 and 1.00.
-</td>
-</tr>
-<tr><td>$db->substr</td><td>Property that holds the name of the SQL substring function.
-</td></tr>
-</table>
-<p>ADOdb also provides multiple oracle oci8 drivers for different scenarios:</p>
-<table width="75%" border="1" align="center">
-  <tr>
-    <td nowrap><b>Driver Name</b></td>
-    <td><b>Description</b></td>
-  </tr>
-  <tr>
-    <td>oci805 </td>
-    <td>Specifically for Oracle 8.0.5. This driver has a slower SelectLimit( ).</td>
-  </tr>
-  <tr>
-    <td>oci8</td>
-    <td>The default high performance driver. The keys of associative arrays returned in a recordset are upper-case.</td>
-  </tr>
-  <tr>
-    <td>oci8po</td>
-    <td> The portable Oracle driver. Slightly slower than oci8. This driver uses ? instead of :<i>bindvar</i> for binding variables, which is the standard for  other databases. Also the keys of associative arrays are in lower-case like other databases.</td>
-  </tr>
-</table>
-<p>Here's an example of calling the <i>oci8po</i> driver. Note that the bind variables use question-mark:</p>
-<pre>$db = NewADOConnection('oci8po');
-$db-&gt;Connect($tns, $user, $pwd);
-$db-&gt;Execute(&quot;insert into atable (f1, f2) values (?,?)&quot;, array(12, 'abc'));</pre>
-<p>&nbsp;<a name=connecting></a>
-<h3>9. Connecting to Oracle</h3>
-<p>Before you can use ADOdb, you need to have the Oracle client installed and setup the oci8 extension. This extension comes pre-compiled for Windows (but you still need to enable it in the php.ini file). For information on compiling the oci8 extension for PHP and Apache on Unix, there is an excellent guide at <a href="http://www.oracle.com/technology/tech/opensource/php/apache/inst_php_apache_linux.html">oracle.com</a>. </p>
-<h4>Should You Use Persistent Connections</h4>
-<p>One question that is frequently asked is should you use persistent connections to Oracle. Persistent connections allow PHP to recycle existing connections, reusing them after the previous web pages have completed. Non-persistent connections close automatically after the web page has completed. Persistent connections are faster because the cost of reconnecting is expensive, but there is additional resource overhead. As an alternative, Oracle allows you to pool and reuse server processes; this is called  <a href="http://www.cise.ufl.edu/help/database/oracle-docs/server.920/a96521/manproc.htm#13132">Shared Server</a> (also known as MTS).</p>
-<p>The author's benchmarks suggest that using non-persistent connections and the  Shared Server configuration offer the best performance. If Shared Server is not an option, only then consider using persistent connections.</p>
-<h4>Connection Examples</h4>
-<p>Just in case you are having problems connecting to Oracle, here are some examples:</p>
-<p>a. PHP and Oracle reside on the same machine, use default SID, with non-persistent connections:</p>
-<pre>	$conn = NewADOConnection('oci8');
-	$conn-&gt;Connect(false, 'scott', 'tiger');</pre>
-<p>b. TNS Name defined in tnsnames.ora (or ONAMES or HOSTNAMES), eg. 'myTNS', using persistent connections:</p>
-<pre>	$conn = NewADOConnection('oci8');
-	$conn-&gt;PConnect(false, 'scott', 'tiger', 'myTNS');</pre>
-<p>or</p>
-<pre> 	$conn-&gt;PConnect('myTNS', 'scott', 'tiger');</pre>
-<p>c. Host Address and SID</p>
-<pre>
-	$conn->connectSID = true;	
-	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'SID');</pre>
-<p>d. Host Address and Service Name</p>
-<pre>	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'servicename');</pre>
-<p>e. Oracle connection string:
-<pre>	$cstr = "(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=$host)(PORT=$port))
-			(CONNECT_DATA=(SID=$sid)))";
-	$conn-&gt;Connect($cstr, 'scott', 'tiger');
-</pre>
-<p>f. ADOdb data source names (dsn):
-<pre>
-	$dsn = 'oci8://user:pwd@tnsname/?persist';  # persist is optional
-	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect
-	
-	$dsn = 'oci8://user:pwd@host/sid';
-	$conn = ADONewConnection($dsn);
-	
-	$dsn = 'oci8://user:pwd@/';   # oracle on local machine
-	$conn = ADONewConnection($dsn);</pre>
-<p>With ADOdb data source names,
-you don't have to call Connect( ) or PConnect( ).
-</p>
-<p>&nbsp;</p>
-<h3>10. Error Checking</h3>
-<p>The examples in this article are easy to read but a bit simplistic because we ignore error-handling. Execute( ) and Connect( ) will return false on error. So a more realistic way to call Connect( ) and Execute( ) is:
-<pre>function InvokeErrorHandler()
-{<br>global $db; ## assume global
-    MyLogFunction($db-&gt;ErrorNo(), $db-&gt;ErrorMsg());
-}
-if (!$db-&gt;Connect($tns, $usr, $pwd)) InvokeErrorHandler();
-
-$rs = $db->Execute("select * from emp where empno>:emp order by empno", 
-                    array('emp' => 7900));
-if (!$rs) return InvokeErrorHandler();
-while ($arr = $rs->FetchRow()) {
-    print_r($arr);
-	echo "&lt;hr>";
-}
-</pre>
-<p>You can retrieve the  error message and error number of the last SQL statement executed from ErrorMsg( ) and ErrorNo( ). You can also <a href=http://phplens.com/adodb/using.custom.error.handlers.and.pear_error.html>define a custom error handler function</a>.
-ADOdb also supports throwing exceptions in PHP5.
-<p>&nbsp;</p>
-<h3>Handling Large Recordsets (added 27 May 2005)</h3>
-The oci8 driver does not support counting the number of records returned in a SELECT statement, so the function RecordCount() 
-is emulated when the global variable $ADODB_COUNTRECS is set to true, which is the default. 
-We emulate this by buffering all the records. This can take up large amounts of memory for big recordsets.
- Set $ADODB_COUNTRECS to false for the best performance. 
- <p>
-This variable is checked every time a query is executed, so you can selectively choose which recordsets to count.
-<p>&nbsp;</p>
-<h3>11. Other ADOdb Features</h3>
-<p><a href="http://phplens.com/lens/adodb/docs-datadict.htm">Schema generation</a>. This allows you to define a schema using XML and import it into different RDBMS systems portably.</p>
-<p><a href="http://phplens.com/lens/adodb/docs-perf.htm">Performance monitoring and tracing</a>. Highlights of performance monitoring include identification of poor and suspicious SQL, with explain plan support, and identifying which web pages the SQL ran on.</p>
-<p>&nbsp;</p>
-<h3>12. Download</h3>
-<p>You can <a href="http://adodb.sourceforge.net/#download">download ADOdb from sourceforge</a>. ADOdb uses a BSD style license. That means that it is free for commercial use, and redistribution without source code is allowed.</p>
-<p>&nbsp;</p>
-<h3>13. Resources</h3>
-<ul>
-  <li>Oracle's <a href="http://www.oracle.com/technology/pub/articles/php_experts/index.html">Hitchhiker Guide to PHP</a></li>
-  <li>OTN article on <a href=http://www.oracle.com/technology/pub/articles/deployphp/lim_deployphp.html>Optimizing PHP and Oracle</a> by this author.
-  <li>Oracle has an excellent <a href="http://www.oracle.com/technology/tech/opensource/php/php_troubleshooting_faq.html">FAQ on PHP</a></li>
-  <li>PHP <a href="http://php.net/oci8">oci8</a> manual pages</li>
-  <li><a href=http://phplens.com/lens/lensforum/topics.php?id=4>ADOdb forums</a>.
-</ul>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+<head>
+<style>
+pre {
+  background-color: #eee;
+  padding: 0.75em 1.5em;
+  font-size: 12px;
+  border: 1px solid #ddd;
+}
+.greybg {
+  background-color: #eee;
+  padding: 0.75em 1.5em;
+  font-size: 12px;
+  border: 1px solid #ddd;
+}
+.style1 {color: #660000}
+</style>
+<title>ADOdb with PHP and Oracle</title>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
+</style>
+</head>
+
+<body>
+<table width=100%><tr><td>
+<h2>Using ADOdb with PHP and Oracle: an advanced tutorial</h2>
+</td><td><div align="right"><img src=cute_icons_for_site/adodb.gif width="88" height="31"></div></tr></table>
+<p><font size="1">(c)2004-2005 John Lim. All rights reserved.</font></p>
+<h3>1. Introduction</h3>
+<p>Oracle is the most popular commercial database used with PHP. There are many ways of accessing Oracle databases in PHP. These include:</p>
+<ul>
+  <li>The oracle extension</li>
+  <li>The oci8 extension</li>
+  <li>PEAR DB library</li>
+  <li>ADOdb library</li>
+</ul>
+<p>The wide range of choices is confusing to someone just starting with Oracle and PHP. I will briefly summarize the differences, and  show you the advantages of using <a href="http://adodb.sourceforge.net/">ADOdb</a>. </p>
+<p>First we have the C extensions which provide low-level access to Oracle functionality. These C extensions are precompiled into PHP, or linked in dynamically when the web server starts up. Just in case you need it, here's a <a href=http://www.oracle.com/technology/tech/opensource/php/apache/inst_php_apache_linux.html>guide to installing Oracle and PHP on Linux</a>.</p>
+<table width="75%" border="1" align="center">
+  <tr valign="top">
+    <td nowrap><b>Oracle extension</b></td>
+    <td>Designed for Oracle 7 or earlier. This is obsolete.</td>
+  </tr>
+  <tr valign="top">
+    <td nowrap><b>Oci8 extension</b></td>
+    <td> Despite it's name, which implies it is only for Oracle 8i, this is the standard method for accessing databases running Oracle 8i, 9i or 10g (and later).</td>
+  </tr>
+</table>
+<p>Here is an example of using the oci8 extension to query the <i>emp</i> table of the <i>scott</i> schema with bind parameters:
+<pre>
+$conn = OCILogon("scott","tiger", $tnsName); 
+
+$stmt = OCIParse($conn,"select * from emp where empno > :emp order by empno"); 
+$emp = 7900;
+OCIBindByName($stmt, ':emp', $emp);
+$ok = OCIExecute($stmt);
+while (OCIFetchInto($stmt,$arr)) {
+	print_r($arr);
+	echo "&lt;hr>";	
+} 
+</pre>
+<p>This generates the following output:
+<div class=greybg>
+Array ( [0] => 7902 [1] => FORD [2] => ANALYST [3] => 7566 [4] => 03/DEC/81 [5] => 3000 [7] => 20 ) 
+<hr />
+  Array ( [0] => 7934 [1] => MILLER [2] => CLERK [3] => 7782 [4] => 23/JAN/82 [5] => 1300 [7] => 10 )
+</div>
+<p>We also have  many higher level PHP libraries that allow you to simplify the above code. The most popular are <a href="http://pear.php.net/">PEAR DB</a> and <a href="http://adodb.sourceforge.net/">ADOdb</a>.  Here are some of the differences between these libraries:</p>
+<table width="75%" border="1" align="center">
+  <tr>
+    <td><b>Feature</b></td>
+    <td><b>PEAR DB 1.6</b></td>
+    <td><b>ADOdb 4.52</b></td>
+  </tr>
+  <tr valign="top">
+    <td>General Style</td>
+    <td>Simple, easy to use. Lacks Oracle specific functionality.</td>
+    <td>Has multi-tier design. Simple high-level design for beginners, and also lower-level advanced Oracle functionality.</td>
+  </tr>
+  <tr valign="top">
+    <td>Support for Prepare</td>
+    <td>Yes, but only on one statement, as the last prepare overwrites previous prepares.</td>
+    <td>Yes (multiple simultaneous prepare's allowed)</td>
+  </tr>
+  <tr valign="top">
+    <td>Support for LOBs</td>
+    <td>No</td>
+    <td>Yes, using update semantics</td>
+  </tr>
+  <tr valign="top">
+    <td>Support for REF Cursors</td>
+    <td>No</td>
+    <td>Yes</td>
+  </tr>
+  <tr valign="top">
+    <td>Support for IN Parameters</td>
+    <td>Yes</td>
+    <td>Yes</td>
+  </tr>
+  <tr valign="top">
+    <td>Support for OUT Parameters</td>
+    <td>No</td>
+    <td>Yes</td>
+  </tr>
+  <tr valign="top">
+    <td>Schema creation using XML</td>
+    <td>No</td>
+    <td>Yes, including ability to define tablespaces and constraints</td>
+  </tr>
+  <tr valign="top">
+    <td>Provides database portability features</td>
+    <td>No</td>
+    <td>Yes, has some ability to abstract features that differ between databases such as dates, bind parameters, and data types.</td>
+  </tr>
+  <tr valign="top">
+    <td>Performance monitoring and tracing</td>
+    <td>No</td>
+    <td>Yes. SQL can be traced and linked to web page it was executed on. Explain plan support included.</td>
+  </tr>
+  <tr valign="top">
+    <td>Recordset caching for frequently used queries</td>
+    <td>No</td>
+    <td>Yes. Provides great speedups for SQL involving complex <i>where, group-by </i>and <i>order-by</i> clauses.</td>
+  </tr>
+  <tr valign="top">
+    <td>Popularity</td>
+    <td>Yes, part of PEAR release</td>
+    <td>Yes, many open source projects are using this software, including PostNuke, Xaraya, Mambo, Tiki Wiki.</td>
+  </tr>
+  <tr valign="top">
+    <td>Speed</td>
+    <td>Medium speed.</td>
+    <td>Very high speed. Fastest database abstraction library available for PHP. <a href="http://phplens.com/lens/adodb/">Benchmarks are available</a>.</td>
+  </tr>
+  <tr valign="top">
+    <td>High Speed Extension available</td>
+    <td>No</td>
+    <td>Yes. You can install the optional ADOdb extension, which reimplements the most frequently used parts of ADOdb as fast C code. Note that the source code version of ADOdb runs just fine without this extension, and only makes use of the extension if detected.</td>
+  </tr>
+</table>
+<p> PEAR DB is good enough for simple web apps. But if you need more power, you can see ADOdb offers more sophisticated functionality. The rest of this article will concentrate on using ADOdb with Oracle. You can find out more about <a href="#connecting">connecting to Oracle</a> later in this guide.</p>
+<h4>ADOdb Example</h4>
+<p>In ADOdb, the above oci8 example querying the <i>emp</i> table could be written as:</p>
+<pre>
+include "/path/to/adodb.inc.php";
+$db = NewADOConnection("oci8");
+$db->Connect($tnsName, "scott", "tiger");
+
+$rs = $db->Execute("select * from emp where empno>:emp order by empno", 
+                    array('emp' => 7900));
+while ($arr = $rs->FetchRow()) {
+    print_r($arr);
+	echo "&lt;hr>";
+}
+</pre>
+<p>The Execute( ) function returns a recordset object, and you can retrieve the rows returned using $recordset-&gt;FetchRow( ). </p>
+<p>If we ignore the initial connection preamble, we can see the ADOdb version is much easier and simpler:</p>
+<table width="100%" border="1">
+  <tr valign="top" bgcolor="#FFFFFF">
+    <td width="50%" bgcolor="#e0e0e0"><b>Oci8</b></td>
+    <td bgcolor="#e0e0e0"><b>ADOdb</b></td>
+  </tr>
+  <tr valign="top" bgcolor="#CCCCCC">
+    <td><pre><font size="1">$stmt = <b>OCIParse</b>($conn,
+       "select * from emp where empno > :emp"); 
+$emp = 7900;
+<b>OCIBindByName</b>($stmt, ':emp', $emp);
+$ok = <b>OCIExecute</b>($stmt);
+
+while (<b>OCIFetchInto</b>($stmt,$arr)) {
+	print_r($arr);
+	echo "&lt;hr>";	
+} </font></pre></td>
+    <td><pre><font size="1">$recordset = $db-><b>Execute</b>("select * from emp where empno>:emp", 
+                           array('emp' => 7900));
+
+while ($arr = $recordset-><b>FetchRow</b>()) {
+	print_r($arr);
+	echo "&lt;hr>";
+}</font></pre></td>
+  </tr>
+</table>
+<p>&nbsp;</p>
+<h3>2. ADOdb Query Semantics</h3>
+<p>You can also query the database using the standard Microsoft ADO MoveNext( ) metaphor. The data array for the current row is stored in the <i>fields</i> property of the recordset object, $rs.
+MoveNext( ) offers the highest performance among all the techniques for iterating through a recordset:
+<pre>
+$rs = $db->Execute("select * from emp where empno>:emp", array('emp' => 7900));
+while (!$rs->EOF) {
+	print_r($rs->fields);
+	$rs->MoveNext();
+}
+</pre>
+<p>And if you are interested in having the data returned in a 2-dimensional array, you can use:
+<pre>
+$arr = $db->GetArray("select * from emp where empno>:emp", array('emp' => 7900));
+</pre>
+<p>Now to obtain only the first row as an array:
+<pre>
+$arr = $db->GetRow("select * from emp where empno=:emp", array('emp' => 7900));
+</pre>
+<p>Or to retrieve only the first field of the first row:
+<pre>
+$arr = $db->GetOne("select ename from emp where empno=:emp", array('emp' => 7900));
+</pre>
+<p>For easy pagination support, we provide the SelectLimit function. The following will perform a select query, limiting it to 100 rows, starting from row 201 (row 1 being the 1st row):
+<pre>
+$offset = 200; $limitrows = 100;
+$rs = $db->SelectLimit('select * from table', $limitrows, $offset);
+</pre>
+<p>The $offset parameter is optional.
+<h4>Array Fetch Mode</h4>
+<p>When data is being returned in an array, you can choose the type of array the data is returned in. 
+<ol>
+  <li> Numeric indexes - use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_NUM).</font></li>
+  <li>Associative indexes - the keys of the array are the names of the fields (in upper-case). Use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_ASSOC)</font><font face="Courier New, Courier, mono">.</font></li>
+  <li>Both numeric and associative indexes - use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_BOTH).</font></li>
+</ol>
+<p>The default is ADODB_FETCH_BOTH for Oracle.</p>
+<h4><b>Caching</b></h4>
+<p>You can define a database cache directory using $ADODB_CACHE_DIR, and cache the results of frequently used queries that rarely change. This is particularly useful for SQL with complex where clauses and group-by's and order-by's. It is also good for relieving heavily-loaded database servers.</p>
+<p>This example will cache the following select statement for 3600 seconds (1 hour):</p>
+<pre>
+$ADODB_CACHE_DIR = '/var/adodb/tmp';
+$rs = $db->CacheExecute(3600, "select names from allcountries order by 1");
+</pre>
+There are analogous CacheGetArray(
+), CacheGetRow( ),  CacheGetOne( ) and CacheSelectLimit( )  functions. The first parameter is the number of seconds to cache. You can also pass a bind array as a 3rd parameter (not shown above).
+<p>There is an alternative syntax for the caching functions. The first parameter is omitted, and you set the cacheSecs
+ property of the connection object:
+<pre>
+$ADODB_CACHE_DIR = '/var/adodb/tmp';
+$connection->cacheSecs = 3600;
+$rs = $connection->CacheExecute($sql, array('id' => 1));
+</pre>
+<h3>&nbsp;</h3>
+<h3>3. Using Prepare( ) For Frequently Used Statements</h3>
+<p>Prepare( ) is  for compiling frequently used  SQL statement for reuse. For example, suppose we have a large array which needs to be inserted into an Oracle database. The following will result in a massive speedup in query execution (at least 20-40%), as the SQL statement only needs to be compiled once:</p>
+<pre>
+$stmt = $db->Prepare('insert into table (field1, field2) values (:f1, :f2)');
+foreach ($arrayToInsert as $key => $value) {
+	$db->Execute($stmt, array('f1' => $key, 'f2' => $val);
+}
+</pre>
+<p>&nbsp;</p>
+<h3>4. Working With LOBs</h3>
+<p>Oracle treats data which is more than 4000 bytes in length specially. These are called Large Objects, or LOBs for short. Binary LOBs are BLOBs, and character LOBs are CLOBs. In most Oracle libraries, you need to do a lot of work to process LOBs, probably because Oracle designed it to work in systems with little memory. ADOdb tries to make things easy by assuming the LOB can fit into main memory. </p>
+<p>ADOdb will transparently handle LOBs  in <i>select</i> statements. The LOBs are automatically converted to PHP variables without any special coding.</p>
+<p>For updating records with LOBs, the functions UpdateBlob( ) and UpdateClob( ) are provided. Here's a BLOB example. The parameters should be self-explanatory:
+<pre>
+$ok = $db->Execute("insert into aTable (id, name, ablob) 
+                                values (aSequence.nextVal, 'Name', null)");
+if (!$ok) return LogError($db-&gt;ErrorMsg());
+<font color="#006600"># params: $tableName, $blobFieldName, $blobValue, $whereClause</font>
+$db->UpdateBlob('aTable', 'ablob', $blobValue, 'id=aSequence.currVal');
+</pre>
+<p>and the analogous CLOB example:
+<pre>
+$ok = $db->Execute("insert into aTable (id, name, aclob) 
+                                values (aSequence.nextVal, 'Name', null)");
+if (!$ok) return LogError($db-&gt;ErrorMsg());
+$db->UpdateClob('aTable', 'aclob', $clobValue, 'id=aSequence.currVal');
+</pre>
+<p>Note that LogError( ) is a user-defined function, and not part of ADOdb.
+<p>Inserting LOBs is more complicated. Since ADOdb 4.55, we allow you to do this
+  (assuming that the <em>photo</em> field is a BLOB, and we want to store $blob_data into
+  this field, and the primary key is the <em>id</em> field):
+<pre>
+	$sql = <span class="style1">"INSERT INTO photos ( ID, photo) ".
+			"VALUES ( :id, empty_blob() )".
+			" RETURNING photo INTO :xx"</span>;
+
+ 		$stmt = $db->PrepareSP($sql);
+		$db->InParameter($stmt, $<strong>id</strong>, <span class="style1">'id'</span>);
+		$blob = $db->InParameter($stmt, $<strong>blob_data</strong>, <span class="style1">'xx'</span>,-1, OCI_B_BLOB);
+		$db->StartTrans();
+		$ok = $db->Execute($stmt);
+		$db->CompleteTrans();
+</pre> 
+<p>
+<h3>5. REF CURSORs</h3>
+<p>Oracle recordsets can be passed around as variables called REF Cursors. For example, in PL/SQL, we could define a function <i>open_tab</i> that returns a REF CURSOR in the first parameter:</p>
+<pre>
+TYPE TabType IS REF CURSOR RETURN TAB%ROWTYPE;
+
+PROCEDURE open_tab (tabcursor IN OUT TabType,tablenames IN VARCHAR) IS
+	BEGIN
+		OPEN tabcursor FOR SELECT * FROM TAB WHERE tname LIKE tablenames;
+	END open_tab;
+</pre>
+<p>In ADOdb, we could access this REF Cursor using the ExecuteCursor() function. The following will find
+ all table names that begin with 'A' in the current schema:
+<pre>
+$rs = $db->ExecuteCursor("BEGIN open_tab(:refc,'A%'); END;",'refc');
+while ($arr = $rs->FetchRow()) print_r($arr);
+</pre>
+<p>The first parameter is the PL/SQL statement, and the second parameter is the name of the REF Cursor.
+</p>
+<p>&nbsp;</p>
+<h3>6. In and Out Parameters</h3>
+<p>The following PL/SQL
+stored procedure  requires an input  variable, and returns a result into an output variable:
+<pre>
+PROCEDURE data_out(input IN VARCHAR, output OUT VARCHAR) IS
+	BEGIN
+		output := 'I love '||input;
+	END;
+</pre>
+<p>The following ADOdb code allows you to call the stored procedure:</p>
+<pre>
+$stmt = $db->PrepareSP("BEGIN adodb.data_out(:a1, :a2); END;");
+$input = 'Sophia Loren';
+$db->InParameter($stmt,$input,'a1');
+$db->OutParameter($stmt,$output,'a2');
+$ok = $db->Execute($stmt);
+if ($ok) echo ($output == 'I love Sophia Loren') ? 'OK' : 'Failed';
+</pre>
+<p>PrepareSP( ) is a special function that knows about bind parameters.
+The main limitation currently is that IN OUT parameters do not work.
+<h4>Bind Parameters and REF CURSORs</h4>
+<p>We could also rewrite the REF CURSOR example to use InParameter (requires ADOdb 4.53 or later):
+<pre>
+$stmt = $db->PrepareSP("BEGIN adodb.open_tab(:refc,:tabname); END;");
+$input = 'A%';
+$db->InParameter($stmt,$input,'tabname');
+$rs = $db->ExecuteCursor($stmt,'refc');
+while ($arr = $rs->FetchRow()) print_r($arr);
+</pre>
+<h4>Bind Parameters and LOBs</h4>
+<p>You can also operate on LOBs. In this example, we have IN and OUT parameters using CLOBs. 
+<pre>
+	$text = 'test test test';
+	$sql = "declare rs clob; begin :rs := lobinout(:sa0); end;";
+	$stmt = $conn -> PrepareSP($sql);
+	$conn -> InParameter($stmt,$text,'sa0', -1, OCI_B_CLOB); # -1 means variable length
+	$rs = '';
+	$conn -> OutParameter($stmt,$rs,'rs', -1, OCI_B_CLOB);
+	$conn -> Execute($stmt);
+	echo "return = ".$rs."&lt;br>";
+</pre>
+<p>Similarly, you can use the constant OCI_B_BLOB to indicate that you are using BLOBs.
+<h4>Reusing Bind Parameters with CURSOR_SHARING=FORCE</h4>
+<p>Many web programmers do not care to use bind parameters, and prefer to enter the SQL directly. So instead of:</p>
+<pre>
+$arr = $db->GetArray("select * from emp where empno>:emp", array('emp' => 7900));
+</pre>
+<p>They prefer  entering the values inside the SQL:
+<pre>
+$arr = $db->GetArray("select * from emp where empno>7900");
+</pre>
+<p>This reduces Oracle performance because Oracle will reuse compiled SQL which is identical to previously compiled SQL. The above example with the values inside the SQL
+is unlikely to be reused. As an optimization, from Oracle 8.1 onwards, you can set the following session parameter after you login:
+<pre>
+ALTER SESSION SET CURSOR_SHARING=FORCE
+</pre>
+<p>This will force Oracle to convert all such variables (eg. the 7900 value) into constant bind parameters, improving SQL reuse.</p>
+<p>More <a href="http://phplens.com/adodb/code.initialization.html#speed">speedup tips</a>.</p>
+<p>&nbsp;</p>
+<h3>7. Dates and Datetime in ADOdb</h3>
+<p>There are two things you need to know about dates in ADOdb. </p>
+<p>First, to ensure cross-database compability, ADOdb assumes that dates are returned in ISO format (YYYY-MM-DD H24:MI:SS).</p>
+<p>Secondly, since Oracle treats dates and datetime as the same data type, we decided not to display the time in the default date format. So on login, ADOdb will set the NLS_DATE_FORMAT to 'YYYY-MM-DD'. If you prefer to show the date and time by default, do this:</p>
+<pre>
+$db = NewADOConnection('oci8');
+$db->NLS_DATE_FORMAT =  'RRRR-MM-DD HH24:MI:SS';
+$db->Connect($tns, $user, $pwd);
+</pre>
+<p>Or execute:</p>
+<pre>$sql = quot;ALTER SESSION SET NLS_DATE_FORMAT = 'RRRR-MM-DD HH24:MI:SS'&quot;;
+$db-&gt;Execute($sql);
+</pre>
+<p>If you are not concerned about date portability and do not use ADOdb's portability layer, you can use your preferred date format instead.
+<p>
+<h3>8. Database Portability Layer</h3>
+<p>ADOdb provides the following functions for portably generating SQL functions 
+  as strings to be merged into your SQL statements:</p>
+<table width="75%" border="1" align=center>
+  <tr> 
+    <td width=30%><b>Function</b></td>
+    <td><b>Description</b></td>
+  </tr>
+  <tr> 
+    <td>DBDate($date)</td>
+    <td>Pass in a UNIX timestamp or ISO date and it will convert it to a date 
+      string formatted for INSERT/UPDATE</td>
+  </tr>
+  <tr> 
+    <td>DBTimeStamp($date)</td>
+    <td>Pass in a UNIX timestamp or ISO date and it will convert it to a timestamp 
+      string formatted for INSERT/UPDATE</td>
+  </tr>
+  <tr> 
+    <td>SQLDate($date, $fmt)</td>
+    <td>Portably generate a date formatted using $fmt mask, for use in SELECT 
+      statements.</td>
+  </tr>
+  <tr> 
+    <td>OffsetDate($date, $ndays)</td>
+    <td>Portably generate a $date offset by $ndays.</td>
+  </tr>
+  <tr> 
+    <td>Concat($s1, $s2, ...)</td>
+    <td>Portably concatenate strings. Alternatively, for mssql use mssqlpo driver, 
+      which allows || operator.</td>
+  </tr>
+  <tr> 
+    <td>IfNull($fld, $replaceNull)</td>
+    <td>Returns a string that is the equivalent of MySQL IFNULL or Oracle NVL.</td>
+  </tr>
+  <tr>
+    <td>Param($name)</td>
+    <td>Generates bind placeholders, using ? or named conventions as appropriate.</td>
+  </tr>
+  <tr><td>$db->sysDate</td><td>Property that holds the SQL function that returns today's date</td>
+</tr>
+<tr><td>$db->sysTimeStamp</td><td>Property that holds the SQL function that returns the current
+timestamp (date+time).
+</td>
+</tr>
+<tr>
+<td>$db->concat_operator</td><td>Property that holds the concatenation operator
+</td>
+</tr>
+<tr><td>$db->length</td><td>Property that holds the name of the SQL strlen function.
+</td></tr>
+
+<tr><td>$db->upperCase</td><td>Property that holds the name of the SQL strtoupper function.
+</td></tr>
+<tr><td>$db->random</td><td>Property that holds the SQL to generate a random number between 0.00 and 1.00.
+</td>
+</tr>
+<tr><td>$db->substr</td><td>Property that holds the name of the SQL substring function.
+</td></tr>
+</table>
+<p>ADOdb also provides multiple oracle oci8 drivers for different scenarios:</p>
+<table width="75%" border="1" align="center">
+  <tr>
+    <td nowrap><b>Driver Name</b></td>
+    <td><b>Description</b></td>
+  </tr>
+  <tr>
+    <td>oci805 </td>
+    <td>Specifically for Oracle 8.0.5. This driver has a slower SelectLimit( ).</td>
+  </tr>
+  <tr>
+    <td>oci8</td>
+    <td>The default high performance driver. The keys of associative arrays returned in a recordset are upper-case.</td>
+  </tr>
+  <tr>
+    <td>oci8po</td>
+    <td> The portable Oracle driver. Slightly slower than oci8. This driver uses ? instead of :<i>bindvar</i> for binding variables, which is the standard for  other databases. Also the keys of associative arrays are in lower-case like other databases.</td>
+  </tr>
+</table>
+<p>Here's an example of calling the <i>oci8po</i> driver. Note that the bind variables use question-mark:</p>
+<pre>$db = NewADOConnection('oci8po');
+$db-&gt;Connect($tns, $user, $pwd);
+$db-&gt;Execute(&quot;insert into atable (f1, f2) values (?,?)&quot;, array(12, 'abc'));</pre>
+<p>&nbsp;<a name=connecting></a>
+<h3>9. Connecting to Oracle</h3>
+<p>Before you can use ADOdb, you need to have the Oracle client installed and setup the oci8 extension. This extension comes pre-compiled for Windows (but you still need to enable it in the php.ini file). For information on compiling the oci8 extension for PHP and Apache on Unix, there is an excellent guide at <a href="http://www.oracle.com/technology/tech/opensource/php/apache/inst_php_apache_linux.html">oracle.com</a>. </p>
+<h4>Should You Use Persistent Connections</h4>
+<p>One question that is frequently asked is should you use persistent connections to Oracle. Persistent connections allow PHP to recycle existing connections, reusing them after the previous web pages have completed. Non-persistent connections close automatically after the web page has completed. Persistent connections are faster because the cost of reconnecting is expensive, but there is additional resource overhead. As an alternative, Oracle allows you to pool and reuse server processes; this is called  <a href="http://www.cise.ufl.edu/help/database/oracle-docs/server.920/a96521/manproc.htm#13132">Shared Server</a> (also known as MTS).</p>
+<p>The author's benchmarks suggest that using non-persistent connections and the  Shared Server configuration offer the best performance. If Shared Server is not an option, only then consider using persistent connections.</p>
+<h4>Connection Examples</h4>
+<p>Just in case you are having problems connecting to Oracle, here are some examples:</p>
+<p>a. PHP and Oracle reside on the same machine, use default SID, with non-persistent connections:</p>
+<pre>	$conn = NewADOConnection('oci8');
+	$conn-&gt;Connect(false, 'scott', 'tiger');</pre>
+<p>b. TNS Name defined in tnsnames.ora (or ONAMES or HOSTNAMES), eg. 'myTNS', using persistent connections:</p>
+<pre>	$conn = NewADOConnection('oci8');
+	$conn-&gt;PConnect(false, 'scott', 'tiger', 'myTNS');</pre>
+<p>or</p>
+<pre> 	$conn-&gt;PConnect('myTNS', 'scott', 'tiger');</pre>
+<p>c. Host Address and SID</p>
+<pre>
+	$conn->connectSID = true;	
+	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'SID');</pre>
+<p>d. Host Address and Service Name</p>
+<pre>	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'servicename');</pre>
+<p>e. Oracle connection string:
+<pre>	$cstr = "(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=$host)(PORT=$port))
+			(CONNECT_DATA=(SID=$sid)))";
+	$conn-&gt;Connect($cstr, 'scott', 'tiger');
+</pre>
+<p>f. ADOdb data source names (dsn):
+<pre>
+	$dsn = 'oci8://user:pwd@tnsname/?persist';  # persist is optional
+	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect
+	
+	$dsn = 'oci8://user:pwd@host/sid';
+	$conn = ADONewConnection($dsn);
+	
+	$dsn = 'oci8://user:pwd@/';   # oracle on local machine
+	$conn = ADONewConnection($dsn);</pre>
+<p>With ADOdb data source names,
+you don't have to call Connect( ) or PConnect( ).
+</p>
+<p>&nbsp;</p>
+<h3>10. Error Checking</h3>
+<p>The examples in this article are easy to read but a bit simplistic because we ignore error-handling. Execute( ) and Connect( ) will return false on error. So a more realistic way to call Connect( ) and Execute( ) is:
+<pre>function InvokeErrorHandler()
+{<br>global $db; ## assume global
+    MyLogFunction($db-&gt;ErrorNo(), $db-&gt;ErrorMsg());
+}
+if (!$db-&gt;Connect($tns, $usr, $pwd)) InvokeErrorHandler();
+
+$rs = $db->Execute("select * from emp where empno>:emp order by empno", 
+                    array('emp' => 7900));
+if (!$rs) return InvokeErrorHandler();
+while ($arr = $rs->FetchRow()) {
+    print_r($arr);
+	echo "&lt;hr>";
+}
+</pre>
+<p>You can retrieve the  error message and error number of the last SQL statement executed from ErrorMsg( ) and ErrorNo( ). You can also <a href=http://phplens.com/adodb/using.custom.error.handlers.and.pear_error.html>define a custom error handler function</a>.
+ADOdb also supports throwing exceptions in PHP5.
+<p>&nbsp;</p>
+<h3>Handling Large Recordsets (added 27 May 2005)</h3>
+The oci8 driver does not support counting the number of records returned in a SELECT statement, so the function RecordCount() 
+is emulated when the global variable $ADODB_COUNTRECS is set to true, which is the default. 
+We emulate this by buffering all the records. This can take up large amounts of memory for big recordsets.
+ Set $ADODB_COUNTRECS to false for the best performance. 
+ <p>
+This variable is checked every time a query is executed, so you can selectively choose which recordsets to count.
+<p>&nbsp;</p>
+<h3>11. Other ADOdb Features</h3>
+<p><a href="http://phplens.com/lens/adodb/docs-datadict.htm">Schema generation</a>. This allows you to define a schema using XML and import it into different RDBMS systems portably.</p>
+<p><a href="http://phplens.com/lens/adodb/docs-perf.htm">Performance monitoring and tracing</a>. Highlights of performance monitoring include identification of poor and suspicious SQL, with explain plan support, and identifying which web pages the SQL ran on.</p>
+<p>&nbsp;</p>
+<h3>12. Download</h3>
+<p>You can <a href="http://adodb.sourceforge.net/#download">download ADOdb from sourceforge</a>. ADOdb uses a BSD style license. That means that it is free for commercial use, and redistribution without source code is allowed.</p>
+<p>&nbsp;</p>
+<h3>13. Resources</h3>
+<ul>
+  <li>Oracle's <a href="http://www.oracle.com/technology/pub/articles/php_experts/index.html">Hitchhiker Guide to PHP</a></li>
+  <li>OTN article on <a href=http://www.oracle.com/technology/pub/articles/deployphp/lim_deployphp.html>Optimizing PHP and Oracle</a> by this author.
+  <li>Oracle has an excellent <a href="http://www.oracle.com/technology/tech/opensource/php/php_troubleshooting_faq.html">FAQ on PHP</a></li>
+  <li>PHP <a href="http://php.net/oci8">oci8</a> manual pages</li>
+  <li><a href=http://phplens.com/lens/lensforum/topics.php?id=4>ADOdb forums</a>.
+</ul>
+</body>
+</html>
diff --git a/third_party/adodb/docs/docs-perf.htm b/third_party/adodb/docs/docs-perf.htm
index 1713387..fad67c7 100644
--- a/third_party/adodb/docs/docs-perf.htm
+++ b/third_party/adodb/docs/docs-perf.htm
@@ -18,7 +18,7 @@ font-size: 8pt;
 </head>
 <body>
 <h3>The ADOdb Performance Monitoring Library</h3>
-<p>V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my)</p>
+<p>V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com)</p>
 <p><font size="1">This software is dual licensed using BSD-Style and
 LGPL. This means you can use it in compiled proprietary and commercial
 products.</font></p>
@@ -90,7 +90,7 @@ parameters and automated tuning hints.</p>
 supported. To create a new performance monitor, call NewPerfMonitor( )
 as demonstrated below: </p>
 <pre>&lt;?php<br>include_once('adodb.inc.php');<br>session_start(); <font
- color="#006600"># session variables required for monitoring</font><br>$conn = ADONewConnection($driver);<br>$conn-&gt;Connect($server,$user,$pwd,$db);<br>$perf =amp; NewPerfMonitor($conn);<br>$perf-&gt;UI($pollsecs=5);<br>?&gt;<br></pre>
+ color="#006600"># session variables required for monitoring</font><br>$conn = ADONewConnection($driver);<br>$conn-&gt;Connect($server,$user,$pwd,$db);<br>$perf =&amp; NewPerfMonitor($conn);<br>$perf-&gt;UI($pollsecs=5);<br>?&gt;<br></pre>
 <p>It is also possible to retrieve a single database parameter:</p>
 <pre>$size = $perf-&gt;DBParameter('data cache size');<br></pre>
 <p>
diff --git a/third_party/adodb/docs/docs-session.htm b/third_party/adodb/docs/docs-session.htm
index 65baf0f..e6af53c 100644
--- a/third_party/adodb/docs/docs-session.htm
+++ b/third_party/adodb/docs/docs-session.htm
@@ -21,7 +21,7 @@ font-size: 8pt;
 <body style="background-color: rgb(255, 255, 255);">
 <h1>ADODB Session 2 Management Manual</h1>
 <p>
-V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my)
+V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com)
 </p>
 <p> <font size="1">This software is dual licensed using BSD-Style and
 LGPL. This means you can use it in compiled proprietary and commercial
@@ -182,7 +182,7 @@ CREATE TABLE sessions2(
 	  expireref VARCHAR( 250 ) DEFAULT '',
 	  created DATETIME NOT NULL ,
 	  modified DATETIME NOT NULL ,
-	  sessdata LONGTEXT DEFAULT '',
+	  sessdata LONGTEXT,
 	  PRIMARY KEY ( sesskey ) ,
 	  INDEX sess2_expiry( expiry ),
 	  INDEX sess2_expireref( expireref )
@@ -242,7 +242,7 @@ So we define (before session_start() is called): </p>
 	$ADODB_SESSION_EXPIRE_NOTIFY = array('USERID','NotifyFn');
 </font></pre>
 And when the NotifyFn is called (when the session expires), the
-$USERID is passed in as the first parameter, eg. NotifyFn($userid, $sesskey). The
+$EXPIREREF holding the user id is passed in as the first parameter, eg. NotifyFn($userid, $sesskey). The
 session key (which is the primary key of the record in the sessions
 table) is the 2nd parameter.
 <p> Here is an example of a Notification function that deletes some
diff --git a/third_party/adodb/docs/docs-session.old.htm b/third_party/adodb/docs/docs-session.old.htm
index b47f4b1..88eb6c7 100644
--- a/third_party/adodb/docs/docs-session.old.htm
+++ b/third_party/adodb/docs/docs-session.old.htm
@@ -21,7 +21,7 @@ font-size: 8pt;
 <body style="background-color: rgb(255, 255, 255);">
 <h3>ADODB Session Management Manual</h3>
 <p>
-V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my)
+V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com)
 </p>
 <p> <font size="1">This software is dual licensed using BSD-Style and
 LGPL. This means you can use it in compiled proprietary and commercial
diff --git a/third_party/adodb/docs/old-changelog.htm b/third_party/adodb/docs/old-changelog.htm
index 284f3ad..bf8a1af 100644
--- a/third_party/adodb/docs/old-changelog.htm
+++ b/third_party/adodb/docs/old-changelog.htm
@@ -1,822 +1,822 @@
-<html><title>Old Changelog: ADOdb</title><body>
-<h3>Old Changelog</h3>
-
-</p><p><b>3.92 22 Sept 2003</b> 
-</p><p>Added GetAssoc and CacheGetAssoc to connection object.
-</p><p>Removed TextMax and CharMax functions from adodb.inc.php. 
-</p><p>HasFailedTrans() returned false when trans failed. Fixed. 
-</p><p>Moved perf driver classes into adodb/perf/*.php. 
-</p><p>Misc improvements to performance monitoring, including UI(). 
-</p><p>RETVAL in mssql Parameter(), we do not append @ now. 
-</p><p>Added Param($name) to connection class, returns '?' or ":$name", for defining 
-  bind parameters portably. 
-</p><p>LogSQL traps affected_rows() and saves its value properly now. Also fixed oci8 
-  _stmt and _affectedrows() bugs. 
-</p><p>Session code timestamp check for oci8 works now. Formerly default NLS_DATE_FORMAT 
-  stripped off time portion. Thx to Tony Blair (tonanbarbarian#hotmail.com). Also 
-  added new $conn-&gt;datetime field to oci8, controls whether MetaType() returns 
-  'D' ($this-&gt;datetime==false) or 'T' ($this-&gt;datetime == true) for DATE type. 
-</p><p>Fixed bugs in adodb-cryptsession.inc.php and adodb-session-clob.inc.php. 
-</p><p>Fixed misc bugs in adodb_key_exists, GetInsertSQL() and GetUpdateSQL(). 
-</p><p>Tuned include_once handling to reduce file-system checking overhead. 
-</p><p><b>3.91 9 Sept 2003</b> 
-</p><p>Only released to InterAkt 
-</p><p>Added LogSQL() for sql logging and $ADODB_NEWCONNECTION to override factory 
-  for driver instantiation. 
-</p><p>Added IfNull($field,$ifNull) function, thx to johnwilk#juno.com 
-</p><p>Added portable substr support. 
-</p><p>Now rs2html() has new parameter, $echo. Set to false to return $html instead 
-  of echoing it. 
-</p><p><b>3.90 5 Sept 2003</b> 
-</p><p>First beta of performance monitoring released. 
-</p><p>MySQL supports MetaTable() masking. 
-</p><p>Fixed key_exists() bug in adodb-lib.inc.php 
-</p><p>Added sp_executesql Prepare() support to mssql. 
-</p><p>Added bind support to db2. 
-</p><p>Added swedish language file - Christian Tiberg" christian#commsoft.nu 
-</p><p>Bug in drop index for mssql data dict fixed. Thx to Gert-Rainer Bitterlich. 
-</p><p>Left join setting for oci8 was wrong. Thx to johnwilk#juno.com 
-</p><p><b>3.80 27 Aug 2003</b> 
-</p><p>Patch for PHP 4.3.3 cached recordset csv2rs() fread loop incompatibility. 
-</p><p>Added matching mask for MetaTables. Only for oci8, mssql and postgres currently. 
-</p><p>Rewrite of "oracle" driver connection code, merging with "oci8", by Gaetano. 
-</p><p>Added better debugging for Smart Transactions. 
-</p><p>Postgres DBTimeStamp() was wrongly using TO_DATE. Changed to TO_TIMESTAMP. 
-</p><p>ADODB_FETCH_CASE check pushed to ADONewConnection to allow people to define 
-  it after including adodb.inc.php. 
-</p><p>Added portugese (brazilian) to languages. Thx to "Levi Fukumori". 
-</p><p>Removed arg3 parameter from Execute/SelectLimit/Cache* functions. 
-</p><p>Execute() now accepts 2-d array as $inputarray. Also changed docs of fnExecute() 
-  to note change in sql query counting with 2-d arrays. 
-</p><p>Added MONEY to MetaType in PostgreSQL. 
-</p><p>Added more debugging output to CacheFlush(). 
-</p><p><b>3.72 9 Aug 2003</b> 
-</p><p>Added qmagic($str), which is a qstr($str) that auto-checks for magic quotes 
-  and does the right thing... 
-</p><p>Fixed CacheFlush() bug - Thx to martin#gmx.de 
-</p><p>Walt Boring contributed MetaForeignKeys for postgres7. 
-</p><p>_fetch() called _BlobDecode() wrongly in interbase. Fixed. 
-</p><p>adodb_time bug fixed with dates after 2038 fixed by Jason Pell. http://phplens.com/lens/lensforum/msgs.php?id=6980 
-</p><p><b>3.71 4 Aug 2003</b> 
-</p><p>The oci8 driver, MetaPrimaryKeys() did not check the owner correctly when $owner 
-  == false. 
-</p><p>Russian language file contributed by "Cyrill Malevanov" cyrill#malevanov.spb.ru. 
-</p><p>Spanish language file contributed by "Horacio Degiorgi" horaciod#codigophp.com. 
-</p><p>Error handling in oci8 bugfix - if there was an error in Execute(), then when 
-  calling ErrorNo() and/or ErrorMsg(), the 1st call would return the error, but 
-  the 2nd call would return no error. 
-</p><p>Error handling in odbc bugfix. ODBC would always return the last error, even 
-  if it happened 5 queries ago. Now we reset the errormsg to '' and errorno to 
-  0 everytime before CacheExecute() and Execute(). 
-</p><p><b>3.70 29 July 2003</b> 
-</p><p>Added new SQLite driver. Tested on PHP 4.3 and PHP 5. 
-</p><p>Added limited "sapdb" driver support - mainly date support. 
-</p><p>The oci8 driver did not identify NUMBER with no defined precision correctly. 
-</p><p>Added ADODB_FORCE_NULLS, if set, then PHP nulls are converted to SQL nulls 
-  in GetInsertSQL/GetUpdateSQL. 
-</p><p>DBDate() and DBTimeStamp() format for postgresql had problems. Fixed. 
-</p><p>Added tableoptions to ChangeTableSQL(). Thx to Mike Benoit. 
-</p><p>Added charset support to postgresql. Thx to Julian Tarkhanov. 
-</p><p>Changed OS check for MS-Windows to prevent confusion with darWIN (MacOS) 
-</p><p>Timestamp format for db2 was wrong. Changed to yyyy-mm-dd-hh.mm.ss.nnnnnn. 
-</p><p>adodb-cryptsession.php includes wrong. Fixed. 
-</p><p>Added MetaForeignKeys(). Supported by mssql, odbc_mssql and oci8. 
-</p><p>Fixed some oci8 MetaColumns/MetaPrimaryKeys bugs. Thx to Walt Boring. 
-</p><p>adodb_getcount() did not init qryRecs to 0. Missing "WHERE" clause checking 
-  in GetUpdateSQL fixed. Thx to Sebastiaan van Stijn. 
-</p><p>Added support for only 'VIEWS' and "TABLES" in MetaTables. From Walt Boring. 
-</p><p>Upgraded to adodb-xmlschema.inc.php 0.0.2. 
-</p><p>NConnect for mysql now returns value. Thx to Dennis Verspuij. 
-</p><p>ADODB_FETCH_BOTH support added to interbase/firebird. 
-</p><p>Czech language file contributed by Kamil Jakubovic jake#host.sk. 
-</p><p>PostgreSQL BlobDecode did not use _connectionID properly. Thx to Juraj Chlebec. 
-</p><p>Added some new initialization stuff for Informix. Thx to "Andrea Pinnisi" pinnisi#sysnet.it 
-</p><p>ADODB_ASSOC_CASE constant wrong in sybase _fetch(). Fixed. 
-</p><p><b>3.60 16 June 2003</b> 
-</p><p>We now SET CONCAT_NULL_YIELDS_NULL OFF for odbc_mssql driver to be compat with 
-  mssql driver. 
-</p><p>The property $emptyDate missing from connection class. Also changed 1903 to 
-  constant (TIMESTAMP_FIRST_YEAR=100). Thx to Sebastiaan van Stijn. 
-</p><p>ADOdb speedup optimization - we now return all arrays by reference. 
-</p><p>Now DBDate() and DBTimeStamp() now accepts the string 'null' as a parameter. 
-  Suggested by vincent. 
-</p><p>Added GetArray() to connection class. 
-</p><p>Added not_null check in informix metacolumns(). 
-</p><p>Connection parameters for postgresql did not work correctly when port was defined. 
-</p><p>DB2 is now a tested driver, making adodb 100% compatible. Extensive changes 
-  to odbc driver for DB2, including implementing serverinfo() and SQLDate(), switching 
-  to SQL_CUR_USE_ODBC as the cursor mode, and lastAffectedRows and SelectLimit() 
-  fixes. 
-</p><p>The odbc driver's FetchField() field names did not obey ADODB_ASSOC_CASE. Fixed. 
-</p><p>Some bugs in adodb_backtrace() fixed. 
-</p><p>Added "INT IDENTITY" type to adorecordset::MetaType() to support odbc_mssql 
-  properly. 
-</p><p>MetaColumns() for oci8, mssql, odbc revised to support scale. Also minor revisions 
-  to odbc MetaColumns() for vfp and db2 compat. 
-</p><p>Added unsigned support to mysql datadict class. Thx to iamsure. 
-</p><p>Infinite loop in mssql MoveNext() fixed when ADODB_FETCH_ASSOC used. Thx to 
-  Josh R, Night_Wulfe#hotmail.com. 
-</p><p>ChangeTableSQL contributed by Florian Buzin. 
-</p><p>The odbc_mssql driver now sets CONCAT_NULL_YIELDS_NULL OFF for compat with 
-  mssql driver. 
-</p>
-
-<p><b>3.50 19 May 2003</b></p>
-<p>Fixed mssql compat with FreeTDS. FreeTDS does not implement mssql_fetch_assoc(). 
-<p>Merged back connection and recordset code into adodb.inc.php. 
-<p>ADOdb sessions using oracle clobs contributed by achim.gosse#ddd.de. See adodb-session-clob.php. 
-<p>Added /s modifier to preg_match everywhere, which ensures that regex does not 
-  stop at /n. Thx Pao-Hsi Huang. 
-<p>Fixed error in metacolumns() for mssql. 
-<p>Added time format support for SQLDate. 
-<p>Image => B added to metatype. 
-<p>MetaType now checks empty($this->blobSize) instead of empty($this). 
-<p>Datadict has beta support for informix, sybase (mapped to mssql), db2 and generic 
-  (which is a fudge). 
-<p>BlobEncode for postgresql uses pg_escape_bytea, if available. Needed for compat 
-  with 7.3. 
-<p>Added $ADODB_LANG, to support multiple languages in MetaErrorMsg(). 
-<p>Datadict can now parse table definition as declarative text. 
-<p>For DataDict, oci8 autoincrement trigger missing semi-colon. Fixed. 
-<p>For DataDict, when REPLACE flag enabled, drop sequence in datadict for autoincrement 
-  field in postgres and oci8.s 
-<p>Postgresql defaults to template1 database if no database defined in connect/pconnect. 
-<p>We now clear _resultid in postgresql if query fails. 
-<p><b>3.40 19 May 2003</b></p>
-<p>Added insert_id for odbc_mssql. 
-<p>Modified postgresql UpdateBlobFile() because it did not work in safe mode. 
-<p>Now connection object is passed to raiseErrorFn as last parameter. Needed by 
-  StartTrans(). 
-<p>Added StartTrans() and CompleteTrans(). It is recommended that you do not modify 
-  transOff, but use the above functions. 
-<p>oci8po now obeys ADODB_ASSOC_CASE settings. 
-<p>Added virtualized error codes, using PEAR DB equivalents. Requires you to manually 
-  include adodb-error.inc.php yourself, with MetaError() and MetaErrorMsg($errno). 
-<p>GetRowAssoc for mysql and pgsql were flawed. Fix by Ross Smith. 
-<p>Added to datadict types I1, I2, I4 and I8. Changed datadict type 'T' to map 
-  to timestamp instead of datetime for postgresql. 
-<p>Error handling in ExecuteSQLArray(), adodb-datadict.inc.php did not work. 
-<p>We now auto-quote postgresql connection parameters when building connection 
-  string. 
-<p>Added session expiry notification. 
-<p>We now test with odbc mysql - made some changes to odbc recordset constructor. 
-<p>MetaColumns now special cases access and other databases for odbc. 
-<p><b>3.31 17 March 2003</b></p>
-<p>Added row checking for _fetch in postgres. 
-<p>Added Interval type to MetaType for postgres. 
-<p>Remapped postgres driver to call postgres7 driver internally. 
-<p>Adorecordset_array::getarray() did not return array when nRows >= 0. 
-<p>Postgresql: at times, no error message returned by pg_result_error() but error 
-  message returned in pg_last_error(). Recoded again. 
-<p>Interbase blob's now use chunking for updateblob. 
-<p>Move() did not set EOF correctly. Reported by Jorma T. 
-<p>We properly support mysql timestamp fields when we are creating mysql tables 
-  using the data-dict interface. 
-<p>Table regex includes backticks character now. 
-<p><b>3.30 3 March 2003</b></p>
-<p>Added $ADODB_EXTENSION and $ADODB_COMPAT_FETCH constant. 
-<p>Made blank1stItem configurable using syntax "value:text" in GetMenu/GetMenu2. 
-  Thx to Gabriel Birke. 
-<p>Previously ADOdb differed from the Microsoft standard because it did not define 
-  what to set $this->fields when EOF was reached. Now at EOF, ADOdb sets $this->fields 
-  to false for all databases, which is consist with Microsoft's implementation. 
-  Postgresql and mysql have always worked this way (in 3.11 and earlier). If you 
-  are experiencing compatibility problems (and you are not using postgresql nor 
-  mysql) on upgrading to 3.30, try setting the global variables $ADODB_COUNTRECS 
-  = true (which is the default) and $ADODB_FETCH_COMPAT = true (this is a new 
-  global variable). 
-<p>We now check both pg_result_error and pg_last_error as sometimes pg_result_error 
-  does not display anything. Iman Mayes 
-<p> We no longer check for magic quotes gpc in Quote(). 
-<p> Misc fixes for table creation in adodb-datadict.inc.php. Thx to iamsure. 
-<p> Time calculations use adodb_time library for all negative timestamps due to 
-  problems in Red Hat 7.3 or later. Formerly, only did this for Windows. 
-<p> In mssqlpo, we now check if $sql in _query is a string before we change || 
-  to +. This is to support prepared stmts. 
-<p> Move() and MoveLast() internals changed to support to support EOF and $this->fields 
-  change. 
-<p> Added ADODB_FETCH_BOTH support to mssql. Thx to Angel Fradejas afradejas#mediafusion.es 
-<p> We now check if link resource exists before we run mysql_escape_string in 
-  qstr(). 
-<p> Before we flock in csv code, we check that it is not a http url. 
-<p><b>3.20 17 Feb 2003</b></p>
-<p>Added new Data Dictionary classes for creating tables and indexes. Warning 
-  - this is very much alpha quality code. The API can still change. See adodb/tests/test-datadict.php 
-  for more info. 
-<p>We now ignore $ADODB_COUNTRECS for mysql, because PHP truncates incomplete 
-  recordsets when mysql_unbuffered_query() is called a second time. 
-<p>Now postgresql works correctly when $ADODB_COUNTRECS = false. 
-<p>Changed _adodb_getcount to properly support SELECT DISTINCT. 
-<p>Discovered that $ADODB_COUNTRECS=true has some problems with prepared queries 
-  - suspect PHP bug. 
-<p>Now GetOne and GetRow run in $ADODB_COUNTRECS=false mode for better performance. 
-<p>Added support for mysql_real_escape_string() and pg_escape_string() in qstr(). 
-<p>Added an intermediate variable for mysql _fetch() and MoveNext() to store fields, 
-  to prevent overwriting field array with boolean when mysql_fetch_array() returns 
-  false. 
-<p>Made arrays for getinsertsql and getupdatesql case-insensitive. Suggested by 
-  Tim Uckun" tim#diligence.com 
-<p><b>3.11 11 Feb 2003</b></p>
-<p>Added check for ADODB_NEVER_PERSIST constant in PConnect(). If defined, then 
-  PConnect() will actually call non-persistent Connect(). 
-<p>Modified interbase to properly work with Prepare(). 
-<p>Added $this->ibase_timefmt to allow you to change the date and time format. 
-<p>Added support for $input_array parameter in CacheFlush(). 
-<p>Added experimental support for dbx, which was then removed when i found that 
-  it was slower than using native calls. 
-<p>Added MetaPrimaryKeys for mssql and ibase/firebird. 
-<p>Added new $trim parameter to GetCol and CacheGetCol 
-<p>Uses updated adodb-time.inc.php 0.06. 
-<p><b>3.10 27 Jan 2003</b> 
-<p>Added adodb_date(), adodb_getdate(), adodb_mktime() and adodb-time.inc.php. 
-<p>For interbase, added code to handle unlimited number of bind parameters. From 
-  Daniel Hasan daniel#hasan.cl. 
-<p>Added BlobDecode and UpdateBlob for informix. Thx to Fernando Ortiz. 
-<p>Added constant ADODB_WINDOWS. If defined, means that running on Windows. 
-<p>Added constant ADODB_PHPVER which stores php version as a hex num. Removed 
-  $ADODB_PHPVER variable. 
-<p>Felho Bacsi reported a minor white-space regular expression problem in GetInsertSQL. 
-<p>Modified ADO to use variant to store _affectedRows 
-<p>Changed ibase to use base class Replace(). Modified base class Replace() to 
-  support ibase. 
-<p>Changed odbc to auto-detect when 0 records returned is wrong due to bad odbc 
-  drivers. 
-<p>Changed mssql to use datetimeconvert ini setting only when 4.30 or later (does 
-  not work in 4.23). 
-<p>ExecuteCursor($stmt, $cursorname, $params) now accepts a new $params array 
-  of additional bind parameters -- William Lovaton walovaton#yahoo.com.mx. 
-<p>Added support for sybase_unbuffered_query if ADODB_COUNTRECS == false. Thx 
-  to chuck may. 
-<p>Fixed FetchNextObj() bug. Thx to Jorma Tuomainen. 
-<p>We now use SCOPE_IDENTITY() instead of @@IDENTITY for mssql - thx to marchesini#eside.it 
-<p>Changed postgresql movenext logic to prevent illegal row number from being 
-  passed to pg_fetch_array(). 
-<p>Postgresql initrs bug found by "Bogdan RIPA" bripa#interakt.ro $f1 accidentally 
-  named $f 
-<p><b>3.00 6 Jan 2003</b> 
-<p>Fixed adodb-pear.inc.php syntax error. 
-<p>Improved _adodb_getcount() to use SELECT COUNT(*) FROM ($sql) for languages 
-  that accept it. 
-<p>Fixed _adodb_getcount() caching error. 
-<p>Added sql to retrive table and column info for odbc_mssql. 
-<p><strong>2.91 3 Jan 2003</strong> 
-<p>Revised PHP version checking to use $ADODB_PHPVER with legal values 0x4000, 
-  0x4050, 0x4200, 0x4300. 
-<p>Added support for bytea fields and oid blobs in postgres by allowing BlobDecode() 
-  to detect and convert non-oid fields. Also added BlobEncode to postgres when 
-  you want to encode oid blobs. 
-<p>Added blobEncodeType property for connections to inform phpLens what encoding 
-  method to use for blobs. 
-<p>Added BlobDecode() and BlobEncode() to base ADOConnection class. 
-<p>Added umask() to _gencachename() when creating directories. 
-<p>Added charPage for ado drivers, so you can set the code page. 
-<pre>
-$conn->charPage = CP_UTF8;
-$conn->Connect($dsn);
-</pre>
-<p>Modified _seek in mysql to check for num rows=0. 
-<p>Added to metatypes new informix types for IDS 9.30. Thx Fernando Ortiz. 
-<p>_maxrecordcount returned in CachePageExecute $rsreturn 
-<p>Fixed sybase cacheselectlimit( ) problems 
-<p>MetaColumns() max_length should use precision for types X and C for ms access. 
-  Fixed. 
-<p>Speedup of odbc non-SELECT sql statements. 
-<p>Added support in MetaColumns for Wide Char types for ODBC. We halve max_length 
-  if unicode/wide char. 
-<p>Added 'B' to types handled by GetUpdateSQL/GetInsertSQL. 
-<p>Fixed warning message in oci8 driver with $persist variable when using PConnect. 
-<p><b>2.90 11 Dec 2002</b> 
-<p>Mssql and mssqlpo and oci8po now support ADODB_ASSOC_CASE. 
-<p>Now MetaType() can accept a field object as the first parameter. 
-<p>New $arr = $db-&gt;ServerInfo( ) function. Returns $arr['description'] which 
-  is the string description, and $arr['version']. 
-<p>PostgreSQL and MSSQL speedups for insert/updates. 
-<p> Implemented new SetFetchMode() that removes the need to use $ADODB_FETCH_MODE. 
-  Each connection has independant fetchMode. 
-<p>ADODB_ASSOC_CASE now defaults to 2, use native defaults. This is because we 
-  would break backward compat for too many applications otherwise. 
-<p>Patched encrypted sessions to use replace() 
-<p>The qstr function supports quoting of nulls when escape character is \ 
-<p>Rewrote bits and pieces of session code to check for time synch and improve 
-  reliability. 
-<p>Added property ADOConnection::hasTransactions = true/false; 
-<p>Added CreateSequence and DropSequence functions 
-<p>Found misplaced MoveNext() in adodb-postgres.inc.php. Fixed. 
-<p>Sybase SelectLimit not reliable because 'set rowcount' not cached - fixed. 
-<p>Moved ADOConnection to adodb-connection.inc.php and ADORecordSet to adodb-recordset.inc.php. 
-  This allows us to use doxygen to generate documentation. Doxygen doesn't like 
-  the classes in the main adodb.inc.php file for some mysterious reason. 
-<p><b>2.50, 14 Nov 2002</b> 
-<p>Added transOff and transCnt properties for disabling (transOff = true) and 
-  tracking transaction status (transCnt>0). 
-<p>Added inputarray handling into _adodb_pageexecute_all_rows - "Ross Smith" RossSmith#bnw.com. 
-<p>Fixed postgresql inconsistencies in date handling. 
-<p>Added support for mssql_fetch_assoc. 
-<p>Fixed $ADODB_FETCH_MODE bug in odbc MetaTables() and MetaPrimaryKeys(). 
-<p>Accidentally declared UnixDate() twice, making adodb incompatible with php 
-  4.3.0. Fixed. 
-<p>Fixed pager problems with some databases that returned -1 for _currentRow on 
-  MoveLast() by switching to MoveNext() in adodb-lib.inc.php. 
-<p>Also fixed uninited $discard in adodb-lib.inc.php. 
-<p><b>2.43, 25 Oct 2002</b></p>
-Added ADODB_ASSOC_CASE constant to better support ibase and odbc field names. 
-<p>Added support for NConnect() for oracle OCINLogin. 
-<p>Fixed NumCols() bug. 
-<p>Changed session handler to use Replace() on write. 
-<p>Fixed oci8 SelectLimit aggregate function bug again. 
-<p>Rewrote pivoting code. 
-<p><b>2.42, 4 Oct 2002</b></p>
-<p>Fixed ibase_fetch() problem with nulls. Also interbase now does automatic blob 
-  decoding, and is backward compatible. Suggested by Heinz Hombergs heinz#hhombergs.de. 
-<p>Fixed postgresql MoveNext() problems when called repeatedly after EOF. Also 
-  suggested by Heinz Hombergs. 
-<p>PageExecute() does not rewrite queries if SELECT DISTINCT is used. Requested 
-  by hans#velum.net 
-<p>Added additional fixes to oci8 SelectLimit handling with aggregate functions 
-  - thx to Christian Bugge for reporting the problem. 
-<p><b>2.41, 2 Oct 2002</b></p>
-<p>Fixed ADODB_COUNTRECS bug in odbc. Thx to Joshua Zoshi jzoshi#hotmail.com. 
-<p>Increased buffers for adodb-csvlib.inc.php for extremely long sql from 8192 
-  to 32000. 
-<p>Revised pivottable.inc.php code. Added better support for aggregate fields. 
-<p>Fixed mysql text/blob types problem in MetaTypes base class - thx to horacio 
-  degiorgi. 
-<p>Added SQLDate($fmt,$date) function, which allows an sql date format string 
-  to be generated - useful for group by's. 
-<p>Fixed bug in oci8 SelectLimit when offset>100. 
-<p><b>2.40 4 Sept 2002</b></p>
-<p>Added new NLS_DATE_FORMAT property to oci8. Suggested by Laurent NAVARRO ln#altidev.com 
-<p>Now use bind parameters in oci8 selectlimit for better performance. 
-<p>Fixed interbase replaceQuote for dialect != 1. Thx to "BEGUIN Pierre-Henri 
-  - INFOCOB" phb#infocob.com. 
-<p>Added white-space check to QA. 
-<p>Changed unixtimestamp to support fractional seconds (we always round down/floor 
-  the seconds). Thanks to beezly#beezly.org.uk. 
-<p>Now you can set the trigger_error type your own user-defined type in adodb-errorhandler.inc.php. 
-  Suggested by Claudio Bustos clbustos#entelchile.net. 
-<p>Added recordset filters with rsfilter.inc.php. 
-<p>$conn->_rs2rs does not create a new recordset when it detects it is of type 
-  array. Some trickery there as there seems to be a bug in Zend Engine 
-<p>Added render_pagelinks to adodb-pager.inc.php. Code by "Pablo Costa" pablo#cbsp.com.br. 
-<p>MetaType() speedup in adodb.inc.php by using hashing instead of switch. Best 
-  performance if constant arrays are supported, as they are in PHP5. 
-<p>adodb-session.php now updates only the expiry date if the crc32 check indicates 
-  that the data has not been modified. 
-<p><b>2.31 20 Aug 2002</b></p>
-<p>Made changes to pivottable.inc.php due to daniel lucuzaeu's suggestions (we sum the pivottable column if desired).
-<p>Fixed ErrorNo() in postgres so it does not depend on _errorMsg property.
-<p>Robert Tuttle added support for oracle cursors. See ExecuteCursor().
-<p>Fixed Replace() so it works with mysql when updating record where data has not changed. Reported by
-Cal Evans (cal#calevans.com).
-<p><b>2.30 1 Aug 2002</b></p>
-<p>Added pivottable.inc.php. Thanks to daniel.lucazeau#ajornet.com for the original 
-  concept.
-<p>Added ADOConnection::outp($msg,$newline) to output error and debugging messages. Now 
-you can override this using the ADODB_OUTP constant and use your own output handler.
-<p>Changed == to === for 'null' comparison. Reported by ericquil#yahoo.com 
-<p>Fixed mssql SelectLimit( ) bug when distinct used.
-<p><b>2.30 1 Aug 2002</b></p>
-<p>New GetCol() and CacheGetCol() from ross#bnw.com that returns the first field as a 1 dim array.
-<p>We have an empty recordset, but RecordCount() could return -1. Fixed. Reported by  "Jonathan Polansky" jonathan#polansky.com.
-<p>We now check for session variable changes using strlen($sessval).crc32($sessval). 
-Formerly we only used crc32().
-<p>Informix SelectLimit() problem with $ADODB_COUNTRECS fixed.
-<p>Fixed informix SELECT FIRST x DISTINCT, and not SELECT DISTINCT FIRST x - reported by F Riosa
-<p>Now default adodb error handlers ignores error if @ used.
-<p>If you set $conn->autoRollback=true, we auto-rollback persistent connections for odbc, mysql, oci8, mssql. 
-Default for autoRollback is false. No need to do so for postgres. 
-As interbase requires a transaction id (what a flawed api), we don't do it for interbase.
-<p>Changed PageExecute() to use non-greedy preg_match when searching for "FROM" keyword.
-<p><b>2.20 9 July 2002</b></p>
-<p>Added CacheGetOne($secs2cache,$sql), CacheGetRow($secs2cache,$sql), CacheGetAll($secs2cache,$sql).
-<p>Added $conn->OffsetDate($dayFraction,$date=false) to generate sql that calcs 
-  date offsets. Useful for scheduling appointments.
-<p>Added connection properties: leftOuter, rightOuter that hold left and right 
-  outer join operators.
-<p>Added connection property: ansiOuter to indicate whether ansi outer joins supported.
-<p>New driver <i>mssqlpo</i>, the portable mssql driver, which converts string 
-  concat operator from || to +.
-<p>Fixed ms access bug - SelectLimit() did not support ties - fixed.
-<p>Karsten Kraus (Karsten.Kraus#web.de), contributed error-handling code to ADONewConnection. 
-  Unfortunately due to backward compat problems, had to rollback most of the changes.
-<p>Added new parameter to GetAssoc() to allow returning an array of key-value pairs, 
-ignoring any additional columns in the recordset. Off by default.
-<p>Corrected mssql $conn->sysDate to return only date using convert().
-<p>CacheExecute() improved debugging output.
-<p>Changed rs2html() so newlines are converted to BR tags. Also optimized rs2html() based
-on feedback by "Jerry Workman" jerry#mtncad.com.
-<p>Added support for Replace() with Interbase, using DELETE and INSERT.
-<p>Some minor optimizations (mostly removing & references when passing arrays).
-<p>Changed  GenID() to allows id's larger than the size of an integer.
-<p>Added force_session property to oci8 for better updateblob() support.
-<p>Fixed PageExecute() which did not work properly with sql containing GROUP BY.
-<p><b>2.12 12 June 2002</b></p>
-<p>Added toexport.inc.php to export recordsets in CSV and tab-delimited format.
-<p>CachePageExecute() does not work - fixed - thx John Huong.
-<p>Interbase aliases not set properly in FetchField() - fixed. Thx Stefan Goethals.
-<p>Added cache property to adodb pager class. The number of secs to cache recordsets.
-<p>SQL rewriting bug in pageexecute() due to skipping of newlines due to missing /s modifier. Fixed.
-<p>Max size of cached recordset due to a bug was 256000 bytes. Fixed.
-<p>Speedup of 1st invocation of CacheExecute() by tuning code.
-<p>We compare $rewritesql with $sql in pageexecute code in case of rewrite failure.
-<p><b>2.11 7 June 2002</b></p>
-<p>Fixed PageExecute() rewrite sql problem - COUNT(*) and ORDER BY don't go together with
-	mssql, access and postgres. Thx to Alexander Zhukov alex#unipack.ru
-<p>DB2 support for CHARACTER type added - thx John Huong huongch#bigfoot.com
-<p>For ado, $argProvider not properly checked. Fixed - kalimero#ngi.it
-<p>Added $conn->Replace() function for update with automatic insert if the record does not exist. 
-	Supported by all databases except interbase.
-<p><b>2.10 4 June 2002</b></p>
-<p>Added uniqueSort property to indicate mssql ORDER BY cols must be unique.
-<p>Optimized session handler by crc32 the data. We only write if session data has changed.
-<p>adodb_sess_read in adodb-session.php now returns ''correctly - thanks to Jorma Tuomainen, webmaster#wizactive.com
-<p>Mssql driver did not throw EXECUTE errors correctly because ErrorMsg() and ErrorNo() called in wrong order. 
-Pointed out by Alexios Fakos. Fixed.
-<p>Changed ado to use client cursors. This fixes BeginTran() problems with ado.
-<p>Added handling of timestamp type in ado.
-<p>Added to ado_mssql support for insert_id() and affected_rows().
-<p>Added support for mssql.datetimeconvert=0, available since php 4.2.0.
-<p>Made UnixDate() less strict, so that the time is ignored if present.
-<p>Changed quote() so that it checks for magic_quotes_gpc.
-<p>Changed maxblobsize for odbc to default to 64000.
-<p><b>2.00 13 May 2002</b></p>
-<p>Added drivers <i>informix72</i> for pre-7.3 versions, and <i>oci805</i> for 
-  oracle 8.0.5, and postgres64 for postgresql 6.4 and earlier. The postgres and postgres7 drivers
-  are now identical.
-<p>Interbase now partially supports ADODB_FETCH_BOTH, by defaulting to ASSOC mode.
-<p>Proper support for blobs in mssql. Also revised blob support code 
-is base class. Now UpdateBlobFile() calls UpdateBlob() for consistency.
-<p>Added support for changed odbc_fetch_into api in php 4.2.0 
-with $conn-&gt;_has_stupid_odbc_fetch_api_change.
-<p>Fixed spelling of tablock locking hint in GenID( ) for mssql. 
-<p>Added RowLock( ) to several databases, including oci8, informix, sybase, etc. 
-  Fixed where error in mssql RowLock().
-<p>Added sysDate and sysTimeStamp properties to most database drivers. These are the sql
-functions/constants for that database that return the current date and current timestamp, and 
-are useful for portable inserts and updates.
-<p>Support for RecordCount() caused date handling in sybase and mssql to break. 
-Fixed, thanks to Toni Tunkkari, by creating derived classes for ADORecordSet_array for
-both databases. Generalized using arrayClass property. Also to support RecordCount(), 
-changed metatype handling for ado drivers. Now the type returned in FetchField 
-  is no longer a number, but the 1-char data type returned by MetaType.
-  At the same time, fixed a lot of date handling. Now mssql support dmy and mdy date formats. 
-Also speedups in sybase and mssql with preg_match and ^ in date/timestamp handling.
-Added support in sybase and mssql for 24 hour clock in timestamps (no AM/PM).
-<p>Extensive revisions to informix driver - thanks to Samuel CARRIERE samuel_carriere#hotmail.com 
-<p>Added $ok parameter to CommitTrans($ok) for easy rollbacks.
-<p>Fixed odbc MetaColumns and MetaTables to save and restore $ADODB_FETCH_MODE.
-<p>Some odbc drivers did not call the base connection class constructor. Fixed.
-<p>Fixed regex for GetUpdateSQL() and GetInsertSQL() to support more legal character combinations.
-
-<p><b>1.99 21 April 2002</b></p>
-<p>Added emulated RecordCount() to all database drivers if $ADODB_COUNTRECS = true 
-  (which it is by default). Inspired by Cristiano Duarte (cunha17#uol.com.br). 
-<p>Unified stored procedure support for mssql and oci8. Parameter() and PrepareSP() 
-  functions implemented. 
-<p>Added support for SELECT FIRST in informix, modified hasTop property to support 
-  this. 
-<p>Changed csv driver to handle updates/deletes/inserts properly (when Execute() returns true).
-Bind params also work now, and raiseErrorFn with csv driver. Added csv driver to QA process. 
-<p>Better error checking in oci8 UpdateBlob() and UpdateBlobFile().
-<p>Added TIME type to MySQL - patch by Manfred h9125297#zechine.wu-wien.ac.at
-<p>Prepare/Execute implemented for Interbase/Firebird 
-<p>Changed some regular expressions to be anchored by /^ $/ for speed.
-<p>Added UnixTimeStamp() and UnixDate() to ADOConnection(). Now these functions 
-  are in both ADOConnection and ADORecordSet classes.
-<p>Empty recordsets were not cached - fixed.
-<p>Thanks to Gaetano Giunta (g.giunta#libero.it) for the oci8 code review. We 
-  didn't agree on everything, but i hoped we agreed to disagree! 
-<p><b>1.90 6 April 2002</b></p>
-<p>Now all database drivers support fetch modes ADODB_FETCH_NUM and ADODB_FETCH_ASSOC, though
-	still not fully tested. Eg. Frontbase, Sybase, Informix.
-<p>NextRecordSet() support for mssql. Contributed by "Sven Axelsson" sven.axelsson#bokochwebb.se
-<p>Added blob support for SQL Anywhere. Contributed by Wade Johnson wade#wadejohnson.de
-<p>Fixed some security loopholes in server.php. Server.php also supports fetch mode.
-<p>Generalized GenID() to support odbc and mssql drivers. Mssql no longer generates GUID's.
-<p>Experimental RowLock($table,$where) for mssql.
-<p>Properly implemented Prepare() in oci8 and ODBC.
-<p>Added Bind() support to oci8 to support Prepare().
-<p>Improved error handler. Catches CacheExecute() and GenID() errors now.
-<p>Now if you are running php from the command line, debugging messages do not output html formating.
-Not 100% complete, but getting there.
-<p><b>1.81 22 March 2002</b></p>
-<p>Restored default $ADODB_FETCH_MODE = ADODB_FETCH_DEFAULT for backward compatibility.
-<p>SelectLimit for oci8 improved - Our FIRST_ROWS optimization now does not overwrite existing hint.
-<p>New Sybase SQL Anywhere driver. Contributed by Wade Johnson wade#wadejohnson.de
-<p><b>1.80 15 March 2002</b></p>
-<p>Redesigned directory structure of ADOdb files. Added new driver directory where
-all database drivers reside.
-<p>Changed caching algorithm to create subdirectories. Now we scale better.
-<p>Informix driver now supports insert_id(). Contribution by "Andrea Pinnisi" pinnisi#sysnet.it
-<p>Added experimental ISO date and FetchField support for informix.
-<p>Fixed a quoting bug in Execute() with bind parameters, causing problems with blobs.
-<p>Mssql driver speedup by 10-15%.
-<p>Now in CacheExecute($secs2cache,$sql,...), $secs2cache is optional. If missing, it will
-take the value defined in $connection->cacheSecs (default is 3600 seconds). Note that
-CacheSelectLimit(), the secs2cache is still compulsory - sigh.
-<p>Sybase SQL Anywhere driver (using ODBC) contributed by Wade Johnson wade#wadejohnson.de
-<p><b>1.72 8 March 2002</b></p>
-<p>Added @ when returning Fields() to prevent spurious error - "Michael William Miller" mille562#pilot.msu.edu
-<p>MetaDatabases() for postgres contributed by Phil pamelant#nerim.net
- <p>Mitchell T. Young (mitch#youngfamily.org) contributed informix driver.
- <p>Fixed rs2html() problem. I cannot reproduce, so probably a problem with pre PHP 4.1.0 versions,
-  when supporting new ADODB_FETCH_MODEs.
- <p>Mattia Rossi (mattia#technologist.com) contributed BlobDecode() and UpdateBlobFile() for postgresql
- using the postgres specific pg_lo_import()/pg_lo_open() - i don't use them but hopefully others will
- find this useful. See <a href="http://phplens.com/lens/lensforum/msgs.php?id=1262">this posting</a>
- for an example of usage.
- <p>Added UpdateBlobFile() for uploading files to a database.
- <p>Made UpdateBlob() compatible with oci8po driver.
- <p>Added noNullStrings support to oci8 driver. Oracle changes all ' ' strings to nulls,
-  so you need to set strings to ' ' to prevent the nullifying of strings. $conn->noNullStrings = true;
-  will do this for you automatically. This is useful when you define a char column as NOT NULL.
-  <p>Fixed UnixTimeStamp() bug - wasn't setting minutes and seconds properly. Patch from Agusti Fita i Borrell agusti#anglatecnic.com.
-  <p>Toni Tunkkari added patch for sybase dates. Problem with spaces in day part of date fixed.
- <p><b>1.71 18 Jan 2002</b></p>
- <p>Sequence start id support. Now $conn->Gen_ID('seqname', 50) to start sequence from 50.
- <p>CSV driver fix for selectlimit, from Andreas - akaiser#vocote.de.
-<P>Gam3r spotted that a global variable was undefined in the session handler. 
-<p>Mssql date regex had error. Fixed - reported by Minh Hoang vb_user#yahoo.com.
-<p>DBTimeStamp() and DBDate() now accept iso dates and unix timestamps. This means
-that the PostgreSQL handling of dates in GetInsertSQL() and GetUpdateSQL() can
-be removed. Also if these functions are passed '' or null or false, we return a SQL null.
-<p>GetInsertSQL() and GetUpdateSQL() now accept a new parameter, $magicq to 
-indicate whether quotes should be inserted based on magic quote settings - suggested by
-dj#4ict.com.
-<p>Reformated docs slightly based on suggestions by Chris Small.
- <p><b>1.65 28 Dec 2001</b></p>
- <p>Fixed borland_ibase class naming bug.
- <p>Now instead of using $rs->fields[0] internally, we use reset($rs->fields) so 
- that we are compatible with ADODB_FETCH_ASSOC mode. Reported by Nico S.
- <p>Changed recordset constructor and _initrs() for oci8 so that it returns the field definitions even
- if no rows in the recordset. Reported by Rick Hickerson (rhickers#mv.mv.com).
- <p>Improved support for postgresql in GetInsertSQL and GetUpdateSQL by
-  "mike" mike#partner2partner.com  and "Ryan Bailey" rebel#windriders.com
- <p><b>1.64 20 Dec 2001</b></p>
-<p>Danny Milosavljevic &lt;danny.milo#gmx.net> added some patches for MySQL error handling
-and displaying default values.
-<p>Fixed some ADODB_FETCH_BOTH inconsistencies in odbc and interbase.
-<p>Added more tests to test suite to cover ADODB_FETCH_* and ADODB_ERROR_HANDLER.
-<p>Added firebird (ibase) driver
-<p>Added borland_ibase driver for interbase 6.5
-<p><b>1.63 13 Dec 2001</b></p>
-Absolute to the adodb-lib.inc.php file not set properly. Fixed.<p>
-
-<p><b>1.62 11 Dec 2001</b></p>
-<p>Major speedup of ADOdb for low-end web sites by reducing the php code loading and compiling
-cycle. We conditionally compile not so common functions. 
-Moved csv code to adodb-csvlib.inc.php to reduce adodb.inc.php parsing. This file
-is loaded only when the csv/proxy driver is used, or CacheExecute() is run.
-Also moved PageExecute(), GetSelectSQL() and GetUpdateSQL() core code to adodb-lib.inc.php.
-This reduced the 70K main adodb.inc.php file to 55K, and since at least 20K of the file
-is comments, we have reduced 50K of code in adodb.inc.php to 35K. There
- should be 35% reduction in memory and thus 35% speedup in compiling the php code for the
-main adodb.inc.php file.
-<p>Highly tuned SelectLimit() for oci8 for massive speed improvements on large files. 
-Selecting 20 rows starting from the 20,000th row of a table is now 7 times faster. 
-Thx to Tomas V V Cox.
-<p>Allow . and # in table definitions in GetInsertSQL and GetUpdateSQL.
- See ADODB_TABLE_REGEX constant. Thx to Ari Kuorikoski.
-<p>Added ADODB_PREFETCH_ROWS constant, defaulting to 10. This determines the number
-of records to prefetch in a SELECT statement. Only used by oci8.</p>
-<p>Added high portability Oracle class called oci8po. This uses ? for bind variables, and 
-lower cases column names.</p>
-<p>Now all database drivers support $ADODB_FETCH_MODE, including interbase, ado, and odbc:
-ADODB_FETCH_NUM and ADODB_FETCH_ASSOC. ADODB_FETCH_BOTH is not fully implemented for all 
-database drivers.
-<p><b>1.61 Nov 2001</b></p>
-<p>Added PO_RecordCount() and PO_Insert_ID(). PO stands for portable. Pablo Roca 
-  [pabloroca#mvps.org]</p>
-<p>GenID now returns 0 if not available. Safer is that you should check $conn->hasGenID 
-  for availability.</p>
-<p>M'soft ADO we now correctly close recordset in _close() peterd#telephonetics.co.uk</p>
-<p>MSSQL now supports GenID(). It generates a 16-byte GUID from mssql newid() 
-  function.</p>
-<p>Changed ereg_replace to preg_replace in SelectLimit. This is a fix for mssql. 
-  Ereg doesn't support t or n! Reported by marino Carlos xaplo#postnuke-espanol.org</p>
-<p>Added $recordset->connection. This is the ADOConnection object for the recordset. 
-Works with cached and normal recordsets. Surprisingly, this had no affect on performance!</p>
-<p><b>1.54 15 Nov 2001</b></p>
-Fixed some more bugs in PageExecute().  I am getting sick of bug in this and will have to 
-reconsider my QA here. The main issue is that I don't use PageExecute() and 
-to check whether it is working requires a visual inspection of the html generated currently.
-It is possible to write a test script but it would be quite complicated :(
-<p> More speedups of SelectLimit() for DB2, Oci8, access, vfp, mssql.
-<p>
-
-<p><b>1.53 7 Nov 2001</b></p>
-Added support for ADODB_FETCH_ASSOC for ado and odbc drivers.<p>
-Tuned GetRowAssoc(false) in postgresql and mysql.<p>
-Stephen Van Dyke contributed ADOdb icon, accepted with some minor mods.<p>
-Enabled Affected_Rows() for postgresql<p>
-Speedup for Concat() using implode() - Benjamin Curtis ben_curtis#yahoo.com<p>
-Fixed some more bugs in PageExecute() to prevent infinite loops<p>
-<p><b>1.52 5 Nov 2001</b></p>
-Spelling error in CacheExecute() caused it to fail. $ql should be $sql in line 625!<p>
-Added fixes for parsing [ and ] in GetUpdateSQL().
-<p><b>1.51 5 Nov 2001</b></p>
-<p>Oci8 SelectLimit() speedup by using OCIFetch().
-<p>Oci8 was mistakenly reporting errors when $db->debug = true.
-<p>If a connection failed with ODBC, it was not correctly reported - fixed.
-<p>_connectionID was inited to -1, changed to false.
-<p>Added $rs->FetchRow(), to simplify API, ala PEAR DB
-<p>Added PEAR DB compat mode, which is still faster than PEAR! See adodb-pear.inc.php.
-<p>Removed postgres pconnect debugging statement.
-<p><b>1.50 31 Oct 2001</b></p>
-<p>ADOdbConnection renamed to ADOConnection, and ADOdbFieldObject to ADOFieldObject.
-<p>PageExecute() now checks for empty $rs correctly, and the errors in the docs on this subject have been fixed.
-<p>odbc_error() does not return 6 digit error correctly at times. Implemented workaround.
-<p>Added ADORecordSet_empty class. This will speedup INSERTS/DELETES/UPDATES because the return
-object created is much smaller.
-<p>Added Prepare() to odbc, and oci8 (but doesn't work properly for oci8 still).
-<p>Made pgsql a synonym for postgre7, and changed SELECT LIMIT to use OFFSET for compat with 
-postgres 7.2.
-<p>Revised adodb-cryptsession.php thanks to Ari.
-<p>Set resources to false on _close, to force freeing of resources.
-<p>Added adodb-errorhandler.inc.php, adodb-errorpear.inc.php and raiseErrorFn on Freek's urging.
-<p>GetRowAssoc($toUpper=true): $toUpper added as default.
-<p>Errors when connecting to a database were not captured formerly. Now we do it correctly.
-<p><b>1.40 19 September 2001</b></p>
-<p>PageExecute() to implement page scrolling added. Code and idea by Iv&aacute;n Oliva.</p>
-<p>Some minor postgresql fixes.</p>
-<p>Added sequence support using GenID() for postgresql, oci8, mysql, interbase.</p>
-<p>Added UpdateBlob support for interbase (untested).</p>
-<p>Added encrypted sessions (see adodb-cryptsession.php). By Ari Kuorikoski &lt;kuoriari#finebyte.com></p>
-<p><b>1.31 21 August 2001</b></p>
-<p>Many bug fixes thanks to "GaM3R (Cameron)" &lt;gamr#outworld.cx>. Some session changes due to Gam3r.
-<p>Fixed qstr() to quote  also.
-<p>rs2html() now pretty printed.
-<p>Jonathan Younger jyounger#unilab.com contributed the great idea GetUpdateSQL() and GetInsertSQL() which
-generates SQL to update and insert into a table from a recordset. Modify the recordset fields
-array, then can this function to generate the SQL (the SQL is not executed).
-<p>"Nicola Fankhauser" &lt;nicola.fankhauser#couniq.com> found some bugs in date handling for mssql.</p>
-<p>Added minimal Oracle support for LOBs. Still under development.</p>
-Added $ADODB_FETCH_MODE so you can control whether recordsets return arrays which are
-numeric, associative or both. This is a global variable you set. Currently only MySQL, Oci8, Postgres
-drivers support this.
-<p>PostgreSQL properly closes recordsets now. Reported by several people.
-<p>
-Added UpdateBlob() for Oracle. A hack to make it easier to save blobs.
-<p>
-Oracle timestamps did not display properly. Fixed.
-<p><b>1.20 6 June 2001</b></p>
-<p>Now Oracle can connect using tnsnames.ora or server and service name</p>
-<p>Extensive Oci8 speed optimizations. 
-Oci8 code revised to support variable binding, and /*+ FIRST_ROWS */ hint.</p>
-<p>Worked around some 4.0.6 bugs in odbc_fetch_into().</p>
-<p>Paolo S. Asioli paolo.asioli#libero.it suggested GetRowAssoc().</p>
-<p>Escape quotes for oracle wrongly set to '. Now '' is used.</p>
-<p>Variable binding now works in ODBC also.</p>
-<p>Jumped to version 1.20 because I don't like 13 :-)</p>
-<p><b>1.12 6 June 2001</b></p>
-<p>Changed $ADODB_DIR to ADODB_DIR constant to plug a security loophole.</p>
-<p>Changed _close() to close persistent connections also. Prevents connection leaks.</p>
-<p>Major revision of oracle and oci8 drivers. 
-Added OCI_RETURN_NULLS and OCI_RETURN_LOBS to OCIFetchInto(). BLOB, CLOB and VARCHAR2 recognition
-in MetaType() improved. MetaColumns() returns columns in correct sort order.</p>
-<p>Interbase timestamp input format was wrong. Fixed.</p>
-<p><b>1.11 20 May 2001</b></p>
-<p>Improved file locking for Windows.</p>
-<p>Probabilistic flushing of cache to avoid avalanche updates when cache timeouts.</p>
-<p>Cached recordset timestamp not saved in some scenarios. Fixed.</p>
-<p><b>1.10 19 May 2001</b></p>
-<p>Added caching. CacheExecute() and CacheSelectLimit().
-<p>Added csv driver. See <a href="http://php.weblogs.com/adodb_csv">http://php.weblogs.com/ADODB_csv</a>. 
-<p>Fixed SelectLimit(), SELECT TOP not working under certain circumstances.
-<p>Added better Frontbase support of MetaTypes() by Frank M. Kromann.
-<p><b>1.01 24 April 2001</b></p>
-<p>Fixed SelectLimit bug.  not quoted properly.
-<p>SelectLimit: SELECT TOP -1 * FROM TABLE not support by Microsoft. Fixed.</p>
-<p>GetMenu improved by glen.davies#cce.ac.nz to support multiple hilited items<p>
-<p>FetchNextObject() did not work with only 1 record returned. Fixed bug reported by $tim#orotech.net</p>
-<p>Fixed mysql field max_length problem. Fix suggested by Jim Nicholson (jnich#att.com)</p>
-<p><b>1.00 16 April 2001</b></p>
-<p>Given some brilliant suggestions on how to simplify ADOdb by akul. You no longer need to
-setup $ADODB_DIR yourself, and ADOLoadCode() is automatically called by ADONewConnection(), 
-simplifying the startup code.</p>
-<p>FetchNextObject() added. Suggested by Jakub Marecek. This makes FetchObject() obsolete, as
-this is more flexible and powerful.</p>
-<p>Misc fixes to SelectLimit() to support Access (top must follow distinct) and Fields() 
-in the array recordset. From Reinhard Balling.</p>
-<p><b>0.96 27 Mar 2001</b></p>
-<p>ADOConnection Close() did not return a value correctly. Thanks to akul#otamedia.com.</p>
-<p>When the horrible magic_quotes is enabled, back-slash () is changed to double-backslash (\).
-This doesn't make sense for Microsoft/Sybase databases. We fix this in qstr().</p>
-<p>Fixed Sybase date problem in UnixDate() thanks to Toni Tunkkari. Also fixed MSSQL problem
-in UnixDate() - thanks to milhouse31#hotmail.com.</p>
-<p>MoveNext() moved to leaf classes for speed in MySQL/PostgreSQL. 10-15% speedup.</p>
-<p>Added null handling in bindInputArray in Execute() -- Ron Baldwin suggestion.</p>
-<p>Fixed some option tags. Thanks to john#jrmstudios.com.</p>
-<p><b>0.95 13 Mar 2001</b></p>
-<p>Added postgres7 database driver which supports LIMIT and other version 7 stuff in the future.</p>
-<p>Added SelectLimit to ADOConnection to simulate PostgreSQL's "select * from table limit 10 offset 3".
-Added helper function GetArrayLimit() to ADORecordSet.</p>
-<p>Fixed mysql metacolumns bug. Thanks to Freek Dijkstra (phpeverywhere#macfreek.com).</p>
-<p>Also many PostgreSQL changes by Freek. He almost rewrote the whole PostgreSQL driver!</p>
-<p>Added fix to input parameters in Execute for non-strings by Ron Baldwin.</p>
-<p>Added new metatype, X for TeXt. Formerly, metatype B for Blob also included
-text fields. Now 'B' is for binary/image data. 'X' for textual data.</p>
-<p>Fixed $this->GetArray() in GetRows().</p>
-<p>Oracle and OCI8: 1st parameter is always blank -- now warns if it is filled.</p>
-<p>Now <i>hasLimit</i> and <i>hasTop</i> added to indicate whether 
-SELECT * FROM TABLE LIMIT 10 or SELECT TOP 10 * FROM TABLE are supported.</p>
-<p><b>0.94 04 Feb 2001</b></p>
-<p>Added ADORecordSet::GetRows() for compatibility with Microsoft ADO. Synonym for GetArray().</p>
-<p>Added new metatype 'R' to represent autoincrement numbers.</p>
-<p>Added ADORecordSet.FetchObject() to return a row as an object.</p>
-<p>Finally got a Linux box to test PostgreSql. Many fixes.</p>
-<p>Fixed copyright misspellings in 0.93.</p>
-<p>Fixed mssql MetaColumns type bug.</p>
-<p>Worked around odbc bug in PHP4 for sessions.</p>
-<p>Fixed many documentation bugs (affected_rows, metadatabases, qstr).</p>
-<p>Fixed MySQL timestamp format (removed comma).</p>
-<p>Interbase driver did not call ibase_pconnect(). Fixed.</p>
-<p><b>0.93 18 Jan 2002</b></p>
-<p>Fixed GetMenu bug.</p>
-<p>Simplified Interbase commit and rollback.</p>
-<p>Default behaviour on closing a connection is now to rollback all active transactions.</p>
-<p>Added field object handling for array recordset for future XML compatibility.</p>
-<p>Added arr2html() to convert array to html table.</p>
-<p><b>0.92 2 Jan 2002</b></p>
-<p>Interbase Commit and Rollback should be working again.</p>
-<p>Changed initialisation of ADORecordSet. This is internal and should not affect users. We
-are doing this to support cached recordsets in the future.</p>
-
-<p>Implemented ADORecordSet_array class. This allows you to simulate a database recordset
-with an array.</p>
-<p>Added UnixDate() and UnixTimeStamp() to ADORecordSet.</p>
-<p><b>0.91 21 Dec 2000</b></p>
-<p>Fixed ODBC so ErrorMsg() is working.</p>
-<p>Worked around ADO unrecognised null (0x1) value problem in COM.</p>
-<p>Added Sybase support for FetchField() type</p>
-<p>Removed debugging code and unneeded html from various files</p>
-<p>Changed to javadoc style comments to adodb.inc.php.</p>
-<p>Added maxsql as synonym for mysqlt</p>
-<p>Now ODBC downloads first 8K of blob by default
-<p><b>0.90 15 Nov 2000</b></p>
-<p>Lots of testing of Microsoft ADO. Should be more stable now.</p>
-<p>Added $ADODB_COUNTREC. Set to false for high speed selects.</p>
-<p>Added Sybase support. Contributed by Toni Tunkkari (toni.tunkkari#finebyte.com). Bug in Sybase 
-  API: GetFields is unable to determine date types.</p>
-<p>Changed behaviour of RecordSet.GetMenu() to support size parameter (listbox) properly.</p>
-<p>Added emptyDate and emptyTimeStamp to RecordSet class that defines how to represent 
-  empty dates.</p>
-<p>Added MetaColumns($table) that returns an array of ADOFieldObject's listing 
-  the columns of a table.</p>
-<p>Added transaction support for PostgresSQL -- thanks to "Eric G. Werk" egw#netguide.dk.</p>
-<p>Added adodb-session.php for session support.</p>
-<p><b>0.80 30 Nov 2000</b></p>
-<p>Added support for charSet for interbase. Implemented MetaTables for most databases. 
-  PostgreSQL more extensively tested.</p>
-<p><b>0.71 22 Nov 2000</b></p>
-<p>Switched from using require_once to include/include_once for backward compatability with PHP 4.02 and earlier.</p>
-<p><b>0.70 15 Nov 2000</b></p>
-<p>Calls by reference have been removed (call_time_pass_reference=Off) to ensure compatibility with future versions of PHP, 
-except in Oracle 7 driver due to a bug in php_oracle.dll.</p>
-<p>PostgreSQL database driver contributed by Alberto Cerezal (acerezalp#dbnet.es). 
-</p>
-<p>Oci8 driver for Oracle 8 contributed by George Fourlanos (fou#infomap.gr).</p>
-<p>Added <i>mysqlt</i> database driver to support MySQL 3.23 which has transaction 
- support. </p>
-<p>Oracle default date format (DD-MON-YY) did not match ADOdb default date format (which is YYYY-MM-DD). Use ALTER SESSION to force the default date.</p>
-<p>Error message checking is now included in test suite.</p>
-<p>MoveNext() did not check EOF properly -- fixed.</p>
-<p><b>0.60 Nov 8 2000</b></p>
-<p>Fixed some constructor bugs in ODBC and ADO. Added ErrorNo function to ADOConnection 
- class. </p>
-<p><b>0.51 Oct 18 2000</b></p>
-<p>Fixed some interbase bugs.</p>
-<p><b>0.50 Oct 16 2000</b></p>
-<p>Interbase commit/rollback changed to be compatible with PHP 4.03. </p>
-<p>CommitTrans( ) will now return true if transactions not supported. </p>
-<p>Conversely RollbackTrans( ) will return false if transactions not supported. 
-</p>
-<p><b>0.46 Oct 12</b></p>
-Many Oracle compatibility issues fixed. 
-<p><b>0.40 Sept 26</b></p>
-<p>Many bug fixes</p>
-<p>Now Code for BeginTrans, CommitTrans and RollbackTrans is working. So is the Affected_Rows
-and Insert_ID. Added above functions to test.php.</p>
-<p>ADO type handling was busted in 0.30. Fixed.</p>
-<p>Generalised Move( ) so it works will all databases, including ODBC.</p>
-<p><b>0.30 Sept 18</b></p>
-<p>Renamed ADOLoadDB to ADOLoadCode. This is clearer.</p>
-<p>Added BeginTrans, CommitTrans and RollbackTrans functions.</p>
-<p>Added Affected_Rows() and Insert_ID(), _affectedrows() and _insertID(), ListTables(), 
- ListDatabases(), ListColumns().</p>
-<p>Need to add New_ID() and hasInsertID and hasAffectedRows, autoCommit </p>
-<p><b>0.20 Sept 12</b></p>
-<p>Added support for Microsoft's ADO.</p>
-<p>Added new field to ADORecordSet -- canSeek</p>
-<p>Added new parameter to _fetch($ignore_fields = false). Setting to true will 
- not update fields array for faster performance.</p>
-<p>Added new field to ADORecordSet/ADOConnection -- dataProvider to indicate whether 
- a class is derived from odbc or ado.</p>
-<p>Changed class ODBCFieldObject to ADOFieldObject -- not documented currently.</p>
-<p>Added benchmark.php and testdatabases.inc.php to the test suite.</p>
-<p>Added to ADORecordSet FastForward( ) for future high speed scrolling. Not documented.</p>
-<p>Realised that ADO's Move( ) uses relative positioning. ADOdb uses absolute. 
-</p>
-<p><b>0.10 Sept 9 2000</b></p>
-<p>First release</p>
+<html><title>Old Changelog: ADOdb</title><body>
+<h3>Old Changelog</h3>
+
+</p><p><b>3.92 22 Sept 2003</b> 
+</p><p>Added GetAssoc and CacheGetAssoc to connection object.
+</p><p>Removed TextMax and CharMax functions from adodb.inc.php. 
+</p><p>HasFailedTrans() returned false when trans failed. Fixed. 
+</p><p>Moved perf driver classes into adodb/perf/*.php. 
+</p><p>Misc improvements to performance monitoring, including UI(). 
+</p><p>RETVAL in mssql Parameter(), we do not append @ now. 
+</p><p>Added Param($name) to connection class, returns '?' or ":$name", for defining 
+  bind parameters portably. 
+</p><p>LogSQL traps affected_rows() and saves its value properly now. Also fixed oci8 
+  _stmt and _affectedrows() bugs. 
+</p><p>Session code timestamp check for oci8 works now. Formerly default NLS_DATE_FORMAT 
+  stripped off time portion. Thx to Tony Blair (tonanbarbarian#hotmail.com). Also 
+  added new $conn-&gt;datetime field to oci8, controls whether MetaType() returns 
+  'D' ($this-&gt;datetime==false) or 'T' ($this-&gt;datetime == true) for DATE type. 
+</p><p>Fixed bugs in adodb-cryptsession.inc.php and adodb-session-clob.inc.php. 
+</p><p>Fixed misc bugs in adodb_key_exists, GetInsertSQL() and GetUpdateSQL(). 
+</p><p>Tuned include_once handling to reduce file-system checking overhead. 
+</p><p><b>3.91 9 Sept 2003</b> 
+</p><p>Only released to InterAkt 
+</p><p>Added LogSQL() for sql logging and $ADODB_NEWCONNECTION to override factory 
+  for driver instantiation. 
+</p><p>Added IfNull($field,$ifNull) function, thx to johnwilk#juno.com 
+</p><p>Added portable substr support. 
+</p><p>Now rs2html() has new parameter, $echo. Set to false to return $html instead 
+  of echoing it. 
+</p><p><b>3.90 5 Sept 2003</b> 
+</p><p>First beta of performance monitoring released. 
+</p><p>MySQL supports MetaTable() masking. 
+</p><p>Fixed key_exists() bug in adodb-lib.inc.php 
+</p><p>Added sp_executesql Prepare() support to mssql. 
+</p><p>Added bind support to db2. 
+</p><p>Added swedish language file - Christian Tiberg" christian#commsoft.nu 
+</p><p>Bug in drop index for mssql data dict fixed. Thx to Gert-Rainer Bitterlich. 
+</p><p>Left join setting for oci8 was wrong. Thx to johnwilk#juno.com 
+</p><p><b>3.80 27 Aug 2003</b> 
+</p><p>Patch for PHP 4.3.3 cached recordset csv2rs() fread loop incompatibility. 
+</p><p>Added matching mask for MetaTables. Only for oci8, mssql and postgres currently. 
+</p><p>Rewrite of "oracle" driver connection code, merging with "oci8", by Gaetano. 
+</p><p>Added better debugging for Smart Transactions. 
+</p><p>Postgres DBTimeStamp() was wrongly using TO_DATE. Changed to TO_TIMESTAMP. 
+</p><p>ADODB_FETCH_CASE check pushed to ADONewConnection to allow people to define 
+  it after including adodb.inc.php. 
+</p><p>Added portugese (brazilian) to languages. Thx to "Levi Fukumori". 
+</p><p>Removed arg3 parameter from Execute/SelectLimit/Cache* functions. 
+</p><p>Execute() now accepts 2-d array as $inputarray. Also changed docs of fnExecute() 
+  to note change in sql query counting with 2-d arrays. 
+</p><p>Added MONEY to MetaType in PostgreSQL. 
+</p><p>Added more debugging output to CacheFlush(). 
+</p><p><b>3.72 9 Aug 2003</b> 
+</p><p>Added qmagic($str), which is a qstr($str) that auto-checks for magic quotes 
+  and does the right thing... 
+</p><p>Fixed CacheFlush() bug - Thx to martin#gmx.de 
+</p><p>Walt Boring contributed MetaForeignKeys for postgres7. 
+</p><p>_fetch() called _BlobDecode() wrongly in interbase. Fixed. 
+</p><p>adodb_time bug fixed with dates after 2038 fixed by Jason Pell. http://phplens.com/lens/lensforum/msgs.php?id=6980 
+</p><p><b>3.71 4 Aug 2003</b> 
+</p><p>The oci8 driver, MetaPrimaryKeys() did not check the owner correctly when $owner 
+  == false. 
+</p><p>Russian language file contributed by "Cyrill Malevanov" cyrill#malevanov.spb.ru. 
+</p><p>Spanish language file contributed by "Horacio Degiorgi" horaciod#codigophp.com. 
+</p><p>Error handling in oci8 bugfix - if there was an error in Execute(), then when 
+  calling ErrorNo() and/or ErrorMsg(), the 1st call would return the error, but 
+  the 2nd call would return no error. 
+</p><p>Error handling in odbc bugfix. ODBC would always return the last error, even 
+  if it happened 5 queries ago. Now we reset the errormsg to '' and errorno to 
+  0 everytime before CacheExecute() and Execute(). 
+</p><p><b>3.70 29 July 2003</b> 
+</p><p>Added new SQLite driver. Tested on PHP 4.3 and PHP 5. 
+</p><p>Added limited "sapdb" driver support - mainly date support. 
+</p><p>The oci8 driver did not identify NUMBER with no defined precision correctly. 
+</p><p>Added ADODB_FORCE_NULLS, if set, then PHP nulls are converted to SQL nulls 
+  in GetInsertSQL/GetUpdateSQL. 
+</p><p>DBDate() and DBTimeStamp() format for postgresql had problems. Fixed. 
+</p><p>Added tableoptions to ChangeTableSQL(). Thx to Mike Benoit. 
+</p><p>Added charset support to postgresql. Thx to Julian Tarkhanov. 
+</p><p>Changed OS check for MS-Windows to prevent confusion with darWIN (MacOS) 
+</p><p>Timestamp format for db2 was wrong. Changed to yyyy-mm-dd-hh.mm.ss.nnnnnn. 
+</p><p>adodb-cryptsession.php includes wrong. Fixed. 
+</p><p>Added MetaForeignKeys(). Supported by mssql, odbc_mssql and oci8. 
+</p><p>Fixed some oci8 MetaColumns/MetaPrimaryKeys bugs. Thx to Walt Boring. 
+</p><p>adodb_getcount() did not init qryRecs to 0. Missing "WHERE" clause checking 
+  in GetUpdateSQL fixed. Thx to Sebastiaan van Stijn. 
+</p><p>Added support for only 'VIEWS' and "TABLES" in MetaTables. From Walt Boring. 
+</p><p>Upgraded to adodb-xmlschema.inc.php 0.0.2. 
+</p><p>NConnect for mysql now returns value. Thx to Dennis Verspuij. 
+</p><p>ADODB_FETCH_BOTH support added to interbase/firebird. 
+</p><p>Czech language file contributed by Kamil Jakubovic jake#host.sk. 
+</p><p>PostgreSQL BlobDecode did not use _connectionID properly. Thx to Juraj Chlebec. 
+</p><p>Added some new initialization stuff for Informix. Thx to "Andrea Pinnisi" pinnisi#sysnet.it 
+</p><p>ADODB_ASSOC_CASE constant wrong in sybase _fetch(). Fixed. 
+</p><p><b>3.60 16 June 2003</b> 
+</p><p>We now SET CONCAT_NULL_YIELDS_NULL OFF for odbc_mssql driver to be compat with 
+  mssql driver. 
+</p><p>The property $emptyDate missing from connection class. Also changed 1903 to 
+  constant (TIMESTAMP_FIRST_YEAR=100). Thx to Sebastiaan van Stijn. 
+</p><p>ADOdb speedup optimization - we now return all arrays by reference. 
+</p><p>Now DBDate() and DBTimeStamp() now accepts the string 'null' as a parameter. 
+  Suggested by vincent. 
+</p><p>Added GetArray() to connection class. 
+</p><p>Added not_null check in informix metacolumns(). 
+</p><p>Connection parameters for postgresql did not work correctly when port was defined. 
+</p><p>DB2 is now a tested driver, making adodb 100% compatible. Extensive changes 
+  to odbc driver for DB2, including implementing serverinfo() and SQLDate(), switching 
+  to SQL_CUR_USE_ODBC as the cursor mode, and lastAffectedRows and SelectLimit() 
+  fixes. 
+</p><p>The odbc driver's FetchField() field names did not obey ADODB_ASSOC_CASE. Fixed. 
+</p><p>Some bugs in adodb_backtrace() fixed. 
+</p><p>Added "INT IDENTITY" type to adorecordset::MetaType() to support odbc_mssql 
+  properly. 
+</p><p>MetaColumns() for oci8, mssql, odbc revised to support scale. Also minor revisions 
+  to odbc MetaColumns() for vfp and db2 compat. 
+</p><p>Added unsigned support to mysql datadict class. Thx to iamsure. 
+</p><p>Infinite loop in mssql MoveNext() fixed when ADODB_FETCH_ASSOC used. Thx to 
+  Josh R, Night_Wulfe#hotmail.com. 
+</p><p>ChangeTableSQL contributed by Florian Buzin. 
+</p><p>The odbc_mssql driver now sets CONCAT_NULL_YIELDS_NULL OFF for compat with 
+  mssql driver. 
+</p>
+
+<p><b>3.50 19 May 2003</b></p>
+<p>Fixed mssql compat with FreeTDS. FreeTDS does not implement mssql_fetch_assoc(). 
+<p>Merged back connection and recordset code into adodb.inc.php. 
+<p>ADOdb sessions using oracle clobs contributed by achim.gosse#ddd.de. See adodb-session-clob.php. 
+<p>Added /s modifier to preg_match everywhere, which ensures that regex does not 
+  stop at /n. Thx Pao-Hsi Huang. 
+<p>Fixed error in metacolumns() for mssql. 
+<p>Added time format support for SQLDate. 
+<p>Image => B added to metatype. 
+<p>MetaType now checks empty($this->blobSize) instead of empty($this). 
+<p>Datadict has beta support for informix, sybase (mapped to mssql), db2 and generic 
+  (which is a fudge). 
+<p>BlobEncode for postgresql uses pg_escape_bytea, if available. Needed for compat 
+  with 7.3. 
+<p>Added $ADODB_LANG, to support multiple languages in MetaErrorMsg(). 
+<p>Datadict can now parse table definition as declarative text. 
+<p>For DataDict, oci8 autoincrement trigger missing semi-colon. Fixed. 
+<p>For DataDict, when REPLACE flag enabled, drop sequence in datadict for autoincrement 
+  field in postgres and oci8.s 
+<p>Postgresql defaults to template1 database if no database defined in connect/pconnect. 
+<p>We now clear _resultid in postgresql if query fails. 
+<p><b>3.40 19 May 2003</b></p>
+<p>Added insert_id for odbc_mssql. 
+<p>Modified postgresql UpdateBlobFile() because it did not work in safe mode. 
+<p>Now connection object is passed to raiseErrorFn as last parameter. Needed by 
+  StartTrans(). 
+<p>Added StartTrans() and CompleteTrans(). It is recommended that you do not modify 
+  transOff, but use the above functions. 
+<p>oci8po now obeys ADODB_ASSOC_CASE settings. 
+<p>Added virtualized error codes, using PEAR DB equivalents. Requires you to manually 
+  include adodb-error.inc.php yourself, with MetaError() and MetaErrorMsg($errno). 
+<p>GetRowAssoc for mysql and pgsql were flawed. Fix by Ross Smith. 
+<p>Added to datadict types I1, I2, I4 and I8. Changed datadict type 'T' to map 
+  to timestamp instead of datetime for postgresql. 
+<p>Error handling in ExecuteSQLArray(), adodb-datadict.inc.php did not work. 
+<p>We now auto-quote postgresql connection parameters when building connection 
+  string. 
+<p>Added session expiry notification. 
+<p>We now test with odbc mysql - made some changes to odbc recordset constructor. 
+<p>MetaColumns now special cases access and other databases for odbc. 
+<p><b>3.31 17 March 2003</b></p>
+<p>Added row checking for _fetch in postgres. 
+<p>Added Interval type to MetaType for postgres. 
+<p>Remapped postgres driver to call postgres7 driver internally. 
+<p>Adorecordset_array::getarray() did not return array when nRows >= 0. 
+<p>Postgresql: at times, no error message returned by pg_result_error() but error 
+  message returned in pg_last_error(). Recoded again. 
+<p>Interbase blob's now use chunking for updateblob. 
+<p>Move() did not set EOF correctly. Reported by Jorma T. 
+<p>We properly support mysql timestamp fields when we are creating mysql tables 
+  using the data-dict interface. 
+<p>Table regex includes backticks character now. 
+<p><b>3.30 3 March 2003</b></p>
+<p>Added $ADODB_EXTENSION and $ADODB_COMPAT_FETCH constant. 
+<p>Made blank1stItem configurable using syntax "value:text" in GetMenu/GetMenu2. 
+  Thx to Gabriel Birke. 
+<p>Previously ADOdb differed from the Microsoft standard because it did not define 
+  what to set $this->fields when EOF was reached. Now at EOF, ADOdb sets $this->fields 
+  to false for all databases, which is consist with Microsoft's implementation. 
+  Postgresql and mysql have always worked this way (in 3.11 and earlier). If you 
+  are experiencing compatibility problems (and you are not using postgresql nor 
+  mysql) on upgrading to 3.30, try setting the global variables $ADODB_COUNTRECS 
+  = true (which is the default) and $ADODB_FETCH_COMPAT = true (this is a new 
+  global variable). 
+<p>We now check both pg_result_error and pg_last_error as sometimes pg_result_error 
+  does not display anything. Iman Mayes 
+<p> We no longer check for magic quotes gpc in Quote(). 
+<p> Misc fixes for table creation in adodb-datadict.inc.php. Thx to iamsure. 
+<p> Time calculations use adodb_time library for all negative timestamps due to 
+  problems in Red Hat 7.3 or later. Formerly, only did this for Windows. 
+<p> In mssqlpo, we now check if $sql in _query is a string before we change || 
+  to +. This is to support prepared stmts. 
+<p> Move() and MoveLast() internals changed to support to support EOF and $this->fields 
+  change. 
+<p> Added ADODB_FETCH_BOTH support to mssql. Thx to Angel Fradejas afradejas#mediafusion.es 
+<p> We now check if link resource exists before we run mysql_escape_string in 
+  qstr(). 
+<p> Before we flock in csv code, we check that it is not a http url. 
+<p><b>3.20 17 Feb 2003</b></p>
+<p>Added new Data Dictionary classes for creating tables and indexes. Warning 
+  - this is very much alpha quality code. The API can still change. See adodb/tests/test-datadict.php 
+  for more info. 
+<p>We now ignore $ADODB_COUNTRECS for mysql, because PHP truncates incomplete 
+  recordsets when mysql_unbuffered_query() is called a second time. 
+<p>Now postgresql works correctly when $ADODB_COUNTRECS = false. 
+<p>Changed _adodb_getcount to properly support SELECT DISTINCT. 
+<p>Discovered that $ADODB_COUNTRECS=true has some problems with prepared queries 
+  - suspect PHP bug. 
+<p>Now GetOne and GetRow run in $ADODB_COUNTRECS=false mode for better performance. 
+<p>Added support for mysql_real_escape_string() and pg_escape_string() in qstr(). 
+<p>Added an intermediate variable for mysql _fetch() and MoveNext() to store fields, 
+  to prevent overwriting field array with boolean when mysql_fetch_array() returns 
+  false. 
+<p>Made arrays for getinsertsql and getupdatesql case-insensitive. Suggested by 
+  Tim Uckun" tim#diligence.com 
+<p><b>3.11 11 Feb 2003</b></p>
+<p>Added check for ADODB_NEVER_PERSIST constant in PConnect(). If defined, then 
+  PConnect() will actually call non-persistent Connect(). 
+<p>Modified interbase to properly work with Prepare(). 
+<p>Added $this->ibase_timefmt to allow you to change the date and time format. 
+<p>Added support for $input_array parameter in CacheFlush(). 
+<p>Added experimental support for dbx, which was then removed when i found that 
+  it was slower than using native calls. 
+<p>Added MetaPrimaryKeys for mssql and ibase/firebird. 
+<p>Added new $trim parameter to GetCol and CacheGetCol 
+<p>Uses updated adodb-time.inc.php 0.06. 
+<p><b>3.10 27 Jan 2003</b> 
+<p>Added adodb_date(), adodb_getdate(), adodb_mktime() and adodb-time.inc.php. 
+<p>For interbase, added code to handle unlimited number of bind parameters. From 
+  Daniel Hasan daniel#hasan.cl. 
+<p>Added BlobDecode and UpdateBlob for informix. Thx to Fernando Ortiz. 
+<p>Added constant ADODB_WINDOWS. If defined, means that running on Windows. 
+<p>Added constant ADODB_PHPVER which stores php version as a hex num. Removed 
+  $ADODB_PHPVER variable. 
+<p>Felho Bacsi reported a minor white-space regular expression problem in GetInsertSQL. 
+<p>Modified ADO to use variant to store _affectedRows 
+<p>Changed ibase to use base class Replace(). Modified base class Replace() to 
+  support ibase. 
+<p>Changed odbc to auto-detect when 0 records returned is wrong due to bad odbc 
+  drivers. 
+<p>Changed mssql to use datetimeconvert ini setting only when 4.30 or later (does 
+  not work in 4.23). 
+<p>ExecuteCursor($stmt, $cursorname, $params) now accepts a new $params array 
+  of additional bind parameters -- William Lovaton walovaton#yahoo.com.mx. 
+<p>Added support for sybase_unbuffered_query if ADODB_COUNTRECS == false. Thx 
+  to chuck may. 
+<p>Fixed FetchNextObj() bug. Thx to Jorma Tuomainen. 
+<p>We now use SCOPE_IDENTITY() instead of @@IDENTITY for mssql - thx to marchesini#eside.it 
+<p>Changed postgresql movenext logic to prevent illegal row number from being 
+  passed to pg_fetch_array(). 
+<p>Postgresql initrs bug found by "Bogdan RIPA" bripa#interakt.ro $f1 accidentally 
+  named $f 
+<p><b>3.00 6 Jan 2003</b> 
+<p>Fixed adodb-pear.inc.php syntax error. 
+<p>Improved _adodb_getcount() to use SELECT COUNT(*) FROM ($sql) for languages 
+  that accept it. 
+<p>Fixed _adodb_getcount() caching error. 
+<p>Added sql to retrive table and column info for odbc_mssql. 
+<p><strong>2.91 3 Jan 2003</strong> 
+<p>Revised PHP version checking to use $ADODB_PHPVER with legal values 0x4000, 
+  0x4050, 0x4200, 0x4300. 
+<p>Added support for bytea fields and oid blobs in postgres by allowing BlobDecode() 
+  to detect and convert non-oid fields. Also added BlobEncode to postgres when 
+  you want to encode oid blobs. 
+<p>Added blobEncodeType property for connections to inform phpLens what encoding 
+  method to use for blobs. 
+<p>Added BlobDecode() and BlobEncode() to base ADOConnection class. 
+<p>Added umask() to _gencachename() when creating directories. 
+<p>Added charPage for ado drivers, so you can set the code page. 
+<pre>
+$conn->charPage = CP_UTF8;
+$conn->Connect($dsn);
+</pre>
+<p>Modified _seek in mysql to check for num rows=0. 
+<p>Added to metatypes new informix types for IDS 9.30. Thx Fernando Ortiz. 
+<p>_maxrecordcount returned in CachePageExecute $rsreturn 
+<p>Fixed sybase cacheselectlimit( ) problems 
+<p>MetaColumns() max_length should use precision for types X and C for ms access. 
+  Fixed. 
+<p>Speedup of odbc non-SELECT sql statements. 
+<p>Added support in MetaColumns for Wide Char types for ODBC. We halve max_length 
+  if unicode/wide char. 
+<p>Added 'B' to types handled by GetUpdateSQL/GetInsertSQL. 
+<p>Fixed warning message in oci8 driver with $persist variable when using PConnect. 
+<p><b>2.90 11 Dec 2002</b> 
+<p>Mssql and mssqlpo and oci8po now support ADODB_ASSOC_CASE. 
+<p>Now MetaType() can accept a field object as the first parameter. 
+<p>New $arr = $db-&gt;ServerInfo( ) function. Returns $arr['description'] which 
+  is the string description, and $arr['version']. 
+<p>PostgreSQL and MSSQL speedups for insert/updates. 
+<p> Implemented new SetFetchMode() that removes the need to use $ADODB_FETCH_MODE. 
+  Each connection has independant fetchMode. 
+<p>ADODB_ASSOC_CASE now defaults to 2, use native defaults. This is because we 
+  would break backward compat for too many applications otherwise. 
+<p>Patched encrypted sessions to use replace() 
+<p>The qstr function supports quoting of nulls when escape character is \ 
+<p>Rewrote bits and pieces of session code to check for time synch and improve 
+  reliability. 
+<p>Added property ADOConnection::hasTransactions = true/false; 
+<p>Added CreateSequence and DropSequence functions 
+<p>Found misplaced MoveNext() in adodb-postgres.inc.php. Fixed. 
+<p>Sybase SelectLimit not reliable because 'set rowcount' not cached - fixed. 
+<p>Moved ADOConnection to adodb-connection.inc.php and ADORecordSet to adodb-recordset.inc.php. 
+  This allows us to use doxygen to generate documentation. Doxygen doesn't like 
+  the classes in the main adodb.inc.php file for some mysterious reason. 
+<p><b>2.50, 14 Nov 2002</b> 
+<p>Added transOff and transCnt properties for disabling (transOff = true) and 
+  tracking transaction status (transCnt>0). 
+<p>Added inputarray handling into _adodb_pageexecute_all_rows - "Ross Smith" RossSmith#bnw.com. 
+<p>Fixed postgresql inconsistencies in date handling. 
+<p>Added support for mssql_fetch_assoc. 
+<p>Fixed $ADODB_FETCH_MODE bug in odbc MetaTables() and MetaPrimaryKeys(). 
+<p>Accidentally declared UnixDate() twice, making adodb incompatible with php 
+  4.3.0. Fixed. 
+<p>Fixed pager problems with some databases that returned -1 for _currentRow on 
+  MoveLast() by switching to MoveNext() in adodb-lib.inc.php. 
+<p>Also fixed uninited $discard in adodb-lib.inc.php. 
+<p><b>2.43, 25 Oct 2002</b></p>
+Added ADODB_ASSOC_CASE constant to better support ibase and odbc field names. 
+<p>Added support for NConnect() for oracle OCINLogin. 
+<p>Fixed NumCols() bug. 
+<p>Changed session handler to use Replace() on write. 
+<p>Fixed oci8 SelectLimit aggregate function bug again. 
+<p>Rewrote pivoting code. 
+<p><b>2.42, 4 Oct 2002</b></p>
+<p>Fixed ibase_fetch() problem with nulls. Also interbase now does automatic blob 
+  decoding, and is backward compatible. Suggested by Heinz Hombergs heinz#hhombergs.de. 
+<p>Fixed postgresql MoveNext() problems when called repeatedly after EOF. Also 
+  suggested by Heinz Hombergs. 
+<p>PageExecute() does not rewrite queries if SELECT DISTINCT is used. Requested 
+  by hans#velum.net 
+<p>Added additional fixes to oci8 SelectLimit handling with aggregate functions 
+  - thx to Christian Bugge for reporting the problem. 
+<p><b>2.41, 2 Oct 2002</b></p>
+<p>Fixed ADODB_COUNTRECS bug in odbc. Thx to Joshua Zoshi jzoshi#hotmail.com. 
+<p>Increased buffers for adodb-csvlib.inc.php for extremely long sql from 8192 
+  to 32000. 
+<p>Revised pivottable.inc.php code. Added better support for aggregate fields. 
+<p>Fixed mysql text/blob types problem in MetaTypes base class - thx to horacio 
+  degiorgi. 
+<p>Added SQLDate($fmt,$date) function, which allows an sql date format string 
+  to be generated - useful for group by's. 
+<p>Fixed bug in oci8 SelectLimit when offset>100. 
+<p><b>2.40 4 Sept 2002</b></p>
+<p>Added new NLS_DATE_FORMAT property to oci8. Suggested by Laurent NAVARRO ln#altidev.com 
+<p>Now use bind parameters in oci8 selectlimit for better performance. 
+<p>Fixed interbase replaceQuote for dialect != 1. Thx to "BEGUIN Pierre-Henri 
+  - INFOCOB" phb#infocob.com. 
+<p>Added white-space check to QA. 
+<p>Changed unixtimestamp to support fractional seconds (we always round down/floor 
+  the seconds). Thanks to beezly#beezly.org.uk. 
+<p>Now you can set the trigger_error type your own user-defined type in adodb-errorhandler.inc.php. 
+  Suggested by Claudio Bustos clbustos#entelchile.net. 
+<p>Added recordset filters with rsfilter.inc.php. 
+<p>$conn->_rs2rs does not create a new recordset when it detects it is of type 
+  array. Some trickery there as there seems to be a bug in Zend Engine 
+<p>Added render_pagelinks to adodb-pager.inc.php. Code by "Pablo Costa" pablo#cbsp.com.br. 
+<p>MetaType() speedup in adodb.inc.php by using hashing instead of switch. Best 
+  performance if constant arrays are supported, as they are in PHP5. 
+<p>adodb-session.php now updates only the expiry date if the crc32 check indicates 
+  that the data has not been modified. 
+<p><b>2.31 20 Aug 2002</b></p>
+<p>Made changes to pivottable.inc.php due to daniel lucuzaeu's suggestions (we sum the pivottable column if desired).
+<p>Fixed ErrorNo() in postgres so it does not depend on _errorMsg property.
+<p>Robert Tuttle added support for oracle cursors. See ExecuteCursor().
+<p>Fixed Replace() so it works with mysql when updating record where data has not changed. Reported by
+Cal Evans (cal#calevans.com).
+<p><b>2.30 1 Aug 2002</b></p>
+<p>Added pivottable.inc.php. Thanks to daniel.lucazeau#ajornet.com for the original 
+  concept.
+<p>Added ADOConnection::outp($msg,$newline) to output error and debugging messages. Now 
+you can override this using the ADODB_OUTP constant and use your own output handler.
+<p>Changed == to === for 'null' comparison. Reported by ericquil#yahoo.com 
+<p>Fixed mssql SelectLimit( ) bug when distinct used.
+<p><b>2.30 1 Aug 2002</b></p>
+<p>New GetCol() and CacheGetCol() from ross#bnw.com that returns the first field as a 1 dim array.
+<p>We have an empty recordset, but RecordCount() could return -1. Fixed. Reported by  "Jonathan Polansky" jonathan#polansky.com.
+<p>We now check for session variable changes using strlen($sessval).crc32($sessval). 
+Formerly we only used crc32().
+<p>Informix SelectLimit() problem with $ADODB_COUNTRECS fixed.
+<p>Fixed informix SELECT FIRST x DISTINCT, and not SELECT DISTINCT FIRST x - reported by F Riosa
+<p>Now default adodb error handlers ignores error if @ used.
+<p>If you set $conn->autoRollback=true, we auto-rollback persistent connections for odbc, mysql, oci8, mssql. 
+Default for autoRollback is false. No need to do so for postgres. 
+As interbase requires a transaction id (what a flawed api), we don't do it for interbase.
+<p>Changed PageExecute() to use non-greedy preg_match when searching for "FROM" keyword.
+<p><b>2.20 9 July 2002</b></p>
+<p>Added CacheGetOne($secs2cache,$sql), CacheGetRow($secs2cache,$sql), CacheGetAll($secs2cache,$sql).
+<p>Added $conn->OffsetDate($dayFraction,$date=false) to generate sql that calcs 
+  date offsets. Useful for scheduling appointments.
+<p>Added connection properties: leftOuter, rightOuter that hold left and right 
+  outer join operators.
+<p>Added connection property: ansiOuter to indicate whether ansi outer joins supported.
+<p>New driver <i>mssqlpo</i>, the portable mssql driver, which converts string 
+  concat operator from || to +.
+<p>Fixed ms access bug - SelectLimit() did not support ties - fixed.
+<p>Karsten Kraus (Karsten.Kraus#web.de), contributed error-handling code to ADONewConnection. 
+  Unfortunately due to backward compat problems, had to rollback most of the changes.
+<p>Added new parameter to GetAssoc() to allow returning an array of key-value pairs, 
+ignoring any additional columns in the recordset. Off by default.
+<p>Corrected mssql $conn->sysDate to return only date using convert().
+<p>CacheExecute() improved debugging output.
+<p>Changed rs2html() so newlines are converted to BR tags. Also optimized rs2html() based
+on feedback by "Jerry Workman" jerry#mtncad.com.
+<p>Added support for Replace() with Interbase, using DELETE and INSERT.
+<p>Some minor optimizations (mostly removing & references when passing arrays).
+<p>Changed  GenID() to allows id's larger than the size of an integer.
+<p>Added force_session property to oci8 for better updateblob() support.
+<p>Fixed PageExecute() which did not work properly with sql containing GROUP BY.
+<p><b>2.12 12 June 2002</b></p>
+<p>Added toexport.inc.php to export recordsets in CSV and tab-delimited format.
+<p>CachePageExecute() does not work - fixed - thx John Huong.
+<p>Interbase aliases not set properly in FetchField() - fixed. Thx Stefan Goethals.
+<p>Added cache property to adodb pager class. The number of secs to cache recordsets.
+<p>SQL rewriting bug in pageexecute() due to skipping of newlines due to missing /s modifier. Fixed.
+<p>Max size of cached recordset due to a bug was 256000 bytes. Fixed.
+<p>Speedup of 1st invocation of CacheExecute() by tuning code.
+<p>We compare $rewritesql with $sql in pageexecute code in case of rewrite failure.
+<p><b>2.11 7 June 2002</b></p>
+<p>Fixed PageExecute() rewrite sql problem - COUNT(*) and ORDER BY don't go together with
+	mssql, access and postgres. Thx to Alexander Zhukov alex#unipack.ru
+<p>DB2 support for CHARACTER type added - thx John Huong huongch#bigfoot.com
+<p>For ado, $argProvider not properly checked. Fixed - kalimero#ngi.it
+<p>Added $conn->Replace() function for update with automatic insert if the record does not exist. 
+	Supported by all databases except interbase.
+<p><b>2.10 4 June 2002</b></p>
+<p>Added uniqueSort property to indicate mssql ORDER BY cols must be unique.
+<p>Optimized session handler by crc32 the data. We only write if session data has changed.
+<p>adodb_sess_read in adodb-session.php now returns ''correctly - thanks to Jorma Tuomainen, webmaster#wizactive.com
+<p>Mssql driver did not throw EXECUTE errors correctly because ErrorMsg() and ErrorNo() called in wrong order. 
+Pointed out by Alexios Fakos. Fixed.
+<p>Changed ado to use client cursors. This fixes BeginTran() problems with ado.
+<p>Added handling of timestamp type in ado.
+<p>Added to ado_mssql support for insert_id() and affected_rows().
+<p>Added support for mssql.datetimeconvert=0, available since php 4.2.0.
+<p>Made UnixDate() less strict, so that the time is ignored if present.
+<p>Changed quote() so that it checks for magic_quotes_gpc.
+<p>Changed maxblobsize for odbc to default to 64000.
+<p><b>2.00 13 May 2002</b></p>
+<p>Added drivers <i>informix72</i> for pre-7.3 versions, and <i>oci805</i> for 
+  oracle 8.0.5, and postgres64 for postgresql 6.4 and earlier. The postgres and postgres7 drivers
+  are now identical.
+<p>Interbase now partially supports ADODB_FETCH_BOTH, by defaulting to ASSOC mode.
+<p>Proper support for blobs in mssql. Also revised blob support code 
+is base class. Now UpdateBlobFile() calls UpdateBlob() for consistency.
+<p>Added support for changed odbc_fetch_into api in php 4.2.0 
+with $conn-&gt;_has_stupid_odbc_fetch_api_change.
+<p>Fixed spelling of tablock locking hint in GenID( ) for mssql. 
+<p>Added RowLock( ) to several databases, including oci8, informix, sybase, etc. 
+  Fixed where error in mssql RowLock().
+<p>Added sysDate and sysTimeStamp properties to most database drivers. These are the sql
+functions/constants for that database that return the current date and current timestamp, and 
+are useful for portable inserts and updates.
+<p>Support for RecordCount() caused date handling in sybase and mssql to break. 
+Fixed, thanks to Toni Tunkkari, by creating derived classes for ADORecordSet_array for
+both databases. Generalized using arrayClass property. Also to support RecordCount(), 
+changed metatype handling for ado drivers. Now the type returned in FetchField 
+  is no longer a number, but the 1-char data type returned by MetaType.
+  At the same time, fixed a lot of date handling. Now mssql support dmy and mdy date formats. 
+Also speedups in sybase and mssql with preg_match and ^ in date/timestamp handling.
+Added support in sybase and mssql for 24 hour clock in timestamps (no AM/PM).
+<p>Extensive revisions to informix driver - thanks to Samuel CARRIERE samuel_carriere#hotmail.com 
+<p>Added $ok parameter to CommitTrans($ok) for easy rollbacks.
+<p>Fixed odbc MetaColumns and MetaTables to save and restore $ADODB_FETCH_MODE.
+<p>Some odbc drivers did not call the base connection class constructor. Fixed.
+<p>Fixed regex for GetUpdateSQL() and GetInsertSQL() to support more legal character combinations.
+
+<p><b>1.99 21 April 2002</b></p>
+<p>Added emulated RecordCount() to all database drivers if $ADODB_COUNTRECS = true 
+  (which it is by default). Inspired by Cristiano Duarte (cunha17#uol.com.br). 
+<p>Unified stored procedure support for mssql and oci8. Parameter() and PrepareSP() 
+  functions implemented. 
+<p>Added support for SELECT FIRST in informix, modified hasTop property to support 
+  this. 
+<p>Changed csv driver to handle updates/deletes/inserts properly (when Execute() returns true).
+Bind params also work now, and raiseErrorFn with csv driver. Added csv driver to QA process. 
+<p>Better error checking in oci8 UpdateBlob() and UpdateBlobFile().
+<p>Added TIME type to MySQL - patch by Manfred h9125297#zechine.wu-wien.ac.at
+<p>Prepare/Execute implemented for Interbase/Firebird 
+<p>Changed some regular expressions to be anchored by /^ $/ for speed.
+<p>Added UnixTimeStamp() and UnixDate() to ADOConnection(). Now these functions 
+  are in both ADOConnection and ADORecordSet classes.
+<p>Empty recordsets were not cached - fixed.
+<p>Thanks to Gaetano Giunta (g.giunta#libero.it) for the oci8 code review. We 
+  didn't agree on everything, but i hoped we agreed to disagree! 
+<p><b>1.90 6 April 2002</b></p>
+<p>Now all database drivers support fetch modes ADODB_FETCH_NUM and ADODB_FETCH_ASSOC, though
+	still not fully tested. Eg. Frontbase, Sybase, Informix.
+<p>NextRecordSet() support for mssql. Contributed by "Sven Axelsson" sven.axelsson#bokochwebb.se
+<p>Added blob support for SQL Anywhere. Contributed by Wade Johnson wade#wadejohnson.de
+<p>Fixed some security loopholes in server.php. Server.php also supports fetch mode.
+<p>Generalized GenID() to support odbc and mssql drivers. Mssql no longer generates GUID's.
+<p>Experimental RowLock($table,$where) for mssql.
+<p>Properly implemented Prepare() in oci8 and ODBC.
+<p>Added Bind() support to oci8 to support Prepare().
+<p>Improved error handler. Catches CacheExecute() and GenID() errors now.
+<p>Now if you are running php from the command line, debugging messages do not output html formating.
+Not 100% complete, but getting there.
+<p><b>1.81 22 March 2002</b></p>
+<p>Restored default $ADODB_FETCH_MODE = ADODB_FETCH_DEFAULT for backward compatibility.
+<p>SelectLimit for oci8 improved - Our FIRST_ROWS optimization now does not overwrite existing hint.
+<p>New Sybase SQL Anywhere driver. Contributed by Wade Johnson wade#wadejohnson.de
+<p><b>1.80 15 March 2002</b></p>
+<p>Redesigned directory structure of ADOdb files. Added new driver directory where
+all database drivers reside.
+<p>Changed caching algorithm to create subdirectories. Now we scale better.
+<p>Informix driver now supports insert_id(). Contribution by "Andrea Pinnisi" pinnisi#sysnet.it
+<p>Added experimental ISO date and FetchField support for informix.
+<p>Fixed a quoting bug in Execute() with bind parameters, causing problems with blobs.
+<p>Mssql driver speedup by 10-15%.
+<p>Now in CacheExecute($secs2cache,$sql,...), $secs2cache is optional. If missing, it will
+take the value defined in $connection->cacheSecs (default is 3600 seconds). Note that
+CacheSelectLimit(), the secs2cache is still compulsory - sigh.
+<p>Sybase SQL Anywhere driver (using ODBC) contributed by Wade Johnson wade#wadejohnson.de
+<p><b>1.72 8 March 2002</b></p>
+<p>Added @ when returning Fields() to prevent spurious error - "Michael William Miller" mille562#pilot.msu.edu
+<p>MetaDatabases() for postgres contributed by Phil pamelant#nerim.net
+ <p>Mitchell T. Young (mitch#youngfamily.org) contributed informix driver.
+ <p>Fixed rs2html() problem. I cannot reproduce, so probably a problem with pre PHP 4.1.0 versions,
+  when supporting new ADODB_FETCH_MODEs.
+ <p>Mattia Rossi (mattia#technologist.com) contributed BlobDecode() and UpdateBlobFile() for postgresql
+ using the postgres specific pg_lo_import()/pg_lo_open() - i don't use them but hopefully others will
+ find this useful. See <a href="http://phplens.com/lens/lensforum/msgs.php?id=1262">this posting</a>
+ for an example of usage.
+ <p>Added UpdateBlobFile() for uploading files to a database.
+ <p>Made UpdateBlob() compatible with oci8po driver.
+ <p>Added noNullStrings support to oci8 driver. Oracle changes all ' ' strings to nulls,
+  so you need to set strings to ' ' to prevent the nullifying of strings. $conn->noNullStrings = true;
+  will do this for you automatically. This is useful when you define a char column as NOT NULL.
+  <p>Fixed UnixTimeStamp() bug - wasn't setting minutes and seconds properly. Patch from Agusti Fita i Borrell agusti#anglatecnic.com.
+  <p>Toni Tunkkari added patch for sybase dates. Problem with spaces in day part of date fixed.
+ <p><b>1.71 18 Jan 2002</b></p>
+ <p>Sequence start id support. Now $conn->Gen_ID('seqname', 50) to start sequence from 50.
+ <p>CSV driver fix for selectlimit, from Andreas - akaiser#vocote.de.
+<P>Gam3r spotted that a global variable was undefined in the session handler. 
+<p>Mssql date regex had error. Fixed - reported by Minh Hoang vb_user#yahoo.com.
+<p>DBTimeStamp() and DBDate() now accept iso dates and unix timestamps. This means
+that the PostgreSQL handling of dates in GetInsertSQL() and GetUpdateSQL() can
+be removed. Also if these functions are passed '' or null or false, we return a SQL null.
+<p>GetInsertSQL() and GetUpdateSQL() now accept a new parameter, $magicq to 
+indicate whether quotes should be inserted based on magic quote settings - suggested by
+dj#4ict.com.
+<p>Reformated docs slightly based on suggestions by Chris Small.
+ <p><b>1.65 28 Dec 2001</b></p>
+ <p>Fixed borland_ibase class naming bug.
+ <p>Now instead of using $rs->fields[0] internally, we use reset($rs->fields) so 
+ that we are compatible with ADODB_FETCH_ASSOC mode. Reported by Nico S.
+ <p>Changed recordset constructor and _initrs() for oci8 so that it returns the field definitions even
+ if no rows in the recordset. Reported by Rick Hickerson (rhickers#mv.mv.com).
+ <p>Improved support for postgresql in GetInsertSQL and GetUpdateSQL by
+  "mike" mike#partner2partner.com  and "Ryan Bailey" rebel#windriders.com
+ <p><b>1.64 20 Dec 2001</b></p>
+<p>Danny Milosavljevic &lt;danny.milo#gmx.net> added some patches for MySQL error handling
+and displaying default values.
+<p>Fixed some ADODB_FETCH_BOTH inconsistencies in odbc and interbase.
+<p>Added more tests to test suite to cover ADODB_FETCH_* and ADODB_ERROR_HANDLER.
+<p>Added firebird (ibase) driver
+<p>Added borland_ibase driver for interbase 6.5
+<p><b>1.63 13 Dec 2001</b></p>
+Absolute to the adodb-lib.inc.php file not set properly. Fixed.<p>
+
+<p><b>1.62 11 Dec 2001</b></p>
+<p>Major speedup of ADOdb for low-end web sites by reducing the php code loading and compiling
+cycle. We conditionally compile not so common functions. 
+Moved csv code to adodb-csvlib.inc.php to reduce adodb.inc.php parsing. This file
+is loaded only when the csv/proxy driver is used, or CacheExecute() is run.
+Also moved PageExecute(), GetSelectSQL() and GetUpdateSQL() core code to adodb-lib.inc.php.
+This reduced the 70K main adodb.inc.php file to 55K, and since at least 20K of the file
+is comments, we have reduced 50K of code in adodb.inc.php to 35K. There
+ should be 35% reduction in memory and thus 35% speedup in compiling the php code for the
+main adodb.inc.php file.
+<p>Highly tuned SelectLimit() for oci8 for massive speed improvements on large files. 
+Selecting 20 rows starting from the 20,000th row of a table is now 7 times faster. 
+Thx to Tomas V V Cox.
+<p>Allow . and # in table definitions in GetInsertSQL and GetUpdateSQL.
+ See ADODB_TABLE_REGEX constant. Thx to Ari Kuorikoski.
+<p>Added ADODB_PREFETCH_ROWS constant, defaulting to 10. This determines the number
+of records to prefetch in a SELECT statement. Only used by oci8.</p>
+<p>Added high portability Oracle class called oci8po. This uses ? for bind variables, and 
+lower cases column names.</p>
+<p>Now all database drivers support $ADODB_FETCH_MODE, including interbase, ado, and odbc:
+ADODB_FETCH_NUM and ADODB_FETCH_ASSOC. ADODB_FETCH_BOTH is not fully implemented for all 
+database drivers.
+<p><b>1.61 Nov 2001</b></p>
+<p>Added PO_RecordCount() and PO_Insert_ID(). PO stands for portable. Pablo Roca 
+  [pabloroca#mvps.org]</p>
+<p>GenID now returns 0 if not available. Safer is that you should check $conn->hasGenID 
+  for availability.</p>
+<p>M'soft ADO we now correctly close recordset in _close() peterd#telephonetics.co.uk</p>
+<p>MSSQL now supports GenID(). It generates a 16-byte GUID from mssql newid() 
+  function.</p>
+<p>Changed ereg_replace to preg_replace in SelectLimit. This is a fix for mssql. 
+  Ereg doesn't support t or n! Reported by marino Carlos xaplo#postnuke-espanol.org</p>
+<p>Added $recordset->connection. This is the ADOConnection object for the recordset. 
+Works with cached and normal recordsets. Surprisingly, this had no affect on performance!</p>
+<p><b>1.54 15 Nov 2001</b></p>
+Fixed some more bugs in PageExecute().  I am getting sick of bug in this and will have to 
+reconsider my QA here. The main issue is that I don't use PageExecute() and 
+to check whether it is working requires a visual inspection of the html generated currently.
+It is possible to write a test script but it would be quite complicated :(
+<p> More speedups of SelectLimit() for DB2, Oci8, access, vfp, mssql.
+<p>
+
+<p><b>1.53 7 Nov 2001</b></p>
+Added support for ADODB_FETCH_ASSOC for ado and odbc drivers.<p>
+Tuned GetRowAssoc(false) in postgresql and mysql.<p>
+Stephen Van Dyke contributed ADOdb icon, accepted with some minor mods.<p>
+Enabled Affected_Rows() for postgresql<p>
+Speedup for Concat() using implode() - Benjamin Curtis ben_curtis#yahoo.com<p>
+Fixed some more bugs in PageExecute() to prevent infinite loops<p>
+<p><b>1.52 5 Nov 2001</b></p>
+Spelling error in CacheExecute() caused it to fail. $ql should be $sql in line 625!<p>
+Added fixes for parsing [ and ] in GetUpdateSQL().
+<p><b>1.51 5 Nov 2001</b></p>
+<p>Oci8 SelectLimit() speedup by using OCIFetch().
+<p>Oci8 was mistakenly reporting errors when $db->debug = true.
+<p>If a connection failed with ODBC, it was not correctly reported - fixed.
+<p>_connectionID was inited to -1, changed to false.
+<p>Added $rs->FetchRow(), to simplify API, ala PEAR DB
+<p>Added PEAR DB compat mode, which is still faster than PEAR! See adodb-pear.inc.php.
+<p>Removed postgres pconnect debugging statement.
+<p><b>1.50 31 Oct 2001</b></p>
+<p>ADOdbConnection renamed to ADOConnection, and ADOdbFieldObject to ADOFieldObject.
+<p>PageExecute() now checks for empty $rs correctly, and the errors in the docs on this subject have been fixed.
+<p>odbc_error() does not return 6 digit error correctly at times. Implemented workaround.
+<p>Added ADORecordSet_empty class. This will speedup INSERTS/DELETES/UPDATES because the return
+object created is much smaller.
+<p>Added Prepare() to odbc, and oci8 (but doesn't work properly for oci8 still).
+<p>Made pgsql a synonym for postgre7, and changed SELECT LIMIT to use OFFSET for compat with 
+postgres 7.2.
+<p>Revised adodb-cryptsession.php thanks to Ari.
+<p>Set resources to false on _close, to force freeing of resources.
+<p>Added adodb-errorhandler.inc.php, adodb-errorpear.inc.php and raiseErrorFn on Freek's urging.
+<p>GetRowAssoc($toUpper=true): $toUpper added as default.
+<p>Errors when connecting to a database were not captured formerly. Now we do it correctly.
+<p><b>1.40 19 September 2001</b></p>
+<p>PageExecute() to implement page scrolling added. Code and idea by Iv&aacute;n Oliva.</p>
+<p>Some minor postgresql fixes.</p>
+<p>Added sequence support using GenID() for postgresql, oci8, mysql, interbase.</p>
+<p>Added UpdateBlob support for interbase (untested).</p>
+<p>Added encrypted sessions (see adodb-cryptsession.php). By Ari Kuorikoski &lt;kuoriari#finebyte.com></p>
+<p><b>1.31 21 August 2001</b></p>
+<p>Many bug fixes thanks to "GaM3R (Cameron)" &lt;gamr#outworld.cx>. Some session changes due to Gam3r.
+<p>Fixed qstr() to quote  also.
+<p>rs2html() now pretty printed.
+<p>Jonathan Younger jyounger#unilab.com contributed the great idea GetUpdateSQL() and GetInsertSQL() which
+generates SQL to update and insert into a table from a recordset. Modify the recordset fields
+array, then can this function to generate the SQL (the SQL is not executed).
+<p>"Nicola Fankhauser" &lt;nicola.fankhauser#couniq.com> found some bugs in date handling for mssql.</p>
+<p>Added minimal Oracle support for LOBs. Still under development.</p>
+Added $ADODB_FETCH_MODE so you can control whether recordsets return arrays which are
+numeric, associative or both. This is a global variable you set. Currently only MySQL, Oci8, Postgres
+drivers support this.
+<p>PostgreSQL properly closes recordsets now. Reported by several people.
+<p>
+Added UpdateBlob() for Oracle. A hack to make it easier to save blobs.
+<p>
+Oracle timestamps did not display properly. Fixed.
+<p><b>1.20 6 June 2001</b></p>
+<p>Now Oracle can connect using tnsnames.ora or server and service name</p>
+<p>Extensive Oci8 speed optimizations. 
+Oci8 code revised to support variable binding, and /*+ FIRST_ROWS */ hint.</p>
+<p>Worked around some 4.0.6 bugs in odbc_fetch_into().</p>
+<p>Paolo S. Asioli paolo.asioli#libero.it suggested GetRowAssoc().</p>
+<p>Escape quotes for oracle wrongly set to '. Now '' is used.</p>
+<p>Variable binding now works in ODBC also.</p>
+<p>Jumped to version 1.20 because I don't like 13 :-)</p>
+<p><b>1.12 6 June 2001</b></p>
+<p>Changed $ADODB_DIR to ADODB_DIR constant to plug a security loophole.</p>
+<p>Changed _close() to close persistent connections also. Prevents connection leaks.</p>
+<p>Major revision of oracle and oci8 drivers. 
+Added OCI_RETURN_NULLS and OCI_RETURN_LOBS to OCIFetchInto(). BLOB, CLOB and VARCHAR2 recognition
+in MetaType() improved. MetaColumns() returns columns in correct sort order.</p>
+<p>Interbase timestamp input format was wrong. Fixed.</p>
+<p><b>1.11 20 May 2001</b></p>
+<p>Improved file locking for Windows.</p>
+<p>Probabilistic flushing of cache to avoid avalanche updates when cache timeouts.</p>
+<p>Cached recordset timestamp not saved in some scenarios. Fixed.</p>
+<p><b>1.10 19 May 2001</b></p>
+<p>Added caching. CacheExecute() and CacheSelectLimit().
+<p>Added csv driver. See <a href="http://php.weblogs.com/adodb_csv">http://php.weblogs.com/ADODB_csv</a>. 
+<p>Fixed SelectLimit(), SELECT TOP not working under certain circumstances.
+<p>Added better Frontbase support of MetaTypes() by Frank M. Kromann.
+<p><b>1.01 24 April 2001</b></p>
+<p>Fixed SelectLimit bug.  not quoted properly.
+<p>SelectLimit: SELECT TOP -1 * FROM TABLE not support by Microsoft. Fixed.</p>
+<p>GetMenu improved by glen.davies#cce.ac.nz to support multiple hilited items<p>
+<p>FetchNextObject() did not work with only 1 record returned. Fixed bug reported by $tim#orotech.net</p>
+<p>Fixed mysql field max_length problem. Fix suggested by Jim Nicholson (jnich#att.com)</p>
+<p><b>1.00 16 April 2001</b></p>
+<p>Given some brilliant suggestions on how to simplify ADOdb by akul. You no longer need to
+setup $ADODB_DIR yourself, and ADOLoadCode() is automatically called by ADONewConnection(), 
+simplifying the startup code.</p>
+<p>FetchNextObject() added. Suggested by Jakub Marecek. This makes FetchObject() obsolete, as
+this is more flexible and powerful.</p>
+<p>Misc fixes to SelectLimit() to support Access (top must follow distinct) and Fields() 
+in the array recordset. From Reinhard Balling.</p>
+<p><b>0.96 27 Mar 2001</b></p>
+<p>ADOConnection Close() did not return a value correctly. Thanks to akul#otamedia.com.</p>
+<p>When the horrible magic_quotes is enabled, back-slash () is changed to double-backslash (\).
+This doesn't make sense for Microsoft/Sybase databases. We fix this in qstr().</p>
+<p>Fixed Sybase date problem in UnixDate() thanks to Toni Tunkkari. Also fixed MSSQL problem
+in UnixDate() - thanks to milhouse31#hotmail.com.</p>
+<p>MoveNext() moved to leaf classes for speed in MySQL/PostgreSQL. 10-15% speedup.</p>
+<p>Added null handling in bindInputArray in Execute() -- Ron Baldwin suggestion.</p>
+<p>Fixed some option tags. Thanks to john#jrmstudios.com.</p>
+<p><b>0.95 13 Mar 2001</b></p>
+<p>Added postgres7 database driver which supports LIMIT and other version 7 stuff in the future.</p>
+<p>Added SelectLimit to ADOConnection to simulate PostgreSQL's "select * from table limit 10 offset 3".
+Added helper function GetArrayLimit() to ADORecordSet.</p>
+<p>Fixed mysql metacolumns bug. Thanks to Freek Dijkstra (phpeverywhere#macfreek.com).</p>
+<p>Also many PostgreSQL changes by Freek. He almost rewrote the whole PostgreSQL driver!</p>
+<p>Added fix to input parameters in Execute for non-strings by Ron Baldwin.</p>
+<p>Added new metatype, X for TeXt. Formerly, metatype B for Blob also included
+text fields. Now 'B' is for binary/image data. 'X' for textual data.</p>
+<p>Fixed $this->GetArray() in GetRows().</p>
+<p>Oracle and OCI8: 1st parameter is always blank -- now warns if it is filled.</p>
+<p>Now <i>hasLimit</i> and <i>hasTop</i> added to indicate whether 
+SELECT * FROM TABLE LIMIT 10 or SELECT TOP 10 * FROM TABLE are supported.</p>
+<p><b>0.94 04 Feb 2001</b></p>
+<p>Added ADORecordSet::GetRows() for compatibility with Microsoft ADO. Synonym for GetArray().</p>
+<p>Added new metatype 'R' to represent autoincrement numbers.</p>
+<p>Added ADORecordSet.FetchObject() to return a row as an object.</p>
+<p>Finally got a Linux box to test PostgreSql. Many fixes.</p>
+<p>Fixed copyright misspellings in 0.93.</p>
+<p>Fixed mssql MetaColumns type bug.</p>
+<p>Worked around odbc bug in PHP4 for sessions.</p>
+<p>Fixed many documentation bugs (affected_rows, metadatabases, qstr).</p>
+<p>Fixed MySQL timestamp format (removed comma).</p>
+<p>Interbase driver did not call ibase_pconnect(). Fixed.</p>
+<p><b>0.93 18 Jan 2002</b></p>
+<p>Fixed GetMenu bug.</p>
+<p>Simplified Interbase commit and rollback.</p>
+<p>Default behaviour on closing a connection is now to rollback all active transactions.</p>
+<p>Added field object handling for array recordset for future XML compatibility.</p>
+<p>Added arr2html() to convert array to html table.</p>
+<p><b>0.92 2 Jan 2002</b></p>
+<p>Interbase Commit and Rollback should be working again.</p>
+<p>Changed initialisation of ADORecordSet. This is internal and should not affect users. We
+are doing this to support cached recordsets in the future.</p>
+
+<p>Implemented ADORecordSet_array class. This allows you to simulate a database recordset
+with an array.</p>
+<p>Added UnixDate() and UnixTimeStamp() to ADORecordSet.</p>
+<p><b>0.91 21 Dec 2000</b></p>
+<p>Fixed ODBC so ErrorMsg() is working.</p>
+<p>Worked around ADO unrecognised null (0x1) value problem in COM.</p>
+<p>Added Sybase support for FetchField() type</p>
+<p>Removed debugging code and unneeded html from various files</p>
+<p>Changed to javadoc style comments to adodb.inc.php.</p>
+<p>Added maxsql as synonym for mysqlt</p>
+<p>Now ODBC downloads first 8K of blob by default
+<p><b>0.90 15 Nov 2000</b></p>
+<p>Lots of testing of Microsoft ADO. Should be more stable now.</p>
+<p>Added $ADODB_COUNTREC. Set to false for high speed selects.</p>
+<p>Added Sybase support. Contributed by Toni Tunkkari (toni.tunkkari#finebyte.com). Bug in Sybase 
+  API: GetFields is unable to determine date types.</p>
+<p>Changed behaviour of RecordSet.GetMenu() to support size parameter (listbox) properly.</p>
+<p>Added emptyDate and emptyTimeStamp to RecordSet class that defines how to represent 
+  empty dates.</p>
+<p>Added MetaColumns($table) that returns an array of ADOFieldObject's listing 
+  the columns of a table.</p>
+<p>Added transaction support for PostgresSQL -- thanks to "Eric G. Werk" egw#netguide.dk.</p>
+<p>Added adodb-session.php for session support.</p>
+<p><b>0.80 30 Nov 2000</b></p>
+<p>Added support for charSet for interbase. Implemented MetaTables for most databases. 
+  PostgreSQL more extensively tested.</p>
+<p><b>0.71 22 Nov 2000</b></p>
+<p>Switched from using require_once to include/include_once for backward compatability with PHP 4.02 and earlier.</p>
+<p><b>0.70 15 Nov 2000</b></p>
+<p>Calls by reference have been removed (call_time_pass_reference=Off) to ensure compatibility with future versions of PHP, 
+except in Oracle 7 driver due to a bug in php_oracle.dll.</p>
+<p>PostgreSQL database driver contributed by Alberto Cerezal (acerezalp#dbnet.es). 
+</p>
+<p>Oci8 driver for Oracle 8 contributed by George Fourlanos (fou#infomap.gr).</p>
+<p>Added <i>mysqlt</i> database driver to support MySQL 3.23 which has transaction 
+ support. </p>
+<p>Oracle default date format (DD-MON-YY) did not match ADOdb default date format (which is YYYY-MM-DD). Use ALTER SESSION to force the default date.</p>
+<p>Error message checking is now included in test suite.</p>
+<p>MoveNext() did not check EOF properly -- fixed.</p>
+<p><b>0.60 Nov 8 2000</b></p>
+<p>Fixed some constructor bugs in ODBC and ADO. Added ErrorNo function to ADOConnection 
+ class. </p>
+<p><b>0.51 Oct 18 2000</b></p>
+<p>Fixed some interbase bugs.</p>
+<p><b>0.50 Oct 16 2000</b></p>
+<p>Interbase commit/rollback changed to be compatible with PHP 4.03. </p>
+<p>CommitTrans( ) will now return true if transactions not supported. </p>
+<p>Conversely RollbackTrans( ) will return false if transactions not supported. 
+</p>
+<p><b>0.46 Oct 12</b></p>
+Many Oracle compatibility issues fixed. 
+<p><b>0.40 Sept 26</b></p>
+<p>Many bug fixes</p>
+<p>Now Code for BeginTrans, CommitTrans and RollbackTrans is working. So is the Affected_Rows
+and Insert_ID. Added above functions to test.php.</p>
+<p>ADO type handling was busted in 0.30. Fixed.</p>
+<p>Generalised Move( ) so it works will all databases, including ODBC.</p>
+<p><b>0.30 Sept 18</b></p>
+<p>Renamed ADOLoadDB to ADOLoadCode. This is clearer.</p>
+<p>Added BeginTrans, CommitTrans and RollbackTrans functions.</p>
+<p>Added Affected_Rows() and Insert_ID(), _affectedrows() and _insertID(), ListTables(), 
+ ListDatabases(), ListColumns().</p>
+<p>Need to add New_ID() and hasInsertID and hasAffectedRows, autoCommit </p>
+<p><b>0.20 Sept 12</b></p>
+<p>Added support for Microsoft's ADO.</p>
+<p>Added new field to ADORecordSet -- canSeek</p>
+<p>Added new parameter to _fetch($ignore_fields = false). Setting to true will 
+ not update fields array for faster performance.</p>
+<p>Added new field to ADORecordSet/ADOConnection -- dataProvider to indicate whether 
+ a class is derived from odbc or ado.</p>
+<p>Changed class ODBCFieldObject to ADOFieldObject -- not documented currently.</p>
+<p>Added benchmark.php and testdatabases.inc.php to the test suite.</p>
+<p>Added to ADORecordSet FastForward( ) for future high speed scrolling. Not documented.</p>
+<p>Realised that ADO's Move( ) uses relative positioning. ADOdb uses absolute. 
+</p>
+<p><b>0.10 Sept 9 2000</b></p>
+<p>First release</p>
 </body></html>
\ No newline at end of file
diff --git a/third_party/adodb/docs/readme.htm b/third_party/adodb/docs/readme.htm
index e2c0bb5..4780cb7 100644
--- a/third_party/adodb/docs/readme.htm
+++ b/third_party/adodb/docs/readme.htm
@@ -1,68 +1,68 @@
-<html>
-<head>
-<title>ADODB Manual</title>
-<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
-<XSTYLE
-	body,td {font-family:Arial,Helvetica,sans-serif;font-size:11pt}
-	pre {font-size:9pt}
-	.toplink {font-size:8pt}
-	/>
-</head>	
-<body bgcolor="#FFFFFF">
-
-<h3>ADOdb Library for PHP</h3>
-<p>ADOdb is a suite of database libraries that allow you to connect to multiple 
-	databases in a portable manner. Download from <a href=http://adodb.sourceforge.net/>http://adodb.sourceforge.net/</a>.
-<ul><li>The ADOdb documentation has moved to <a href=docs-adodb.htm>docs-adodb.htm</a> 
-	This allows you to query, update and insert records using a portable API.
-<p><li>The ADOdb data dictionary docs are at <a href=docs-datadict.htm>docs-datadict.htm</a>. 
-	This allows you to create database tables and indexes in a portable manner.
-<p><li>The ADOdb database performance monitoring docs are at <a href=docs-perf.htm>docs-perf.htm</a>. 
-	This allows you to perform health checks, tune and monitor your database.
-<p><li>The ADOdb database-backed session docs are at <a href=docs-session.htm>docs-session.htm</a>. 
-</ul>
-<p>
-<h3>Installation</h3>
-Make sure you are running PHP4.0.4 or later. Unpack all the files into a directory accessible by your webserver.
-<p>
-To test, try modifying some of the tutorial examples. Make sure you customize the connection settings correctly. You can debug using:
-<pre>
-&lt;?php
-include('adodb/adodb.inc.php');
-
-$db = <b>ADONewConnection</b>($driver); # eg. 'mysql' or 'oci8' 
-$db->debug = true;
-$db-><b>Connect</b>($server, $user, $password, $database);
-$rs = $db-><b>Execute</b>('select * from some_small_table');
-print "&lt;pre>";
-print_r($rs-><b>GetRows</b>());
-print "&lt;/pre>";
-?>
-</pre>
-<h3>How are people using ADOdb</h3>
-Here are some examples of how people are using ADOdb: 
-<ul>
-	<li> <strong>PhpLens</strong> is a commercial data grid component that allows 
-		both cool Web designers and serious unshaved programmers to develop and 
-		maintain databases on the Web easily. Developed by the author of ADOdb. 
-	</li>
-	<li> <strong>PHAkt</strong>: PHP Extension for DreamWeaver Ultradev allows 
-		you to script PHP in the popular Web page editor. Database handling provided 
-		by ADOdb. </li>
-	<li> <strong>Analysis Console for Intrusion Databases (ACID)</strong>: PHP-based 
-		analysis engine to search and process a database of security incidents 
-		generated by security-related software such as IDSes and firewalls (e.g. 
-		Snort, ipchains). By Roman Danyliw. </li>
-	<li> <strong>PostNuke</strong> is a very popular free content management system 
-		and weblog system. It offers full CSS support, HTML 4.01 transitional 
-		compliance throughout, an advanced blocks system, and is fully multi-lingual 
-		enabled. </li>
-	<li><strong> EasyPublish CMS</strong> is another free content management system 
-		for managing information and integrated modules on your internet, intranet- 
-		and extranet-sites. From Norway. </li>
-	<li> <strong>NOLA</strong> is a full featured accounting, inventory, and job 
-		tracking application. It is licensed under the GPL, and developed by Noguska. 
-	</li>
-</ul>
-</body>
-</html>
+<html>
+<head>
+<title>ADODB Manual</title>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
+<XSTYLE
+	body,td {font-family:Arial,Helvetica,sans-serif;font-size:11pt}
+	pre {font-size:9pt}
+	.toplink {font-size:8pt}
+	/>
+</head>	
+<body bgcolor="#FFFFFF">
+
+<h3>ADOdb Library for PHP</h3>
+<p>ADOdb is a suite of database libraries that allow you to connect to multiple 
+	databases in a portable manner. Download from <a href=http://adodb.sourceforge.net/>http://adodb.sourceforge.net/</a>.
+<ul><li>The ADOdb documentation has moved to <a href=docs-adodb.htm>docs-adodb.htm</a> 
+	This allows you to query, update and insert records using a portable API.
+<p><li>The ADOdb data dictionary docs are at <a href=docs-datadict.htm>docs-datadict.htm</a>. 
+	This allows you to create database tables and indexes in a portable manner.
+<p><li>The ADOdb database performance monitoring docs are at <a href=docs-perf.htm>docs-perf.htm</a>. 
+	This allows you to perform health checks, tune and monitor your database.
+<p><li>The ADOdb database-backed session docs are at <a href=docs-session.htm>docs-session.htm</a>. 
+</ul>
+<p>
+<h3>Installation</h3>
+Make sure you are running PHP4.0.4 or later. Unpack all the files into a directory accessible by your webserver.
+<p>
+To test, try modifying some of the tutorial examples. Make sure you customize the connection settings correctly. You can debug using:
+<pre>
+&lt;?php
+include('adodb/adodb.inc.php');
+
+$db = <b>ADONewConnection</b>($driver); # eg. 'mysql' or 'oci8' 
+$db->debug = true;
+$db-><b>Connect</b>($server, $user, $password, $database);
+$rs = $db-><b>Execute</b>('select * from some_small_table');
+print "&lt;pre>";
+print_r($rs-><b>GetRows</b>());
+print "&lt;/pre>";
+?>
+</pre>
+<h3>How are people using ADOdb</h3>
+Here are some examples of how people are using ADOdb: 
+<ul>
+	<li> <strong>PhpLens</strong> is a commercial data grid component that allows 
+		both cool Web designers and serious unshaved programmers to develop and 
+		maintain databases on the Web easily. Developed by the author of ADOdb. 
+	</li>
+	<li> <strong>PHAkt</strong>: PHP Extension for DreamWeaver Ultradev allows 
+		you to script PHP in the popular Web page editor. Database handling provided 
+		by ADOdb. </li>
+	<li> <strong>Analysis Console for Intrusion Databases (ACID)</strong>: PHP-based 
+		analysis engine to search and process a database of security incidents 
+		generated by security-related software such as IDSes and firewalls (e.g. 
+		Snort, ipchains). By Roman Danyliw. </li>
+	<li> <strong>PostNuke</strong> is a very popular free content management system 
+		and weblog system. It offers full CSS support, HTML 4.01 transitional 
+		compliance throughout, an advanced blocks system, and is fully multi-lingual 
+		enabled. </li>
+	<li><strong> EasyPublish CMS</strong> is another free content management system 
+		for managing information and integrated modules on your internet, intranet- 
+		and extranet-sites. From Norway. </li>
+	<li> <strong>NOLA</strong> is a full featured accounting, inventory, and job 
+		tracking application. It is licensed under the GPL, and developed by Noguska. 
+	</li>
+</ul>
+</body>
+</html>
diff --git a/third_party/adodb/docs/tips_portable_sql.htm b/third_party/adodb/docs/tips_portable_sql.htm
index 685749c..aa75069 100644
--- a/third_party/adodb/docs/tips_portable_sql.htm
+++ b/third_party/adodb/docs/tips_portable_sql.htm
@@ -1,367 +1,367 @@
-<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
-
-<html>
-<head>
-	<title>Tips on Writing Portable SQL for Multiple Databases for PHP</title>
-</head>
-
-<body bgcolor=white>
-<table width=100% border=0><tr><td><h2>Tips on Writing Portable SQL &nbsp;</h2></td><td>
- <div align=right><img src="cute_icons_for_site/adodb.gif"></div></td></tr></table>
-  <p>Updated 6 Oct 2006. Added OffsetDate example.
-  <p>Updated 18 Sep 2003. Added Portable Native SQL section.
-<p>
-
- If you are writing an application that is used in multiple environments and 
-  operating systems, you need to plan to support multiple databases. This article 
-  is based on my experiences with multiple database systems, stretching from 4th 
-  Dimension in my Mac days, to the databases I currently use, which are: Oracle, 
-  FoxPro, Access, MS SQL Server and MySQL. Although most of the advice here applies 
-  to using SQL with Perl, Python and other programming languages, I will focus on PHP and how 
-  the <a href="http://adodb.sourceforge.net/">ADOdb</a> database abstraction library 
-  offers some solutions.<p></p>
-<p>Most database vendors practice product lock-in. The best or fastest way to 
-  do things is often implemented using proprietary extensions to SQL. This makes 
-  it extremely hard to write portable SQL code that performs well under all conditions. 
-  When the first ANSI committee got together in 1984 to standardize SQL, the database 
-  vendors had such different implementations that they could only agree on the 
-  core functionality of SQL. Many important application specific requirements 
-  were not standardized, and after so many years since the ANSI effort began, 
-  it looks as if much useful database functionality will never be standardized. 
-  Even though ANSI-92 SQL has codified much more, we still have to implement portability 
-  at the application level.</p>
-<h3><b>Selects</b></h3>
-<p>The SELECT statement has been standardized to a great degree. Nearly every 
-  database supports the following:</p>
-<p>SELECT [cols] FROM [tables]<br>
-  &nbsp;&nbsp;[WHERE conditions]<br>
-  &nbsp; [GROUP BY cols]<br>
-  &nbsp; [HAVING conditions] <br>
-  &nbsp; [ORDER BY cols]</p>
-<p>But so many useful techniques can only be implemented by using proprietary 
-  extensions. For example, when writing SQL to retrieve the first 10 rows for 
-  paging, you could write...</p>
-<table width="80%" border="1" cellspacing="0" cellpadding="0" align="center">
-  <tr> 
-	<td><b>Database</b></td>
-	<td><b>SQL Syntax</b></td>
-  </tr>
-  <tr> 
-	<td>DB2</td>
-	<td>select * from table fetch first 10 rows only</td>
-  </tr>
-  <tr> 
-	<td>Informix</td>
-	<td>select first 10 * from table</td>
-  </tr>
-  <tr> 
-	<td>Microsoft SQL Server and Access</td>
-	<td>select top 10 * from table</td>
-  </tr>
-  <tr> 
-	<td>MySQL and PostgreSQL</td>
-	<td>select * from table limit 10</td>
-  </tr>
-  <tr> 
-	<td>Oracle 8i</td>
-	<td>select * from (select * from table) where rownum &lt;= 10</td>
-  </tr>
-</table>
-<p>This feature of getting a subset of data is so useful that in the PHP class 
-  library ADOdb, we have a SelectLimit( ) function that allows you to hide the 
-  implementation details within a function that will rewrite your SQL for you:</p>
-<pre>$connection-&gt;SelectLimit('select * from table', 10);
-</pre>
-<p><b>Selects: Fetch Modes</b></p>
-<p>PHP allows you to retrieve database records as arrays. You can choose to have 
-  the arrays indexed by field name or number. However different low-level PHP 
-  database drivers are inconsistent in their indexing efforts. ADOdb allows you 
-  to determine your prefered mode. You set this by setting the variable $ADODB_FETCH_MODE 
-  to either of the constants ADODB_FETCH_NUM (for numeric indexes) or ADODB_FETCH_ASSOC 
-  (using field names as an associative index).</p>
-<p>The default behaviour of ADOdb varies depending on the database you are using. 
-  For consistency, set the fetch mode to either ADODB_FETCH_NUM (for speed) or 
-  ADODB_FETCH_ASSOC (for convenience) at the beginning of your code. </p>
-<p><b>Selects: Counting Records</b></p>
-<p>Another problem with SELECTs is that some databases do not return the number 
-  of rows retrieved from a select statement. This is because the highest performance 
-  databases will return records to you even before the last record has been found. 
-</p>
-<p>In ADOdb, RecordCount( ) returns the number of rows returned, or will emulate 
-  it by buffering the rows and returning the count after all rows have been returned. 
-  This can be disabled for performance reasons when retrieving large recordsets 
-  by setting the global variable $ADODB_COUNTRECS = false. This variable is checked 
-  every time a query is executed, so you can selectively choose which recordsets 
-  to count.</p>
-<p>If you prefer to set $ADODB_COUNTRECS = false, ADOdb still has the PO_RecordCount( 
-  ) function. This will return the number of rows, or if it is not found, it will 
-  return an estimate using SELECT COUNT(*):</p>
-<pre>$rs = $db-&gt;Execute(&quot;select * from table where state=$state&quot;);
-$numrows = $rs-&gt;PO_RecordCount('table', &quot;state=$state&quot;);</pre>
-<p><b>Selects: Locking</b> </p>
-<p>SELECT statements are commonly used to implement row-level locking of tables. 
-  Other databases such as Oracle, Interbase, PostgreSQL and MySQL with InnoDB 
-  do not require row-level locking because they use versioning to display data 
-  consistent with a specific point in time.</p>
-<p>Currently, I recommend encapsulating the row-level locking in a separate function, 
-  such as RowLock($table, $where):</p>
-<pre>$connection-&gt;BeginTrans( );
-$connection-&gt;RowLock($table, $where); </pre>
-<pre><font color=green># some operation</font></pre>
-<pre>if ($ok) $connection-&gt;CommitTrans( );
-else $connection-&gt;RollbackTrans( );
-</pre>
-<p><b>Selects: Outer Joins</b></p>
-<p>Not all databases support outer joins. Furthermore the syntax for outer joins 
-  differs dramatically between database vendors. One portable (and possibly slower) 
-  method of implementing outer joins is using UNION.</p>
-<p>For example, an ANSI-92 left outer join between two tables t1 and t2 could 
-  look like:</p>
-<pre>SELECT t1.col1, t1.col2, t2.cola <br>  FROM t1 <i>LEFT JOIN</i> t2 ON t1.col = t2.col</pre>
-<p>This can be emulated using:</p>
-<pre>SELECT t1.col1, t1.col2, t2.cola FROM t1, t2 <br>	   WHERE t1.col = t2.col 
-   UNION ALL
-SELECT col1, col2, null FROM t1 <br>	   WHERE t1.col not in (select distinct col from t2)
-</pre>
-<p>Since ADOdb 2.13, we provide some hints in the connection object as to legal 
-  join variations. This is still incomplete and sometimes depends on the database 
-  version you are using, but is useful as a general guideline:</p>
-<p><font face="Courier New, Courier, mono">$conn-&gt;leftOuter</font>: holds the 
-  operator used for left outer joins (eg. '*='), or false if not known or not 
-  available.<br>
-  <font face="Courier New, Courier, mono">$conn-&gt;rightOuter</font>: holds the 
-  operator used for right outer joins (eg '=*'), or false if not known or not 
-  available.<br>
-  <font face="Courier New, Courier, mono">$conn-&gt;ansiOuter</font>: boolean 
-  that if true means that ANSI-92 style outer joins are supported, or false if 
-  not known.</p>
-<h3><b>Inserts</b> </h3>
-<p>When you create records, you need to generate unique id's for each record. 
-  There are two common techniques: (1) auto-incrementing columns and (2) sequences. 
-</p>
-<p>Auto-incrementing columns are supported by MySQL, Sybase and Microsoft Access 
-  and SQL Server. However most other databases do not support this feature. So 
-  for portability, you have little choice but to use sequences. Sequences are 
-  special functions that return a unique incrementing number every time you call 
-  it, suitable to be used as database keys. In ADOdb, we use the GenID( ) function. 
-  It has takes a parameter, the sequence name. Different tables can have different 
-  sequences. </p>
-<pre>$id = $connection-&gt;GenID('sequence_name');<br>$connection-&gt;Execute(&quot;insert into table (id, firstname, lastname) <br>			   values ($id, $firstname, $lastname)&quot;);</pre>
-<p>For databases that do not support sequences natively, ADOdb emulates sequences 
-  by creating a table for every sequence.</p>
-<h3><b>Binding</b></h3>
-<p>Binding variables in an SQL statement is another tricky feature. Binding is 
-  useful because it allows pre-compilation of SQL. When inserting multiple records 
-  into a database in a loop, binding can offer a 50% (or greater) speedup. However 
-  many databases such as Access and MySQL do not support binding natively and 
-  there is some overhead in emulating binding. Furthermore, different databases 
-  (specificly Oracle!) implement binding differently. My recommendation is to 
-  use binding if your database queries are too slow, but make sure you are using 
-  a database that supports it like Oracle. </p>
-<p>ADOdb supports portable Prepare/Execute with:</p>
-<pre>$stmt = $db-&gt;Prepare('select * from customers where custid=? and state=?');
-$rs = $db-&gt;Execute($stmt, array($id,'New York'));</pre>
-<p>Oracle uses named bind placeholders, not "?", so to support portable binding, we have Param() that generates 
-the correct placeholder (available since ADOdb 3.92):
-<pre><font color="#000000">$sql = <font color="#993300">'insert into table (col1,col2) values ('</font>.$DB-&gt;Param('a').<font color="#993300">','</font>.$DB-&gt;Param('b').<font color="#993300">')'</font>;
-<font color="#006600"># generates 'insert into table (col1,col2) values (?,?)'
-# or        'insert into table (col1,col2) values (:a,:b)</font>'
-$stmt = $DB-&gt;Prepare($sql);
-$stmt = $DB-&gt;Execute($stmt,array('one','two'));
-</font></pre>
-<a name="native"></a>
-<h2>Portable Native SQL</h2>
-<p>ADOdb provides the following functions for portably generating SQL functions 
-  as strings to be merged into your SQL statements (some are only available since 
-  ADOdb 3.92): </p>
-<table width="75%" border="1" align=center>
-  <tr> 
-    <td width=30%><b>Function</b></td>
-    <td><b>Description</b></td>
-  </tr>
-  <tr> 
-    <td>DBDate($date)</td>
-    <td>Pass in a UNIX timestamp or ISO date and it will convert it to a date 
-      string formatted for INSERT/UPDATE</td>
-  </tr>
-  <tr> 
-    <td>DBTimeStamp($date)</td>
-    <td>Pass in a UNIX timestamp or ISO date and it will convert it to a timestamp 
-      string formatted for INSERT/UPDATE</td>
-  </tr>
-  <tr> 
-    <td>SQLDate($date, $fmt)</td>
-    <td>Portably generate a date formatted using $fmt mask, for use in SELECT 
-      statements.</td>
-  </tr>
-  <tr> 
-    <td>OffsetDate($date, $ndays)</td>
-    <td>Portably generate a $date offset by $ndays.</td>
-  </tr>
-  <tr> 
-    <td>Concat($s1, $s2, ...)</td>
-    <td>Portably concatenate strings. Alternatively, for mssql use mssqlpo driver, 
-      which allows || operator.</td>
-  </tr>
-  <tr> 
-    <td>IfNull($fld, $replaceNull)</td>
-    <td>Returns a string that is the equivalent of MySQL IFNULL or Oracle NVL.</td>
-  </tr>
-  <tr>
-    <td>Param($name)</td>
-    <td>Generates bind placeholders, using ? or named conventions as appropriate.</td>
-  </tr>
-  <tr><td>$db->sysDate</td><td>Property that holds the SQL function that returns today's date</td>
-</tr>
-<tr><td>$db->sysTimeStamp</td><td>Property that holds the SQL function that returns the current
-timestamp (date+time).
-</td>
-</tr>
-<tr>
-<td>$db->concat_operator</td><td>Property that holds the concatenation operator
-</td>
-</tr>
-<tr><td>$db->length</td><td>Property that holds the name of the SQL strlen function.
-</td></tr>
-
-<tr><td>$db->upperCase</td><td>Property that holds the name of the SQL strtoupper function.
-</td></tr>
-<tr><td>$db->random</td><td>Property that holds the SQL to generate a random number between 0.00 and 1.00.
-</td>
-</tr>
-<tr><td>$db->substr</td><td>Property that holds the name of the SQL substring function.
-</td></tr>
-</table>
-<p>&nbsp; </p>
-<h2>DDL and Tuning</h2>
-There are database design tools such as ERWin or Dezign that allow you to generate data definition language commands such as ALTER TABLE or CREATE INDEX from Entity-Relationship diagrams. 
-<p>
-However if you prefer to use a PHP-based table creation scheme, adodb provides you with this feature. Here is the code to generate the SQL to create a table with: 
-<ol>
-	<li> Auto-increment primary key 'ID', </li>
-	<li>The person's 'NAME' VARCHAR(32) NOT NULL and defaults to '', </li>
-	<li>The date and time of record creation 'CREATED', </li>
-	<li> The person's 'AGE', defaulting to 0, type NUMERIC(16). </li>
-</ol>
-<p>
-Also create a compound index consisting of 'NAME' and 'AGE': 
-<pre>
-$datadict = <strong>NewDataDictionary</strong>($connection);
-$flds = " 
-<font color="#660000">  ID I AUTOINCREMENT PRIMARY,
-  NAME C(32) DEFAULT '' NOTNULL,
-  CREATED T DEFTIMESTAMP,
-  AGE N(16) DEFAULT 0</font>
-";
-$sql1 = $datadict-><strong>CreateTableSQL</strong>('tabname', $flds);
-$sql2 = $datadict-><strong>CreateIndexSQL</strong>('idx_name_age', 'tabname', 'NAME,AGE');
-</pre>
-
-<h3>Data Types</h3>
-<p>Stick to a few data types that are available in most databases. Char, varchar 
-  and numeric/number are supported by most databases. Most other data types (including 
-  integer, boolean and float) cannot be relied on being available. I recommend 
-  using char(1) or number(1) to hold booleans. </p>
-<p>Different databases have different ways of representing dates and timestamps/datetime. 
-  ADOdb attempts to display all dates in ISO (YYYY-MM-DD) format. ADOdb also provides 
-  DBDate( ) and DBTimeStamp( ) to convert dates to formats that are acceptable 
-  to that database. Both functions accept Unix integer timestamps and date strings 
-  in ISO format.</p>
-<pre>$date1 = $connection-&gt;DBDate(time( ));<br>$date2 = $connection-&gt;DBTimeStamp('2002-02-23 13:03:33');</pre>
-<p>We also provide functions to convert database dates to Unix timestamps:</p>
-<pre>$unixts = $recordset-&gt;UnixDate('#2002-02-30#'); <font color="green"># MS Access date =gt; unix timestamp</font></pre>
-<p>For date calculations, we have OffsetDate which allows you to calculate dates such as <i>yesterday</i> and <i>next week</i> in a RDBMS independant fashion. For example, if we want to set a field to 6 hour from now, use:
-<pre>
-$sql = 'update table set dtimefld='.$db-&gt;OffsetDate($db-&gtsysTimeStamp, 6/24).' where ...';
-</pre>
-<p>The maximum length of a char/varchar field is also database specific. You can 
-  only assume that field lengths of up to 250 characters are supported. This is 
-  normally impractical for web based forum or content management systems. You 
-  will need to be familiar with how databases handle large objects (LOBs). ADOdb 
-  implements two functions, UpdateBlob( ) and UpdateClob( ) that allow you to 
-  update fields holding Binary Large Objects (eg. pictures) and Character Large 
-  Objects (eg. HTML articles):</p>
-<pre><font color=green># for oracle </font>
-$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1,empty_blob())'); 
-$conn->UpdateBlob('blobtable','blobcol',$blobvalue,'id=1'); 
-   
-<font color=green># non-oracle databases</font>
-$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)'); 
-$conn->UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');
-</pre>
-<p>Null handling is another area where differences can occur. This is a mine-field, 
-  because 3-value logic is tricky.
-<p>In general, I avoid using nulls except for dates and default all my numeric 
-  and character fields to 0 or the empty string. This maintains consistency with 
-  PHP, where empty strings and zero are treated as equivalent, and avoids SQL 
-  ambiguities when you use the ANY and EXISTS operators. However if your database 
-  has significant amounts of missing or unknown data, using nulls might be a good 
-  idea. 
-  <p>
-  ADOdb also supports a portable <a href=http://phplens.com/adodb/reference.functions.concat.html#ifnull>IfNull</a> function, so you can define what to display
-  if the field contains a null.
-<h3><b>Stored Procedures</b></h3>
-<p>Stored procedures are another problem area. Some databases allow recordsets 
-  to be returned in a stored procedure (Microsoft SQL Server and Sybase), and 
-  others only allow output parameters to be returned. Stored procedures sometimes 
-  need to be wrapped in special syntax. For example, Oracle requires such code 
-  to be wrapped in an anonymous block with BEGIN and END. Also internal sql operators 
-  and functions such as +, ||, TRIM( ), SUBSTR( ) or INSTR( ) vary between vendors. 
-</p>
-<p>An example of how to call a stored procedure with 2 parameters and 1 return 
-  value follows:</p>
-<pre>	switch ($db->databaseType) {
-	case '<font color="#993300">mssql</font>':
-	  $sql = <font color="#000000"><font color="#993333">'<font color="#993300">SP_RUNSOMETHING</font>'</font></font>; break;
-	case '<font color="#993300">oci8</font>':
-	  $sql = 
-<font color="#993300">	  </font><font color="#000000"><font color="#993300">&quot;declare RETVAL integer;begin :RETVAL := </font><font color="#000000"><font color="#993333"><font color="#993300">SP_RUNSOMETHING</font></font></font><font color="#993300">(:myid,:group);end;&quot;;
-</font>	  break;</font>
-	default:
-	  die('<font color="#993300">Unsupported feature</font>');
-	}
-<font color="#000000"><font color="green">	# @RETVAL = SP_RUNSOMETHING @myid,@group</font>
-	$stmt = $db-&gt;PrepareSP($sql);	<br>	$db-&gt;Parameter($stmt,$id,'<font color="#993300">myid</font>'); 
-	$db-&gt;Parameter($stmt,$group,'<font color="#993300">group</font>');
-	<font color="green"># true indicates output parameter<br>	</font>$db-&gt;Parameter($stmt,$ret,'<font color="#993300">RETVAL</font>',true); 
-	$db-&gt;Execute($stmt); </font></pre>
-<p>As you can see, the ADOdb API is the same for both databases. But the stored 
-  procedure SQL syntax is quite different between databases and is not portable, 
-  so be forewarned! However sometimes you have little choice as some systems only 
-  allow data to be accessed via stored procedures. This is when the ultimate portability 
-  solution might be the only solution: <i>treating portable SQL as a localization 
-  exercise...</i></p>
-<h3><b>SQL as a Localization Exercise</b></h3>
-<p> In general to provide real portability, you will have to treat SQL coding 
-  as a localization exercise. In PHP, it has become common to define separate 
-  language files for English, Russian, Korean, etc. Similarly, I would suggest 
-  you have separate Sybase, Intebase, MySQL, etc files, and conditionally include 
-  the SQL based on the database. For example, each MySQL SQL statement would be 
-  stored in a separate variable, in a file called 'mysql-lang.inc.php'.</p>
-<pre>$sqlGetPassword = '<font color="#993300">select password from users where userid=%s</font>';
-$sqlSearchKeyword = quot;<font color="#993300">SELECT * FROM articles WHERE match (title,body) against (%s</font>)&quot;;</pre>
-<p>In our main PHP file:</p>
-<pre><font color=green># define which database to load...</font>
-<b>$database = '<font color="#993300">mysql</font>';
-include_once(&quot;<font color="#993300">$database-lang.inc.php</font>&quot;);</b>
-
-$db = NewADOConnection($database);
-$db->PConnect(...) or die('<font color="#993300">Failed to connect to database</font>');
-
-<font color=green># search for a keyword $word</font>
-$rs = $db-&gt;Execute(sprintf($sqlSearchKeyWord,$db-&gt;qstr($word)));</pre>
-<p>Note that we quote the $word variable using the qstr( ) function. This is because 
-  each database quotes strings using different conventions.</p>
-<p>
-<h3>Final Thoughts</h3>
-<p>The best way to ensure that you have portable SQL is to have your data tables designed using 
-sound principles. Learn the theory of normalization and entity-relationship diagrams and model 
-your data carefully. Understand how joins and indexes work and how they are used to tune performance.
-<p> Visit the following page for more references on database theory and vendors: 
-  <a href="http://php.weblogs.com/sql_tutorial">http://php.weblogs.com/sql_tutorial</a>. 
-  Also read this article on <a href=http://phplens.com/lens/php-book/optimizing-debugging-php.php>Optimizing PHP</a>.
-<p>
-<font size=1>(c) 2002-2003 John Lim.</font>
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+
+<html>
+<head>
+	<title>Tips on Writing Portable SQL for Multiple Databases for PHP</title>
+</head>
+
+<body bgcolor=white>
+<table width=100% border=0><tr><td><h2>Tips on Writing Portable SQL &nbsp;</h2></td><td>
+ <div align=right><img src="cute_icons_for_site/adodb.gif"></div></td></tr></table>
+  <p>Updated 6 Oct 2006. Added OffsetDate example.
+  <p>Updated 18 Sep 2003. Added Portable Native SQL section.
+<p>
+
+ If you are writing an application that is used in multiple environments and 
+  operating systems, you need to plan to support multiple databases. This article 
+  is based on my experiences with multiple database systems, stretching from 4th 
+  Dimension in my Mac days, to the databases I currently use, which are: Oracle, 
+  FoxPro, Access, MS SQL Server and MySQL. Although most of the advice here applies 
+  to using SQL with Perl, Python and other programming languages, I will focus on PHP and how 
+  the <a href="http://adodb.sourceforge.net/">ADOdb</a> database abstraction library 
+  offers some solutions.<p></p>
+<p>Most database vendors practice product lock-in. The best or fastest way to 
+  do things is often implemented using proprietary extensions to SQL. This makes 
+  it extremely hard to write portable SQL code that performs well under all conditions. 
+  When the first ANSI committee got together in 1984 to standardize SQL, the database 
+  vendors had such different implementations that they could only agree on the 
+  core functionality of SQL. Many important application specific requirements 
+  were not standardized, and after so many years since the ANSI effort began, 
+  it looks as if much useful database functionality will never be standardized. 
+  Even though ANSI-92 SQL has codified much more, we still have to implement portability 
+  at the application level.</p>
+<h3><b>Selects</b></h3>
+<p>The SELECT statement has been standardized to a great degree. Nearly every 
+  database supports the following:</p>
+<p>SELECT [cols] FROM [tables]<br>
+  &nbsp;&nbsp;[WHERE conditions]<br>
+  &nbsp; [GROUP BY cols]<br>
+  &nbsp; [HAVING conditions] <br>
+  &nbsp; [ORDER BY cols]</p>
+<p>But so many useful techniques can only be implemented by using proprietary 
+  extensions. For example, when writing SQL to retrieve the first 10 rows for 
+  paging, you could write...</p>
+<table width="80%" border="1" cellspacing="0" cellpadding="0" align="center">
+  <tr> 
+	<td><b>Database</b></td>
+	<td><b>SQL Syntax</b></td>
+  </tr>
+  <tr> 
+	<td>DB2</td>
+	<td>select * from table fetch first 10 rows only</td>
+  </tr>
+  <tr> 
+	<td>Informix</td>
+	<td>select first 10 * from table</td>
+  </tr>
+  <tr> 
+	<td>Microsoft SQL Server and Access</td>
+	<td>select top 10 * from table</td>
+  </tr>
+  <tr> 
+	<td>MySQL and PostgreSQL</td>
+	<td>select * from table limit 10</td>
+  </tr>
+  <tr> 
+	<td>Oracle 8i</td>
+	<td>select * from (select * from table) where rownum &lt;= 10</td>
+  </tr>
+</table>
+<p>This feature of getting a subset of data is so useful that in the PHP class 
+  library ADOdb, we have a SelectLimit( ) function that allows you to hide the 
+  implementation details within a function that will rewrite your SQL for you:</p>
+<pre>$connection-&gt;SelectLimit('select * from table', 10);
+</pre>
+<p><b>Selects: Fetch Modes</b></p>
+<p>PHP allows you to retrieve database records as arrays. You can choose to have 
+  the arrays indexed by field name or number. However different low-level PHP 
+  database drivers are inconsistent in their indexing efforts. ADOdb allows you 
+  to determine your prefered mode. You set this by setting the variable $ADODB_FETCH_MODE 
+  to either of the constants ADODB_FETCH_NUM (for numeric indexes) or ADODB_FETCH_ASSOC 
+  (using field names as an associative index).</p>
+<p>The default behaviour of ADOdb varies depending on the database you are using. 
+  For consistency, set the fetch mode to either ADODB_FETCH_NUM (for speed) or 
+  ADODB_FETCH_ASSOC (for convenience) at the beginning of your code. </p>
+<p><b>Selects: Counting Records</b></p>
+<p>Another problem with SELECTs is that some databases do not return the number 
+  of rows retrieved from a select statement. This is because the highest performance 
+  databases will return records to you even before the last record has been found. 
+</p>
+<p>In ADOdb, RecordCount( ) returns the number of rows returned, or will emulate 
+  it by buffering the rows and returning the count after all rows have been returned. 
+  This can be disabled for performance reasons when retrieving large recordsets 
+  by setting the global variable $ADODB_COUNTRECS = false. This variable is checked 
+  every time a query is executed, so you can selectively choose which recordsets 
+  to count.</p>
+<p>If you prefer to set $ADODB_COUNTRECS = false, ADOdb still has the PO_RecordCount( 
+  ) function. This will return the number of rows, or if it is not found, it will 
+  return an estimate using SELECT COUNT(*):</p>
+<pre>$rs = $db-&gt;Execute(&quot;select * from table where state=$state&quot;);
+$numrows = $rs-&gt;PO_RecordCount('table', &quot;state=$state&quot;);</pre>
+<p><b>Selects: Locking</b> </p>
+<p>SELECT statements are commonly used to implement row-level locking of tables. 
+  Other databases such as Oracle, Interbase, PostgreSQL and MySQL with InnoDB 
+  do not require row-level locking because they use versioning to display data 
+  consistent with a specific point in time.</p>
+<p>Currently, I recommend encapsulating the row-level locking in a separate function, 
+  such as RowLock($table, $where):</p>
+<pre>$connection-&gt;BeginTrans( );
+$connection-&gt;RowLock($table, $where); </pre>
+<pre><font color=green># some operation</font></pre>
+<pre>if ($ok) $connection-&gt;CommitTrans( );
+else $connection-&gt;RollbackTrans( );
+</pre>
+<p><b>Selects: Outer Joins</b></p>
+<p>Not all databases support outer joins. Furthermore the syntax for outer joins 
+  differs dramatically between database vendors. One portable (and possibly slower) 
+  method of implementing outer joins is using UNION.</p>
+<p>For example, an ANSI-92 left outer join between two tables t1 and t2 could 
+  look like:</p>
+<pre>SELECT t1.col1, t1.col2, t2.cola <br>  FROM t1 <i>LEFT JOIN</i> t2 ON t1.col = t2.col</pre>
+<p>This can be emulated using:</p>
+<pre>SELECT t1.col1, t1.col2, t2.cola FROM t1, t2 <br>	   WHERE t1.col = t2.col 
+   UNION ALL
+SELECT col1, col2, null FROM t1 <br>	   WHERE t1.col not in (select distinct col from t2)
+</pre>
+<p>Since ADOdb 2.13, we provide some hints in the connection object as to legal 
+  join variations. This is still incomplete and sometimes depends on the database 
+  version you are using, but is useful as a general guideline:</p>
+<p><font face="Courier New, Courier, mono">$conn-&gt;leftOuter</font>: holds the 
+  operator used for left outer joins (eg. '*='), or false if not known or not 
+  available.<br>
+  <font face="Courier New, Courier, mono">$conn-&gt;rightOuter</font>: holds the 
+  operator used for right outer joins (eg '=*'), or false if not known or not 
+  available.<br>
+  <font face="Courier New, Courier, mono">$conn-&gt;ansiOuter</font>: boolean 
+  that if true means that ANSI-92 style outer joins are supported, or false if 
+  not known.</p>
+<h3><b>Inserts</b> </h3>
+<p>When you create records, you need to generate unique id's for each record. 
+  There are two common techniques: (1) auto-incrementing columns and (2) sequences. 
+</p>
+<p>Auto-incrementing columns are supported by MySQL, Sybase and Microsoft Access 
+  and SQL Server. However most other databases do not support this feature. So 
+  for portability, you have little choice but to use sequences. Sequences are 
+  special functions that return a unique incrementing number every time you call 
+  it, suitable to be used as database keys. In ADOdb, we use the GenID( ) function. 
+  It has takes a parameter, the sequence name. Different tables can have different 
+  sequences. </p>
+<pre>$id = $connection-&gt;GenID('sequence_name');<br>$connection-&gt;Execute(&quot;insert into table (id, firstname, lastname) <br>			   values ($id, $firstname, $lastname)&quot;);</pre>
+<p>For databases that do not support sequences natively, ADOdb emulates sequences 
+  by creating a table for every sequence.</p>
+<h3><b>Binding</b></h3>
+<p>Binding variables in an SQL statement is another tricky feature. Binding is 
+  useful because it allows pre-compilation of SQL. When inserting multiple records 
+  into a database in a loop, binding can offer a 50% (or greater) speedup. However 
+  many databases such as Access and MySQL do not support binding natively and 
+  there is some overhead in emulating binding. Furthermore, different databases 
+  (specificly Oracle!) implement binding differently. My recommendation is to 
+  use binding if your database queries are too slow, but make sure you are using 
+  a database that supports it like Oracle. </p>
+<p>ADOdb supports portable Prepare/Execute with:</p>
+<pre>$stmt = $db-&gt;Prepare('select * from customers where custid=? and state=?');
+$rs = $db-&gt;Execute($stmt, array($id,'New York'));</pre>
+<p>Oracle uses named bind placeholders, not "?", so to support portable binding, we have Param() that generates 
+the correct placeholder (available since ADOdb 3.92):
+<pre><font color="#000000">$sql = <font color="#993300">'insert into table (col1,col2) values ('</font>.$DB-&gt;Param('a').<font color="#993300">','</font>.$DB-&gt;Param('b').<font color="#993300">')'</font>;
+<font color="#006600"># generates 'insert into table (col1,col2) values (?,?)'
+# or        'insert into table (col1,col2) values (:a,:b)</font>'
+$stmt = $DB-&gt;Prepare($sql);
+$stmt = $DB-&gt;Execute($stmt,array('one','two'));
+</font></pre>
+<a name="native"></a>
+<h2>Portable Native SQL</h2>
+<p>ADOdb provides the following functions for portably generating SQL functions 
+  as strings to be merged into your SQL statements (some are only available since 
+  ADOdb 3.92): </p>
+<table width="75%" border="1" align=center>
+  <tr> 
+    <td width=30%><b>Function</b></td>
+    <td><b>Description</b></td>
+  </tr>
+  <tr> 
+    <td>DBDate($date)</td>
+    <td>Pass in a UNIX timestamp or ISO date and it will convert it to a date 
+      string formatted for INSERT/UPDATE</td>
+  </tr>
+  <tr> 
+    <td>DBTimeStamp($date)</td>
+    <td>Pass in a UNIX timestamp or ISO date and it will convert it to a timestamp 
+      string formatted for INSERT/UPDATE</td>
+  </tr>
+  <tr> 
+    <td>SQLDate($date, $fmt)</td>
+    <td>Portably generate a date formatted using $fmt mask, for use in SELECT 
+      statements.</td>
+  </tr>
+  <tr> 
+    <td>OffsetDate($date, $ndays)</td>
+    <td>Portably generate a $date offset by $ndays.</td>
+  </tr>
+  <tr> 
+    <td>Concat($s1, $s2, ...)</td>
+    <td>Portably concatenate strings. Alternatively, for mssql use mssqlpo driver, 
+      which allows || operator.</td>
+  </tr>
+  <tr> 
+    <td>IfNull($fld, $replaceNull)</td>
+    <td>Returns a string that is the equivalent of MySQL IFNULL or Oracle NVL.</td>
+  </tr>
+  <tr>
+    <td>Param($name)</td>
+    <td>Generates bind placeholders, using ? or named conventions as appropriate.</td>
+  </tr>
+  <tr><td>$db->sysDate</td><td>Property that holds the SQL function that returns today's date</td>
+</tr>
+<tr><td>$db->sysTimeStamp</td><td>Property that holds the SQL function that returns the current
+timestamp (date+time).
+</td>
+</tr>
+<tr>
+<td>$db->concat_operator</td><td>Property that holds the concatenation operator
+</td>
+</tr>
+<tr><td>$db->length</td><td>Property that holds the name of the SQL strlen function.
+</td></tr>
+
+<tr><td>$db->upperCase</td><td>Property that holds the name of the SQL strtoupper function.
+</td></tr>
+<tr><td>$db->random</td><td>Property that holds the SQL to generate a random number between 0.00 and 1.00.
+</td>
+</tr>
+<tr><td>$db->substr</td><td>Property that holds the name of the SQL substring function.
+</td></tr>
+</table>
+<p>&nbsp; </p>
+<h2>DDL and Tuning</h2>
+There are database design tools such as ERWin or Dezign that allow you to generate data definition language commands such as ALTER TABLE or CREATE INDEX from Entity-Relationship diagrams. 
+<p>
+However if you prefer to use a PHP-based table creation scheme, adodb provides you with this feature. Here is the code to generate the SQL to create a table with: 
+<ol>
+	<li> Auto-increment primary key 'ID', </li>
+	<li>The person's 'NAME' VARCHAR(32) NOT NULL and defaults to '', </li>
+	<li>The date and time of record creation 'CREATED', </li>
+	<li> The person's 'AGE', defaulting to 0, type NUMERIC(16). </li>
+</ol>
+<p>
+Also create a compound index consisting of 'NAME' and 'AGE': 
+<pre>
+$datadict = <strong>NewDataDictionary</strong>($connection);
+$flds = " 
+<font color="#660000">  ID I AUTOINCREMENT PRIMARY,
+  NAME C(32) DEFAULT '' NOTNULL,
+  CREATED T DEFTIMESTAMP,
+  AGE N(16) DEFAULT 0</font>
+";
+$sql1 = $datadict-><strong>CreateTableSQL</strong>('tabname', $flds);
+$sql2 = $datadict-><strong>CreateIndexSQL</strong>('idx_name_age', 'tabname', 'NAME,AGE');
+</pre>
+
+<h3>Data Types</h3>
+<p>Stick to a few data types that are available in most databases. Char, varchar 
+  and numeric/number are supported by most databases. Most other data types (including 
+  integer, boolean and float) cannot be relied on being available. I recommend 
+  using char(1) or number(1) to hold booleans. </p>
+<p>Different databases have different ways of representing dates and timestamps/datetime. 
+  ADOdb attempts to display all dates in ISO (YYYY-MM-DD) format. ADOdb also provides 
+  DBDate( ) and DBTimeStamp( ) to convert dates to formats that are acceptable 
+  to that database. Both functions accept Unix integer timestamps and date strings 
+  in ISO format.</p>
+<pre>$date1 = $connection-&gt;DBDate(time( ));<br>$date2 = $connection-&gt;DBTimeStamp('2002-02-23 13:03:33');</pre>
+<p>We also provide functions to convert database dates to Unix timestamps:</p>
+<pre>$unixts = $recordset-&gt;UnixDate('#2002-02-30#'); <font color="green"># MS Access date =gt; unix timestamp</font></pre>
+<p>For date calculations, we have OffsetDate which allows you to calculate dates such as <i>yesterday</i> and <i>next week</i> in a RDBMS independant fashion. For example, if we want to set a field to 6 hour from now, use:
+<pre>
+$sql = 'update table set dtimefld='.$db-&gt;OffsetDate($db-&gtsysTimeStamp, 6/24).' where ...';
+</pre>
+<p>The maximum length of a char/varchar field is also database specific. You can 
+  only assume that field lengths of up to 250 characters are supported. This is 
+  normally impractical for web based forum or content management systems. You 
+  will need to be familiar with how databases handle large objects (LOBs). ADOdb 
+  implements two functions, UpdateBlob( ) and UpdateClob( ) that allow you to 
+  update fields holding Binary Large Objects (eg. pictures) and Character Large 
+  Objects (eg. HTML articles):</p>
+<pre><font color=green># for oracle </font>
+$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1,empty_blob())'); 
+$conn->UpdateBlob('blobtable','blobcol',$blobvalue,'id=1'); 
+   
+<font color=green># non-oracle databases</font>
+$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)'); 
+$conn->UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');
+</pre>
+<p>Null handling is another area where differences can occur. This is a mine-field, 
+  because 3-value logic is tricky.
+<p>In general, I avoid using nulls except for dates and default all my numeric 
+  and character fields to 0 or the empty string. This maintains consistency with 
+  PHP, where empty strings and zero are treated as equivalent, and avoids SQL 
+  ambiguities when you use the ANY and EXISTS operators. However if your database 
+  has significant amounts of missing or unknown data, using nulls might be a good 
+  idea. 
+  <p>
+  ADOdb also supports a portable <a href=http://phplens.com/adodb/reference.functions.concat.html#ifnull>IfNull</a> function, so you can define what to display
+  if the field contains a null.
+<h3><b>Stored Procedures</b></h3>
+<p>Stored procedures are another problem area. Some databases allow recordsets 
+  to be returned in a stored procedure (Microsoft SQL Server and Sybase), and 
+  others only allow output parameters to be returned. Stored procedures sometimes 
+  need to be wrapped in special syntax. For example, Oracle requires such code 
+  to be wrapped in an anonymous block with BEGIN and END. Also internal sql operators 
+  and functions such as +, ||, TRIM( ), SUBSTR( ) or INSTR( ) vary between vendors. 
+</p>
+<p>An example of how to call a stored procedure with 2 parameters and 1 return 
+  value follows:</p>
+<pre>	switch ($db->databaseType) {
+	case '<font color="#993300">mssql</font>':
+	  $sql = <font color="#000000"><font color="#993333">'<font color="#993300">SP_RUNSOMETHING</font>'</font></font>; break;
+	case '<font color="#993300">oci8</font>':
+	  $sql = 
+<font color="#993300">	  </font><font color="#000000"><font color="#993300">&quot;declare RETVAL integer;begin :RETVAL := </font><font color="#000000"><font color="#993333"><font color="#993300">SP_RUNSOMETHING</font></font></font><font color="#993300">(:myid,:group);end;&quot;;
+</font>	  break;</font>
+	default:
+	  die('<font color="#993300">Unsupported feature</font>');
+	}
+<font color="#000000"><font color="green">	# @RETVAL = SP_RUNSOMETHING @myid,@group</font>
+	$stmt = $db-&gt;PrepareSP($sql);	<br>	$db-&gt;Parameter($stmt,$id,'<font color="#993300">myid</font>'); 
+	$db-&gt;Parameter($stmt,$group,'<font color="#993300">group</font>');
+	<font color="green"># true indicates output parameter<br>	</font>$db-&gt;Parameter($stmt,$ret,'<font color="#993300">RETVAL</font>',true); 
+	$db-&gt;Execute($stmt); </font></pre>
+<p>As you can see, the ADOdb API is the same for both databases. But the stored 
+  procedure SQL syntax is quite different between databases and is not portable, 
+  so be forewarned! However sometimes you have little choice as some systems only 
+  allow data to be accessed via stored procedures. This is when the ultimate portability 
+  solution might be the only solution: <i>treating portable SQL as a localization 
+  exercise...</i></p>
+<h3><b>SQL as a Localization Exercise</b></h3>
+<p> In general to provide real portability, you will have to treat SQL coding 
+  as a localization exercise. In PHP, it has become common to define separate 
+  language files for English, Russian, Korean, etc. Similarly, I would suggest 
+  you have separate Sybase, Intebase, MySQL, etc files, and conditionally include 
+  the SQL based on the database. For example, each MySQL SQL statement would be 
+  stored in a separate variable, in a file called 'mysql-lang.inc.php'.</p>
+<pre>$sqlGetPassword = '<font color="#993300">select password from users where userid=%s</font>';
+$sqlSearchKeyword = quot;<font color="#993300">SELECT * FROM articles WHERE match (title,body) against (%s</font>)&quot;;</pre>
+<p>In our main PHP file:</p>
+<pre><font color=green># define which database to load...</font>
+<b>$database = '<font color="#993300">mysql</font>';
+include_once(&quot;<font color="#993300">$database-lang.inc.php</font>&quot;);</b>
+
+$db = NewADOConnection($database);
+$db->PConnect(...) or die('<font color="#993300">Failed to connect to database</font>');
+
+<font color=green># search for a keyword $word</font>
+$rs = $db-&gt;Execute(sprintf($sqlSearchKeyWord,$db-&gt;qstr($word)));</pre>
+<p>Note that we quote the $word variable using the qstr( ) function. This is because 
+  each database quotes strings using different conventions.</p>
+<p>
+<h3>Final Thoughts</h3>
+<p>The best way to ensure that you have portable SQL is to have your data tables designed using 
+sound principles. Learn the theory of normalization and entity-relationship diagrams and model 
+your data carefully. Understand how joins and indexes work and how they are used to tune performance.
+<p> Visit the following page for more references on database theory and vendors: 
+  <a href="http://php.weblogs.com/sql_tutorial">http://php.weblogs.com/sql_tutorial</a>. 
+  Also read this article on <a href=http://phplens.com/lens/php-book/optimizing-debugging-php.php>Optimizing PHP</a>.
+<p>
+<font size=1>(c) 2002-2003 John Lim.</font>
+
+</body>
+</html>
diff --git a/third_party/adodb/docs/tute.htm b/third_party/adodb/docs/tute.htm
index aeb5893..408ba75 100644
--- a/third_party/adodb/docs/tute.htm
+++ b/third_party/adodb/docs/tute.htm
@@ -1,290 +1,290 @@
-<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
-
-<html>
-<head>
-	<title>Tutorial: Moving from MySQL to ADODB</title>
-</head>
-
-<body bgcolor=white>
-<h1>Tutorial: Moving from MySQL to ADODB</h1>
-
-<pre>		You say eether and I say eyether, 
-		You say neether and I say nyther; 
-		Eether, eyether, neether, nyther - 
-		Let's call the whole thing off ! 
-<br>
-		You like potato and I like po-tah-to, 
-		You like tomato and I like to-mah-to; 
-		Potato, po-tah-to, tomato, to-mah-to - 
-		Let's call the whole thing off ! 
-</pre>
-<p>I love this song, especially the version with Louis Armstrong and Ella singing 
-  duet. It is all about how hard it is for two people in love to be compatible 
-  with each other. It's about compromise and finding a common ground, and that's 
-  what this article is all about. 
-<p>PHP is all about creating dynamic web-sites with the least fuss and the most 
-  fun. To create these websites we need to use databases to retrieve login information, 
-  to splash dynamic news onto the web page and store forum postings. So let's 
-  say we were using the popular MySQL database for this. Your company has done 
-  such a fantastic job that the Web site is more popular than your wildest dreams. 
-  You find that MySQL cannot scale to handle the workload; time to switch databases. 
-<p> Unfortunately in PHP every database is accessed slightly differently. To connect 
-  to MySQL, you would use <i>mysql_connect()</i>; when you decide to upgrade to 
-  Oracle or Microsoft SQL Server, you would use <i>ocilogon() </i>or <i>mssql_connect()</i> 
-  respectively. What is worse is that the parameters you use for the different 
-  connect functions are different also.. One database says po-tato, the other 
-  database says pota-to. Oh-oh. 
-<h3>Let's NOT call the whole thing off</h3>
-<p>A database wrapper library such as ADODB comes in handy when you need to ensure portability. It provides 
-  you with a common API to communicate with any supported database so you don't have to call things off. <p>
-
-<p>ADODB stands for Active Data Objects DataBase (sorry computer guys are sometimes 
-  not very original). ADODB currently supports MySQL, PostgreSQL, Oracle, Interbase, 
-  Microsoft SQL Server, Access, FoxPro, Sybase, ODBC and ADO. You can download 
-  ADODB from <a href=http://php.weblogs.com/adodb></a><a href="http://php.weblogs.com/adodb">http://php.weblogs.com/adodb</a>.
-<h3>MySQL Example</h3>
-<p>The most common database used with PHP is MySQL, so I guess you should be familiar 
-  with the following code. It connects to a MySQL server at <i>localhost</i>, 
-  database <i>mydb</i>, and executes an SQL select statement. The results are 
-  printed, one line per row. 
-<pre><font color="#666600">$db = <b>mysql_connect</b>(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;);
-<b>mysql_select_db</b>(&quot;mydb&quot;,$db);</font>
-<font color="#660000">$result = <b>mysql_query</b>(&quot;SELECT * FROM employees&quot;,$db)</font><code><font color="#663300">;
-if ($result === false) die(&quot;failed&quot;);</font></code> 
-<font color="#006666"><b>while</b> ($fields =<b> mysql_fetch_row</b>($result)) &#123;
- <b>for</b> ($i=0, $max=sizeof($fields); $i &lt; $max; $i++) &#123;
-		<b>print</b> $fields[$i].' ';
- &#125;
- <b>print</b> &quot;&lt;br&gt;\n&quot;;
-&#125;</font> 
-</pre>
-<p>The above code has been color-coded by section. The first section is the connection 
-  phase. The second is the execution of the SQL, and the last section is displaying 
-  the fields. The <i>while</i> loop scans the rows of the result, while the <i>for</i> 
-  loop scans the fields in one row.</p>
-<p>Here is the equivalent code in ADODB</p>
-<pre><b><font color="#666600"> include(&quot;adodb.inc.php&quot;);</font></b><font color="#666600">
- $db = <b>NewADOConnection</b>('mysql');
- $db-&gt;<b>Connect</b>(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;, &quot;mydb&quot;);</font>
- <font color="#663300">$result = $db-&gt;<b>Execute</b>(&quot;SELECT * FROM employees&quot;);
- </font><font color="#663300"></font><code><font color="#663300">if ($result === false) die(&quot;failed&quot;)</font></code><code><font color="#663300">;</font></code>  
- <font color="#006666"><b>while</b> (!$result-&gt;EOF) &#123;
-	<b>for</b> ($i=0, $max=$result-&gt;<b>FieldCount</b>(); $i &lt; $max; $i++)
-		   <b>print</b> $result-&gt;fields[$i].' ';
-	$result-&gt;<b>MoveNext</b>();
-	<b>print</b> &quot;&lt;br&gt;\n&quot;;
- &#125;</font> </pre>
-<p></p>
-<p>Now porting to Oracle is as simple as changing the second line to <code>NewADOConnection('oracle')</code>. 
-  Let's walk through the code...</p>
-<h3>Connecting to the Database</h3>
-<p></p>
-<pre><b><font color="#666600">include(&quot;adodb.inc.php&quot;);</font></b><font color="#666600">
-$db = <b>NewADOConnection</b>('mysql');
-$db-&gt;<b>Connect</b>(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;, &quot;mydb&quot;);</font></pre>
-<p>The connection code is a bit more sophisticated than MySQL's because our needs 
-  are more sophisticated. In ADODB, we use an object-oriented approach to managing 
-  the complexity of handling multiple databases. We have different classes to 
-  handle different databases. If you aren't familiar with object-oriented programing, 
-  don't worry -- the complexity is all hidden away in the<code> NewADOConnection()</code> 
-  function.</p>
-<p>To conserve memory, we only load the PHP code specific to the database you 
-  are connecting to. We do this by calling <code>NewADOConnection(databasedriver)</code>. 
-  Legal database drivers include <i>mysql, mssql, oracle, oci8, postgres, sybase, 
-  vfp, access, ibase </i>and many others.</p>
-<p>Then we create a new instance of the connection class by calling <code>NewADOConnection()</code>. 
-  Finally we connect to the database using <code>$db-&gt;Connect(). </code></p>
-<h3>Executing the SQL</h3>
-<p><code><font color="#663300">$result = $db-&gt;<b>Execute</b>(&quot;SELECT * 
-  FROM employees&quot;);<br>
-  if ($result === false) die(&quot;failed&quot;)</font></code><code><font color="#663300">;</font></code> 
-  <br>
-</p>
-<p>Sending the SQL statement to the server is straight forward. Execute() will 
-  return a recordset object on successful execution. You should check $result 
-  as we do above.
-<p>An issue that confuses beginners is the fact that we have two types of objects 
-  in ADODB, the connection object and the recordset object. When do we use each?
-<p>The connection object ($db) is responsible for connecting to the database, 
-  formatting your SQL and querying the database server. The recordset object ($result) 
-  is responsible for retrieving the results and formatting the reply as text or 
-  as an array.
-<p>The only thing I need to add is that ADODB provides several helper functions 
-  for making INSERT and UPDATE statements easier, which we will cover in the Advanced 
-  section. 
-<h3>Retrieving the Data<br>
-</h3>
-<pre><font color="#006666"><b>while</b> (!$result-&gt;EOF) &#123;
-   <b>for</b> ($i=0, $max=$result-&gt;<b>FieldCount</b>(); $i &lt; $max; $i++)
-	   <b>print</b> $result-&gt;fields[$i].' ';
-   $result-&gt;<b>MoveNext</b>();
-   <b>print</b> &quot;&lt;br&gt;\n&quot;;
-&#125;</font></pre>
-<p>The paradigm for getting the data is that it's like reading a file. For every 
-  line, we check first whether we have reached the end-of-file (EOF). While not 
-  end-of-file, loop through each field in the row. Then move to the next line 
-  (MoveNext) and repeat. 
-<p>The <code>$result-&gt;fields[]</code> array is generated by the PHP database 
-  extension. Some database extensions do not index the array by field name. 
-  To force indexing by name - that is associative arrays - 
-  use the $ADODB_FETCH_MODE global variable. 
-<pre>
-	$<b>ADODB_FETCH_MODE</b> = ADODB_FETCH_NUM;
-	$rs1 = $db->Execute('select * from table');
-	$<b>ADODB_FETCH_MODE</b> = ADODB_FETCH_ASSOC;
-	$rs2 = $db->Execute('select * from table');
-	print_r($rs1->fields); // shows <i>array([0]=>'v0',[1] =>'v1')</i>
-	print_r($rs2->fields); // shows <i>array(['col1']=>'v0',['col2'] =>'v1')</i>
-</pre>
-<p>
-As you can see in the above example, both recordsets store and use different fetch modes
-based on the $ADODB_FETCH_MODE setting when the recordset was created by Execute().</p>
-<h2>ADOConnection<a name="ADOConnection"></a></h2>
-<p>Object that performs the connection to the database, executes SQL statements 
-  and has a set of utility functions for standardising the format of SQL statements 
-  for issues such as concatenation and date formats.</p>
-  
-<h3>Other Useful Functions</h3>
-<p><code>$recordset-&gt;Move($pos)</code> scrolls to that particular row. ADODB supports forward 
-  scrolling for all databases. Some databases will not support backwards scrolling. 
-  This is normally not a problem as you can always cache records to simulate backwards 
-  scrolling. 
-<p><code>$recordset-&gt;RecordCount()</code> returns the number of records accessed by the 
-  SQL statement. Some databases will return -1 because it is not supported. 
-<p><code>$recordset-&gt;GetArray()</code> returns the result as an array. 
-<p><code>rs2html($recordset)</code> is a function that is generates a HTML table based on the 
-  $recordset passed to it. An example with the relevant lines in bold:
-<pre>   include('adodb.inc.php'); 
-   <b>include('tohtml.inc.php');</b> /* includes the rs2html function */
-   $conn = ADONewConnection('mysql'); 
-   $conn-&gt;PConnect('localhost','userid','password','database');
-   $rs = $conn-&gt;Execute('select * from table');
-  <b> rs2html($rs)</b>; /* recordset to html table */ </pre>
-<p>There are many other helper functions that are listed in the documentation available at <a href="http://php.weblogs.com/adodb_manual"></a><a href="http://php.weblogs.com/adodb_manual">http://php.weblogs.com/adodb_manual</a>. 
-<h2>Advanced Material</h2>
-<h3>Inserts and Updates </h3>
-<p>Let's say you want to insert the following data into a database. 
-<p><b>ID</b> = 3<br>
-  <b>TheDate</b>=mktime(0,0,0,8,31,2001) /* 31st August 2001 */<br>
-  <b>Note</b>= sugar why don't we call it off 
-<p>When you move to another database, your insert might no longer work.</p>
-<p>The first problem is that each database has a different default date format. 
-  MySQL expects YYYY-MM-DD format, while other databases have different defaults. 
-  ADODB has a function called DBDate() that addresses this issue by converting 
-  converting the date to the correct format.</p>
-<p>The next problem is that the <b>don't</b> in the Note needs to be quoted. In 
-  MySQL, we use <b>don\'t</b> but in some other databases (Sybase, Access, Microsoft 
-  SQL Server) we use <b>don''t. </b>The qstr() function addresses this issue.</p>
-<p>So how do we use the functions? Like this:</p>
-<pre>$sql = &quot;INSERT INTO table (id, thedate,note) values (&quot; 
-   . $<b>ID</b> . ','
-   . $db-&gt;DBDate($<b>TheDate</b>) .','
-   . $db-&gt;qstr($<b>Note</b>).&quot;)&quot;;
-$db-&gt;Execute($sql);</pre>
-<p>ADODB also supports <code>$connection-&gt;Affected_Rows()</code> (returns the 
-  number of rows affected by last update or delete) and <code>$recordset-&gt;Insert_ID()</code> 
-  (returns last autoincrement number generated by an insert statement). Be forewarned 
-  that not all databases support the two functions.<br>
-</p>
-<h3>MetaTypes</h3>
-<p>You can find out more information about each of the fields (I use the words 
-  fields and columns interchangebly) you are selecting by calling the recordset 
-  method <code>FetchField($fieldoffset)</code>. This will return an object with 
-  3 properties: name, type and max_length. 
-<pre>For example:</pre>
-<pre>$recordset = $conn-&gt;Execute(&quot;select adate from table&quot;);<br>$f0 = $recordset-&gt;FetchField(0);
-</pre>
-<p>Then <code>$f0-&gt;name</code> will hold <i>'adata'</i>, <code>$f0-&gt;type</code> 
-  will be set to '<i>date'</i>. If the max_length is unknown, it will be set to 
-  -1. 
-<p>One problem with handling different databases is that each database often calls 
-  the same type by a different name. For example a <i>timestamp</i> type is called 
-  <i>datetime</i> in one database and <i>time</i> in another. So ADODB has a special 
-  <code>MetaType($type, $max_length)</code> function that standardises the types 
-  to the following: 
-<p>C: character and varchar types<br>
-  X: text or long character (eg. more than 255 bytes wide).<br>
-  B: blob or binary image<br>
-  D: date<br>
-  T: timestamp<br>
-  L: logical (boolean)<br>
-  I: integer<br>
-  N: numeric (float, double, money) 
-<p>In the above date example, 
-<p><code>$recordset = $conn-&gt;Execute(&quot;select adate from table&quot;);<br>
-  $f0 = $recordset-&gt;FetchField(0);<br>
-  $type = $recordset-&gt;MetaType($f0-&gt;type, $f0-&gt;max_length);<br>
-  print $type; /* should print 'D'</code> */
-<p> 
-<p><b>Select Limit and Top Support</b> 
-<p>ADODB has a function called $connection->SelectLimit($sql,$nrows,$offset) that allows
-you to retrieve a subset of the recordset. This will take advantage of native
-SELECT TOP on Microsoft products and SELECT ... LIMIT with PostgreSQL and MySQL, and
-emulated if the database does not support it.
-<p><b>Caching Support</b> 
-<p>ADODB allows you to cache recordsets in your file system, and only requery the database
-server after a certain timeout period with $connection->CacheExecute($secs2cache,$sql) and 
-$connection->CacheSelectLimit($secs2cache,$sql,$nrows,$offset).
-<p><b>PHP4 Session Handler Support</b> 
-<p>ADODB also supports PHP4 session handlers. You can store your session variables 
-  in a database for true scalability using ADODB. For further information, visit 
-  <a href="http://php.weblogs.com/adodb-sessions"></a><a href="http://php.weblogs.com/adodb-sessions">http://php.weblogs.com/adodb-sessions</a>
-<h3>Commercial Use Encouraged</h3>
-<p>If you plan to write commercial PHP applications that you want to resell, you should consider ADODB. It has been released using the lesser GPL, which means you can legally include it in commercial applications, while keeping your code proprietary. Commercial use of ADODB is strongly encouraged! We are using it internally for this reason.<p>
-
-<h2>Conclusion</h2>
-<p>As a thank you for finishing this article, here are the complete lyrics for 
-  <i>let's call the whole thing off</i>.<br>
-  <br>
-<pre>
-   Refrain 
-<br>
-		You say eether and I say eyether, 
-		You say neether and I say nyther; 
-		Eether, eyether, neether, nyther - 
-		Let's call the whole thing off ! 
-<br>
-		You like potato and I like po-tah-to, 
-		You like tomato and I like to-mah-to; 
-		Potato, po-tah-to, tomato, to-mah-to - 
-		Let's call the whole thing off ! 
-<br>
-But oh, if we call the whole thing off, then we must part. 
-And oh, if we ever part, then that might break my heart. 
-<br>
-		So, if you like pajamas and I like pa-jah-mas, 
-		I'll wear pajamas and give up pa-jah-mas. 
-		For we know we 
-		Need each other, so we 
-		Better call the calling off off. 
-		Let's call the whole thing off ! 
-<br>
-   Second Refrain 
-<br>
-		You say laughter and I say lawfter, 
-		You say after and I say awfter; 
-		Laughter, lawfter, after, awfter - 
-		Let's call the whole thing off ! 
-<br>
-		You like vanilla and I like vanella, 
-		You, sa's'parilla and I sa's'parella; 
-		Vanilla, vanella, choc'late, strawb'ry - 
-		Let's call the whole thing off ! 
-<br>
-But oh, if we call the whole thing off, then we must part. 
-And oh, if we ever part, then that might break my heart. 
-<br>
-		So, if you go for oysters and I go for ersters, 
-		I'll order oysters and cancel the ersters. 
-		For we know we 
-		Need each other, so we 
-		Better call the calling off off. 
-		Let's call the whole thing off ! 
-  </pre>
-<p><font size=2>Song and lyrics by George and Ira Gershwin, introduced by Fred Astaire and Ginger Rogers
-in the film "Shall We Dance?"  </font><p>
-<p>
-(c)2001-2002 John Lim.
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+
+<html>
+<head>
+	<title>Tutorial: Moving from MySQL to ADODB</title>
+</head>
+
+<body bgcolor=white>
+<h1>Tutorial: Moving from MySQL to ADODB</h1>
+
+<pre>		You say eether and I say eyether, 
+		You say neether and I say nyther; 
+		Eether, eyether, neether, nyther - 
+		Let's call the whole thing off ! 
+<br>
+		You like potato and I like po-tah-to, 
+		You like tomato and I like to-mah-to; 
+		Potato, po-tah-to, tomato, to-mah-to - 
+		Let's call the whole thing off ! 
+</pre>
+<p>I love this song, especially the version with Louis Armstrong and Ella singing 
+  duet. It is all about how hard it is for two people in love to be compatible 
+  with each other. It's about compromise and finding a common ground, and that's 
+  what this article is all about. 
+<p>PHP is all about creating dynamic web-sites with the least fuss and the most 
+  fun. To create these websites we need to use databases to retrieve login information, 
+  to splash dynamic news onto the web page and store forum postings. So let's 
+  say we were using the popular MySQL database for this. Your company has done 
+  such a fantastic job that the Web site is more popular than your wildest dreams. 
+  You find that MySQL cannot scale to handle the workload; time to switch databases. 
+<p> Unfortunately in PHP every database is accessed slightly differently. To connect 
+  to MySQL, you would use <i>mysql_connect()</i>; when you decide to upgrade to 
+  Oracle or Microsoft SQL Server, you would use <i>ocilogon() </i>or <i>mssql_connect()</i> 
+  respectively. What is worse is that the parameters you use for the different 
+  connect functions are different also.. One database says po-tato, the other 
+  database says pota-to. Oh-oh. 
+<h3>Let's NOT call the whole thing off</h3>
+<p>A database wrapper library such as ADODB comes in handy when you need to ensure portability. It provides 
+  you with a common API to communicate with any supported database so you don't have to call things off. <p>
+
+<p>ADODB stands for Active Data Objects DataBase (sorry computer guys are sometimes 
+  not very original). ADODB currently supports MySQL, PostgreSQL, Oracle, Interbase, 
+  Microsoft SQL Server, Access, FoxPro, Sybase, ODBC and ADO. You can download 
+  ADODB from <a href=http://php.weblogs.com/adodb></a><a href="http://php.weblogs.com/adodb">http://php.weblogs.com/adodb</a>.
+<h3>MySQL Example</h3>
+<p>The most common database used with PHP is MySQL, so I guess you should be familiar 
+  with the following code. It connects to a MySQL server at <i>localhost</i>, 
+  database <i>mydb</i>, and executes an SQL select statement. The results are 
+  printed, one line per row. 
+<pre><font color="#666600">$db = <b>mysql_connect</b>(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;);
+<b>mysql_select_db</b>(&quot;mydb&quot;,$db);</font>
+<font color="#660000">$result = <b>mysql_query</b>(&quot;SELECT * FROM employees&quot;,$db)</font><code><font color="#663300">;
+if ($result === false) die(&quot;failed&quot;);</font></code> 
+<font color="#006666"><b>while</b> ($fields =<b> mysql_fetch_row</b>($result)) &#123;
+ <b>for</b> ($i=0, $max=sizeof($fields); $i &lt; $max; $i++) &#123;
+		<b>print</b> $fields[$i].' ';
+ &#125;
+ <b>print</b> &quot;&lt;br&gt;\n&quot;;
+&#125;</font> 
+</pre>
+<p>The above code has been color-coded by section. The first section is the connection 
+  phase. The second is the execution of the SQL, and the last section is displaying 
+  the fields. The <i>while</i> loop scans the rows of the result, while the <i>for</i> 
+  loop scans the fields in one row.</p>
+<p>Here is the equivalent code in ADODB</p>
+<pre><b><font color="#666600"> include(&quot;adodb.inc.php&quot;);</font></b><font color="#666600">
+ $db = <b>NewADOConnection</b>('mysql');
+ $db-&gt;<b>Connect</b>(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;, &quot;mydb&quot;);</font>
+ <font color="#663300">$result = $db-&gt;<b>Execute</b>(&quot;SELECT * FROM employees&quot;);
+ </font><font color="#663300"></font><code><font color="#663300">if ($result === false) die(&quot;failed&quot;)</font></code><code><font color="#663300">;</font></code>  
+ <font color="#006666"><b>while</b> (!$result-&gt;EOF) &#123;
+	<b>for</b> ($i=0, $max=$result-&gt;<b>FieldCount</b>(); $i &lt; $max; $i++)
+		   <b>print</b> $result-&gt;fields[$i].' ';
+	$result-&gt;<b>MoveNext</b>();
+	<b>print</b> &quot;&lt;br&gt;\n&quot;;
+ &#125;</font> </pre>
+<p></p>
+<p>Now porting to Oracle is as simple as changing the second line to <code>NewADOConnection('oracle')</code>. 
+  Let's walk through the code...</p>
+<h3>Connecting to the Database</h3>
+<p></p>
+<pre><b><font color="#666600">include(&quot;adodb.inc.php&quot;);</font></b><font color="#666600">
+$db = <b>NewADOConnection</b>('mysql');
+$db-&gt;<b>Connect</b>(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;, &quot;mydb&quot;);</font></pre>
+<p>The connection code is a bit more sophisticated than MySQL's because our needs 
+  are more sophisticated. In ADODB, we use an object-oriented approach to managing 
+  the complexity of handling multiple databases. We have different classes to 
+  handle different databases. If you aren't familiar with object-oriented programing, 
+  don't worry -- the complexity is all hidden away in the<code> NewADOConnection()</code> 
+  function.</p>
+<p>To conserve memory, we only load the PHP code specific to the database you 
+  are connecting to. We do this by calling <code>NewADOConnection(databasedriver)</code>. 
+  Legal database drivers include <i>mysql, mssql, oracle, oci8, postgres, sybase, 
+  vfp, access, ibase </i>and many others.</p>
+<p>Then we create a new instance of the connection class by calling <code>NewADOConnection()</code>. 
+  Finally we connect to the database using <code>$db-&gt;Connect(). </code></p>
+<h3>Executing the SQL</h3>
+<p><code><font color="#663300">$result = $db-&gt;<b>Execute</b>(&quot;SELECT * 
+  FROM employees&quot;);<br>
+  if ($result === false) die(&quot;failed&quot;)</font></code><code><font color="#663300">;</font></code> 
+  <br>
+</p>
+<p>Sending the SQL statement to the server is straight forward. Execute() will 
+  return a recordset object on successful execution. You should check $result 
+  as we do above.
+<p>An issue that confuses beginners is the fact that we have two types of objects 
+  in ADODB, the connection object and the recordset object. When do we use each?
+<p>The connection object ($db) is responsible for connecting to the database, 
+  formatting your SQL and querying the database server. The recordset object ($result) 
+  is responsible for retrieving the results and formatting the reply as text or 
+  as an array.
+<p>The only thing I need to add is that ADODB provides several helper functions 
+  for making INSERT and UPDATE statements easier, which we will cover in the Advanced 
+  section. 
+<h3>Retrieving the Data<br>
+</h3>
+<pre><font color="#006666"><b>while</b> (!$result-&gt;EOF) &#123;
+   <b>for</b> ($i=0, $max=$result-&gt;<b>FieldCount</b>(); $i &lt; $max; $i++)
+	   <b>print</b> $result-&gt;fields[$i].' ';
+   $result-&gt;<b>MoveNext</b>();
+   <b>print</b> &quot;&lt;br&gt;\n&quot;;
+&#125;</font></pre>
+<p>The paradigm for getting the data is that it's like reading a file. For every 
+  line, we check first whether we have reached the end-of-file (EOF). While not 
+  end-of-file, loop through each field in the row. Then move to the next line 
+  (MoveNext) and repeat. 
+<p>The <code>$result-&gt;fields[]</code> array is generated by the PHP database 
+  extension. Some database extensions do not index the array by field name. 
+  To force indexing by name - that is associative arrays - 
+  use the $ADODB_FETCH_MODE global variable. 
+<pre>
+	$<b>ADODB_FETCH_MODE</b> = ADODB_FETCH_NUM;
+	$rs1 = $db->Execute('select * from table');
+	$<b>ADODB_FETCH_MODE</b> = ADODB_FETCH_ASSOC;
+	$rs2 = $db->Execute('select * from table');
+	print_r($rs1->fields); // shows <i>array([0]=>'v0',[1] =>'v1')</i>
+	print_r($rs2->fields); // shows <i>array(['col1']=>'v0',['col2'] =>'v1')</i>
+</pre>
+<p>
+As you can see in the above example, both recordsets store and use different fetch modes
+based on the $ADODB_FETCH_MODE setting when the recordset was created by Execute().</p>
+<h2>ADOConnection<a name="ADOConnection"></a></h2>
+<p>Object that performs the connection to the database, executes SQL statements 
+  and has a set of utility functions for standardising the format of SQL statements 
+  for issues such as concatenation and date formats.</p>
+  
+<h3>Other Useful Functions</h3>
+<p><code>$recordset-&gt;Move($pos)</code> scrolls to that particular row. ADODB supports forward 
+  scrolling for all databases. Some databases will not support backwards scrolling. 
+  This is normally not a problem as you can always cache records to simulate backwards 
+  scrolling. 
+<p><code>$recordset-&gt;RecordCount()</code> returns the number of records accessed by the 
+  SQL statement. Some databases will return -1 because it is not supported. 
+<p><code>$recordset-&gt;GetArray()</code> returns the result as an array. 
+<p><code>rs2html($recordset)</code> is a function that is generates a HTML table based on the 
+  $recordset passed to it. An example with the relevant lines in bold:
+<pre>   include('adodb.inc.php'); 
+   <b>include('tohtml.inc.php');</b> /* includes the rs2html function */
+   $conn = ADONewConnection('mysql'); 
+   $conn-&gt;PConnect('localhost','userid','password','database');
+   $rs = $conn-&gt;Execute('select * from table');
+  <b> rs2html($rs)</b>; /* recordset to html table */ </pre>
+<p>There are many other helper functions that are listed in the documentation available at <a href="http://php.weblogs.com/adodb_manual"></a><a href="http://php.weblogs.com/adodb_manual">http://php.weblogs.com/adodb_manual</a>. 
+<h2>Advanced Material</h2>
+<h3>Inserts and Updates </h3>
+<p>Let's say you want to insert the following data into a database. 
+<p><b>ID</b> = 3<br>
+  <b>TheDate</b>=mktime(0,0,0,8,31,2001) /* 31st August 2001 */<br>
+  <b>Note</b>= sugar why don't we call it off 
+<p>When you move to another database, your insert might no longer work.</p>
+<p>The first problem is that each database has a different default date format. 
+  MySQL expects YYYY-MM-DD format, while other databases have different defaults. 
+  ADODB has a function called DBDate() that addresses this issue by converting 
+  converting the date to the correct format.</p>
+<p>The next problem is that the <b>don't</b> in the Note needs to be quoted. In 
+  MySQL, we use <b>don\'t</b> but in some other databases (Sybase, Access, Microsoft 
+  SQL Server) we use <b>don''t. </b>The qstr() function addresses this issue.</p>
+<p>So how do we use the functions? Like this:</p>
+<pre>$sql = &quot;INSERT INTO table (id, thedate,note) values (&quot; 
+   . $<b>ID</b> . ','
+   . $db-&gt;DBDate($<b>TheDate</b>) .','
+   . $db-&gt;qstr($<b>Note</b>).&quot;)&quot;;
+$db-&gt;Execute($sql);</pre>
+<p>ADODB also supports <code>$connection-&gt;Affected_Rows()</code> (returns the 
+  number of rows affected by last update or delete) and <code>$recordset-&gt;Insert_ID()</code> 
+  (returns last autoincrement number generated by an insert statement). Be forewarned 
+  that not all databases support the two functions.<br>
+</p>
+<h3>MetaTypes</h3>
+<p>You can find out more information about each of the fields (I use the words 
+  fields and columns interchangebly) you are selecting by calling the recordset 
+  method <code>FetchField($fieldoffset)</code>. This will return an object with 
+  3 properties: name, type and max_length. 
+<pre>For example:</pre>
+<pre>$recordset = $conn-&gt;Execute(&quot;select adate from table&quot;);<br>$f0 = $recordset-&gt;FetchField(0);
+</pre>
+<p>Then <code>$f0-&gt;name</code> will hold <i>'adata'</i>, <code>$f0-&gt;type</code> 
+  will be set to '<i>date'</i>. If the max_length is unknown, it will be set to 
+  -1. 
+<p>One problem with handling different databases is that each database often calls 
+  the same type by a different name. For example a <i>timestamp</i> type is called 
+  <i>datetime</i> in one database and <i>time</i> in another. So ADODB has a special 
+  <code>MetaType($type, $max_length)</code> function that standardises the types 
+  to the following: 
+<p>C: character and varchar types<br>
+  X: text or long character (eg. more than 255 bytes wide).<br>
+  B: blob or binary image<br>
+  D: date<br>
+  T: timestamp<br>
+  L: logical (boolean)<br>
+  I: integer<br>
+  N: numeric (float, double, money) 
+<p>In the above date example, 
+<p><code>$recordset = $conn-&gt;Execute(&quot;select adate from table&quot;);<br>
+  $f0 = $recordset-&gt;FetchField(0);<br>
+  $type = $recordset-&gt;MetaType($f0-&gt;type, $f0-&gt;max_length);<br>
+  print $type; /* should print 'D'</code> */
+<p> 
+<p><b>Select Limit and Top Support</b> 
+<p>ADODB has a function called $connection->SelectLimit($sql,$nrows,$offset) that allows
+you to retrieve a subset of the recordset. This will take advantage of native
+SELECT TOP on Microsoft products and SELECT ... LIMIT with PostgreSQL and MySQL, and
+emulated if the database does not support it.
+<p><b>Caching Support</b> 
+<p>ADODB allows you to cache recordsets in your file system, and only requery the database
+server after a certain timeout period with $connection->CacheExecute($secs2cache,$sql) and 
+$connection->CacheSelectLimit($secs2cache,$sql,$nrows,$offset).
+<p><b>PHP4 Session Handler Support</b> 
+<p>ADODB also supports PHP4 session handlers. You can store your session variables 
+  in a database for true scalability using ADODB. For further information, visit 
+  <a href="http://php.weblogs.com/adodb-sessions"></a><a href="http://php.weblogs.com/adodb-sessions">http://php.weblogs.com/adodb-sessions</a>
+<h3>Commercial Use Encouraged</h3>
+<p>If you plan to write commercial PHP applications that you want to resell, you should consider ADODB. It has been released using the lesser GPL, which means you can legally include it in commercial applications, while keeping your code proprietary. Commercial use of ADODB is strongly encouraged! We are using it internally for this reason.<p>
+
+<h2>Conclusion</h2>
+<p>As a thank you for finishing this article, here are the complete lyrics for 
+  <i>let's call the whole thing off</i>.<br>
+  <br>
+<pre>
+   Refrain 
+<br>
+		You say eether and I say eyether, 
+		You say neether and I say nyther; 
+		Eether, eyether, neether, nyther - 
+		Let's call the whole thing off ! 
+<br>
+		You like potato and I like po-tah-to, 
+		You like tomato and I like to-mah-to; 
+		Potato, po-tah-to, tomato, to-mah-to - 
+		Let's call the whole thing off ! 
+<br>
+But oh, if we call the whole thing off, then we must part. 
+And oh, if we ever part, then that might break my heart. 
+<br>
+		So, if you like pajamas and I like pa-jah-mas, 
+		I'll wear pajamas and give up pa-jah-mas. 
+		For we know we 
+		Need each other, so we 
+		Better call the calling off off. 
+		Let's call the whole thing off ! 
+<br>
+   Second Refrain 
+<br>
+		You say laughter and I say lawfter, 
+		You say after and I say awfter; 
+		Laughter, lawfter, after, awfter - 
+		Let's call the whole thing off ! 
+<br>
+		You like vanilla and I like vanella, 
+		You, sa's'parilla and I sa's'parella; 
+		Vanilla, vanella, choc'late, strawb'ry - 
+		Let's call the whole thing off ! 
+<br>
+But oh, if we call the whole thing off, then we must part. 
+And oh, if we ever part, then that might break my heart. 
+<br>
+		So, if you go for oysters and I go for ersters, 
+		I'll order oysters and cancel the ersters. 
+		For we know we 
+		Need each other, so we 
+		Better call the calling off off. 
+		Let's call the whole thing off ! 
+  </pre>
+<p><font size=2>Song and lyrics by George and Ira Gershwin, introduced by Fred Astaire and Ginger Rogers
+in the film "Shall We Dance?"  </font><p>
+<p>
+(c)2001-2002 John Lim.
+
+</body>
+</html>
diff --git a/third_party/adodb/drivers/adodb-access.inc.php b/third_party/adodb/drivers/adodb-access.inc.php
index 663a2f4..36645ee 100644
--- a/third_party/adodb/drivers/adodb-access.inc.php
+++ b/third_party/adodb/drivers/adodb-access.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
diff --git a/third_party/adodb/drivers/adodb-ado.inc.php b/third_party/adodb/drivers/adodb-ado.inc.php
index d300e92..552e577 100644
--- a/third_party/adodb/drivers/adodb-ado.inc.php
+++ b/third_party/adodb/drivers/adodb-ado.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -169,7 +169,7 @@ class ADODB_ado extends ADOConnection {
 		return $arr;
 	}
 	
-	function MetaColumns($table)
+	function MetaColumns($table, $normalize=true)
 	{
 		$table = strtoupper($table);
 		$arr = array();
@@ -221,11 +221,27 @@ class ADODB_ado extends ADOConnection {
 			$oCmd->CommandText = $sql;
 			$oCmd->CommandType = 1;
 
-			foreach($inputarr as $val) {
+      // Map by http://msdn.microsoft.com/library/default.asp?url=/library/en-us/ado270/htm/mdmthcreateparam.asp
+      // Check issue http://bugs.php.net/bug.php?id=40664 !!!
+			while(list(, $val) = each($inputarr)) {
+				$type = gettype($val);
+				$len=strlen($val);
+				if ($type == 'boolean')
+					$this->adoParameterType = 11;
+				else if ($type == 'integer')
+					$this->adoParameterType = 3;
+				else if ($type == 'double')
+					$this->adoParameterType = 5;
+				elseif ($type == 'string')
+					$this->adoParameterType = 202;
+				else if (($val === null) || (!defined($val)))
+					$len=1;
+				else
+					$this->adoParameterType = 130;
+				
 				// name, type, direction 1 = input, len,
-				$this->adoParameterType = 130;
-				$p = $oCmd->CreateParameter('name',$this->adoParameterType,1,strlen($val),$val);
-				//print $p->Type.' '.$p->value;
+        		$p = $oCmd->CreateParameter('name',$this->adoParameterType,1,$len,$val);
+
 				$oCmd->Parameters->Append($p);
 			}
 			$p = false;
diff --git a/third_party/adodb/drivers/adodb-ado5.inc.php b/third_party/adodb/drivers/adodb-ado5.inc.php
index d914b93..51beb65 100644
--- a/third_party/adodb/drivers/adodb-ado5.inc.php
+++ b/third_party/adodb/drivers/adodb-ado5.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -70,7 +70,8 @@ class ADODB_ado extends ADOConnection {
 		 } else {
 		 	$argDatabasename = '';
 		 	if ($argDBorProvider) $argProvider = $argDBorProvider;
-			else $argProvider = 'MSDASQL';
+			else if (stripos($argHostname,'PROVIDER') === false) /* full conn string is not in $argHostname */ 
+				$argProvider = 'MSDASQL';
 		}
 		
 		
@@ -117,6 +118,7 @@ class ADODB_ado extends ADOConnection {
 		$dbc->CursorLocation = $this->_cursor_location;
 		return  $dbc->State > 0;
 		} catch (exception $e) {
+			if ($this->debug);echo "<pre>",$argHostname,"\n",$e,"</pre>\n";
 		}
 		
 		return false;
@@ -192,7 +194,7 @@ class ADODB_ado extends ADOConnection {
 		return $arr;
 	}
 	
-	function MetaColumns($table)
+	function MetaColumns($table, $normalize=true)
 	{
 		$table = strtoupper($table);
 		$arr= array();
@@ -244,13 +246,28 @@ class ADODB_ado extends ADOConnection {
 			$oCmd->CommandText = $sql;
 			$oCmd->CommandType = 1;
 
-			foreach($inputarr as $val) {
+			while(list(, $val) = each($inputarr)) {
+				$type = gettype($val);
+				$len=strlen($val);
+				if ($type == 'boolean')
+					$this->adoParameterType = 11;
+				else if ($type == 'integer')
+					$this->adoParameterType = 3;
+				else if ($type == 'double')
+					$this->adoParameterType = 5;
+				elseif ($type == 'string')
+					$this->adoParameterType = 202;
+				else if (($val === null) || (!defined($val)))
+					$len=1;
+				else
+					$this->adoParameterType = 130;
+				
 				// name, type, direction 1 = input, len,
-				$this->adoParameterType = 130;
-				$p = $oCmd->CreateParameter('name',$this->adoParameterType,1,strlen($val),$val);
-				//print $p->Type.' '.$p->value;
+        		$p = $oCmd->CreateParameter('name',$this->adoParameterType,1,$len,$val);
+
 				$oCmd->Parameters->Append($p);
 			}
+			
 			$p = false;
 			$rs = $oCmd->Execute();
 			$e = $dbc->Errors;
@@ -375,6 +392,8 @@ class ADORecordSet_ado extends ADORecordSet {
 		
 		$o= new ADOFieldObject();
 		$rs = $this->_queryID;
+		if (!$rs) return false;
+		
 		$f = $rs->Fields($fieldOffset);
 		$o->name = $f->Name;
 		$t = $f->Type;
@@ -406,8 +425,12 @@ class ADORecordSet_ado extends ADORecordSet {
 	function _initrs()
 	{
 		$rs = $this->_queryID;
-		$this->_numOfRows = $rs->RecordCount;
 		
+		try {
+			$this->_numOfRows = $rs->RecordCount;
+		} catch (Exception $e) {
+			$this->_numOfRows = -1;
+		}
 		$f = $rs->Fields;
 		$this->_numOfFields = $f->Count;
 	}
@@ -617,6 +640,10 @@ class ADORecordSet_ado extends ADORecordSet {
 			case 1: // null
 				$this->fields[] = false;
 				break;
+			case 20:
+			case 21: // bigint (64 bit)
+    			$this->fields[] = (float) $f->value; // if 64 bit PHP, could use (int)
+    			break;
 			case 6: // currency is not supported properly;
 				ADOConnection::outp( '<b>'.$f->Name.': currency type not supported by PHP</b>');
 				$this->fields[] = (float) $f->value;
@@ -669,7 +696,10 @@ class ADORecordSet_ado extends ADORecordSet {
 
 	function _close() {
 		$this->_flds = false;
+		try {
 		@$this->_queryID->Close();// by Pete Dishman (peterd@telephonetics.co.uk)
+		} catch (Exception $e) {
+		}
 		$this->_queryID = false;	
 	}
 
diff --git a/third_party/adodb/drivers/adodb-ado_access.inc.php b/third_party/adodb/drivers/adodb-ado_access.inc.php
index 05cb0e7..3a827a5 100644
--- a/third_party/adodb/drivers/adodb-ado_access.inc.php
+++ b/third_party/adodb/drivers/adodb-ado_access.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
 Released under both BSD license and Lesser GPL library license. 
 Whenever there is any discrepancy between the two licenses, 
 the BSD license will take precedence. See License.txt. 
@@ -26,7 +26,6 @@ class  ADODB_ado_access extends ADODB_ado {
 	var $fmtTimeStamp = "#Y-m-d h:i:sA#";// note no comma
 	var $sysDate = "FORMAT(NOW,'yyyy-mm-dd')";
 	var $sysTimeStamp = 'NOW';
-	var $hasTransactions = false;
 	var $upperCase = 'ucase';
 	
 	function ADODB_ado_access()
@@ -34,11 +33,11 @@ class  ADODB_ado_access extends ADODB_ado {
 		$this->ADODB_ado();
 	}
 	
-	function BeginTrans() { return false;}
+	/*function BeginTrans() { return false;}
 	
 	function CommitTrans() { return false;}
 	
-	function RollbackTrans() { return false;}
+	function RollbackTrans() { return false;}*/
 
 }
 
diff --git a/third_party/adodb/drivers/adodb-ado_mssql.inc.php b/third_party/adodb/drivers/adodb-ado_mssql.inc.php
index 5a73e64..0831984 100644
--- a/third_party/adodb/drivers/adodb-ado_mssql.inc.php
+++ b/third_party/adodb/drivers/adodb-ado_mssql.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -71,7 +71,7 @@ class  ADODB_ado_mssql extends ADODB_ado {
 		return str_replace("\0", "\\\\000", $s);
 	}
 	
-	function MetaColumns($table)
+	function MetaColumns($table, $normalize=true)
 	{
         $table = strtoupper($table);
         $arr= array();
diff --git a/third_party/adodb/drivers/adodb-ads.inc.php b/third_party/adodb/drivers/adodb-ads.inc.php
new file mode 100644
index 0000000..0de57ca
--- /dev/null
+++ b/third_party/adodb/drivers/adodb-ads.inc.php
@@ -0,0 +1,796 @@
+<?php
+/*
+  (c) 2000-2007 John Lim (jlim#natsoft.com.my). All rights reserved.
+  Portions Copyright (c) 2007-2009, iAnywhere Solutions, Inc.
+  All rights reserved. All unpublished rights reserved.
+
+  Released under both BSD license and Lesser GPL library license.
+  Whenever there is any discrepancy between the two licenses,
+  the BSD license will take precedence.
+
+Set tabs to 4 for best viewing.
+
+
+NOTE: This driver requires the Advantage PHP client libraries, which
+      can be downloaded for free via:
+      http://devzone.advantagedatabase.com/dz/content.aspx?key=20
+
+DELPHI FOR PHP USERS:
+      The following steps can be taken to utilize this driver from the
+      CodeGear Delphi for PHP product:
+        1 - See note above, download and install the Advantage PHP client.
+        2 - Copy the following files to the Delphi for PHP\X.X\php\ext directory:
+              ace32.dll
+              axcws32.dll
+              adsloc32.dll
+              php_advantage.dll (rename the existing php_advantage.dll.5.x.x file)
+        3 - Add the following line to the Delphi for PHP\X.X\php\php.ini.template file:
+              extension=php_advantage.dll
+        4 - To use: enter "ads" as the DriverName on a connection component, and set
+            a Host property similar to "DataDirectory=c:\". See the Advantage PHP
+            help file topic for ads_connect for details on connection path options
+            and formatting.
+        5 - (optional) - Modify the Delphi for PHP\X.X\vcl\packages\database.packages.php
+            file and add ads to the list of strings returned when registering the
+            Database object's DriverName property.
+
+*/
+// security - hide paths
+if (!defined('ADODB_DIR')) die();
+
+  define("_ADODB_ADS_LAYER", 2 );
+
+/*--------------------------------------------------------------------------------------
+--------------------------------------------------------------------------------------*/
+
+
+class ADODB_ads extends ADOConnection {
+  var $databaseType = "ads";
+  var $fmt = "'m-d-Y'";
+  var $fmtTimeStamp = "'Y-m-d H:i:s'";
+        var $concat_operator = '';
+  var $replaceQuote = "''"; // string to use to replace quotes
+  var $dataProvider = "ads";
+  var $hasAffectedRows = true;
+  var $binmode = ODBC_BINMODE_RETURN;
+  var $useFetchArray = false; // setting this to true will make array elements in FETCH_ASSOC mode case-sensitive
+                        // breaking backward-compat
+  //var $longreadlen = 8000; // default number of chars to return for a Blob/Long field
+  var $_bindInputArray = false;
+  var $curmode = SQL_CUR_USE_DRIVER; // See sqlext.h, SQL_CUR_DEFAULT == SQL_CUR_USE_DRIVER == 2L
+  var $_genSeqSQL = "create table %s (id integer)";
+  var $_autocommit = true;
+  var $_haserrorfunctions = true;
+  var $_has_stupid_odbc_fetch_api_change = true;
+  var $_lastAffectedRows = 0;
+  var $uCaseTables = true; // for meta* functions, uppercase table names
+
+
+  function ADODB_ads()
+  {
+    $this->_haserrorfunctions = ADODB_PHPVER >= 0x4050;
+    $this->_has_stupid_odbc_fetch_api_change = ADODB_PHPVER >= 0x4200;
+  }
+
+  // returns true or false
+  function _connect($argDSN, $argUsername, $argPassword, $argDatabasename)
+  {
+          global $php_errormsg;
+
+    if (!function_exists('ads_connect')) return null;
+
+    if ($this->debug && $argDatabasename && $this->databaseType != 'vfp') {
+      ADOConnection::outp("For Advantage Connect(), $argDatabasename is not used. Place dsn in 1st parameter.");
+    }
+    if (isset($php_errormsg)) $php_errormsg = '';
+    if ($this->curmode === false) $this->_connectionID = ads_connect($argDSN,$argUsername,$argPassword);
+    else $this->_connectionID = ads_connect($argDSN,$argUsername,$argPassword,$this->curmode);
+    $this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+    if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
+
+    return $this->_connectionID != false;
+  }
+
+  // returns true or false
+  function _pconnect($argDSN, $argUsername, $argPassword, $argDatabasename)
+  {
+  global $php_errormsg;
+
+    if (!function_exists('ads_connect')) return null;
+
+    if (isset($php_errormsg)) $php_errormsg = '';
+    $this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+    if ($this->debug && $argDatabasename) {
+            ADOConnection::outp("For PConnect(), $argDatabasename is not used. Place dsn in 1st parameter.");
+    }
+  //  print "dsn=$argDSN u=$argUsername p=$argPassword<br>"; flush();
+    if ($this->curmode === false) $this->_connectionID = ads_connect($argDSN,$argUsername,$argPassword);
+    else $this->_connectionID = ads_pconnect($argDSN,$argUsername,$argPassword,$this->curmode);
+
+    $this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+    if ($this->_connectionID && $this->autoRollback) @ads_rollback($this->_connectionID);
+    if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
+
+    return $this->_connectionID != false;
+  }
+
+  // returns the Server version and Description
+  function ServerInfo()
+  {
+
+    if (!empty($this->host) && ADODB_PHPVER >= 0x4300) {
+      $stmt = $this->Prepare('EXECUTE PROCEDURE sp_mgGetInstallInfo()');
+                        $res =  $this->Execute($stmt);
+                        if(!$res)
+                                print $this->ErrorMsg();
+                        else{
+                                $ret["version"]= $res->fields[3];
+                                $ret["description"]="Advantage Database Server";
+                                return $ret;
+                        }
+                }
+                else {
+            return ADOConnection::ServerInfo();
+    }
+  }
+
+
+        // returns true or false
+        function CreateSequence( $seqname,$start=1)
+  {
+                $res =  $this->Execute("CREATE TABLE $seqname ( ID autoinc( 1 ) ) IN DATABASE");
+                if(!$res){
+                        print $this->ErrorMsg();
+                        return false;
+                }
+                else
+                        return true;
+
+        }
+
+        // returns true or false
+        function DropSequence($seqname)
+  {
+                $res = $this->Execute("DROP TABLE $seqname");
+                if(!$res){
+                        print $this->ErrorMsg();
+                        return false;
+                }
+                else
+                        return true;
+        }
+
+
+  // returns the generated ID or false
+        // checks if the table already exists, else creates the table and inserts a record into the table
+        // and gets the ID number of the last inserted record.
+        function GenID($seqname,$start=1)
+        {
+                $go = $this->Execute("select * from $seqname");
+                if (!$go){
+                        $res = $this->Execute("CREATE TABLE $seqname ( ID autoinc( 1 ) ) IN DATABASE");
+                        if(!res){
+                                print $this->ErrorMsg();
+                                return false;
+                        }
+                }
+                $res = $this->Execute("INSERT INTO $seqname VALUES( DEFAULT )");
+                if(!$res){
+                        print $this->ErrorMsg();
+                        return false;
+                }
+                else{
+                        $gen = $this->Execute("SELECT LastAutoInc( STATEMENT ) FROM system.iota");
+                        $ret = $gen->fields[0];
+                        return $ret;
+                }
+
+        }
+
+
+
+
+  function ErrorMsg()
+  {
+    if ($this->_haserrorfunctions) {
+      if ($this->_errorMsg !== false) return $this->_errorMsg;
+      if (empty($this->_connectionID)) return @ads_errormsg();
+      return @ads_errormsg($this->_connectionID);
+    } else return ADOConnection::ErrorMsg();
+  }
+
+
+  function ErrorNo()
+  {
+
+                if ($this->_haserrorfunctions) {
+      if ($this->_errorCode !== false) {
+        // bug in 4.0.6, error number can be corrupted string (should be 6 digits)
+        return (strlen($this->_errorCode)<=2) ? 0 : $this->_errorCode;
+      }
+
+      if (empty($this->_connectionID)) $e = @ads_error();
+      else $e = @ads_error($this->_connectionID);
+
+       // bug in 4.0.6, error number can be corrupted string (should be 6 digits)
+       // so we check and patch
+      if (strlen($e)<=2) return 0;
+      return $e;
+    } else return ADOConnection::ErrorNo();
+  }
+
+
+
+  function BeginTrans()
+  {
+    if (!$this->hasTransactions) return false;
+    if ($this->transOff) return true;
+    $this->transCnt += 1;
+    $this->_autocommit = false;
+    return ads_autocommit($this->_connectionID,false);
+  }
+
+  function CommitTrans($ok=true)
+  {
+    if ($this->transOff) return true;
+    if (!$ok) return $this->RollbackTrans();
+    if ($this->transCnt) $this->transCnt -= 1;
+    $this->_autocommit = true;
+    $ret = ads_commit($this->_connectionID);
+    ads_autocommit($this->_connectionID,true);
+    return $ret;
+  }
+
+  function RollbackTrans()
+  {
+    if ($this->transOff) return true;
+    if ($this->transCnt) $this->transCnt -= 1;
+    $this->_autocommit = true;
+    $ret = ads_rollback($this->_connectionID);
+    ads_autocommit($this->_connectionID,true);
+    return $ret;
+  }
+
+
+  // Returns tables,Views or both on succesfull execution. Returns
+        // tables by default on succesfull execustion.
+  function &MetaTables($ttype)
+  {
+          $recordSet1 = $this->Execute("select * from system.tables");
+                if(!$recordSet1){
+                        print $this->ErrorMsg();
+                        return false;
+                }
+                $recordSet2 = $this->Execute("select * from system.views");
+                if(!$recordSet2){
+                        print $this->ErrorMsg();
+                        return false;
+                }
+                $i=0;
+                while (!$recordSet1->EOF){
+                                 $arr["$i"] = $recordSet1->fields[0];
+                                 $recordSet1->MoveNext();
+                                 $i=$i+1;
+                }
+                if($ttype=='FALSE'){
+                        while (!$recordSet2->EOF){
+                                $arr["$i"] = $recordSet2->fields[0];
+                                $recordSet2->MoveNext();
+                                $i=$i+1;
+                        }
+                        return $arr;
+                }
+                elseif($ttype=='VIEWS'){
+                        while (!$recordSet2->EOF){
+                                $arrV["$i"] = $recordSet2->fields[0];
+                                $recordSet2->MoveNext();
+                                $i=$i+1;
+                        }
+                        return $arrV;
+                }
+                else{
+                        return $arr;
+                }
+
+  }
+
+        function &MetaPrimaryKeys($table)
+  {
+          $recordSet = $this->Execute("select table_primary_key from system.tables where name='$table'");
+                if(!$recordSet){
+                        print $this->ErrorMsg();
+                        return false;
+                }
+                $i=0;
+                while (!$recordSet->EOF){
+                                 $arr["$i"] = $recordSet->fields[0];
+                                 $recordSet->MoveNext();
+                                 $i=$i+1;
+                }
+                return $arr;
+        }
+
+/*
+See http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/odbcdatetime_data_type_changes.asp
+/ SQL data type codes /
+#define SQL_UNKNOWN_TYPE  0
+#define SQL_CHAR      1
+#define SQL_NUMERIC    2
+#define SQL_DECIMAL    3
+#define SQL_INTEGER    4
+#define SQL_SMALLINT    5
+#define SQL_FLOAT      6
+#define SQL_REAL      7
+#define SQL_DOUBLE      8
+#if (ODBCVER >= 0x0300)
+#define SQL_DATETIME    9
+#endif
+#define SQL_VARCHAR   12
+
+
+/ One-parameter shortcuts for date/time data types /
+#if (ODBCVER >= 0x0300)
+#define SQL_TYPE_DATE   91
+#define SQL_TYPE_TIME   92
+#define SQL_TYPE_TIMESTAMP 93
+
+#define SQL_UNICODE                             (-95)
+#define SQL_UNICODE_VARCHAR                     (-96)
+#define SQL_UNICODE_LONGVARCHAR                 (-97)
+*/
+  function ODBCTypes($t)
+  {
+    switch ((integer)$t) {
+    case 1:
+    case 12:
+    case 0:
+    case -95:
+    case -96:
+      return 'C';
+    case -97:
+    case -1: //text
+      return 'X';
+    case -4: //image
+      return 'B';
+
+    case 9:
+    case 91:
+      return 'D';
+
+    case 10:
+    case 11:
+    case 92:
+    case 93:
+      return 'T';
+
+    case 4:
+    case 5:
+    case -6:
+      return 'I';
+
+    case -11: // uniqidentifier
+      return 'R';
+    case -7: //bit
+      return 'L';
+
+    default:
+      return 'N';
+    }
+  }
+
+  function &MetaColumns($table)
+  {
+  global $ADODB_FETCH_MODE;
+
+    $false = false;
+    if ($this->uCaseTables) $table = strtoupper($table);
+    $schema = '';
+    $this->_findschema($table,$schema);
+
+    $savem = $ADODB_FETCH_MODE;
+    $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+
+    /*if (false) { // after testing, confirmed that the following does not work becoz of a bug
+      $qid2 = ads_tables($this->_connectionID);
+      $rs = new ADORecordSet_ads($qid2);
+      $ADODB_FETCH_MODE = $savem;
+      if (!$rs) return false;
+      $rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
+      $rs->_fetch();
+
+      while (!$rs->EOF) {
+        if ($table == strtoupper($rs->fields[2])) {
+          $q = $rs->fields[0];
+          $o = $rs->fields[1];
+          break;
+        }
+        $rs->MoveNext();
+      }
+      $rs->Close();
+
+      $qid = ads_columns($this->_connectionID,$q,$o,strtoupper($table),'%');
+    } */
+
+    switch ($this->databaseType) {
+    case 'access':
+    case 'vfp':
+      $qid = ads_columns($this->_connectionID);#,'%','',strtoupper($table),'%');
+      break;
+
+
+    case 'db2':
+            $colname = "%";
+            $qid = ads_columns($this->_connectionID, "", $schema, $table, $colname);
+            break;
+
+    default:
+      $qid = @ads_columns($this->_connectionID,'%','%',strtoupper($table),'%');
+      if (empty($qid)) $qid = ads_columns($this->_connectionID);
+      break;
+    }
+    if (empty($qid)) return $false;
+
+    $rs = new ADORecordSet_ads($qid);
+    $ADODB_FETCH_MODE = $savem;
+
+    if (!$rs) return $false;
+    $rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
+    $rs->_fetch();
+
+    $retarr = array();
+
+    /*
+    $rs->fields indices
+    0 TABLE_QUALIFIER
+    1 TABLE_SCHEM
+    2 TABLE_NAME
+    3 COLUMN_NAME
+    4 DATA_TYPE
+    5 TYPE_NAME
+    6 PRECISION
+    7 LENGTH
+    8 SCALE
+    9 RADIX
+    10 NULLABLE
+    11 REMARKS
+    */
+    while (!$rs->EOF) {
+    //  adodb_pr($rs->fields);
+      if (strtoupper(trim($rs->fields[2])) == $table && (!$schema || strtoupper($rs->fields[1]) == $schema)) {
+        $fld = new ADOFieldObject();
+        $fld->name = $rs->fields[3];
+        $fld->type = $this->ODBCTypes($rs->fields[4]);
+
+        // ref: http://msdn.microsoft.com/library/default.asp?url=/archive/en-us/dnaraccgen/html/msdn_odk.asp
+        // access uses precision to store length for char/varchar
+        if ($fld->type == 'C' or $fld->type == 'X') {
+          if ($this->databaseType == 'access')
+            $fld->max_length = $rs->fields[6];
+          else if ($rs->fields[4] <= -95) // UNICODE
+            $fld->max_length = $rs->fields[7]/2;
+          else
+            $fld->max_length = $rs->fields[7];
+        } else
+          $fld->max_length = $rs->fields[7];
+        $fld->not_null = !empty($rs->fields[10]);
+        $fld->scale = $rs->fields[8];
+        $retarr[strtoupper($fld->name)] = $fld;
+      } else if (sizeof($retarr)>0)
+        break;
+      $rs->MoveNext();
+    }
+    $rs->Close(); //-- crashes 4.03pl1 -- why?
+
+    if (empty($retarr)) $retarr = false;
+    return $retarr;
+  }
+
+        // Returns an array of columns names for a given table
+        function &MetaColumnNames($table)
+        {
+                $recordSet = $this->Execute("select name from system.columns where parent='$table'");
+                if(!$recordSet){
+                        print $this->ErrorMsg();
+                        return false;
+                }
+                else{
+                        $i=0;
+                        while (!$recordSet->EOF){
+                                $arr["FIELD$i"] = $recordSet->fields[0];
+                                $recordSet->MoveNext();
+                                $i=$i+1;
+                        }
+                        return $arr;
+                }
+        }
+
+
+  function Prepare($sql)
+  {
+    if (! $this->_bindInputArray) return $sql; // no binding
+    $stmt = ads_prepare($this->_connectionID,$sql);
+    if (!$stmt) {
+      // we don't know whether odbc driver is parsing prepared stmts, so just return sql
+      return $sql;
+    }
+    return array($sql,$stmt,false);
+  }
+
+  /* returns queryID or false */
+  function _query($sql,$inputarr=false)
+  {
+  GLOBAL $php_errormsg;
+    if (isset($php_errormsg)) $php_errormsg = '';
+    $this->_error = '';
+
+                if ($inputarr) {
+      if (is_array($sql)) {
+        $stmtid = $sql[1];
+      } else {
+        $stmtid = ads_prepare($this->_connectionID,$sql);
+
+        if ($stmtid == false) {
+          $this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+          return false;
+        }
+      }
+
+      if (! ads_execute($stmtid,$inputarr)) {
+        //@ads_free_result($stmtid);
+        if ($this->_haserrorfunctions) {
+          $this->_errorMsg = ads_errormsg();
+          $this->_errorCode = ads_error();
+        }
+        return false;
+      }
+
+    } else if (is_array($sql)) {
+      $stmtid = $sql[1];
+      if (!ads_execute($stmtid)) {
+        //@ads_free_result($stmtid);
+        if ($this->_haserrorfunctions) {
+          $this->_errorMsg = ads_errormsg();
+          $this->_errorCode = ads_error();
+        }
+        return false;
+      }
+    } else
+                        {
+
+      $stmtid = ads_exec($this->_connectionID,$sql);
+
+                        }
+
+                $this->_lastAffectedRows = 0;
+
+    if ($stmtid)
+                {
+
+      if (@ads_num_fields($stmtid) == 0) {
+        $this->_lastAffectedRows = ads_num_rows($stmtid);
+        $stmtid = true;
+
+      } else {
+
+        $this->_lastAffectedRows = 0;
+        ads_binmode($stmtid,$this->binmode);
+        ads_longreadlen($stmtid,$this->maxblobsize);
+
+      }
+
+      if ($this->_haserrorfunctions)
+                        {
+
+        $this->_errorMsg = '';
+        $this->_errorCode = 0;
+      }
+                        else
+        $this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+    }
+                else
+                {
+      if ($this->_haserrorfunctions) {
+        $this->_errorMsg = ads_errormsg();
+        $this->_errorCode = ads_error();
+      } else
+        $this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+    }
+
+    return $stmtid;
+
+  }
+
+  /*
+    Insert a null into the blob field of the table first.
+    Then use UpdateBlob to store the blob.
+
+    Usage:
+
+    $conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');
+    $conn->UpdateBlob('blobtable','blobcol',$blob,'id=1');
+   */
+  function UpdateBlob($table,$column,$val,$where,$blobtype='BLOB')
+  {
+                $sql = "UPDATE $table SET $column=? WHERE $where";
+                $stmtid = ads_prepare($this->_connectionID,$sql);
+                if ($stmtid == false){
+                  $this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
+                  return false;
+          }
+                if (! ads_execute($stmtid,array($val),array(SQL_BINARY) )){
+                        if ($this->_haserrorfunctions){
+                                $this->_errorMsg = ads_errormsg();
+                    $this->_errorCode = ads_error();
+            }
+                        return false;
+           }
+                 return TRUE;
+        }
+
+  // returns true or false
+  function _close()
+  {
+    $ret = @ads_close($this->_connectionID);
+    $this->_connectionID = false;
+    return $ret;
+  }
+
+  function _affectedrows()
+  {
+    return $this->_lastAffectedRows;
+  }
+
+}
+
+/*--------------------------------------------------------------------------------------
+   Class Name: Recordset
+--------------------------------------------------------------------------------------*/
+
+class ADORecordSet_ads extends ADORecordSet {
+
+  var $bind = false;
+  var $databaseType = "ads";
+  var $dataProvider = "ads";
+  var $useFetchArray;
+  var $_has_stupid_odbc_fetch_api_change;
+
+  function ADORecordSet_ads($id,$mode=false)
+  {
+    if ($mode === false) {
+      global $ADODB_FETCH_MODE;
+      $mode = $ADODB_FETCH_MODE;
+    }
+    $this->fetchMode = $mode;
+
+    $this->_queryID = $id;
+
+    // the following is required for mysql odbc driver in 4.3.1 -- why?
+    $this->EOF = false;
+    $this->_currentRow = -1;
+    //$this->ADORecordSet($id);
+  }
+
+
+  // returns the field object
+  function &FetchField($fieldOffset = -1)
+  {
+
+    $off=$fieldOffset+1; // offsets begin at 1
+
+    $o= new ADOFieldObject();
+    $o->name = @ads_field_name($this->_queryID,$off);
+    $o->type = @ads_field_type($this->_queryID,$off);
+    $o->max_length = @ads_field_len($this->_queryID,$off);
+    if (ADODB_ASSOC_CASE == 0) $o->name = strtolower($o->name);
+    else if (ADODB_ASSOC_CASE == 1) $o->name = strtoupper($o->name);
+    return $o;
+  }
+
+  /* Use associative array to get fields array */
+  function Fields($colname)
+  {
+    if ($this->fetchMode & ADODB_FETCH_ASSOC) return $this->fields[$colname];
+    if (!$this->bind) {
+      $this->bind = array();
+      for ($i=0; $i < $this->_numOfFields; $i++) {
+        $o = $this->FetchField($i);
+        $this->bind[strtoupper($o->name)] = $i;
+      }
+    }
+
+     return $this->fields[$this->bind[strtoupper($colname)]];
+  }
+
+
+  function _initrs()
+  {
+  global $ADODB_COUNTRECS;
+    $this->_numOfRows = ($ADODB_COUNTRECS) ? @ads_num_rows($this->_queryID) : -1;
+    $this->_numOfFields = @ads_num_fields($this->_queryID);
+    // some silly drivers such as db2 as/400 and intersystems cache return _numOfRows = 0
+    if ($this->_numOfRows == 0) $this->_numOfRows = -1;
+    //$this->useFetchArray = $this->connection->useFetchArray;
+    $this->_has_stupid_odbc_fetch_api_change = ADODB_PHPVER >= 0x4200;
+  }
+
+  function _seek($row)
+  {
+    return false;
+  }
+
+  // speed up SelectLimit() by switching to ADODB_FETCH_NUM as ADODB_FETCH_ASSOC is emulated
+  function &GetArrayLimit($nrows,$offset=-1)
+  {
+    if ($offset <= 0) {
+      $rs =& $this->GetArray($nrows);
+      return $rs;
+    }
+    $savem = $this->fetchMode;
+    $this->fetchMode = ADODB_FETCH_NUM;
+    $this->Move($offset);
+    $this->fetchMode = $savem;
+
+    if ($this->fetchMode & ADODB_FETCH_ASSOC) {
+      $this->fields =& $this->GetRowAssoc(ADODB_ASSOC_CASE);
+    }
+
+    $results = array();
+    $cnt = 0;
+    while (!$this->EOF && $nrows != $cnt) {
+      $results[$cnt++] = $this->fields;
+      $this->MoveNext();
+    }
+
+    return $results;
+  }
+
+
+  function MoveNext()
+  {
+    if ($this->_numOfRows != 0 && !$this->EOF) {
+      $this->_currentRow++;
+
+      if ($this->_has_stupid_odbc_fetch_api_change)
+        $rez = @ads_fetch_into($this->_queryID,$this->fields);
+      else {
+        $row = 0;
+        $rez = @ads_fetch_into($this->_queryID,$row,$this->fields);
+      }
+      if ($rez) {
+        if ($this->fetchMode & ADODB_FETCH_ASSOC) {
+          $this->fields =& $this->GetRowAssoc(ADODB_ASSOC_CASE);
+        }
+        return true;
+      }
+    }
+    $this->fields = false;
+    $this->EOF = true;
+    return false;
+  }
+
+  function _fetch()
+  {
+
+    if ($this->_has_stupid_odbc_fetch_api_change)
+      $rez = @ads_fetch_into($this->_queryID,$this->fields);
+    else {
+      $row = 0;
+      $rez = @ads_fetch_into($this->_queryID,$row,$this->fields);
+    }
+    if ($rez) {
+      if ($this->fetchMode & ADODB_FETCH_ASSOC) {
+        $this->fields =& $this->GetRowAssoc(ADODB_ASSOC_CASE);
+      }
+      return true;
+    }
+    $this->fields = false;
+    return false;
+  }
+
+  function _close()
+  {
+    return @ads_free_result($this->_queryID);
+  }
+
+}
+?>
\ No newline at end of file
diff --git a/third_party/adodb/drivers/adodb-borland_ibase.inc.php b/third_party/adodb/drivers/adodb-borland_ibase.inc.php
index 040834e..301fd19 100644
--- a/third_party/adodb/drivers/adodb-borland_ibase.inc.php
+++ b/third_party/adodb/drivers/adodb-borland_ibase.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/drivers/adodb-csv.inc.php b/third_party/adodb/drivers/adodb-csv.inc.php
index f699c04..fd52b60 100644
--- a/third_party/adodb/drivers/adodb-csv.inc.php
+++ b/third_party/adodb/drivers/adodb-csv.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -72,7 +72,7 @@ class ADODB_csv extends ADOConnection {
 		return true;
 	}
 	
- 	function MetaColumns($table) 
+ 	function MetaColumns($table, $normalize=true) 
 	{
 		return false;
 	}
diff --git a/third_party/adodb/drivers/adodb-db2.inc.php b/third_party/adodb/drivers/adodb-db2.inc.php
index e99c71e..5bd9ebe 100644
--- a/third_party/adodb/drivers/adodb-db2.inc.php
+++ b/third_party/adodb/drivers/adodb-db2.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-  V5.04a 25 Mar 2008   (c) 2006 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.06 16 Oct 2008   (c) 2006 John Lim (jlim#natsoft.com). All rights reserved.
 
   This is a version of the ADODB driver for DB2.  It uses the 'ibm_db2' PECL extension
   for PHP (http://pecl.php.net/package/ibm_db2), which in turn requires DB2 V8.2.2 or
@@ -24,6 +24,9 @@ if (!defined('ADODB_DIR')) die();
 --------------------------------------------------------------------------------------*/
 
 
+
+
+
 class ADODB_db2 extends ADOConnection {
 	var $databaseType = "db2";	
 	var $fmtDate = "'Y-m-d'";
@@ -33,7 +36,7 @@ class ADODB_db2 extends ADOConnection {
 	var $sysDate = 'CURRENT DATE';
 	var $sysTimeStamp = 'CURRENT TIMESTAMP';
 	
-	var $fmtTimeStamp = "'Y-m-d-H:i:s'";
+	var $fmtTimeStamp = "'Y-m-d H:i:s'";
 	var $replaceQuote = "''"; // string to use to replace quotes
 	var $dataProvider = "db2";
 	var $hasAffectedRows = true;
@@ -44,7 +47,7 @@ class ADODB_db2 extends ADOConnection {
 								// breaking backward-compat
 	var $_bindInputArray = false;	
 	var $_genIDSQL = "VALUES NEXTVAL FOR %s";
-	var $_genSeqSQL = "CREATE SEQUENCE %s START WITH 1 NO MAXVALUE NO CYCLE";
+	var $_genSeqSQL = "CREATE SEQUENCE %s START WITH %s NO MAXVALUE NO CYCLE";
 	var $_dropSeqSQL = "DROP SEQUENCE %s";
 	var $_autocommit = true;
 	var $_haserrorfunctions = true;
@@ -52,6 +55,7 @@ class ADODB_db2 extends ADOConnection {
 	var $uCaseTables = true; // for meta* functions, uppercase table names
 	var $hasInsertID = true;
 	
+	
     function _insertid()
     {
         return ADOConnection::GetOne('VALUES IDENTITY_VAL_LOCAL()');
@@ -68,17 +72,21 @@ class ADODB_db2 extends ADOConnection {
 		global $php_errormsg;
 		
 		if (!function_exists('db2_connect')) {
-			ADOConnection::outp("Warning: The old ODBC based DB2 driver has been renamed 'odbc_db2'. This ADOdb driver calls PHP's native db2 extension.");
+			ADOConnection::outp("Warning: The old ODBC based DB2 driver has been renamed 'odbc_db2'. This ADOdb driver calls PHP's native db2 extension which is not installed.");
 			return null;
 		}
 		// This needs to be set before the connect().
 		// Replaces the odbc_binmode() call that was in Execute()
 		ini_set('ibm_db2.binmode', $this->binmode);
 
-		if ($argDatabasename) {
-			$this->_connectionID = db2_connect($argDatabasename,$argUsername,$argPassword);
+		if ($argDatabasename && empty($argDSN)) {
+		
+			if (stripos($argDatabasename,'UID=') && stripos($argDatabasename,'PWD=')) $this->_connectionID = db2_connect($argDatabasename,null,null);
+			else $this->_connectionID = db2_connect($argDatabasename,$argUsername,$argPassword);
 		} else {
-			$this->_connectionID = db2_connect($argDSN,$argUsername,$argPassword);
+			if ($argDatabasename) $schema = $argDatabasename;
+			if (stripos($argDSN,'UID=') && stripos($argDSN,'PWD=')) $this->_connectionID = db2_connect($argDSN,null,null);
+			else $this->_connectionID = db2_connect($argDSN,$argUsername,$argPassword);
 		}
 		if (isset($php_errormsg)) $php_errormsg = '';
 
@@ -86,9 +94,9 @@ class ADODB_db2 extends ADOConnection {
 		// an array of valid options.  So far, we don't use them.
 
 		$this->_errorMsg = @db2_conn_errormsg();
- 
 		if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
 		
+		if ($this->_connectionID && isset($schema)) $this->Execute("SET SCHEMA=$schema");
 		return $this->_connectionID != false;
 	}
 	
@@ -106,10 +114,14 @@ class ADODB_db2 extends ADOConnection {
 		if (isset($php_errormsg)) $php_errormsg = '';
 		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
 		
-		if ($argDatabasename) {
-			$this->_connectionID = db2_pconnect($argDatabasename,$argUsername,$argPassword);
+		if ($argDatabasename && empty($argDSN)) {
+		
+			if (stripos($argDatabasename,'UID=') && stripos($argDatabasename,'PWD=')) $this->_connectionID = db2_pconnect($argDatabasename,null,null);
+			else $this->_connectionID = db2_pconnect($argDatabasename,$argUsername,$argPassword);
 		} else {
-			$this->_connectionID = db2_pconnect($argDSN,$argUsername,$argPassword);
+			if ($argDatabasename) $schema = $argDatabasename;
+			if (stripos($argDSN,'UID=') && stripos($argDSN,'PWD=')) $this->_connectionID = db2_pconnect($argDSN,null,null);
+			else $this->_connectionID = db2_pconnect($argDSN,$argUsername,$argPassword);
 		}
 		if (isset($php_errormsg)) $php_errormsg = '';
 
@@ -117,6 +129,7 @@ class ADODB_db2 extends ADOConnection {
 		if ($this->_connectionID && $this->autoRollback) @db2_rollback($this->_connectionID);
 		if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
 		
+		if ($this->_connectionID && isset($schema)) $this->Execute("SET SCHEMA=$schema");
 		return $this->_connectionID != false;
 	}
 
@@ -223,12 +236,11 @@ class ADODB_db2 extends ADOConnection {
 			return ADOConnection::ServerInfo();
 		}
 	}
-
 	
 	function CreateSequence($seqname='adodbseq',$start=1)
 	{
 		if (empty($this->_genSeqSQL)) return false;
-		$ok = $this->Execute(sprintf($this->_genSeqSQL,$seqname));
+		$ok = $this->Execute(sprintf($this->_genSeqSQL,$seqname,$start));
 		if (!$ok) return false;
 		return true;
 	}
@@ -239,6 +251,25 @@ class ADODB_db2 extends ADOConnection {
 		return $this->Execute(sprintf($this->_dropSeqSQL,$seqname));
 	}
 	
+	function SelectLimit($sql,$nrows=-1,$offset=-1,$inputArr=false)
+	{
+		$nrows = (integer) $nrows;
+		if ($offset <= 0) {
+		// could also use " OPTIMIZE FOR $nrows ROWS "
+			if ($nrows >= 0) $sql .=  " FETCH FIRST $nrows ROWS ONLY ";
+			$rs = $this->Execute($sql,$inputArr);
+		} else {
+			if ($offset > 0 && $nrows < 0);
+			else {
+				$nrows += $offset;
+				$sql .=  " FETCH FIRST $nrows ROWS ONLY ";
+			}
+			$rs = ADOConnection::SelectLimit($sql,-1,$offset,$inputArr);
+		}
+		
+		return $rs;
+	}
+	
 	/*
 		This algorithm is not very efficient, but works even if table locking
 		is not available.
@@ -249,9 +280,9 @@ class ADODB_db2 extends ADOConnection {
 	{	
 		// if you have to modify the parameter below, your database is overloaded,
 		// or you need to implement generation of id's yourself!
-		$num = $this->GetOne("VALUES NEXTVAL FOR $seq");
+				$num = $this->GetOne("VALUES NEXTVAL FOR $seq");
 				return $num;
-			}
+	}
 
 
 	function ErrorMsg()
@@ -407,7 +438,6 @@ class ADODB_db2 extends ADOConnection {
 		}
 		
 		$arr = $rs->GetArray();
-		
 		$rs->Close();
 		$arr2 = array();
 		
@@ -417,12 +447,13 @@ class ADODB_db2 extends ADOConnection {
 		for ($i=0; $i < sizeof($arr); $i++) {
 			if (!$arr[$i][2]) continue;
 			$type = $arr[$i][3];
+			$owner = $arr[$i][1];
 			$schemaval = ($schema) ? $arr[$i][1].'.' : '';
 			if ($ttype) { 
 				if ($isview) {
 					if (strncmp($type,'V',1) === 0) $arr2[] = $schemaval.$arr[$i][2];
-				} else if (strncmp($type,'SYS',3) !== 0) $arr2[] = $schemaval.$arr[$i][2];
-			} else if (strncmp($type,'SYS',3) !== 0) $arr2[] = $schemaval.$arr[$i][2];
+				} else if (strncmp($owner,'SYS',3) !== 0) $arr2[] = $schemaval.$arr[$i][2];
+			} else if (strncmp($owner,'SYS',3) !== 0) $arr2[] = $schemaval.$arr[$i][2];
 		}
 		return $arr2;
 	}
@@ -495,7 +526,7 @@ See http://msdn.microsoft.com/library/default.asp?url=/library/en-us/db2/htm/db2
 		}
 	}
 	
-	function MetaColumns($table)
+	function MetaColumns($table, $normalize=true)
 	{
 	global $ADODB_FETCH_MODE;
 	
@@ -591,6 +622,7 @@ See http://msdn.microsoft.com/library/default.asp?url=/library/en-us/db2/htm/db2
 		return $retarr;
 	}
 	
+		
 	function Prepare($sql)
 	{
 		if (! $this->_bindInputArray) return $sql; // no binding
diff --git a/third_party/adodb/drivers/adodb-db2oci.inc.php b/third_party/adodb/drivers/adodb-db2oci.inc.php
new file mode 100644
index 0000000..32f2132
--- /dev/null
+++ b/third_party/adodb/drivers/adodb-db2oci.inc.php
@@ -0,0 +1,230 @@
+<?php
+/* 
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence. 
+Set tabs to 4 for best viewing.
+  
+  Latest version is available at http://adodb.sourceforge.net
+  
+  Microsoft Visual FoxPro data driver. Requires ODBC. Works only on MS Windows.
+*/
+
+// security - hide paths
+if (!defined('ADODB_DIR')) die();
+include(ADODB_DIR."/drivers/adodb-db2.inc.php");
+
+
+if (!defined('ADODB_DB2OCI')){
+define('ADODB_DB2OCI',1);
+
+/*
+// regex code for smart remapping of :0, :1 bind vars to ? ?
+function _colontrack($p)
+{
+global $_COLONARR,$_COLONSZ;
+	$v = (integer) substr($p,1);
+	if ($v > $_COLONSZ) return $p;
+	$_COLONARR[] = $v;
+	return '?';
+}
+
+// smart remapping of :0, :1 bind vars to ? ?
+function _colonscope($sql,$arr)
+{
+global $_COLONARR,$_COLONSZ;
+
+	$_COLONARR = array();
+	$_COLONSZ = sizeof($arr);
+	
+	$sql2 = preg_replace("/(:[0-9]+)/e","_colontrack('\\1')",$sql);
+	
+	if (empty($_COLONARR)) return array($sql,$arr);
+	
+	foreach($_COLONARR as $k => $v) {
+		$arr2[] = $arr[$v]; 
+	}
+	
+	return array($sql2,$arr2);
+}
+*/
+
+/*
+	Smart remapping of :0, :1 bind vars to ? ?
+	
+	Handles colons in comments -- and / * * / and in quoted strings.
+*/
+
+function _colonparser($sql,$arr)
+{
+	$lensql = strlen($sql);
+	$arrsize = sizeof($arr);
+	$state = 'NORM';
+	$at = 1;
+	$ch = $sql[0]; 
+	$ch2 = @$sql[1];
+	$sql2 = '';
+	$arr2 = array();
+	$nprev = 0;
+	
+	
+	while (strlen($ch)) {
+	
+		switch($ch) {
+		case '/':
+			if ($state == 'NORM' && $ch2 == '*') {
+				$state = 'COMMENT';
+				
+				$at += 1;
+				$ch = $ch2;
+				$ch2 = $at < $lensql ? $sql[$at] : '';
+			}
+			break;
+			
+		case '*':
+			if ($state == 'COMMENT' && $ch2 == '/') {
+				$state = 'NORM';
+				
+				$at += 1;
+				$ch = $ch2;
+				$ch2 = $at < $lensql ? $sql[$at] : '';
+			}
+			break;
+		
+		case "\n":
+		case "\r":
+			if ($state == 'COMMENT2') $state = 'NORM';
+			break;
+		
+		case "'":
+			do {
+				$at += 1;
+				$ch = $ch2;
+				$ch2 = $at < $lensql ? $sql[$at] : '';
+			} while ($ch !== "'");
+			break;
+			
+		case ':':
+			if ($state == 'COMMENT' || $state == 'COMMENT2') break;
+			
+			//echo "$at=$ch $ch2, ";
+			if ('0' <= $ch2 && $ch2 <= '9') {
+				$n = '';
+				$nat = $at;
+				do {
+					$at += 1;
+					$ch = $ch2;
+					$n .= $ch;
+					$ch2 = $at < $lensql ? $sql[$at] : '';
+				} while ('0' <= $ch && $ch <= '9');
+				#echo "$n $arrsize ] ";
+				$n = (integer) $n;
+				if ($n < $arrsize) {
+					$sql2 .= substr($sql,$nprev,$nat-$nprev-1).'?';
+					$nprev = $at-1;
+					$arr2[] = $arr[$n];
+				}
+			}
+			break;
+			
+		case '-':
+			if ($state == 'NORM') {
+				if ($ch2 == '-') $state = 'COMMENT2';
+				$at += 1;
+				$ch = $ch2;
+				$ch2 = $at < $lensql ? $sql[$at] : '';
+			}
+			break;
+		}
+		
+		$at += 1;
+		$ch = $ch2;
+		$ch2 = $at < $lensql ? $sql[$at] : '';
+	}
+	
+	if ($nprev == 0) {
+		$sql2 = $sql;
+	} else {
+		$sql2 .= substr($sql,$nprev);
+	}
+	
+	return array($sql2,$arr2);
+}
+
+class ADODB_db2oci extends ADODB_db2 {
+	var $databaseType = "db2oci";	
+	var $sysTimeStamp = 'sysdate';
+	var $sysDate = 'trunc(sysdate)';
+	var $_bindInputArray = true;
+	
+	function ADODB_db2oci()
+	{
+		parent::ADODB_db2();
+	}
+	
+	function Param($name,$type=false)
+	{
+		return ':'.$name;
+	}
+	
+	
+	function MetaTables($ttype=false,$schema=false)
+	{
+	global $ADODB_FETCH_MODE;
+	
+		$savem = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		$qid = db2_tables($this->_connectionID);
+		
+		$rs = new ADORecordSet_db2($qid);
+		
+		$ADODB_FETCH_MODE = $savem;
+		if (!$rs) {
+			$false = false;
+			return $false;
+		}
+		
+		$arr = $rs->GetArray();
+		$rs->Close();
+		$arr2 = array();
+	//	adodb_pr($arr);
+		if ($ttype) {
+			$isview = strncmp($ttype,'V',1) === 0;
+		}
+		for ($i=0; $i < sizeof($arr); $i++) {
+			if (!$arr[$i][2]) continue;
+			$type = $arr[$i][3];
+			$schemaval = ($schema) ? $arr[$i][1].'.' : '';
+			$name = $schemaval.$arr[$i][2];
+			$owner = $arr[$i][1];
+			if (substr($name,0,8) == 'EXPLAIN_') continue;
+			if ($ttype) { 
+				if ($isview) {
+					if (strncmp($type,'V',1) === 0) $arr2[] = $name;
+				} else if (strncmp($type,'T',1) === 0 && strncmp($owner,'SYS',3) !== 0) $arr2[] = $name;
+			} else if (strncmp($type,'T',1) === 0 && strncmp($owner,'SYS',3) !== 0) $arr2[] = $name;
+		}
+		return $arr2;
+	}
+	
+	function _Execute($sql, $inputarr=false	)
+	{
+		if ($inputarr) list($sql,$inputarr) = _colonparser($sql, $inputarr);
+		return parent::_Execute($sql, $inputarr);
+	}
+};
+ 
+
+class  ADORecordSet_db2oci extends ADORecordSet_db2 {	
+	
+	var $databaseType = "db2oci";		
+	
+	function ADORecordSet_db2oci($id,$mode=false)
+	{
+		return $this->ADORecordSet_db2($id,$mode);
+	}
+}
+
+} //define
+?>
\ No newline at end of file
diff --git a/third_party/adodb/drivers/adodb-fbsql.inc.php b/third_party/adodb/drivers/adodb-fbsql.inc.php
index 3c8a15a..13bbd86 100644
--- a/third_party/adodb/drivers/adodb-fbsql.inc.php
+++ b/third_party/adodb/drivers/adodb-fbsql.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
- @version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ @version V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -80,7 +80,7 @@ class ADODB_fbsql extends ADOConnection {
 		return true;	
 	}
 	
- 	function MetaColumns($table) 
+ 	function MetaColumns($table, $normalize=true) 
 	{
 		if ($this->metaColumnsSQL) {
 			
@@ -127,7 +127,7 @@ class ADODB_fbsql extends ADOConnection {
 	
 	
 	// returns queryID or false
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		return fbsql_query("$sql;",$this->_connectionID);
 	}
diff --git a/third_party/adodb/drivers/adodb-firebird.inc.php b/third_party/adodb/drivers/adodb-firebird.inc.php
index 41b1d7b..d234a62 100644
--- a/third_party/adodb/drivers/adodb-firebird.inc.php
+++ b/third_party/adodb/drivers/adodb-firebird.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/drivers/adodb-ibase.inc.php b/third_party/adodb/drivers/adodb-ibase.inc.php
index 05bbead..0dc5c7a 100644
--- a/third_party/adodb/drivers/adodb-ibase.inc.php
+++ b/third_party/adodb/drivers/adodb-ibase.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.  
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.  
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -242,7 +242,7 @@ class ADODB_ibase extends ADOConnection {
 
 	
 	// See http://community.borland.com/article/0,1410,25844,00.html
-	function RowLock($tables,$where,$col)
+	function RowLock($tables,$where,$col=false)
 	{
 		if ($this->autoCommit) $this->BeginTrans();
 		$this->Execute("UPDATE $table SET $col=$col WHERE $where "); // is this correct - jlim?
@@ -476,7 +476,7 @@ class ADODB_ibase extends ADOConnection {
 	}
 	//OPN STUFF end
 		// returns array of ADOFieldObjects for current table
-	function MetaColumns($table) 
+	function MetaColumns($table, $normalize=true) 
 	{
 	global $ADODB_FETCH_MODE;
 		
diff --git a/third_party/adodb/drivers/adodb-informix.inc.php b/third_party/adodb/drivers/adodb-informix.inc.php
index 964a2fc..1b2643b 100644
--- a/third_party/adodb/drivers/adodb-informix.inc.php
+++ b/third_party/adodb/drivers/adodb-informix.inc.php
@@ -1,6 +1,6 @@
 <?php
 /**
-* @version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+* @version V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
 * Released under both BSD license and Lesser GPL library license.
 * Whenever there is any discrepancy between the two licenses,
 * the BSD license will take precedence.
diff --git a/third_party/adodb/drivers/adodb-informix72.inc.php b/third_party/adodb/drivers/adodb-informix72.inc.php
index d36f9d1..dd49123 100644
--- a/third_party/adodb/drivers/adodb-informix72.inc.php
+++ b/third_party/adodb/drivers/adodb-informix72.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim. All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim. All rights reserved.
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
   the BSD license will take precedence.
@@ -123,10 +123,10 @@ class ADODB_informix72 extends ADOConnection {
 		return true;
 	}
 
-	function RowLock($tables,$where,$flds='1 as ignore')
+	function RowLock($tables,$where,$col='1 as ignore')
 	{
 		if ($this->_autocommit) $this->BeginTrans();
-		return $this->GetOne("select $flds from $tables where $where for update");
+		return $this->GetOne("select $col from $tables where $where for update");
 	}
 
 	/*	Returns: the last error message from previous database operation
@@ -147,7 +147,7 @@ class ADODB_informix72 extends ADOConnection {
 	}
 
    
-    function MetaColumns($table)
+    function MetaColumns($table, $normalize=true)
 	{
 	global $ADODB_FETCH_MODE;
 	
@@ -284,7 +284,7 @@ class ADODB_informix72 extends ADOConnection {
 	}
 */
 	// returns query ID if successful, otherwise false
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 	global $ADODB_COUNTRECS;
 	
@@ -369,7 +369,7 @@ class ADORecordset_informix72 extends ADORecordSet {
 			foreach($fp as $k => $v) {
 				$o = new ADOFieldObject;
 				$o->name = $k;
-				$arr = split(';',$v); //"SQLTYPE;length;precision;scale;ISNULLABLE"
+				$arr = explode(';',$v); //"SQLTYPE;length;precision;scale;ISNULLABLE"
 				$o->type = $arr[0];
 				$o->max_length = $arr[1];
 				$this->_fieldprops[] = $o;
diff --git a/third_party/adodb/drivers/adodb-ldap.inc.php b/third_party/adodb/drivers/adodb-ldap.inc.php
index 30156a2..d6ebb40 100644
--- a/third_party/adodb/drivers/adodb-ldap.inc.php
+++ b/third_party/adodb/drivers/adodb-ldap.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
    Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -55,13 +55,17 @@ class ADODB_ldap extends ADOConnection {
 		
 		if ( !function_exists( 'ldap_connect' ) ) return null;
 		
-		$conn_info = array( $host,$this->port);
+		if (strpos('ldap://',$host) === 0 || strpos('ldaps://',$host) === 0) {
+			$this->_connectionID = @ldap_connect($host);
+		} else {
+			$conn_info = array( $host,$this->port);
 		
-		if ( strstr( $host, ':' ) ) {
-		    $conn_info = split( ':', $host );
-		} 
+			if ( strstr( $host, ':' ) ) {
+			    $conn_info = explode( ':', $host );
+			} 
 		
-		$this->_connectionID = @ldap_connect( $conn_info[0], $conn_info[1] );
+			$this->_connectionID = @ldap_connect( $conn_info[0], $conn_info[1] );
+		}
 		if (!$this->_connectionID) {
 			$e = 'Could not connect to ' . $conn_info[0];
 			$this->_errorMsg = $e;
@@ -150,7 +154,7 @@ class ADODB_ldap extends ADOConnection {
 	}
 	
 	/* returns _queryID or false */
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		$rs = @ldap_search( $this->_connectionID, $this->database, $sql );
 		$this->_errorMsg = ($rs) ? '' : 'Search error on '.$sql.': '.ldap_error($this->_connectionID);
diff --git a/third_party/adodb/drivers/adodb-mssql.inc.php b/third_party/adodb/drivers/adodb-mssql.inc.php
index 2048f5f..21de19a 100644
--- a/third_party/adodb/drivers/adodb-mssql.inc.php
+++ b/third_party/adodb/drivers/adodb-mssql.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -103,6 +103,7 @@ class ADODB_mssql extends ADOConnection {
 	var $identitySQL = 'select SCOPE_IDENTITY()'; // 'select SCOPE_IDENTITY'; # for mssql 2000
 	var $uniqueOrderBy = true;
 	var $_bindInputArray = true;
+	var $forceNewConnect = false;
 	
 	function ADODB_mssql() 
 	{		
@@ -152,8 +153,47 @@ class ADODB_mssql extends ADOConnection {
 	// the same scope. A scope is a module -- a stored procedure, trigger, 
 	// function, or batch. Thus, two statements are in the same scope if 
 	// they are in the same stored procedure, function, or batch.
+        if ($this->lastInsID !== false) {
+            return $this->lastInsID; // InsID from sp_executesql call
+        } else {
 			return $this->GetOne($this->identitySQL);
+		}
+	}
+
+
+
+	/**
+	* Correctly quotes a string so that all strings are escaped. We prefix and append
+	* to the string single-quotes.
+	* An example is  $db->qstr("Don't bother",magic_quotes_runtime());
+	* 
+	* @param s         the string to quote
+	* @param [magic_quotes]    if $s is GET/POST var, set to get_magic_quotes_gpc().
+	*              This undoes the stupidity of magic quotes for GPC.
+	*
+	* @return  quoted string to be sent back to database
+	*/
+	function qstr($s,$magic_quotes=false)
+	{
+ 		if (!$magic_quotes) {
+ 			return  "'".str_replace("'",$this->replaceQuote,$s)."'";
+		}
+
+ 		// undo magic quotes for " unless sybase is on
+ 		$sybase = ini_get('magic_quotes_sybase');
+ 		if (!$sybase) {
+ 			$s = str_replace('\\"','"',$s);
+ 			if ($this->replaceQuote == "\\'")  // ' already quoted, no need to change anything
+ 				return "'$s'";
+ 			else {// change \' to '' for sybase/mssql
+ 				$s = str_replace('\\\\','\\',$s);
+ 				return "'".str_replace("\\'",$this->replaceQuote,$s)."'";
+ 			}
+ 		} else {
+ 			return "'".$s."'";
+		}
 	}
+// moodle change end - see readme_moodle.txt
 
 	function _affectedrows()
 	{
@@ -206,7 +246,11 @@ class ADODB_mssql extends ADOConnection {
 		if ($nrows > 0 && $offset <= 0) {
 			$sql = preg_replace(
 				'/(^\s*select\s+(distinctrow|distinct)?)/i','\\1 '.$this->hasTop." $nrows ",$sql);
-			$rs = $this->Execute($sql,$inputarr);
+				
+			if ($secs2cache)
+				$rs = $this->CacheExecute($secs2cache, $sql, $inputarr);
+			else
+				$rs = $this->Execute($sql,$inputarr);
 		} else
 			$rs = ADOConnection::SelectLimit($sql,$nrows,$offset,$inputarr,$secs2cache);
 	
@@ -279,8 +323,8 @@ class ADODB_mssql extends ADOConnection {
 	{
 		if ($this->transOff) return true; 
 		$this->transCnt += 1;
-	   	$this->Execute('BEGIN TRAN');
-	   	return true;
+	   	$ok = $this->Execute('BEGIN TRAN');
+	   	return $ok;
 	}
 		
 	function CommitTrans($ok=true) 
@@ -288,15 +332,15 @@ class ADODB_mssql extends ADOConnection {
 		if ($this->transOff) return true; 
 		if (!$ok) return $this->RollbackTrans();
 		if ($this->transCnt) $this->transCnt -= 1;
-		$this->Execute('COMMIT TRAN');
-		return true;
+		$ok = $this->Execute('COMMIT TRAN');
+		return $ok;
 	}
 	function RollbackTrans()
 	{
 		if ($this->transOff) return true; 
 		if ($this->transCnt) $this->transCnt -= 1;
-		$this->Execute('ROLLBACK TRAN');
-		return true;
+		$ok = $this->Execute('ROLLBACK TRAN');
+		return $ok;
 	}
 	
 	function SetTransactionMode( $transaction_mode ) 
@@ -322,14 +366,14 @@ class ADODB_mssql extends ADOConnection {
 		
 		See http://www.swynk.com/friends/achigrik/SQL70Locks.asp
 	*/
-	function RowLock($tables,$where,$flds='top 1 null as ignore') 
+	function RowLock($tables,$where,$col='top 1 null as ignore') 
 	{
 		if (!$this->transCnt) $this->BeginTrans();
-		return $this->GetOne("select $flds from $tables with (ROWLOCK,HOLDLOCK) where $where");
+		return $this->GetOne("select $col from $tables with (ROWLOCK,HOLDLOCK) where $where");
 	}
 	
 	
-	function MetaIndexes($table,$primary=false)
+	function MetaIndexes($table,$primary=false, $owner=false)
 	{
 		$table = $this->qstr($table);
 
@@ -361,7 +405,7 @@ class ADODB_mssql extends ADOConnection {
 
 		$indexes = array();
 		while ($row = $rs->FetchRow()) {
-			if (!$primary && $row[5]) continue;
+			if ($primary && !$row[5]) continue;
 			
             $indexes[$row[0]]['unique'] = $row[6];
             $indexes[$row[0]]['columns'][] = $row[1];
@@ -504,11 +548,11 @@ order by constraint_name, referenced_table_name, keyno";
 	   else return -1;
 	}
 	
-	// returns true or false
-	function _connect($argHostname, $argUsername, $argPassword, $argDatabasename)
+	// returns true or false, newconnect supported since php 5.1.0.
+	function _connect($argHostname, $argUsername, $argPassword, $argDatabasename,$newconnect=false)
 	{
 		if (!function_exists('mssql_pconnect')) return null;
-		$this->_connectionID = mssql_connect($argHostname,$argUsername,$argPassword);
+		$this->_connectionID = mssql_connect($argHostname,$argUsername,$argPassword,$newconnect);
 		if ($this->_connectionID === false) return false;
 		if ($argDatabasename) return $this->SelectDB($argDatabasename);
 		return true;	
@@ -531,6 +575,11 @@ order by constraint_name, referenced_table_name, keyno";
 		return true;	
 	}
 	
+	function _nconnect($argHostname, $argUsername, $argPassword, $argDatabasename)
+    {
+		return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename, true);
+    }
+
 	function Prepare($sql)
 	{
 		$sqlarr = explode('?',$sql);
@@ -539,7 +588,7 @@ order by constraint_name, referenced_table_name, keyno";
 		for ($i = 1, $max = sizeof($sqlarr); $i < $max; $i++) {
 			$sql2 .=  '@P'.($i-1) . $sqlarr[$i];
 		} 
-		return array($sql,$this->qstr($sql2),$max);
+		return array($sql,$this->qstr($sql2),$max,$sql2);
 	}
 	
 	function PrepareSP($sql)
@@ -655,7 +704,7 @@ order by constraint_name, referenced_table_name, keyno";
 	}
 	
 	// returns query ID if successful, otherwise false
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		$this->_errorMsg = false;
 		if (is_array($inputarr)) {
@@ -663,6 +712,11 @@ order by constraint_name, referenced_table_name, keyno";
 			# bind input params with sp_executesql: 
 			# see http://www.quest-pipelines.com/newsletter-v3/0402_F.htm
 			# works only with sql server 7 and newer
+            $getIdentity = false;
+            if (!is_array($sql) && preg_match('/^\\s*insert/i', $sql)) {
+                $getIdentity = true;
+                $sql .= (preg_match('/;\\s*$/i', $sql) ? ' ' : '; ') . $this->identitySQL;
+            }
 			if (!is_array($sql)) $sql = $this->Prepare($sql);
 			$params = '';
 			$decl = '';
@@ -702,13 +756,20 @@ order by constraint_name, referenced_table_name, keyno";
 			$decl = $this->qstr($decl);
 			if ($this->debug) ADOConnection::outp("<font size=-1>sp_executesql N{$sql[1]},N$decl,$params</font>");
 			$rez = mssql_query("sp_executesql N{$sql[1]},N$decl,$params", $this->_connectionID);
+            if ($getIdentity) {
+                $arr = @mssql_fetch_row($rez);
+                $this->lastInsID = isset($arr[0]) ? $arr[0] : false;
+                @mssql_data_seek($rez, 0);
+            }
 			
 		} else if (is_array($sql)) {
 			# PrepareSP()
 			$rez = mssql_execute($sql[1]);
+            $this->lastInsID = false;
 			
 		} else {
 			$rez = mssql_query($sql,$this->_connectionID);
+            $this->lastInsID = false;
 		}
 		return $rez;
 	}
diff --git a/third_party/adodb/drivers/adodb-mssql_n.inc.php b/third_party/adodb/drivers/adodb-mssql_n.inc.php
index 3808298..199b100 100644
--- a/third_party/adodb/drivers/adodb-mssql_n.inc.php
+++ b/third_party/adodb/drivers/adodb-mssql_n.inc.php
@@ -9,7 +9,7 @@
 // ADOdb  - Database Abstraction Library for PHP                         //
 //          http://adodb.sourceforge.net/                                //
 //                                                                       //
-// Copyright (C) 2000-2008 John Lim (jlim\@natsoft.com.my)               //
+// Copyright (C) 2000-2009 John Lim (jlim\@natsoft.com.my)               //
 //          All rights reserved.                                         //
 //          Released under both BSD license and LGPL library license.    //
 //          Whenever there is any discrepancy between the two licenses,  //
@@ -58,7 +58,7 @@ class ADODB_mssql_n extends ADODB_mssql {
 		ADODB_mssql::ADODB_mssql();
 	}
 
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
         $sql = $this->_appendN($sql);
 		return ADODB_mssql::_query($sql,$inputarr);
diff --git a/third_party/adodb/drivers/adodb-mssqlnative.inc.php b/third_party/adodb/drivers/adodb-mssqlnative.inc.php
new file mode 100644
index 0000000..920d947
--- /dev/null
+++ b/third_party/adodb/drivers/adodb-mssqlnative.inc.php
@@ -0,0 +1,922 @@
+<?php
+/* 
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence. 
+Set tabs to 4 for best viewing.
+  
+  Latest version is available at http://adodb.sourceforge.net
+  
+  Native mssql driver. Requires mssql client. Works on Windows. 
+    http://www.microsoft.com/sql/technologies/php/default.mspx
+  To configure for Unix, see 
+   	http://phpbuilder.com/columns/alberto20000919.php3
+
+    $stream = sqlsrv_get_field($stmt, $index, SQLSRV_SQLTYPE_STREAM(SQLSRV_ENC_BINARY));
+    stream_filter_append($stream, "convert.iconv.ucs-2/utf-8"); // Voila, UTF-8 can be read directly from $stream
+
+*/
+
+// security - hide paths
+if (!defined('ADODB_DIR')) die();
+
+if (!function_exists('sqlsrv_configure')) {
+	die("mssqlnative extension not installed");
+}
+
+if (!function_exists('sqlsrv_set_error_handling')) {
+	function sqlsrv_set_error_handling($constant) {
+		sqlsrv_configure("WarningsReturnAsErrors", $constant);
+	}
+}
+if (!function_exists('sqlsrv_log_set_severity')) {
+	function sqlsrv_log_set_severity($constant) {
+		sqlsrv_configure("LogSeverity", $constant);
+	}
+}
+if (!function_exists('sqlsrv_log_set_subsystems')) {
+	function sqlsrv_log_set_subsystems($constant) {
+		sqlsrv_configure("LogSubsystems", $constant);
+	}
+}
+
+
+//----------------------------------------------------------------
+// MSSQL returns dates with the format Oct 13 2002 or 13 Oct 2002
+// and this causes tons of problems because localized versions of 
+// MSSQL will return the dates in dmy or  mdy order; and also the 
+// month strings depends on what language has been configured. The 
+// following two variables allow you to control the localization
+// settings - Ugh.
+//
+// MORE LOCALIZATION INFO
+// ----------------------
+// To configure datetime, look for and modify sqlcommn.loc, 
+//  	typically found in c:\mssql\install
+// Also read :
+//	 http://support.microsoft.com/default.aspx?scid=kb;EN-US;q220918
+// Alternatively use:
+// 	   CONVERT(char(12),datecol,120)
+//
+// Also if your month is showing as month-1, 
+//   e.g. Jan 13, 2002 is showing as 13/0/2002, then see
+//     http://phplens.com/lens/lensforum/msgs.php?id=7048&x=1
+//   it's a localisation problem.
+//----------------------------------------------------------------
+
+
+// has datetime converstion to YYYY-MM-DD format, and also mssql_fetch_assoc
+if (ADODB_PHPVER >= 0x4300) {
+// docs say 4.2.0, but testing shows only since 4.3.0 does it work!
+	ini_set('mssql.datetimeconvert',0); 
+} else {
+    global $ADODB_mssql_mths;		// array, months must be upper-case
+	$ADODB_mssql_date_order = 'mdy'; 
+	$ADODB_mssql_mths = array(
+		'JAN'=>1,'FEB'=>2,'MAR'=>3,'APR'=>4,'MAY'=>5,'JUN'=>6,
+		'JUL'=>7,'AUG'=>8,'SEP'=>9,'OCT'=>10,'NOV'=>11,'DEC'=>12);
+}
+
+//---------------------------------------------------------------------------
+// Call this to autoset $ADODB_mssql_date_order at the beginning of your code,
+// just after you connect to the database. Supports mdy and dmy only.
+// Not required for PHP 4.2.0 and above.
+function AutoDetect_MSSQL_Date_Order($conn)
+{
+    global $ADODB_mssql_date_order;
+	$adate = $conn->GetOne('select getdate()');
+	if ($adate) {
+		$anum = (int) $adate;
+		if ($anum > 0) {
+			if ($anum > 31) {
+				//ADOConnection::outp( "MSSQL: YYYY-MM-DD date format not supported currently");
+			} else
+				$ADODB_mssql_date_order = 'dmy';
+		} else
+			$ADODB_mssql_date_order = 'mdy';
+	}
+}
+
+class ADODB_mssqlnative extends ADOConnection {
+	var $databaseType = "mssqlnative";	
+	var $dataProvider = "mssqlnative";
+	var $replaceQuote = "''"; // string to use to replace quotes
+	var $fmtDate = "'Y-m-d'";
+	var $fmtTimeStamp = "'Y-m-d H:i:s'";
+	var $hasInsertID = true;
+	var $substr = "substring";
+	var $length = 'len';
+	var $hasAffectedRows = true;
+	var $poorAffectedRows = false;
+	var $metaDatabasesSQL = "select name from sys.sysdatabases where name <> 'master'";
+	var $metaTablesSQL="select name,case when type='U' then 'T' else 'V' end from sysobjects where (type='U' or type='V') and (name not in ('sysallocations','syscolumns','syscomments','sysdepends','sysfilegroups','sysfiles','sysfiles1','sysforeignkeys','sysfulltextcatalogs','sysindexes','sysindexkeys','sysmembers','sysobjects','syspermissions','sysprotects','sysreferences','systypes','sysusers','sysalternates','sysconstraints','syssegments','REFERENTIAL_CONSTRAINTS','CHECK_CONSTRAINTS','CONSTRAINT_TABLE_USAGE','CONSTRAINT_COLUMN_USAGE','VIEWS','VIEW_TABLE_USAGE','VIEW_COLUMN_USAGE','SCHEMATA','TABLES','TABLE_CONSTRAINTS','TABLE_PRIVILEGES','COLUMNS','COLUMN_DOMAIN_USAGE','COLUMN_PRIVILEGES','DOMAINS','DOMAIN_CONSTRAINTS','KEY_COLUMN_USAGE','dtproperties'))";
+	var $metaColumnsSQL = # xtype==61 is datetime
+        "select c.name,t.name,c.length,
+	    (case when c.xusertype=61 then 0 else c.xprec end),
+	    (case when c.xusertype=61 then 0 else c.xscale end) 
+	    from syscolumns c join systypes t on t.xusertype=c.xusertype join sysobjects o on o.id=c.id where o.name='%s'";
+	var $hasTop = 'top';		// support mssql SELECT TOP 10 * FROM TABLE
+	var $hasGenID = true;
+	var $sysDate = 'convert(datetime,convert(char,GetDate(),102),102)';
+	var $sysTimeStamp = 'GetDate()';
+	var $maxParameterLen = 4000;
+	var $arrayClass = 'ADORecordSet_array_mssqlnative';
+	var $uniqueSort = true;
+	var $leftOuter = '*=';
+	var $rightOuter = '=*';
+	var $ansiOuter = true; // for mssql7 or later
+	var $identitySQL = 'select SCOPE_IDENTITY()'; // 'select SCOPE_IDENTITY'; # for mssql 2000
+	var $uniqueOrderBy = true;
+	var $_bindInputArray = true;
+	var $_dropSeqSQL = "drop table %s";
+	
+	function ADODB_mssqlnative() 
+	{		
+        if ($this->debug) {
+            error_log("<pre>");
+            sqlsrv_set_error_handling( SQLSRV_ERRORS_LOG_ALL );
+            sqlsrv_log_set_severity( SQLSRV_LOG_SEVERITY_ALL );
+            sqlsrv_log_set_subsystems(SQLSRV_LOG_SYSTEM_ALL);
+            sqlsrv_configure('warnings_return_as_errors', 0);
+        } else {
+            sqlsrv_set_error_handling(0);
+            sqlsrv_log_set_severity(0);
+            sqlsrv_log_set_subsystems(SQLSRV_LOG_SYSTEM_ALL);
+            sqlsrv_configure('warnings_return_as_errors', 0);
+        }
+	}
+
+	function ServerInfo()
+	{
+    	global $ADODB_FETCH_MODE;
+		if ($this->fetchMode === false) {
+			$savem = $ADODB_FETCH_MODE;
+			$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		} else 
+			$savem = $this->SetFetchMode(ADODB_FETCH_NUM);
+		$arrServerInfo = sqlsrv_server_info($this->_connectionID);
+		$arr['description'] = $arrServerInfo['SQLServerName'].' connected to '.$arrServerInfo['CurrentDatabase'];
+		$arr['version'] = $arrServerInfo['SQLServerVersion'];//ADOConnection::_findvers($arr['description']);
+		return $arr;
+	}
+	
+	function IfNull( $field, $ifNull ) 
+	{
+		return " ISNULL($field, $ifNull) "; // if MS SQL Server
+	}
+	
+	function _insertid()
+	{
+	// SCOPE_IDENTITY()
+	// Returns the last IDENTITY value inserted into an IDENTITY column in 
+	// the same scope. A scope is a module -- a stored procedure, trigger, 
+	// function, or batch. Thus, two statements are in the same scope if 
+	// they are in the same stored procedure, function, or batch.
+		return $this->GetOne($this->identitySQL);
+	}
+
+	function _affectedrows()
+	{
+        return sqlsrv_rows_affected($this->_queryID);
+	}
+	
+	function CreateSequence($seq='adodbseq',$start=1)
+	{
+		if($this->debug) error_log("<hr>CreateSequence($seq,$start)");
+        sqlsrv_begin_transaction($this->_connectionID);
+		$start -= 1;
+		$this->Execute("create table $seq (id int)");//was float(53)
+		$ok = $this->Execute("insert into $seq with (tablock,holdlock) values($start)");
+		if (!$ok) {
+            if($this->debug) error_log("<hr>Error: ROLLBACK");
+            sqlsrv_rollback($this->_connectionID);
+			return false;
+		}
+        sqlsrv_commit($this->_connectionID);
+		return true;
+	}
+
+	function GenID($seq='adodbseq',$start=1)
+	{
+        if($this->debug) error_log("<hr>GenID($seq,$start)");
+        sqlsrv_begin_transaction($this->_connectionID);
+		$ok = $this->Execute("update $seq with (tablock,holdlock) set id = id + 1");
+		if (!$ok) {
+			$this->Execute("create table $seq (id int)");
+			$ok = $this->Execute("insert into $seq with (tablock,holdlock) values($start)");
+			if (!$ok) {
+                if($this->debug) error_log("<hr>Error: ROLLBACK");
+                sqlsrv_rollback($this->_connectionID);
+				return false;
+			}
+			sqlsrv_commit($this->_connectionID);
+			return $start;
+		}
+		$num = $this->GetOne("select id from $seq");
+        sqlsrv_commit($this->_connectionID);
+        if($this->debug) error_log(" Returning: $num");
+		return $num;
+	}
+	
+	// Format date column in sql string given an input format that understands Y M D
+	function SQLDate($fmt, $col=false)
+	{	
+		if (!$col) $col = $this->sysTimeStamp;
+		$s = '';
+		
+		$len = strlen($fmt);
+		for ($i=0; $i < $len; $i++) {
+			if ($s) $s .= '+';
+			$ch = $fmt[$i];
+			switch($ch) {
+			case 'Y':
+			case 'y':
+				$s .= "datename(yyyy,$col)";
+				break;
+			case 'M':
+				$s .= "convert(char(3),$col,0)";
+				break;
+			case 'm':
+				$s .= "replace(str(month($col),2),' ','0')";
+				break;
+			case 'Q':
+			case 'q':
+				$s .= "datename(quarter,$col)";
+				break;
+			case 'D':
+			case 'd':
+				$s .= "replace(str(day($col),2),' ','0')";
+				break;
+			case 'h':
+				$s .= "substring(convert(char(14),$col,0),13,2)";
+				break;
+			
+			case 'H':
+				$s .= "replace(str(datepart(hh,$col),2),' ','0')";
+				break;
+				
+			case 'i':
+				$s .= "replace(str(datepart(mi,$col),2),' ','0')";
+				break;
+			case 's':
+				$s .= "replace(str(datepart(ss,$col),2),' ','0')";
+				break;
+			case 'a':
+			case 'A':
+				$s .= "substring(convert(char(19),$col,0),18,2)";
+				break;
+				
+			default:
+				if ($ch == '\\') {
+					$i++;
+					$ch = substr($fmt,$i,1);
+				}
+				$s .= $this->qstr($ch);
+				break;
+			}
+		}
+		return $s;
+	}
+
+	
+	function BeginTrans()
+	{
+		if ($this->transOff) return true; 
+		$this->transCnt += 1;
+        if ($this->debug) error_log('<hr>begin transaction');
+		sqlsrv_begin_transaction($this->_connectionID);
+	   	return true;
+	}
+		
+	function CommitTrans($ok=true) 
+	{ 
+		if ($this->transOff) return true; 
+        if ($this->debug) error_log('<hr>commit transaction');
+		if (!$ok) return $this->RollbackTrans();
+		if ($this->transCnt) $this->transCnt -= 1;
+		sqlsrv_commit($this->_connectionID);
+		return true;
+	}
+	function RollbackTrans()
+	{
+		if ($this->transOff) return true; 
+        if ($this->debug) error_log('<hr>rollback transaction');
+		if ($this->transCnt) $this->transCnt -= 1;
+		sqlsrv_rollback($this->_connectionID);
+		return true;
+	}
+	
+	function SetTransactionMode( $transaction_mode ) 
+	{
+		$this->_transmode  = $transaction_mode;
+		if (empty($transaction_mode)) {
+			$this->Execute('SET TRANSACTION ISOLATION LEVEL READ COMMITTED');
+			return;
+		}
+		if (!stristr($transaction_mode,'isolation')) $transaction_mode = 'ISOLATION LEVEL '.$transaction_mode;
+		$this->Execute("SET TRANSACTION ".$transaction_mode);
+	}
+	
+	/*
+		Usage:
+		
+		$this->BeginTrans();
+		$this->RowLock('table1,table2','table1.id=33 and table2.id=table1.id'); # lock row 33 for both tables
+		
+		# some operation on both tables table1 and table2
+		
+		$this->CommitTrans();
+		
+		See http://www.swynk.com/friends/achigrik/SQL70Locks.asp
+	*/
+	function RowLock($tables,$where,$col='top 1 null as ignore') 
+	{
+		if (!$this->transCnt) $this->BeginTrans();
+		return $this->GetOne("select $col from $tables with (ROWLOCK,HOLDLOCK) where $where");
+	}
+	 
+	function SelectDB($dbName) 
+	{
+		$this->database = $dbName;
+		$this->databaseName = $dbName; # obsolete, retained for compat with older adodb versions
+		if ($this->_connectionID) {
+            $rs = $this->Execute('USE '.$dbName); 
+            if($rs) {
+                return true;
+            } else return false;		
+		}
+		else return false;	
+	}
+	
+	function ErrorMsg() 
+	{
+		$retErrors = sqlsrv_errors(SQLSRV_ERR_ALL);
+		if($retErrors != null) {
+			foreach($retErrors as $arrError) {
+				$this->_errorMsg .= "SQLState: ".$arrError[ 'SQLSTATE']."\n";
+				$this->_errorMsg .= "Error Code: ".$arrError[ 'code']."\n";
+				$this->_errorMsg .= "Message: ".$arrError[ 'message']."\n";
+			}
+		} else {
+			$this->_errorMsg = "No errors found";
+		}
+		return $this->_errorMsg;
+	}
+	
+	function ErrorNo() 
+	{
+		if ($this->_logsql && $this->_errorCode !== false) return $this->_errorCode;
+		$err = sqlsrv_errors(SQLSRV_ERR_ALL);
+        if($err[0]) return $err[0]['code'];
+        else return -1;
+	}
+	
+	// returns true or false
+	function _connect($argHostname, $argUsername, $argPassword, $argDatabasename)
+	{
+		if (!function_exists('sqlsrv_connect')) return null;
+        $connectionInfo = array("Database"=>$argDatabasename,'UID'=>$argUsername,'PWD'=>$argPassword);
+        if ($this->debug) error_log("<hr>connecting... hostname: $argHostname params: ".var_export($connectionInfo,true));
+        //if ($this->debug) error_log("<hr>_connectionID before: ".serialize($this->_connectionID));
+        if(!($this->_connectionID = sqlsrv_connect($argHostname,$connectionInfo))) { 
+            if ($this->debug) error_log( "<hr><b>errors</b>: ".print_r( sqlsrv_errors(), true));
+            return false;
+        }
+        //if ($this->debug) error_log(" _connectionID after: ".serialize($this->_connectionID));
+        //if ($this->debug) error_log("<hr>defined functions: <pre>".var_export(get_defined_functions(),true)."</pre>");
+		return true;	
+	}
+	
+	// returns true or false
+	function _pconnect($argHostname, $argUsername, $argPassword, $argDatabasename)
+	{
+		//return null;//not implemented. NOTE: Persistent connections have no effect if PHP is used as a CGI program. (FastCGI!)
+        return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename);
+	}
+	
+	function Prepare($sql)
+	{
+		$stmt = sqlsrv_prepare( $this->_connectionID, $sql);
+		if (!$stmt)  return $sql;
+		return array($sql,$stmt);
+	}
+	
+	// returns concatenated string
+    // MSSQL requires integers to be cast as strings
+    // automatically cast every datatype to VARCHAR(255)
+    // @author David Rogers (introspectshun)
+    function Concat()
+    {
+        $s = "";
+        $arr = func_get_args();
+
+        // Split single record on commas, if possible
+        if (sizeof($arr) == 1) {
+            foreach ($arr as $arg) {
+                $args = explode(',', $arg);
+            }
+            $arr = $args;
+        }
+
+        array_walk($arr, create_function('&$v', '$v = "CAST(" . $v . " AS VARCHAR(255))";'));
+        $s = implode('+',$arr);
+        if (sizeof($arr) > 0) return "$s";
+        
+		return '';
+    }
+	
+	/* 
+		Unfortunately, it appears that mssql cannot handle varbinary > 255 chars
+		So all your blobs must be of type "image".
+		
+		Remember to set in php.ini the following...
+		
+		; Valid range 0 - 2147483647. Default = 4096. 
+		mssql.textlimit = 0 ; zero to pass through 
+
+		; Valid range 0 - 2147483647. Default = 4096. 
+		mssql.textsize = 0 ; zero to pass through 
+	*/
+	function UpdateBlob($table,$column,$val,$where,$blobtype='BLOB')
+	{
+	
+		if (strtoupper($blobtype) == 'CLOB') {
+			$sql = "UPDATE $table SET $column='" . $val . "' WHERE $where";
+			return $this->Execute($sql) != false;
+		}
+		$sql = "UPDATE $table SET $column=0x".bin2hex($val)." WHERE $where";
+		return $this->Execute($sql) != false;
+	}
+	
+	// returns query ID if successful, otherwise false
+	function _query($sql,$inputarr=false)
+	{
+		$this->_errorMsg = false;
+		if (is_array($inputarr)) {
+            $rez = sqlsrv_query($this->_connectionID,$sql,$inputarr);
+		} else if (is_array($sql)) {
+            $rez = sqlsrv_query($this->_connectionID,$sql[1],$inputarr);
+		} else {
+			$rez = sqlsrv_query($this->_connectionID,$sql);
+		}
+        if ($this->debug) error_log("<hr>running query: ".var_export($sql,true)."<hr>input array: ".var_export($inputarr,true)."<hr>result: ".var_export($rez,true));//"<hr>connection: ".serialize($this->_connectionID)
+        //fix for returning true on anything besides select statements
+        if (is_array($sql)) $sql = $sql[1];
+        $sql = ltrim($sql);
+        if(stripos($sql, 'SELECT') !== 0 && $rez !== false) {
+            if ($this->debug) error_log(" isn't a select query, returning boolean true");
+            return true;
+        }
+        //end fix
+        if(!$rez) $rez = false;
+		return $rez;
+	}
+	
+	// returns true or false
+	function _close()
+	{ 
+		if ($this->transCnt) $this->RollbackTrans();
+		$rez = @sqlsrv_close($this->_connectionID);
+		$this->_connectionID = false;
+		return $rez;
+	}
+	
+	// mssql uses a default date like Dec 30 2000 12:00AM
+	static function UnixDate($v)
+	{
+		return ADORecordSet_array_mssql::UnixDate($v);
+	}
+	
+	static function UnixTimeStamp($v)
+	{
+		return ADORecordSet_array_mssql::UnixTimeStamp($v);
+	}	
+
+	function &MetaIndexes($table,$primary=false)
+	{
+		$table = $this->qstr($table);
+
+		$sql = "SELECT i.name AS ind_name, C.name AS col_name, USER_NAME(O.uid) AS Owner, c.colid, k.Keyno, 
+			CASE WHEN I.indid BETWEEN 1 AND 254 AND (I.status & 2048 = 2048 OR I.Status = 16402 AND O.XType = 'V') THEN 1 ELSE 0 END AS IsPK,
+			CASE WHEN I.status & 2 = 2 THEN 1 ELSE 0 END AS IsUnique
+			FROM dbo.sysobjects o INNER JOIN dbo.sysindexes I ON o.id = i.id 
+			INNER JOIN dbo.sysindexkeys K ON I.id = K.id AND I.Indid = K.Indid 
+			INNER JOIN dbo.syscolumns c ON K.id = C.id AND K.colid = C.Colid
+			WHERE LEFT(i.name, 8) <> '_WA_Sys_' AND o.status >= 0 AND O.Name LIKE $table
+			ORDER BY O.name, I.Name, K.keyno";
+
+		global $ADODB_FETCH_MODE;
+		$save = $ADODB_FETCH_MODE;
+        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+        if ($this->fetchMode !== FALSE) {
+        	$savem = $this->SetFetchMode(FALSE);
+        }
+        
+        $rs = $this->Execute($sql);
+        if (isset($savem)) {
+        	$this->SetFetchMode($savem);
+        }
+        $ADODB_FETCH_MODE = $save;
+
+        if (!is_object($rs)) {
+        	return FALSE;
+        }
+
+		$indexes = array();
+		while ($row = $rs->FetchRow()) {
+			if (!$primary && $row[5]) continue;
+			
+            $indexes[$row[0]]['unique'] = $row[6];
+            $indexes[$row[0]]['columns'][] = $row[1];
+    	}
+        return $indexes;
+	}
+	
+	function MetaForeignKeys($table, $owner=false, $upper=false)
+	{
+    	global $ADODB_FETCH_MODE;
+	
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		$table = $this->qstr(strtoupper($table));
+		
+		$sql = 
+            "select object_name(constid) as constraint_name,
+	            col_name(fkeyid, fkey) as column_name,
+	            object_name(rkeyid) as referenced_table_name,
+   	            col_name(rkeyid, rkey) as referenced_column_name
+            from sysforeignkeys
+            where upper(object_name(fkeyid)) = $table
+            order by constraint_name, referenced_table_name, keyno";
+		
+		$constraints =& $this->GetArray($sql);
+		
+		$ADODB_FETCH_MODE = $save;
+		
+		$arr = false;
+		foreach($constraints as $constr) {
+			//print_r($constr);
+			$arr[$constr[0]][$constr[2]][] = $constr[1].'='.$constr[3]; 
+		}
+		if (!$arr) return false;
+		
+		$arr2 = false;
+		
+		foreach($arr as $k => $v) {
+			foreach($v as $a => $b) {
+				if ($upper) $a = strtoupper($a);
+				$arr2[$a] = $b;
+			}
+		}
+		return $arr2;
+	}
+
+	//From: Fernando Moreira <FMoreira@imediata.pt>
+	function MetaDatabases() 
+	{ 
+	    $this->SelectDB("master");
+        $rs =& $this->Execute($this->metaDatabasesSQL);
+        $rows = $rs->GetRows();
+        $ret = array();
+        for($i=0;$i<count($rows);$i++) {
+            $ret[] = $rows[$i][0];
+        }
+        $this->SelectDB($this->database);
+        if($ret)
+            return $ret;
+        else 
+            return false;
+	} 
+
+	// "Stein-Aksel Basma" <basma@accelero.no>
+	// tested with MSSQL 2000
+	function &MetaPrimaryKeys($table)
+	{
+    	global $ADODB_FETCH_MODE;
+	
+		$schema = '';
+		$this->_findschema($table,$schema);
+		if (!$schema) $schema = $this->database;
+		if ($schema) $schema = "and k.table_catalog like '$schema%'"; 
+
+		$sql = "select distinct k.column_name,ordinal_position from information_schema.key_column_usage k,
+		information_schema.table_constraints tc 
+		where tc.constraint_name = k.constraint_name and tc.constraint_type =
+		'PRIMARY KEY' and k.table_name = '$table' $schema order by ordinal_position ";
+		
+		$savem = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		$a = $this->GetCol($sql);
+		$ADODB_FETCH_MODE = $savem;
+		
+		if ($a && sizeof($a)>0) return $a;
+		$false = false;
+		return $false;	  
+	}
+
+	
+	function &MetaTables($ttype=false,$showSchema=false,$mask=false) 
+	{
+	    if ($mask) {
+			$save = $this->metaTablesSQL;
+			$mask = $this->qstr(($mask));
+			$this->metaTablesSQL .= " AND name like $mask";
+		}
+		$ret =& ADOConnection::MetaTables($ttype,$showSchema);
+
+		if ($mask) {
+			$this->metaTablesSQL = $save;
+		}
+		return $ret;
+	}
+}
+	
+/*--------------------------------------------------------------------------------------
+	 Class Name: Recordset
+--------------------------------------------------------------------------------------*/
+
+class ADORecordset_mssqlnative extends ADORecordSet {	
+
+	var $databaseType = "mssqlnative";
+	var $canSeek = false;
+	var $fieldOffset = 0;
+	// _mths works only in non-localised system
+	
+	function ADORecordset_mssqlnative($id,$mode=false)
+	{
+		if ($mode === false) { 
+			global $ADODB_FETCH_MODE;
+			$mode = $ADODB_FETCH_MODE;
+
+		}
+		$this->fetchMode = $mode;
+		return $this->ADORecordSet($id,$mode);
+	}
+	
+	
+	function _initrs()
+	{
+	    global $ADODB_COUNTRECS;	
+        if ($this->connection->debug) error_log("(before) ADODB_COUNTRECS: {$ADODB_COUNTRECS} _numOfRows: {$this->_numOfRows} _numOfFields: {$this->_numOfFields}");
+        /*$retRowsAff = sqlsrv_rows_affected($this->_queryID);//"If you need to determine the number of rows a query will return before retrieving the actual results, appending a SELECT COUNT ... query would let you get that information, and then a call to next_result would move you to the "real" results."
+        error_log("rowsaff: ".serialize($retRowsAff));
+		$this->_numOfRows = ($ADODB_COUNTRECS)? $retRowsAff:-1;*/
+        $this->_numOfRows = -1;//not supported
+        $fieldmeta = sqlsrv_field_metadata($this->_queryID);
+        $this->_numOfFields = ($fieldmeta)? count($fieldmeta):-1;
+        if ($this->connection->debug) error_log("(after) _numOfRows: {$this->_numOfRows} _numOfFields: {$this->_numOfFields}");
+	}
+	
+
+	//Contributed by "Sven Axelsson" <sven.axelsson@bokochwebb.se>
+	// get next resultset - requires PHP 4.0.5 or later
+	function NextRecordSet()
+	{
+		if (!sqlsrv_next_result($this->_queryID)) return false;
+		$this->_inited = false;
+		$this->bind = false;
+		$this->_currentRow = -1;
+		$this->Init();
+		return true;
+	}
+
+	/* Use associative array to get fields array */
+	function Fields($colname)
+	{
+		if ($this->fetchMode != ADODB_FETCH_NUM) return $this->fields[$colname];
+		if (!$this->bind) {
+			$this->bind = array();
+			for ($i=0; $i < $this->_numOfFields; $i++) {
+				$o = $this->FetchField($i);
+				$this->bind[strtoupper($o->name)] = $i;
+			}
+		}
+		
+		return $this->fields[$this->bind[strtoupper($colname)]];
+	}
+	
+	/*	Returns: an object containing field information. 
+		Get column information in the Recordset object. fetchField() can be used in order to obtain information about
+		fields in a certain query result. If the field offset isn't specified, the next field that wasn't yet retrieved by
+		fetchField() is retrieved.	*/
+
+	function &FetchField($fieldOffset = -1) 
+	{
+        if ($this->connection->debug) error_log("<hr>fetchfield: $fieldOffset, fetch array: <pre>".print_r($this->fields,true)."</pre> backtrace: ".adodb_backtrace(false));
+		if ($fieldOffset != -1) $this->fieldOffset = $fieldOffset;
+		$arrKeys = array_keys($this->fields);
+		if(array_key_exists($this->fieldOffset,$arrKeys) && !array_key_exists($arrKeys[$this->fieldOffset],$this->fields)) {
+			$f = false;
+		} else {
+			$f = $this->fields[ $arrKeys[$this->fieldOffset] ];
+			if($fieldOffset == -1) $this->fieldOffset++;
+		}
+
+        if (empty($f)) {
+            $f = false;//PHP Notice: Only variable references should be returned by reference
+        }
+		return $f;
+	}
+	
+	function _seek($row) 
+	{
+		return false;//There is no support for cursors in the driver at this time.  All data is returned via forward-only streams.
+	}
+
+	// speedup
+	function MoveNext() 
+	{
+        if ($this->connection->debug) error_log("movenext()");
+        //if ($this->connection->debug) error_log("eof (beginning): ".$this->EOF);
+		if ($this->EOF) return false;
+		
+		$this->_currentRow++;
+        if ($this->connection->debug) error_log("_currentRow: ".$this->_currentRow);
+		
+		if ($this->_fetch()) return true;
+		$this->EOF = true;
+        //if ($this->connection->debug) error_log("eof (end): ".$this->EOF);
+		
+		return false;
+	}
+
+	
+	// INSERT UPDATE DELETE returns false even if no error occurs in 4.0.4
+	// also the date format has been changed from YYYY-mm-dd to dd MMM YYYY in 4.0.4. Idiot!
+	function _fetch($ignore_fields=false) 
+	{
+        if ($this->connection->debug) error_log("_fetch()");
+		if ($this->fetchMode & ADODB_FETCH_ASSOC) {
+			if ($this->fetchMode & ADODB_FETCH_NUM) {
+                if ($this->connection->debug) error_log("fetch mode: both");
+				$this->fields = @sqlsrv_fetch_array($this->_queryID,SQLSRV_FETCH_BOTH);
+			} else {
+                if ($this->connection->debug) error_log("fetch mode: assoc");
+				$this->fields = @sqlsrv_fetch_array($this->_queryID,SQLSRV_FETCH_ASSOC);
+			}
+			
+			if (ADODB_ASSOC_CASE == 0) {
+				foreach($this->fields as $k=>$v) {
+					$this->fields[strtolower($k)] = $v;
+				}
+			} else if (ADODB_ASSOC_CASE == 1) {
+				foreach($this->fields as $k=>$v) {
+					$this->fields[strtoupper($k)] = $v;
+				}
+			}
+		} else {
+            if ($this->connection->debug) error_log("fetch mode: num");
+			$this->fields = @sqlsrv_fetch_array($this->_queryID,SQLSRV_FETCH_NUMERIC);
+		}
+        if(is_array($this->fields) && array_key_exists(1,$this->fields) && !array_key_exists(0,$this->fields)) {//fix fetch numeric keys since they're not 0 based 
+            $arrFixed = array();
+            foreach($this->fields as $key=>$value) {
+                if(is_numeric($key)) {
+                    $arrFixed[$key-1] = $value;
+                } else {
+                    $arrFixed[$key] = $value;
+                }
+            }
+            //if($this->connection->debug) error_log("<hr>fixing non 0 based return array, old: ".print_r($this->fields,true)." new: ".print_r($arrFixed,true));
+            $this->fields = $arrFixed;
+        }
+		if(is_array($this->fields)) {
+			foreach($this->fields as $key=>$value) {
+				if (is_object($value) && method_exists($value, 'format')) {//is DateTime object
+					$this->fields[$key] = $value->format("Y-m-d\TH:i:s\Z");
+				}
+			}
+		}
+        if($this->fields === null) $this->fields = false;
+        if ($this->connection->debug) error_log("<hr>after _fetch, fields: <pre>".print_r($this->fields,true)." backtrace: ".adodb_backtrace(false));
+		return $this->fields;
+	}
+	
+    /*	close() only needs to be called if you are worried about using too much memory while your script
+		is running. All associated result memory for the specified result identifier will automatically be freed.	*/
+	function _close() 
+	{
+		$rez = sqlsrv_free_stmt($this->_queryID);	
+		$this->_queryID = false;
+		return $rez;
+	}
+
+	// mssql uses a default date like Dec 30 2000 12:00AM
+	static function UnixDate($v)
+	{
+		return ADORecordSet_array_mssqlnative::UnixDate($v);
+	}
+	
+	static function UnixTimeStamp($v)
+	{
+		return ADORecordSet_array_mssqlnative::UnixTimeStamp($v);
+	}
+}
+
+
+class ADORecordSet_array_mssqlnative extends ADORecordSet_array {
+	function ADORecordSet_array_mssqlnative($id=-1,$mode=false) 
+	{
+		$this->ADORecordSet_array($id,$mode);
+	}
+	
+		// mssql uses a default date like Dec 30 2000 12:00AM
+	static function UnixDate($v)
+	{
+	
+		if (is_numeric(substr($v,0,1)) && ADODB_PHPVER >= 0x4200) return parent::UnixDate($v);
+		
+    	global $ADODB_mssql_mths,$ADODB_mssql_date_order;
+	
+		//Dec 30 2000 12:00AM 
+		if ($ADODB_mssql_date_order == 'dmy') {
+			if (!preg_match( "|^([0-9]{1,2})[-/\. ]+([A-Za-z]{3})[-/\. ]+([0-9]{4})|" ,$v, $rr)) {
+				return parent::UnixDate($v);
+			}
+			if ($rr[3] <= TIMESTAMP_FIRST_YEAR) return 0;
+			
+			$theday = $rr[1];
+			$themth =  substr(strtoupper($rr[2]),0,3);
+		} else {
+			if (!preg_match( "|^([A-Za-z]{3})[-/\. ]+([0-9]{1,2})[-/\. ]+([0-9]{4})|" ,$v, $rr)) {
+				return parent::UnixDate($v);
+			}
+			if ($rr[3] <= TIMESTAMP_FIRST_YEAR) return 0;
+			
+			$theday = $rr[2];
+			$themth = substr(strtoupper($rr[1]),0,3);
+		}
+		$themth = $ADODB_mssql_mths[$themth];
+		if ($themth <= 0) return false;
+		// h-m-s-MM-DD-YY
+		return  mktime(0,0,0,$themth,$theday,$rr[3]);
+	}
+	
+	static function UnixTimeStamp($v)
+	{
+	
+		if (is_numeric(substr($v,0,1)) && ADODB_PHPVER >= 0x4200) return parent::UnixTimeStamp($v);
+		
+	    global $ADODB_mssql_mths,$ADODB_mssql_date_order;
+	
+		//Dec 30 2000 12:00AM
+		 if ($ADODB_mssql_date_order == 'dmy') {
+			 if (!preg_match( "|^([0-9]{1,2})[-/\. ]+([A-Za-z]{3})[-/\. ]+([0-9]{4}) +([0-9]{1,2}):([0-9]{1,2}) *([apAP]{0,1})|"
+			,$v, $rr)) return parent::UnixTimeStamp($v);
+			if ($rr[3] <= TIMESTAMP_FIRST_YEAR) return 0;
+		
+			$theday = $rr[1];
+			$themth =  substr(strtoupper($rr[2]),0,3);
+		} else {
+			if (!preg_match( "|^([A-Za-z]{3})[-/\. ]+([0-9]{1,2})[-/\. ]+([0-9]{4}) +([0-9]{1,2}):([0-9]{1,2}) *([apAP]{0,1})|"
+			,$v, $rr)) return parent::UnixTimeStamp($v);
+			if ($rr[3] <= TIMESTAMP_FIRST_YEAR) return 0;
+		
+			$theday = $rr[2];
+			$themth = substr(strtoupper($rr[1]),0,3);
+		}
+		
+		$themth = $ADODB_mssql_mths[$themth];
+		if ($themth <= 0) return false;
+		
+		switch (strtoupper($rr[6])) {
+		case 'P':
+			if ($rr[4]<12) $rr[4] += 12;
+			break;
+		case 'A':
+			if ($rr[4]==12) $rr[4] = 0;
+			break;
+		default:
+			break;
+		}
+		// h-m-s-MM-DD-YY
+		return  mktime($rr[4],$rr[5],0,$themth,$theday,$rr[3]);
+	}
+}
+
+/*
+Code Example 1:
+
+select 	object_name(constid) as constraint_name,
+       	object_name(fkeyid) as table_name, 
+        col_name(fkeyid, fkey) as column_name,
+	object_name(rkeyid) as referenced_table_name,
+   	col_name(rkeyid, rkey) as referenced_column_name
+from sysforeignkeys
+where object_name(fkeyid) = x
+order by constraint_name, table_name, referenced_table_name,  keyno
+
+Code Example 2:
+select 	constraint_name,
+	column_name,
+	ordinal_position
+from information_schema.key_column_usage
+where constraint_catalog = db_name()
+and table_name = x
+order by constraint_name, ordinal_position
+
+http://www.databasejournal.com/scripts/article.php/1440551
+*/
+
+?>
\ No newline at end of file
diff --git a/third_party/adodb/drivers/adodb-mssqlpo.inc.php b/third_party/adodb/drivers/adodb-mssqlpo.inc.php
index 1d7845e..d10e1b8 100644
--- a/third_party/adodb/drivers/adodb-mssqlpo.inc.php
+++ b/third_party/adodb/drivers/adodb-mssqlpo.inc.php
@@ -1,6 +1,6 @@
 <?php
 /**
-* @version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+* @version V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
 * Released under both BSD license and Lesser GPL library license.
 * Whenever there is any discrepancy between the two licenses,
 * the BSD license will take precedence.
@@ -45,7 +45,7 @@ class ADODB_mssqlpo extends ADODB_mssql {
 		return array($sql,$stmt);
 	}
 	
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		if (is_string($sql)) $sql = str_replace('||','+',$sql);
 		return ADODB_mssql::_query($sql,$inputarr);
diff --git a/third_party/adodb/drivers/adodb-mysql.inc.php b/third_party/adodb/drivers/adodb-mysql.inc.php
index a8b7e5a..751e8bd 100644
--- a/third_party/adodb/drivers/adodb-mysql.inc.php
+++ b/third_party/adodb/drivers/adodb-mysql.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -349,7 +349,7 @@ class ADODB_mysql extends ADOConnection {
 		if (!$date) $date = $this->sysDate;
 		
 		$fraction = $dayFraction * 24 * 3600;
-		return $date . ' + INTERVAL ' .	 $fraction.' SECOND';
+		return '('. $date . ' + INTERVAL ' .	 $fraction.' SECOND)';
 		
 //		return "from_unixtime(unix_timestamp($date)+$fraction)";
 	}
@@ -394,7 +394,7 @@ class ADODB_mysql extends ADOConnection {
 		return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename);
 	}
 	
- 	function MetaColumns($table) 
+ 	function MetaColumns($table, $normalize=true) 
 	{
 		$this->_findschema($table,$schema);
 		if ($schema) {
@@ -447,7 +447,7 @@ class ADODB_mysql extends ADOConnection {
 			$fld->not_null = ($rs->fields[2] != 'YES');
 			$fld->primary_key = ($rs->fields[3] == 'PRI');
 			$fld->auto_increment = (strpos($rs->fields[5], 'auto_increment') !== false);
-			$fld->binary = (strpos($type,'blob') !== false);
+			$fld->binary = (strpos($type,'blob') !== false || strpos($type,'binary') !== false);
 			$fld->unsigned = (strpos($type,'unsigned') !== false);
 			$fld->zerofill = (strpos($type,'zerofill') !== false);
 
@@ -499,7 +499,7 @@ class ADODB_mysql extends ADOConnection {
 	}
 	
 	// returns queryID or false
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 	//global $ADODB_COUNTRECS;
 		//if($ADODB_COUNTRECS) 
@@ -559,8 +559,9 @@ class ADODB_mysql extends ADOConnection {
             $table = "$owner.$table";
          }
          $a_create_table = $this->getRow(sprintf('SHOW CREATE TABLE %s', $table));
-		 if ($associative) $create_sql = $a_create_table["Create Table"];
-         else $create_sql  = $a_create_table[1];
+		 if ($associative) {
+		 	$create_sql = isset($a_create_table["Create Table"]) ? $a_create_table["Create Table"] : $a_create_table["Create View"];
+         } else $create_sql  = $a_create_table[1];
 
          $matches = array();
 
@@ -576,9 +577,12 @@ class ADODB_mysql extends ADOConnection {
                  $ref_table = strtoupper($ref_table);
              }
 
-             $foreign_keys[$ref_table] = array();
-             $num_fields = count($my_field);
-             for ( $j = 0;  $j < $num_fields;  $j ++ ) {
+			// see https://sourceforge.net/tracker/index.php?func=detail&aid=2287278&group_id=42718&atid=433976
+			if (!isset($foreign_keys[$ref_table])) {
+				$foreign_keys[$ref_table] = array();
+			}
+            $num_fields = count($my_field);
+            for ( $j = 0;  $j < $num_fields;  $j ++ ) {
                  if ( $associative ) {
                      $foreign_keys[$ref_table][$ref_field[$j]] = $my_field[$j];
                  } else {
@@ -733,6 +737,7 @@ class ADORecordSet_mysql extends ADORecordSet{
 		case 'LONGBLOB': 
 		case 'BLOB':
 		case 'MEDIUMBLOB':
+		case 'BINARY':
 			return !empty($fieldobj->binary) ? 'B' : 'X';
 			
 		case 'YEAR':
diff --git a/third_party/adodb/drivers/adodb-mysqli.inc.php b/third_party/adodb/drivers/adodb-mysqli.inc.php
index bf6cd20..d4c3a33 100644
--- a/third_party/adodb/drivers/adodb-mysqli.inc.php
+++ b/third_party/adodb/drivers/adodb-mysqli.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -50,7 +50,8 @@ class ADODB_mysqli extends ADOConnection {
 	var $_bindInputArray = false;
 	var $nameQuote = '`';		/// string to use to quote identifiers and names
 	var $optionFlags = array(array(MYSQLI_READ_DEFAULT_GROUP,0));
-  var $arrayClass = 'ADORecordSet_array_mysqli';
+  	var $arrayClass = 'ADORecordSet_array_mysqli';
+  	var $multiQuery = false;
 	
 	function ADODB_mysqli() 
 	{			
@@ -194,11 +195,11 @@ class ADODB_mysqli extends ADOConnection {
 		return true;
 	}
 	
-	function RowLock($tables,$where='',$flds='1 as adodb_ignore') 
+	function RowLock($tables,$where='',$col='1 as adodb_ignore') 
 	{
 		if ($this->transCnt==0) $this->BeginTrans();
 		if ($where) $where = ' where '.$where;
-		$rs = $this->Execute("select $flds from $tables $where for update");
+		$rs = $this->Execute("select $col from $tables $where for update");
 		return !empty($rs); 
 	}
 	
@@ -491,8 +492,9 @@ class ADODB_mysqli extends ADOConnection {
 	       $table = "$owner.$table";
 	    }
 	    $a_create_table = $this->getRow(sprintf('SHOW CREATE TABLE %s', $table));
-		if ($associative) $create_sql = $a_create_table["Create Table"];
-	    else $create_sql  = $a_create_table[1];
+		if ($associative) {
+			$create_sql = isset($a_create_table["Create Table"]) ? $a_create_table["Create Table"] : $a_create_table["Create View"];
+	    } else $create_sql  = $a_create_table[1];
 	
 	    $matches = array();
 	
@@ -508,8 +510,11 @@ class ADODB_mysqli extends ADOConnection {
 	            $ref_table = strtoupper($ref_table);
 	        }
 	
-	        $foreign_keys[$ref_table] = array();
-	        $num_fields               = count($my_field);
+	        // see https://sourceforge.net/tracker/index.php?func=detail&aid=2287278&group_id=42718&atid=433976
+			if (!isset($foreign_keys[$ref_table])) {
+				$foreign_keys[$ref_table] = array();
+			}
+	        $num_fields = count($my_field);
 	        for ( $j = 0;  $j < $num_fields;  $j ++ ) {
 	            if ( $associative ) {
 	                $foreign_keys[$ref_table][$ref_field[$j]] = $my_field[$j];
@@ -522,7 +527,7 @@ class ADODB_mysqli extends ADOConnection {
 	    return  $foreign_keys;
 	}
 	
- 	function MetaColumns($table) 
+ 	function MetaColumns($table, $normalize=true) 
 	{
 		$false = false;
 		if (!$this->metaColumnsSQL)
@@ -556,8 +561,10 @@ class ADODB_mysqli extends ADOConnection {
 				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
 			} elseif (preg_match("/^(enum)\((.*)\)$/i", $type, $query_array)) {
 				$fld->type = $query_array[1];
-				$fld->max_length = max(array_map("strlen",explode(",",$query_array[2]))) - 2; // PHP >= 4.0.6
-				$fld->max_length = ($fld->max_length == 0 ? 1 : $fld->max_length);
+				$arr = explode(",",$query_array[2]);
+				$fld->enums = $arr;
+				$zlen = max(array_map("strlen",$arr)) - 2; // PHP >= 4.0.6
+				$fld->max_length = ($zlen > 0) ? $zlen : 1;
 			} else {
 				$fld->type = $type;
 				$fld->max_length = -1;
@@ -630,7 +637,6 @@ class ADODB_mysqli extends ADOConnection {
 	function Prepare($sql)
 	{
 		return $sql;
-		
 		$stmt = $this->_connectionID->prepare($sql);
 		if (!$stmt) {
 			echo $this->ErrorMsg();
@@ -644,8 +650,18 @@ class ADODB_mysqli extends ADOConnection {
 	function _query($sql, $inputarr)
 	{
 	global $ADODB_COUNTRECS;
-		
+		// Move to the next recordset, or return false if there is none. In a stored proc
+		// call, mysqli_next_result returns true for the last "recordset", but mysqli_store_result
+		// returns false. I think this is because the last "recordset" is actually just the
+		// return value of the stored proc (ie the number of rows affected).
+		// Commented out for reasons of performance. You should retrieve every recordset yourself.
+		//	if (!mysqli_next_result($this->connection->_connectionID))	return false;
+	
 		if (is_array($sql)) {
+		
+			// Prepare() not supported because mysqli_stmt_execute does not return a recordset, but
+			// returns as bound variables.
+		
 			$stmt = $sql[1];
 			$a = '';
 			foreach($inputarr as $k => $v) {
@@ -656,16 +672,36 @@ class ADODB_mysqli extends ADOConnection {
 			
 			$fnarr = array_merge( array($stmt,$a) , $inputarr);
 			$ret = call_user_func_array('mysqli_stmt_bind_param',$fnarr);
-
 			$ret = mysqli_stmt_execute($stmt);
 			return $ret;
 		}
+		
+		/*
 		if (!$mysql_res =  mysqli_query($this->_connectionID, $sql, ($ADODB_COUNTRECS) ? MYSQLI_STORE_RESULT : MYSQLI_USE_RESULT)) {
 		    if ($this->debug) ADOConnection::outp("Query: " . $sql . " failed. " . $this->ErrorMsg());
 		    return false;
 		}
 		
 		return $mysql_res;
+		*/
+		
+		if ($this->multiQuery) {
+			$rs = mysqli_multi_query($this->_connectionID, $sql.';');
+			if ($rs) {
+				$rs = ($ADODB_COUNTRECS) ? @mysqli_store_result( $this->_connectionID ) : @mysqli_use_result( $this->_connectionID );
+				return $rs ? $rs : true; // mysqli_more_results( $this->_connectionID )
+			}
+		} else {
+			$rs = mysqli_query($this->_connectionID, $sql, $ADODB_COUNTRECS ? MYSQLI_STORE_RESULT : MYSQLI_USE_RESULT);
+		
+			if ($rs) return $rs;
+		}
+
+		if($this->debug)
+			ADOConnection::outp("Query: " . $sql . " failed. " . $this->ErrorMsg());
+		
+		return false;
+		
 	}
 
 	/*	Returns: the last error message from previous database operation	*/	
@@ -819,9 +855,10 @@ class ADORecordSet_mysqli extends ADORecordSet{
 	{	
 		$fieldnr = $fieldOffset;
 		if ($fieldOffset != -1) {
-		  $fieldOffset = mysqli_field_seek($this->_queryID, $fieldnr);
+		  $fieldOffset = @mysqli_field_seek($this->_queryID, $fieldnr);
 		}
-		$o = mysqli_fetch_field($this->_queryID);
+		$o = @mysqli_fetch_field($this->_queryID);
+		if (!$o) return false;
 		/* Properties of an ADOFieldObject as set by MetaColumns */
 		$o->primary_key = $o->flags & MYSQLI_PRI_KEY_FLAG;
 		$o->not_null = $o->flags & MYSQLI_NOT_NULL_FLAG;
@@ -870,6 +907,33 @@ class ADORecordSet_mysqli extends ADORecordSet{
 	  return true;
 	}
 		
+		
+	function NextRecordSet()
+	{
+	global $ADODB_COUNTRECS;
+	
+		mysqli_free_result($this->_queryID);
+		$this->_queryID = -1;
+		// Move to the next recordset, or return false if there is none. In a stored proc
+		// call, mysqli_next_result returns true for the last "recordset", but mysqli_store_result
+		// returns false. I think this is because the last "recordset" is actually just the
+		// return value of the stored proc (ie the number of rows affected).
+		if(!mysqli_next_result($this->connection->_connectionID)) {
+		return false;
+		}
+		// CD: There is no $this->_connectionID variable, at least in the ADO version I'm using
+		$this->_queryID = ($ADODB_COUNTRECS) ? @mysqli_store_result( $this->connection->_connectionID )
+						: @mysqli_use_result( $this->connection->_connectionID );
+		if(!$this->_queryID) {
+			return false;
+		}
+		$this->_inited = false;
+		$this->bind = false;
+		$this->_currentRow = -1;
+		$this->Init();
+		return true;
+	}
+
 	// 10% speedup to move MoveNext to child class
 	// This is the only implementation that works now (23-10-2003).
 	// Other functions return no or the wrong results.
@@ -892,6 +956,19 @@ class ADORecordSet_mysqli extends ADORecordSet{
 	
 	function _close() 
 	{
+	    //if results are attached to this pointer from Stored Proceedure calls, the next standard query will die 2014
+        //only a problem with persistant connections
+
+        //mysqli_next_result($this->connection->_connectionID); trashes the DB side attached results.
+
+        while(mysqli_more_results($this->connection->_connectionID)){
+           @mysqli_next_result($this->connection->_connectionID);
+        }
+
+        //Because you can have one attached result, without tripping mysqli_more_results
+        @mysqli_next_result($this->connection->_connectionID);
+
+
 		mysqli_free_result($this->_queryID); 
 	  	$this->_queryID = false;	
 	}
diff --git a/third_party/adodb/drivers/adodb-mysqlpo.inc.php b/third_party/adodb/drivers/adodb-mysqlpo.inc.php
index 37b1b80..b52ff96 100644
--- a/third_party/adodb/drivers/adodb-mysqlpo.inc.php
+++ b/third_party/adodb/drivers/adodb-mysqlpo.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -59,11 +59,11 @@ class ADODB_mysqlt extends ADODB_mysql {
 		return true;
 	}
 	
-	function RowLock($tables,$where='',$flds='1 as adodb_ignore') 
+	function RowLock($tables,$where='',$col='1 as adodb_ignore') 
 	{
 		if ($this->transCnt==0) $this->BeginTrans();
 		if ($where) $where = ' where '.$where;
-		$rs = $this->Execute("select $flds from $tables $where for update");
+		$rs = $this->Execute("select $col from $tables $where for update");
 		return !empty($rs); 
 	}
 	
diff --git a/third_party/adodb/drivers/adodb-mysqlt.inc.php b/third_party/adodb/drivers/adodb-mysqlt.inc.php
index 8812f2b..f14dc05 100644
--- a/third_party/adodb/drivers/adodb-mysqlt.inc.php
+++ b/third_party/adodb/drivers/adodb-mysqlt.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -62,25 +62,25 @@ class ADODB_mysqlt extends ADODB_mysql {
 		if (!$ok) return $this->RollbackTrans();
 		
 		if ($this->transCnt) $this->transCnt -= 1;
-		$this->Execute('COMMIT');
+		$ok = $this->Execute('COMMIT');
 		$this->Execute('SET AUTOCOMMIT=1');
-		return true;
+		return $ok ? true : false;
 	}
 	
 	function RollbackTrans()
 	{
 		if ($this->transOff) return true;
 		if ($this->transCnt) $this->transCnt -= 1;
-		$this->Execute('ROLLBACK');
+		$ok = $this->Execute('ROLLBACK');
 		$this->Execute('SET AUTOCOMMIT=1');
-		return true;
+		return $ok ? true : false;
 	}
 	
-	function RowLock($tables,$where='',$flds='1 as adodb_ignore') 
+	function RowLock($tables,$where='',$col='1 as adodb_ignore') 
 	{
 		if ($this->transCnt==0) $this->BeginTrans();
 		if ($where) $where = ' where '.$where;
-		$rs = $this->Execute("select $flds from $tables $where for update");
+		$rs = $this->Execute("select $col from $tables $where for update");
 		return !empty($rs); 
 	}
 	
diff --git a/third_party/adodb/drivers/adodb-netezza.inc.php b/third_party/adodb/drivers/adodb-netezza.inc.php
index 0725633..8b78943 100644
--- a/third_party/adodb/drivers/adodb-netezza.inc.php
+++ b/third_party/adodb/drivers/adodb-netezza.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  
   First cut at the Netezza Driver by Josh Eldridge joshuae74#hotmail.com
  Based on the previous postgres drivers.
diff --git a/third_party/adodb/drivers/adodb-oci8.inc.php b/third_party/adodb/drivers/adodb-oci8.inc.php
index cce7e6b..a14e3f6 100644
--- a/third_party/adodb/drivers/adodb-oci8.inc.php
+++ b/third_party/adodb/drivers/adodb-oci8.inc.php
@@ -1,7 +1,7 @@
 <?php
 /*
 
-  version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim. All rights reserved.
+  version V5.06 16 Oct 2008  (c) 2000-2009 John Lim. All rights reserved.
 
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
@@ -58,7 +58,7 @@ class ADODB_oci8 extends ADOConnection {
 	var $replaceQuote = "''"; // string to use to replace quotes
 	var $concat_operator='||';
 	var $sysDate = "TRUNC(SYSDATE)";
-	var $sysTimeStamp = 'SYSDATE';
+	var $sysTimeStamp = 'SYSDATE'; // requires oracle 9 or later, otherwise use SYSDATE
 	var $metaDatabasesSQL = "SELECT USERNAME FROM ALL_USERS WHERE USERNAME NOT IN ('SYS','SYSTEM','DBSNMP','OUTLN') ORDER BY 1";
 	var $_stmt;
 	var $_commit = OCI_COMMIT_ON_SUCCESS;
@@ -81,7 +81,7 @@ class ADODB_oci8 extends ADOConnection {
 	var $leftOuter = '';  // oracle wierdness, $col = $value (+) for LEFT OUTER, $col (+)= $value for RIGHT OUTER
 	var $session_sharing_force_blob = false; // alter session on updateblob if set to true 
 	var $firstrows = true; // enable first rows optimization on SelectLimit()
-	var $selectOffsetAlg1 = 100; // when to use 1st algorithm of selectlimit.
+	var $selectOffsetAlg1 = 1000; // when to use 1st algorithm of selectlimit.
 	var $NLS_DATE_FORMAT = 'YYYY-MM-DD';  // To include time, use 'RRRR-MM-DD HH24:MI:SS'
 	var $dateformat = 'YYYY-MM-DD'; // DBDate format
  	var $useDBDateFormatForTextInput=false;
@@ -96,8 +96,8 @@ class ADODB_oci8 extends ADOConnection {
 		if (defined('ADODB_EXTENSION')) $this->rsPrefix .= 'ext_';
 	}
 	
-	/*  function MetaColumns($table) added by smondino@users.sourceforge.net*/
-	function MetaColumns($table) 
+	/*  function MetaColumns($table, $normalize=true) added by smondino@users.sourceforge.net*/
+	function MetaColumns($table, $normalize=true) 
 	{
 	global $ADODB_FETCH_MODE;
 	
@@ -184,7 +184,7 @@ NATSOFT.DOMAIN =
 	function _connect($argHostname, $argUsername, $argPassword, $argDatabasename,$mode=0)
 	{
 		if (!function_exists('OCIPLogon')) return null;
-		
+		#adodb_backtrace(); 
 		
         $this->_errorMsg = false;
 		$this->_errorCode = false;
@@ -200,6 +200,11 @@ NATSOFT.DOMAIN =
 					$argHostport = empty($this->port)?  "1521" : $this->port;
 	   			}
 				
+				if (strncasecmp($argDatabasename,'SID=',4) == 0) {
+					$argDatabasename = substr($argDatabasename,4);
+					$this->connectSID = true;
+				}
+				
 				if ($this->connectSID) {
 					$argDatabasename="(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=".$argHostname
 					.")(PORT=$argHostport))(CONNECT_DATA=(SID=$argDatabasename)))";
@@ -272,12 +277,17 @@ NATSOFT.DOMAIN =
 	}
 	
 	// format and return date string in database date format
-	function DBDate($d)
+	function DBDate($d,$isfld=false)
 	{
 		if (empty($d) && $d !== 0) return 'null';
+		if ($isfld) return 'TO_DATE('.$d.",'".$this->dateformat."')";
 		
 		if (is_string($d)) $d = ADORecordSet::UnixDate($d);
-		return "TO_DATE(".adodb_date($this->fmtDate,$d).",'".$this->dateformat."')";
+		
+		if (is_object($d)) $ds = $d->format($this->fmtDate);
+		else $ds = adodb_date($this->fmtDate,$d);
+		
+		return "TO_DATE(".$ds.",'".$this->dateformat."')";
 	}
 
 	function BindDate($d)
@@ -288,26 +298,34 @@ NATSOFT.DOMAIN =
 		return substr($d,1,strlen($d)-2);
 	}
 	
-	function BindTimeStamp($d)
+	function BindTimeStamp($ts)
 	{
-		$d = ADOConnection::DBTimeStamp($d);
-		if (strncmp($d,"'",1)) return $d;
+		if (empty($ts) && $ts !== 0) return 'null';
+		if (is_string($ts)) $ts = ADORecordSet::UnixTimeStamp($ts);
 		
-		return substr($d,1,strlen($d)-2);
+		if (is_object($ts)) $tss = $ts->format("'Y-m-d H:i:s'");
+		else $tss = adodb_date("'Y-m-d H:i:s'",$ts);
+		
+		return $tss;
 	}
 	
 	// format and return date string in database timestamp format
-	function DBTimeStamp($ts)
+	function DBTimeStamp($ts,$isfld=false)
 	{
 		if (empty($ts) && $ts !== 0) return 'null';
+		if ($isfld) return 'TO_DATE(substr('.$ts.",1,19),'RRRR-MM-DD, HH24:MI:SS')";
 		if (is_string($ts)) $ts = ADORecordSet::UnixTimeStamp($ts);
-		return 'TO_DATE('.adodb_date("'Y-m-d H:i:s'",$ts).",'RRRR-MM-DD, HH24:MI:SS')";
+		
+		if (is_object($ts)) $tss = $ts->format("'Y-m-d H:i:s'");
+		else $tss = adodb_date("'Y-m-d H:i:s'",$ts);
+		
+		return 'TO_DATE('.$tss.",'RRRR-MM-DD, HH24:MI:SS')";
 	}
 	
-	function RowLock($tables,$where,$flds='1 as ignore') 
+	function RowLock($tables,$where,$col='1 as ignore') 
 	{
 		if ($this->autoCommit) $this->BeginTrans();
-		return $this->GetOne("select $flds from $tables where $where for update");
+		return $this->GetOne("select $col from $tables where $where for update");
 	}
 	
 	function MetaTables($ttype=false,$showSchema=false,$mask=false) 
@@ -399,8 +417,10 @@ NATSOFT.DOMAIN =
 		$this->autoCommit = false;
 		$this->_commit = OCI_DEFAULT;
 		
-		if ($this->_transmode) $this->Execute("SET TRANSACTION ".$this->_transmode);
-		return true;
+		if ($this->_transmode) $ok = $this->Execute("SET TRANSACTION ".$this->_transmode);
+		else $ok = true;
+		
+		return $ok ? true : false;
 	}
 	
 	function CommitTrans($ok=true) 
@@ -573,7 +593,7 @@ NATSOFT.DOMAIN =
 				$sql = preg_replace('/^[ \t\n]*select/i','SELECT /*+FIRST_ROWS*/',$sql);
 		}
 		
-		if ($offset < $this->selectOffsetAlg1 && 0 < $nrows && $nrows < 1000) {
+		if ($offset == -1 || ($offset < $this->selectOffsetAlg1 && 0 < $nrows && $nrows < 1000)) {
 			if ($nrows > 0) {	
 				if ($offset > 0) $nrows += $offset;
 				//$inputarr['adodb_rownum'] = $nrows;
@@ -595,14 +615,14 @@ NATSOFT.DOMAIN =
 			
 			 // Let Oracle return the name of the columns
 			$q_fields = "SELECT * FROM (".$sql.") WHERE NULL = NULL";
-			 
+		
 			$false = false;
 			if (! $stmt_arr = $this->Prepare($q_fields)) {
 				return $false;
 			}
 			$stmt = $stmt_arr[1];
 			 
-			 if (is_array($inputarr)) {
+			if (is_array($inputarr)) {
 			 	foreach($inputarr as $k => $v) {
 					if (is_array($v)) {
 						if (sizeof($v) == 2) // suggested by g.giunta@libero.
@@ -616,6 +636,7 @@ NATSOFT.DOMAIN =
 							$bindarr[$k] = $v;
 						} else { 				// dynamic sql, so rebind every time
 							OCIBindByName($stmt,":$k",$inputarr[$k],$len);
+							
 						}
 					}
 				}
@@ -634,16 +655,17 @@ NATSOFT.DOMAIN =
 			
 			 OCIFreeStatement($stmt); 
 			 $fields = implode(',', $cols);
-			 $nrows += $offset;
+			 if ($nrows <= 0) $nrows = 999999999999;
+			 else $nrows += $offset;
 			 $offset += 1; // in Oracle rownum starts at 1
 			
 			if ($this->databaseType == 'oci8po') {
-					 $sql = "SELECT $fields FROM".
+					 $sql = "SELECT /*+ FIRST_ROWS */ $fields FROM".
 					  "(SELECT rownum as adodb_rownum, $fields FROM".
 					  " ($sql) WHERE rownum <= ?".
 					  ") WHERE adodb_rownum >= ?";
 				} else {
-					 $sql = "SELECT $fields FROM".
+					 $sql = "SELECT /*+ FIRST_ROWS */ $fields FROM".
 					  "(SELECT rownum as adodb_rownum, $fields FROM".
 					  " ($sql) WHERE rownum <= :adodb_nrows".
 					  ") WHERE adodb_rownum >= :adodb_offset";
@@ -710,7 +732,7 @@ NATSOFT.DOMAIN =
 	}
 	
 	/**
-	* Usage:  store file pointed to by $var in a blob
+	* Usage:  store file pointed to by $val in a blob
 	*/
 	function UpdateBlobFile($table,$column,$val,$where,$blobtype='BLOB')
 	{
@@ -945,7 +967,7 @@ NATSOFT.DOMAIN =
 			if ($isOutput == false) {
 				$var = $this->BlobEncode($var);
 				$tmp->WriteTemporary($var);
-				$this->_refLOBs[$numlob]['VAR'] = $var;
+				$this->_refLOBs[$numlob]['VAR'] = &$var;
 				if ($this->debug) {
 					ADOConnection::outp("<b>Bind</b>: LOB has been written to temp");
 				}
@@ -1010,7 +1032,7 @@ NATSOFT.DOMAIN =
 		  $db->bind($stmt,1); $db->bind($stmt,2); $db->bind($stmt,3); 
 		  $db->execute($stmt);
 	*/ 
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		if (is_array($sql)) { // is prepared sql
 			$stmt = $sql[1];
@@ -1122,6 +1144,32 @@ NATSOFT.DOMAIN =
 		return false;
 	}
 	
+	// From Oracle Whitepaper: PHP Scalability and High Availability
+	function IsConnectionError($err)
+	{
+		switch($err) {
+			case 378: /* buffer pool param incorrect */
+			case 602: /* core dump */
+			case 603: /* fatal error */
+			case 609: /* attach failed */
+			case 1012: /* not logged in */
+			case 1033: /* init or shutdown in progress */
+			case 1043: /* Oracle not available */
+			case 1089: /* immediate shutdown in progress */
+			case 1090: /* shutdown in progress */
+			case 1092: /* instance terminated */
+			case 3113: /* disconnect */
+			case 3114: /* not connected */
+			case 3122: /* closing window */
+			case 3135: /* lost contact */
+			case 12153: /* TNS: not connected */
+			case 27146: /* fatal or instance terminated */
+			case 28511: /* Lost RPC */
+			return true;
+		}
+		return false;
+	}
+	
 	// returns true or false
 	function _close()
 	{
@@ -1247,12 +1295,14 @@ SELECT /*+ RULE */ distinct b.column_name
 			return  "'".str_replace("'",$this->replaceQuote,$s)."'";
 		}
 		
-		// undo magic quotes for "
-		$s = str_replace('\\"','"',$s);
-		
-		$s = str_replace('\\\\','\\',$s);
-		return "'".str_replace("\\'",$this->replaceQuote,$s)."'";
-		
+		// undo magic quotes for " unless sybase is on
+		if (!ini_get('magic_quotes_sybase')) {
+			$s = str_replace('\\"','"',$s);
+			$s = str_replace('\\\\','\\',$s);
+			return "'".str_replace("\\'",$this->replaceQuote,$s)."'";
+		} else {
+			return "'".$s."'";
+		}
 	}
 	
 }
@@ -1510,7 +1560,7 @@ class ADORecordset_oci8 extends ADORecordSet {
 		case 'NCHAR':
 		case 'NVARCHAR':
 		case 'NVARCHAR2':
-				 if (isset($this) && $len <= $this->blobSize) return 'C';
+				 if ($len <= $this->blobSize) return 'C';
 		
 		case 'NCLOB':
 		case 'LONG':
@@ -1563,4 +1613,4 @@ class ADORecordSet_ext_oci8 extends ADORecordSet_oci8 {
 		return adodb_movenext($this);
 	}
 }
-?>
+?>
\ No newline at end of file
diff --git a/third_party/adodb/drivers/adodb-oci805.inc.php b/third_party/adodb/drivers/adodb-oci805.inc.php
index b1c75b1..3051872 100644
--- a/third_party/adodb/drivers/adodb-oci805.inc.php
+++ b/third_party/adodb/drivers/adodb-oci805.inc.php
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V5.04a 25 Mar 2008  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V5.06 16 Oct 2008  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
diff --git a/third_party/adodb/drivers/adodb-oci8po.inc.php b/third_party/adodb/drivers/adodb-oci8po.inc.php
index 33c7eee..90be872 100644
--- a/third_party/adodb/drivers/adodb-oci8po.inc.php
+++ b/third_party/adodb/drivers/adodb-oci8po.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim. All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim. All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -50,7 +50,7 @@ class ADODB_oci8po extends ADODB_oci8 {
 	}
 	
 	// emulate handling of parameters ? ?, replacing with :bind0 :bind1
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		if (is_array($inputarr)) {
 			$i = 0;
@@ -102,7 +102,8 @@ class ADORecordset_oci8po extends ADORecordset_oci8 {
 	{
 		 $fld = new ADOFieldObject;
  		 $fieldOffset += 1;
-		 $fld->name = strtolower(OCIcolumnname($this->_queryID, $fieldOffset));
+		 $fld->name = OCIcolumnname($this->_queryID, $fieldOffset);
+		 if (ADODB_ASSOC_CASE == 0) $fld->name = strtolower($fld->name);
 		 $fld->type = OCIcolumntype($this->_queryID, $fieldOffset);
 		 $fld->max_length = OCIcolumnsize($this->_queryID, $fieldOffset);
 		 if ($fld->type == 'NUMBER') {
diff --git a/third_party/adodb/drivers/adodb-odbc.inc.php b/third_party/adodb/drivers/adodb-odbc.inc.php
index 3809992..19a0e96 100644
--- a/third_party/adodb/drivers/adodb-odbc.inc.php
+++ b/third_party/adodb/drivers/adodb-odbc.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -370,7 +370,7 @@ See http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/od
 		}
 	}
 	
-	function MetaColumns($table)
+	function MetaColumns($table, $normalize=true)
 	{
 	global $ADODB_FETCH_MODE;
 	
diff --git a/third_party/adodb/drivers/adodb-odbc_db2.inc.php b/third_party/adodb/drivers/adodb-odbc_db2.inc.php
index 3a3449f..b12be03 100644
--- a/third_party/adodb/drivers/adodb-odbc_db2.inc.php
+++ b/third_party/adodb/drivers/adodb-odbc_db2.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -134,10 +134,10 @@ class ADODB_ODBC_DB2 extends ADODB_odbc {
 		return $this->GetOne($this->identitySQL);
 	}
 	
-	function RowLock($tables,$where,$flds='1 as ignore')
+	function RowLock($tables,$where,$col='1 as ignore')
 	{
 		if ($this->_autocommit) $this->BeginTrans();
-		return $this->GetOne("select $flds from $tables where $where for update");
+		return $this->GetOne("select $col from $tables where $where for update");
 	}
 	
 	function MetaTables($ttype=false,$showSchema=false, $qtable="%", $qschema="%")
diff --git a/third_party/adodb/drivers/adodb-odbc_mssql.inc.php b/third_party/adodb/drivers/adodb-odbc_mssql.inc.php
index 5754ee0..c8e261b 100644
--- a/third_party/adodb/drivers/adodb-odbc_mssql.inc.php
+++ b/third_party/adodb/drivers/adodb-odbc_mssql.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -130,14 +130,14 @@ order by constraint_name, referenced_table_name, keyno";
 		return $ret;
 	}
 	
-	function MetaColumns($table)
+	function MetaColumns($table, $normalize=true)
 	{
 		$arr = ADOConnection::MetaColumns($table);
 		return $arr;
 	}
 	
 	
-	function MetaIndexes($table,$primary=false)
+	function MetaIndexes($table,$primary=false, $owner=false)
 	{
 		$table = $this->qstr($table);
 
@@ -177,7 +177,7 @@ order by constraint_name, referenced_table_name, keyno";
         return $indexes;
 	}
 	
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		if (is_string($sql)) $sql = str_replace('||','+',$sql);
 		return ADODB_odbc::_query($sql,$inputarr);
diff --git a/third_party/adodb/drivers/adodb-odbc_oracle.inc.php b/third_party/adodb/drivers/adodb-odbc_oracle.inc.php
index 6f2bd5b..9d2d527 100644
--- a/third_party/adodb/drivers/adodb-odbc_oracle.inc.php
+++ b/third_party/adodb/drivers/adodb-odbc_oracle.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -50,7 +50,7 @@ class  ADODB_odbc_oracle extends ADODB_odbc {
 		return $arr2;
 	}
 	
-	function MetaColumns($table) 
+	function MetaColumns($table, $normalize=true) 
 	{
 	global $ADODB_FETCH_MODE;
 	
diff --git a/third_party/adodb/drivers/adodb-odbtp.inc.php b/third_party/adodb/drivers/adodb-odbtp.inc.php
index e9fe830..299bf70 100644
--- a/third_party/adodb/drivers/adodb-odbtp.inc.php
+++ b/third_party/adodb/drivers/adodb-odbtp.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
   the BSD license will take precedence. See License.txt.
@@ -45,16 +45,39 @@ class ADODB_odbtp extends ADOConnection{
 
 	function ErrorMsg()
 	{
+		if ($this->_errorMsg !== false) return $this->_errorMsg;
 		if (empty($this->_connectionID)) return @odbtp_last_error();
 		return @odbtp_last_error($this->_connectionID);
 	}
 
 	function ErrorNo()
 	{
+		if ($this->_errorCode !== false) return $this->_errorCode;
 		if (empty($this->_connectionID)) return @odbtp_last_error_state();
 			return @odbtp_last_error_state($this->_connectionID);
 	}
-
+/*
+	function DBDate($d,$isfld=false)
+	{
+		if (empty($d) && $d !== 0) return 'null';
+		if ($isfld) return "convert(date, $d, 120)";
+		
+		if (is_string($d)) $d = ADORecordSet::UnixDate($d);
+		$d = adodb_date($this->fmtDate,$d);
+		return "convert(date, $d, 120)"; 
+	}
+	
+	function DBTimeStamp($d,$isfld=false)
+	{
+		if (empty($d) && $d !== 0) return 'null';
+		if ($isfld) return "convert(datetime, $d, 120)";
+		
+		if (is_string($d)) $d = ADORecordSet::UnixDate($d);
+		$d = adodb_date($this->fmtDate,$d);
+		return "convert(datetime, $d, 120)"; 
+	}
+*/
+	
 	function _insertid()
 	{
 	// SCOPE_IDENTITY()
@@ -437,6 +460,10 @@ class ADODB_odbtp extends ADOConnection{
 	function Prepare($sql)
 	{
 		if (! $this->_bindInputArray) return $sql; // no binding
+		
+        $this->_errorMsg = false;
+		$this->_errorCode = false;
+		
 		$stmt = @odbtp_prepare($sql,$this->_connectionID);
 		if (!$stmt) {
 		//	print "Prepare Error for ($sql) ".$this->ErrorMsg()."<br>";
@@ -449,6 +476,9 @@ class ADODB_odbtp extends ADOConnection{
 	{
 		if (!$this->_canPrepareSP) return $sql; // Can't prepare procedures
 
+        $this->_errorMsg = false;
+		$this->_errorCode = false;
+		
 		$stmt = @odbtp_prepare_proc($sql,$this->_connectionID);
 		if (!$stmt) return false;
 		return array($sql,$stmt);
@@ -511,6 +541,56 @@ class ADODB_odbtp extends ADOConnection{
 		return @odbtp_execute( $stmt ) != false;
 	}
 
+	function MetaIndexes($table,$primary=false, $owner=false)
+	{
+		switch ( $this->odbc_driver) {
+			case ODB_DRIVER_MSSQL:
+				return $this->MetaIndexes_mssql($table, $primary);
+			default:
+				return array();
+		}
+	}
+	
+	function MetaIndexes_mssql($table,$primary=false)
+	{
+		$table = strtolower($this->qstr($table));
+
+		$sql = "SELECT i.name AS ind_name, C.name AS col_name, USER_NAME(O.uid) AS Owner, c.colid, k.Keyno, 
+			CASE WHEN I.indid BETWEEN 1 AND 254 AND (I.status & 2048 = 2048 OR I.Status = 16402 AND O.XType = 'V') THEN 1 ELSE 0 END AS IsPK,
+			CASE WHEN I.status & 2 = 2 THEN 1 ELSE 0 END AS IsUnique
+			FROM dbo.sysobjects o INNER JOIN dbo.sysindexes I ON o.id = i.id 
+			INNER JOIN dbo.sysindexkeys K ON I.id = K.id AND I.Indid = K.Indid 
+			INNER JOIN dbo.syscolumns c ON K.id = C.id AND K.colid = C.Colid
+			WHERE LEFT(i.name, 8) <> '_WA_Sys_' AND o.status >= 0 AND lower(O.Name) = $table
+			ORDER BY O.name, I.Name, K.keyno";
+
+		global $ADODB_FETCH_MODE;
+		$save = $ADODB_FETCH_MODE;
+        $ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+        if ($this->fetchMode !== FALSE) {
+        	$savem = $this->SetFetchMode(FALSE);
+        }
+        
+        $rs = $this->Execute($sql);
+        if (isset($savem)) {
+        	$this->SetFetchMode($savem);
+        }
+        $ADODB_FETCH_MODE = $save;
+
+        if (!is_object($rs)) {
+        	return FALSE;
+        }
+
+		$indexes = array();
+		while ($row = $rs->FetchRow()) {
+			if ($primary && !$row[5]) continue;
+			
+            $indexes[$row[0]]['unique'] = $row[6];
+            $indexes[$row[0]]['columns'][] = $row[1];
+    	}
+        return $indexes;
+	}
+	
 	function IfNull( $field, $ifNull )
 	{
 		switch( $this->odbc_driver ) {
@@ -526,6 +606,9 @@ class ADODB_odbtp extends ADOConnection{
 	{
 	global $php_errormsg;
 	
+        $this->_errorMsg = false;
+		$this->_errorCode = false;
+		
  		if ($inputarr) {
 			if (is_array($sql)) {
 				$stmtid = $sql[1];
@@ -537,10 +620,20 @@ class ADODB_odbtp extends ADOConnection{
 				}
 			}
 			$num_params = @odbtp_num_params( $stmtid );
+			/*
 			for( $param = 1; $param <= $num_params; $param++ ) {
 				@odbtp_input( $stmtid, $param );
 				@odbtp_set( $stmtid, $param, $inputarr[$param-1] );
+			}*/
+			
+			$param = 1;
+			foreach($inputarr as $v) {
+				@odbtp_input( $stmtid, $param );
+				@odbtp_set( $stmtid, $param, $v );
+				$param += 1;
+				if ($param > $num_params) break;
 			}
+			
 			if (!@odbtp_execute($stmtid) ) {
 				return false;
 			}
diff --git a/third_party/adodb/drivers/adodb-odbtp_unicode.inc.php b/third_party/adodb/drivers/adodb-odbtp_unicode.inc.php
index 5af24c0..0e2e676 100644
--- a/third_party/adodb/drivers/adodb-odbtp_unicode.inc.php
+++ b/third_party/adodb/drivers/adodb-odbtp_unicode.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-	V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+	V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
   the BSD license will take precedence. See License.txt.
diff --git a/third_party/adodb/drivers/adodb-oracle.inc.php b/third_party/adodb/drivers/adodb-oracle.inc.php
index addc549..b873ee0 100644
--- a/third_party/adodb/drivers/adodb-oracle.inc.php
+++ b/third_party/adodb/drivers/adodb-oracle.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -35,15 +35,19 @@ class ADODB_oracle extends ADOConnection {
 	function DBDate($d)
 	{
 		if (is_string($d)) $d = ADORecordSet::UnixDate($d);
-		return 'TO_DATE('.adodb_date($this->fmtDate,$d).",'YYYY-MM-DD')";
+		if (is_object($d)) $ds = $d->format($this->fmtDate);
+		else $ds = adodb_date($this->fmtDate,$d);
+		return 'TO_DATE('.$ds.",'YYYY-MM-DD')";
 	}
 	
 	// format and return date string in database timestamp format
 	function DBTimeStamp($ts)
 	{
 
-		if (is_string($ts)) $d = ADORecordSet::UnixTimeStamp($ts);
-		return 'TO_DATE('.adodb_date($this->fmtTimeStamp,$ts).",'RRRR-MM-DD, HH:MI:SS AM')";
+		if (is_string($ts)) $ts = ADORecordSet::UnixTimeStamp($ts);
+		if (is_object($ts)) $ds = $ts->format($this->fmtDate);
+		else $ds = adodb_date($this->fmtTimeStamp,$ts);
+		return 'TO_DATE('.$ds.",'RRRR-MM-DD, HH:MI:SS AM')";
 	}
 	
 	
@@ -286,9 +290,9 @@ class ADORecordset_oracle extends ADORecordSet {
    function _fetch($ignore_fields=false) {
 // should remove call by reference, but ora_fetch_into requires it in 4.0.3pl1
 		if ($this->fetchMode & ADODB_FETCH_ASSOC)
-			return @ora_fetch_into($this->_queryID,&$this->fields,ORA_FETCHINTO_NULLS|ORA_FETCHINTO_ASSOC);
+			return @ora_fetch_into($this->_queryID,$this->fields,ORA_FETCHINTO_NULLS|ORA_FETCHINTO_ASSOC);
    		else 
-			return @ora_fetch_into($this->_queryID,&$this->fields,ORA_FETCHINTO_NULLS);
+			return @ora_fetch_into($this->_queryID,$this->fields,ORA_FETCHINTO_NULLS);
    }
 
    /*		close() only needs to be called if you are worried about using too much memory while your script
diff --git a/third_party/adodb/drivers/adodb-pdo.inc.php b/third_party/adodb/drivers/adodb-pdo.inc.php
index f7ee6d0..d88456f 100644
--- a/third_party/adodb/drivers/adodb-pdo.inc.php
+++ b/third_party/adodb/drivers/adodb-pdo.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -158,6 +158,7 @@ class ADODB_pdo extends ADOConnection {
 			case 'mysql':
 			case 'pgsql':
 			case 'mssql':
+			case 'sqlite':
 				include_once(ADODB_DIR.'/drivers/adodb-pdo_'.$this->dsnType.'.inc.php');
 				break;
 			}
@@ -174,6 +175,15 @@ class ADODB_pdo extends ADOConnection {
 		return false;
 	}
 	
+	function Concat() 
+	{
+		$args = func_get_args();
+		if(method_exists($this->_driver, 'Concat')) 
+			return call_user_func_array(array($this->_driver, 'Concat'), $args); 
+		
+		return call_user_func_array(array($this,'parent::Concat'), $args); 
+	}
+	
 	// returns true or false
 	function _pconnect($argDSN, $argUsername, $argPassword, $argDatabasename)
 	{
@@ -216,6 +226,10 @@ class ADODB_pdo extends ADOConnection {
 		else $obj->bindParam($name, $var);
 	}
 	
+	function OffsetDate($dayFraction,$date=false)
+    {   
+        return $this->_driver->OffsetDate($dayFraction,$date);
+    }
 	
 	function ErrorMsg()
 	{
@@ -248,8 +262,19 @@ class ADODB_pdo extends ADOConnection {
 		return $err;
 	}
 
+	function SetTransactionMode($transaction_mode) 
+	{
+		if(method_exists($this->_driver, 'SetTransactionMode')) 
+			return $this->_driver->SetTransactionMode($transaction_mode); 
+		
+		return parent::SetTransactionMode($seqname); 
+	}
+
 	function BeginTrans()
 	{	
+		if(method_exists($this->_driver, 'BeginTrans')) 
+			return $this->_driver->BeginTrans(); 
+		
 		if (!$this->hasTransactions) return false;
 		if ($this->transOff) return true; 
 		$this->transCnt += 1;
@@ -260,6 +285,9 @@ class ADODB_pdo extends ADOConnection {
 	
 	function CommitTrans($ok=true) 
 	{ 
+		if(method_exists($this->_driver, 'CommitTrans')) 
+			return $this->_driver->CommitTrans($ok); 
+		
 		if (!$this->hasTransactions) return false;
 		if ($this->transOff) return true; 
 		if (!$ok) return $this->RollbackTrans();
@@ -273,6 +301,9 @@ class ADODB_pdo extends ADOConnection {
 	
 	function RollbackTrans()
 	{
+		if(method_exists($this->_driver, 'RollbackTrans')) 
+			return $this->_driver->RollbackTrans(); 
+		
 		if (!$this->hasTransactions) return false;
 		if ($this->transOff) return true; 
 		if ($this->transCnt) $this->transCnt -= 1;
@@ -299,6 +330,30 @@ class ADODB_pdo extends ADOConnection {
 		return $obj;
 	}
 	
+	function CreateSequence($seqname='adodbseq',$startID=1)
+	{
+		if(method_exists($this->_driver, 'CreateSequence')) 
+			return $this->_driver->CreateSequence($seqname, $startID); 
+		
+		return parent::CreateSequence($seqname, $startID); 
+	}
+	
+	function DropSequence($seqname='adodbseq')
+	{
+		if(method_exists($this->_driver, 'DropSequence')) 
+			return $this->_driver->DropSequence($seqname); 
+		
+		return parent::DropSequence($seqname); 
+	}
+
+	function GenID($seqname='adodbseq',$startID=1)
+	{
+		if(method_exists($this->_driver, 'GenID')) 
+			return $this->_driver->GenID($seqname, $startID); 
+		
+		return parent::GenID($seqname, $startID); 
+	}
+
 	
 	/* returns queryID or false */
 	function _query($sql,$inputarr=false) 
diff --git a/third_party/adodb/drivers/adodb-pdo_mssql.inc.php b/third_party/adodb/drivers/adodb-pdo_mssql.inc.php
index a683094..a83ddfb 100644
--- a/third_party/adodb/drivers/adodb-pdo_mssql.inc.php
+++ b/third_party/adodb/drivers/adodb-pdo_mssql.inc.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -47,12 +47,12 @@ class ADODB_pdo_mssql extends ADODB_pdo {
 		$this->Execute("SET TRANSACTION ".$transaction_mode);
 	}
 	
-	function MetaTables()
+	function MetaTables($ttype=false,$showSchema=false,$mask=false) 
 	{
 		return false;
 	}
 	
-	function MetaColumns()
+	function MetaColumns($table,$normalize=true)
 	{
 		return false;
 	}
diff --git a/third_party/adodb/drivers/adodb-pdo_mysql.inc.php b/third_party/adodb/drivers/adodb-pdo_mysql.inc.php
index 70b73b0..c650726 100644
--- a/third_party/adodb/drivers/adodb-pdo_mysql.inc.php
+++ b/third_party/adodb/drivers/adodb-pdo_mysql.inc.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -18,14 +18,14 @@ class ADODB_pdo_mysql extends ADODB_pdo {
 	var $hasGenID = true;
 	var $_genIDSQL = "update %s set id=LAST_INSERT_ID(id+1);";
 	var $_dropSeqSQL = "drop table %s";
-
+	var $fmtTimeStamp = "'Y-m-d, H:i:s'";
 	var $nameQuote = '`';
 
 	function _init($parentDriver)
 	{
 	
 		$parentDriver->hasTransactions = false;
-		$parentDriver->_bindInputArray = false;
+		#$parentDriver->_bindInputArray = false;
 		$parentDriver->hasInsertID = true;
 		$parentDriver->_connectionID->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY,true);
 	}
@@ -41,6 +41,16 @@ class ADODB_pdo_mysql extends ADODB_pdo {
 //		return "from_unixtime(unix_timestamp($date)+$fraction)";
 	}
 	
+	function Concat() 
+	{	
+		$s = "";
+		$arr = func_get_args();
+
+		// suggestion by andrew005#mnogo.ru
+		$s = implode(',',$arr);
+		if (strlen($s) > 0) return "CONCAT($s)"; return ''; 
+	}
+	
 	function ServerInfo()
 	{
 		$arr['description'] = ADOConnection::GetOne("select version()");
@@ -76,7 +86,7 @@ class ADODB_pdo_mysql extends ADODB_pdo {
 		$this->Execute("SET SESSION TRANSACTION ".$transaction_mode);
 	}
 	
- 	function MetaColumns($table) 
+ 	function MetaColumns($table,$normalize=true)
 	{
 		$this->_findschema($table,$schema);
 		if ($schema) {
diff --git a/third_party/adodb/drivers/adodb-pdo_oci.inc.php b/third_party/adodb/drivers/adodb-pdo_oci.inc.php
index b5f5868..b16fdef 100644
--- a/third_party/adodb/drivers/adodb-pdo_oci.inc.php
+++ b/third_party/adodb/drivers/adodb-pdo_oci.inc.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -47,7 +47,7 @@ class ADODB_pdo_oci extends ADODB_pdo_base {
 		return $ret;
 	}
 	
-	function MetaColumns($table) 
+	function MetaColumns($table,$normalize=true)
 	{
 	global $ADODB_FETCH_MODE;
 	
diff --git a/third_party/adodb/drivers/adodb-pdo_pgsql.inc.php b/third_party/adodb/drivers/adodb-pdo_pgsql.inc.php
index 1bf137f..a7e6462 100644
--- a/third_party/adodb/drivers/adodb-pdo_pgsql.inc.php
+++ b/third_party/adodb/drivers/adodb-pdo_pgsql.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/drivers/adodb-pdo_sqlite.inc.php b/third_party/adodb/drivers/adodb-pdo_sqlite.inc.php
new file mode 100644
index 0000000..6218ff9
--- /dev/null
+++ b/third_party/adodb/drivers/adodb-pdo_sqlite.inc.php
@@ -0,0 +1,203 @@
+<?php
+
+/* 
+ V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence. See License.txt. 
+  Set tabs to 4 for best viewing.
+  
+  Latest version is available at http://adodb.sourceforge.net
+  
+  Thanks Diogo Toscano (diogo#scriptcase.net) for the code.
+	And also Sid Dunayer [sdunayer#interserv.com] for extensive fixes.
+*/
+
+class ADODB_pdo_sqlite extends ADODB_pdo {
+	var $metaTablesSQL   = "SELECT name FROM sqlite_master WHERE type='table'";
+	var $sysDate         = 'current_date';
+	var $sysTimeStamp    = 'current_timestamp';
+	var $nameQuote       = '`';
+	var $replaceQuote    = "''";
+	var $hasGenID        = true;
+	var $_genIDSQL       = "UPDATE %s SET id=id+1 WHERE id=%s";
+	var $_genSeqSQL      = "CREATE TABLE %s (id integer)";
+	var $_genSeqCountSQL = 'SELECT COUNT(*) FROM %s';
+	var $_genSeq2SQL     = 'INSERT INTO %s VALUES(%s)';
+	var $_dropSeqSQL     = 'DROP TABLE %s';
+	var $concat_operator = '||';
+    var $pdoDriver       = false;
+	var $random='abs(random())';
+    
+	function _init($parentDriver)
+	{
+		$this->pdoDriver = $parentDriver;
+		$parentDriver->_bindInputArray = true;
+		$parentDriver->hasTransactions = false; // // should be set to false because of PDO SQLite driver not supporting changing autocommit mode
+		$parentDriver->hasInsertID = true;
+	}
+
+	function ServerInfo()
+	{
+		$parent = $this->pdoDriver;
+		@($ver = array_pop($parent->GetCol("SELECT sqlite_version()")));
+		@($enc = array_pop($parent->GetCol("PRAGMA encoding")));
+
+		$arr['version']     = $ver;
+		$arr['description'] = 'SQLite ';
+		$arr['encoding']    = $enc;
+
+		return $arr;
+	}
+	
+	function SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0) 
+	{
+		$parent = $this->pdoDriver;
+		$offsetStr = ($offset >= 0) ? " OFFSET $offset" : '';
+		$limitStr  = ($nrows >= 0)  ? " LIMIT $nrows" : ($offset >= 0 ? ' LIMIT 999999999' : '');
+	  	if ($secs2cache)
+	   		$rs = $parent->CacheExecute($secs2cache,$sql."$limitStr$offsetStr",$inputarr);
+	  	else
+	   		$rs = $parent->Execute($sql."$limitStr$offsetStr",$inputarr);
+
+		return $rs;
+	}
+
+	function GenID($seq='adodbseq',$start=1)
+	{
+		$parent = $this->pdoDriver;
+		// if you have to modify the parameter below, your database is overloaded,
+		// or you need to implement generation of id's yourself!
+		$MAXLOOPS = 100;
+		while (--$MAXLOOPS>=0) {
+			@($num = array_pop($parent->GetCol("SELECT id FROM {$seq}")));
+			if ($num === false || !is_numeric($num)) {
+				@$parent->Execute(sprintf($this->_genSeqSQL ,$seq));
+				$start -= 1;
+				$num = '0';
+				$cnt = $parent->GetOne(sprintf($this->_genSeqCountSQL,$seq));
+				if (!$cnt) {
+					$ok = $parent->Execute(sprintf($this->_genSeq2SQL,$seq,$start));
+				}
+				if (!$ok) return false;
+			}
+			$parent->Execute(sprintf($this->_genIDSQL,$seq,$num));
+
+			if ($parent->affected_rows() > 0) {
+                	        $num += 1;
+                		$parent->genID = intval($num);
+                		return intval($num);
+			}
+		}
+		if ($fn = $parent->raiseErrorFn) {
+			$fn($parent->databaseType,'GENID',-32000,"Unable to generate unique id after $MAXLOOPS attempts",$seq,$num);
+		}
+		return false;
+	}
+
+	function CreateSequence($seqname='adodbseq',$start=1)
+	{
+		$parent = $this->pdoDriver;
+		$ok = $parent->Execute(sprintf($this->_genSeqSQL,$seqname));
+		if (!$ok) return false;
+		$start -= 1;
+		return $parent->Execute("insert into $seqname values($start)");
+	}
+
+	function SetTransactionMode($transaction_mode)
+	{
+		$parent = $this->pdoDriver;
+		$parent->_transmode = strtoupper($transaction_mode);
+	}
+
+	function BeginTrans()
+	{	
+		$parent = $this->pdoDriver;
+		if ($parent->transOff) return true; 
+		$parent->transCnt += 1;
+		$parent->_autocommit = false;
+		return $parent->Execute("BEGIN {$parent->_transmode}");
+	}
+	
+	function CommitTrans($ok=true) 
+	{ 
+		$parent = $this->pdoDriver;
+		if ($parent->transOff) return true; 
+		if (!$ok) return $parent->RollbackTrans();
+		if ($parent->transCnt) $parent->transCnt -= 1;
+		$parent->_autocommit = true;
+		
+		$ret = $parent->Execute('COMMIT');
+		return $ret;
+	}
+	
+	function RollbackTrans()
+	{
+		$parent = $this->pdoDriver;
+		if ($parent->transOff) return true; 
+		if ($parent->transCnt) $parent->transCnt -= 1;
+		$parent->_autocommit = true;
+		
+		$ret = $parent->Execute('ROLLBACK');
+		return $ret;
+	}
+
+
+    // mark newnham
+	function MetaColumns($tab,$normalize=true)
+	{
+	  global $ADODB_FETCH_MODE;
+
+	  $parent = $this->pdoDriver;
+	  $false = false;
+	  $save = $ADODB_FETCH_MODE;
+	  $ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
+	  if ($parent->fetchMode !== false) $savem = $parent->SetFetchMode(false);
+	  $rs = $parent->Execute("PRAGMA table_info('$tab')");
+	  if (isset($savem)) $parent->SetFetchMode($savem);
+	  if (!$rs) {
+	    $ADODB_FETCH_MODE = $save; 
+	    return $false;
+	  }
+	  $arr = array();
+	  while ($r = $rs->FetchRow()) {
+	    $type = explode('(',$r['type']);
+	    $size = '';
+	    if (sizeof($type)==2)
+	    $size = trim($type[1],')');
+	    $fn = strtoupper($r['name']);
+	    $fld = new ADOFieldObject;
+	    $fld->name = $r['name'];
+	    $fld->type = $type[0];
+	    $fld->max_length = $size;
+	    $fld->not_null = $r['notnull'];
+	    $fld->primary_key = $r['pk'];
+	    $fld->default_value = $r['dflt_value'];
+	    $fld->scale = 0;
+	    if ($save == ADODB_FETCH_NUM) $arr[] = $fld;	
+	    else $arr[strtoupper($fld->name)] = $fld;
+	  }
+	  $rs->Close();
+	  $ADODB_FETCH_MODE = $save;
+	  return $arr;
+	}
+
+	function MetaTables($ttype=false,$showSchema=false,$mask=false)
+	{
+		$parent = $this->pdoDriver;
+		
+		if ($mask) {
+			$save = $this->metaTablesSQL;
+			$mask = $this->qstr(strtoupper($mask));
+			$this->metaTablesSQL .= " AND name LIKE $mask";
+		}
+		
+		$ret = $parent->GetCol($this->metaTablesSQL);
+		
+		if ($mask) {
+			$this->metaTablesSQL = $save;
+		}
+		return $ret;
+   }
+}
+?>
\ No newline at end of file
diff --git a/third_party/adodb/drivers/adodb-postgres.inc.php b/third_party/adodb/drivers/adodb-postgres.inc.php
index 916ad98..b4e69b6 100644
--- a/third_party/adodb/drivers/adodb-postgres.inc.php
+++ b/third_party/adodb/drivers/adodb-postgres.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
- V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/drivers/adodb-postgres64.inc.php b/third_party/adodb/drivers/adodb-postgres64.inc.php
index c0e8c76..82fc328 100644
--- a/third_party/adodb/drivers/adodb-postgres64.inc.php
+++ b/third_party/adodb/drivers/adodb-postgres64.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
- V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -104,7 +104,8 @@ WHERE relkind in ('r','v') AND (c.relname='%s' or c.relname = lower('%s'))
 	var $random = 'random()';		/// random function
 	var $autoRollback = true; // apparently pgsql does not autorollback properly before php 4.3.4
 							// http://bugs.php.net/bug.php?id=25404
-							
+	
+	var $uniqueIisR = true;
 	var $_bindInputArray = false; // requires postgresql 7.3+ and ability to modify database
 	var $disableBlobs = false; // set to true to disable blob checking, resulting in 2-5% improvement in performance.
 	
@@ -177,10 +178,10 @@ a different OID if a database must be reloaded. */
 		return @pg_Exec($this->_connectionID, "begin ".$this->_transmode);
 	}
 	
-	function RowLock($tables,$where,$flds='1 as ignore') 
+	function RowLock($tables,$where,$col='1 as ignore') 
 	{
 		if (!$this->transCnt) $this->BeginTrans();
-		return $this->GetOne("select $flds from $tables where $where for update");
+		return $this->GetOne("select $col from $tables where $where for update");
 	}
 
 	// returns true/false. 
@@ -236,6 +237,8 @@ select viewname,'V' from pg_views where viewname like $mask";
 	// if magic quotes disabled, use pg_escape_string()
 	function qstr($s,$magic_quotes=false)
 	{
+		if (is_bool($s)) return $s ? 'true' : 'false';
+		 
 		if (!$magic_quotes) {
 			if (ADODB_PHPVER >= 0x5200) {
 				return  "'".pg_escape_string($this->_connectionID,$s)."'";
@@ -457,7 +460,10 @@ select viewname,'V' from pg_views where viewname like $mask";
 			if (10 <= $len && $len <= 12) $date = 'date '.$date;
 			else $date = 'timestamp '.$date;
 		}
-		return "($date+interval'$dayFraction days')";
+		
+		
+		return "($date+interval'".($dayFraction * 1440)." minutes')";
+		#return "($date+interval'$dayFraction days')";
 	}
 	
 
@@ -659,7 +665,7 @@ WHERE (c2.relname=\'%s\' or c2.relname=lower(\'%s\'))';
 			if (strlen($db) == 0) $db = 'template1';
 			$db = adodb_addslashes($db);
 		   	if ($str)  {
-			 	$host = split(":", $str);
+			 	$host = explode(":", $str);
 				if ($host[0]) $str = "host=".adodb_addslashes($host[0]);
 				else $str = '';
 				if (isset($host[1])) $str .= " port=$host[1]";
@@ -713,7 +719,7 @@ WHERE (c2.relname=\'%s\' or c2.relname=lower(\'%s\'))';
 	
 
 	// returns queryID or false
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		$this->_errorMsg = false;
 		if ($inputarr) {
@@ -943,6 +949,7 @@ class ADORecordSet_postgres64 extends ADORecordSet{
 	
 	function _decode($blob)
 	{
+		if ($blob === NULL) return NULL;
 		eval('$realblob="'.adodb_str_replace(array('"','$'),array('\"','\$'),$blob).'";');
 		return $realblob;	
 	}
@@ -1049,7 +1056,7 @@ class ADORecordSet_postgres64 extends ADORecordSet{
 				case 'INT4':
 				case 'INT2':
 					if (isset($fieldobj) &&
-				empty($fieldobj->primary_key) && empty($fieldobj->unique)) return 'I';
+				empty($fieldobj->primary_key) && (!$this->connection->uniqueIisR || empty($fieldobj->unique))) return 'I';
 				
 				case 'OID':
 				case 'SERIAL':
diff --git a/third_party/adodb/drivers/adodb-postgres7.inc.php b/third_party/adodb/drivers/adodb-postgres7.inc.php
index ded804e..57fb9a6 100644
--- a/third_party/adodb/drivers/adodb-postgres7.inc.php
+++ b/third_party/adodb/drivers/adodb-postgres7.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
- V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -56,10 +56,59 @@ class ADODB_postgres7 extends ADODB_postgres64 {
 	}
  	*/
 
-
-	// from  Edward Jaramilla, improved version - works on pg 7.4
+	/*
+		I discovered that the MetaForeignKeys method no longer worked for Postgres 8.3.
+		I went ahead and modified it to work for both 8.2 and 8.3. 
+		Please feel free to include this change in your next release of adodb.
+		 William Kolodny [William.Kolodny#gt-t.net]
+	*/
 	function MetaForeignKeys($table, $owner=false, $upper=false)
 	{
+	  $sql="
+	  SELECT fum.ftblname AS lookup_table, split_part(fum.rf, ')'::text, 1) AS lookup_field,
+	     fum.ltable AS dep_table, split_part(fum.lf, ')'::text, 1) AS dep_field
+	  FROM (
+	  SELECT fee.ltable, fee.ftblname, fee.consrc, split_part(fee.consrc,'('::text, 2) AS lf, 
+	    split_part(fee.consrc, '('::text, 3) AS rf
+	  FROM (
+	      SELECT foo.relname AS ltable, foo.ftblname,
+	          pg_get_constraintdef(foo.oid) AS consrc
+	      FROM (
+	          SELECT c.oid, c.conname AS name, t.relname, ft.relname AS ftblname
+	          FROM pg_constraint c 
+	          JOIN pg_class t ON (t.oid = c.conrelid) 
+	          JOIN pg_class ft ON (ft.oid = c.confrelid)
+	          JOIN pg_namespace nft ON (nft.oid = ft.relnamespace)
+	          LEFT JOIN pg_description ds ON (ds.objoid = c.oid)
+	          JOIN pg_namespace n ON (n.oid = t.relnamespace)
+	          WHERE c.contype = 'f'::\"char\"
+	          ORDER BY t.relname, n.nspname, c.conname, c.oid
+	          ) foo
+	      ) fee) fum
+	  WHERE fum.ltable='".strtolower($table)."'
+	  ORDER BY fum.ftblname, fum.ltable, split_part(fum.lf, ')'::text, 1)
+	  ";
+	  $rs = $this->Execute($sql);
+	
+	  if (!$rs || $rs->EOF) return false;
+	
+	  $a = array();
+	  while (!$rs->EOF) {
+	    if ($upper) {
+	      $a[strtoupper($rs->Fields('lookup_table'))][] = strtoupper(str_replace('"','',$rs->Fields('dep_field').'='.$rs->Fields('lookup_field')));
+	    } else {
+	      $a[$rs->Fields('lookup_table')][] = str_replace('"','',$rs->Fields('dep_field').'='.$rs->Fields('lookup_field'));
+	    }
+		$rs->MoveNext();
+	  }
+	
+	  return $a;
+	
+	}
+	
+	// from  Edward Jaramilla, improved version - works on pg 7.4
+	function _old_MetaForeignKeys($table, $owner=false, $upper=false)
+	{
 		$sql = 'SELECT t.tgargs as args
 		FROM
 		pg_trigger t,pg_class c,pg_proc p
@@ -91,7 +140,7 @@ class ADODB_postgres7 extends ADODB_postgres64 {
 		return $a;
 	}
 
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 		if (! $this->_bindInputArray) {
 			// We don't have native support for parameterized queries, so let's emulate it at the parent
diff --git a/third_party/adodb/drivers/adodb-postgres8.inc.php b/third_party/adodb/drivers/adodb-postgres8.inc.php
index 08267ec..f4bbe36 100644
--- a/third_party/adodb/drivers/adodb-postgres8.inc.php
+++ b/third_party/adodb/drivers/adodb-postgres8.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
- V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/drivers/adodb-proxy.inc.php b/third_party/adodb/drivers/adodb-proxy.inc.php
index 581d83f..f985823 100644
--- a/third_party/adodb/drivers/adodb-proxy.inc.php
+++ b/third_party/adodb/drivers/adodb-proxy.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/drivers/adodb-sapdb.inc.php b/third_party/adodb/drivers/adodb-sapdb.inc.php
index 41ad9cc..016d5fd 100644
--- a/third_party/adodb/drivers/adodb-sapdb.inc.php
+++ b/third_party/adodb/drivers/adodb-sapdb.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/drivers/adodb-sqlanywhere.inc.php b/third_party/adodb/drivers/adodb-sqlanywhere.inc.php
index dbb6e98..2229323 100644
--- a/third_party/adodb/drivers/adodb-sqlanywhere.inc.php
+++ b/third_party/adodb/drivers/adodb-sqlanywhere.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-version V5.04a 25 Mar 2008  (c) 2000-2008  John Lim (jlim#natsoft.com.my).  All rights
+version V5.06 16 Oct 2008  (c) 2000-2009  John Lim (jlim#natsoft.com).  All rights
 reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
diff --git a/third_party/adodb/drivers/adodb-sqlite.inc.php b/third_party/adodb/drivers/adodb-sqlite.inc.php
index 845b92f..79836e0 100644
--- a/third_party/adodb/drivers/adodb-sqlite.inc.php
+++ b/third_party/adodb/drivers/adodb-sqlite.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -78,14 +78,14 @@ class ADODB_sqlite extends ADOConnection {
 	}
 	
 	// mark newnham
-	function MetaColumns($tab)
+	function MetaColumns($table, $normalize=true) 
 	{
 	  global $ADODB_FETCH_MODE;
 	  $false = false;
 	  $save = $ADODB_FETCH_MODE;
 	  $ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
 	  if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
-	  $rs = $this->Execute("PRAGMA table_info('$tab')");
+	  $rs = $this->Execute("PRAGMA table_info('$table')");
 	  if (isset($savem)) $this->SetFetchMode($savem);
 	  if (!$rs) {
 	    $ADODB_FETCH_MODE = $save; 
diff --git a/third_party/adodb/drivers/adodb-sqlitepo.inc.php b/third_party/adodb/drivers/adodb-sqlitepo.inc.php
index 2555eea..79d809e 100644
--- a/third_party/adodb/drivers/adodb-sqlitepo.inc.php
+++ b/third_party/adodb/drivers/adodb-sqlitepo.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
   the BSD license will take precedence.
diff --git a/third_party/adodb/drivers/adodb-sybase.inc.php b/third_party/adodb/drivers/adodb-sybase.inc.php
index d8ba400..46bf827 100644
--- a/third_party/adodb/drivers/adodb-sybase.inc.php
+++ b/third_party/adodb/drivers/adodb-sybase.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim. All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim. All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -86,11 +86,11 @@ class ADODB_sybase extends ADOConnection {
 	}
 	
 	// http://www.isug.com/Sybase_FAQ/ASE/section6.1.html#6.1.4
-	function RowLock($tables,$where,$flds='top 1 null as ignore') 
+	function RowLock($tables,$where,$col='top 1 null as ignore') 
 	{
 		if (!$this->_hastrans) $this->BeginTrans();
 		$tables = str_replace(',',' HOLDLOCK,',$tables);
-		return $this->GetOne("select $flds from $tables HOLDLOCK where $where");
+		return $this->GetOne("select $col from $tables HOLDLOCK where $where");
 		
 	}	
 		
@@ -123,6 +123,12 @@ class ADODB_sybase extends ADOConnection {
 	{
 		if (!function_exists('sybase_connect')) return null;
 		
+		if ($this->charSet) {
+ 			$this->_connectionID = sybase_connect($argHostname,$argUsername,$argPassword, $this->charSet);
+       	} else {
+       		$this->_connectionID = sybase_connect($argHostname,$argUsername,$argPassword);
+       	}
+
 		$this->_connectionID = sybase_connect($argHostname,$argUsername,$argPassword);
 		if ($this->_connectionID === false) return false;
 		if ($argDatabasename) return $this->SelectDB($argDatabasename);
@@ -133,14 +139,18 @@ class ADODB_sybase extends ADOConnection {
 	{
 		if (!function_exists('sybase_connect')) return null;
 		
-		$this->_connectionID = sybase_pconnect($argHostname,$argUsername,$argPassword);
+		if ($this->charSet) {
+ 			$this->_connectionID = sybase_pconnect($argHostname,$argUsername,$argPassword, $this->charSet);
+       	} else {
+       		$this->_connectionID = sybase_pconnect($argHostname,$argUsername,$argPassword);
+       	}
 		if ($this->_connectionID === false) return false;
 		if ($argDatabasename) return $this->SelectDB($argDatabasename);
 		return true;	
 	}
 	
 	// returns query ID if successful, otherwise false
-	function _query($sql,$inputarr)
+	function _query($sql,$inputarr=false)
 	{
 	global $ADODB_COUNTRECS;
 	
@@ -177,12 +187,12 @@ class ADODB_sybase extends ADOConnection {
 		return @sybase_close($this->_connectionID);
 	}
 	
-	function UnixDate($v)
+	static function UnixDate($v)
 	{
 		return ADORecordSet_array_sybase::UnixDate($v);
 	}
 	
-	function UnixTimeStamp($v)
+	static function UnixTimeStamp($v)
 	{
 		return ADORecordSet_array_sybase::UnixTimeStamp($v);
 	}	
@@ -211,7 +221,7 @@ class ADODB_sybase extends ADOConnection {
                 $s .= "convert(char(3),$col,0)";
                 break;
             case 'm':
-                $s .= "replace(str(month($col),2),' ','0')";
+                $s .= "str_replace(str(month($col),2),' ','0')";
                 break;
             case 'Q':
             case 'q':
@@ -219,21 +229,21 @@ class ADODB_sybase extends ADOConnection {
                 break;
             case 'D':
             case 'd':
-                $s .= "replace(str(datepart(dd,$col),2),' ','0')";
+                $s .= "str_replace(str(datepart(dd,$col),2),' ','0')";
                 break;
             case 'h':
                 $s .= "substring(convert(char(14),$col,0),13,2)";
                 break;
 
             case 'H':
-                $s .= "replace(str(datepart(hh,$col),2),' ','0')";
+                $s .= "str_replace(str(datepart(hh,$col),2),' ','0')";
                 break;
 
             case 'i':
-                $s .= "replace(str(datepart(mi,$col),2),' ','0')";
+                $s .= "str_replace(str(datepart(mi,$col),2),' ','0')";
                 break;
             case 's':
-                $s .= "replace(str(datepart(ss,$col),2),' ','0')";
+                $s .= "str_replace(str(datepart(ss,$col),2),' ','0')";
                 break;
             case 'a':
             case 'A':
@@ -353,12 +363,12 @@ class ADORecordset_sybase extends ADORecordSet {
 	}
 	
 	// sybase/mssql uses a default date like Dec 30 2000 12:00AM
-	function UnixDate($v)
+	static function UnixDate($v)
 	{
 		return ADORecordSet_array_sybase::UnixDate($v);
 	}
 	
-	function UnixTimeStamp($v)
+	static function UnixTimeStamp($v)
 	{
 		return ADORecordSet_array_sybase::UnixTimeStamp($v);
 	}
@@ -371,12 +381,12 @@ class ADORecordSet_array_sybase extends ADORecordSet_array {
 	}
 	
 		// sybase/mssql uses a default date like Dec 30 2000 12:00AM
-	function UnixDate($v)
+	static function UnixDate($v)
 	{
 	global $ADODB_sybase_mths;
 	
 		//Dec 30 2000 12:00AM
-		if (!ereg( "([A-Za-z]{3})[-/\. ]+([0-9]{1,2})[-/\. ]+([0-9]{4})"
+		if (!preg_match( "/([A-Za-z]{3})[-/\. ]+([0-9]{1,2})[-/\. ]+([0-9]{4})/"
 			,$v, $rr)) return parent::UnixDate($v);
 			
 		if ($rr[3] <= TIMESTAMP_FIRST_YEAR) return 0;
@@ -388,12 +398,12 @@ class ADORecordSet_array_sybase extends ADORecordSet_array {
 		return  mktime(0,0,0,$themth,$rr[2],$rr[3]);
 	}
 	
-	function UnixTimeStamp($v)
+	static function UnixTimeStamp($v)
 	{
 	global $ADODB_sybase_mths;
 		//11.02.2001 Toni Tunkkari toni.tunkkari@finebyte.com
 		//Changed [0-9] to [0-9 ] in day conversion
-		if (!ereg( "([A-Za-z]{3})[-/\. ]([0-9 ]{1,2})[-/\. ]([0-9]{4}) +([0-9]{1,2}):([0-9]{1,2}) *([apAP]{0,1})"
+		if (!preg_match( "/([A-Za-z]{3})[-/\. ]([0-9 ]{1,2})[-/\. ]([0-9]{4}) +([0-9]{1,2}):([0-9]{1,2}) *([apAP]{0,1})/"
 			,$v, $rr)) return parent::UnixTimeStamp($v);
 		if ($rr[3] <= TIMESTAMP_FIRST_YEAR) return 0;
 		
diff --git a/third_party/adodb/drivers/adodb-sybase_ase.inc.php b/third_party/adodb/drivers/adodb-sybase_ase.inc.php
index 5360c2a..13f7bdd 100644
--- a/third_party/adodb/drivers/adodb-sybase_ase.inc.php
+++ b/third_party/adodb/drivers/adodb-sybase_ase.inc.php
@@ -1,6 +1,6 @@
 <?php
 /*
-  V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/drivers/adodb-vfp.inc.php b/third_party/adodb/drivers/adodb-vfp.inc.php
index 3b13aef..490a6cb 100644
--- a/third_party/adodb/drivers/adodb-vfp.inc.php
+++ b/third_party/adodb/drivers/adodb-vfp.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/lang/adodb-cn.inc.php b/third_party/adodb/lang/adodb-cn.inc.php
index 44d5f49..eb8c7de 100644
--- a/third_party/adodb/lang/adodb-cn.inc.php
+++ b/third_party/adodb/lang/adodb-cn.inc.php
@@ -1,35 +1,35 @@
-<?php
-// Chinese language file contributed by "Cuiyan (cysoft)" cysoft#php.net.
-// Encode by GB2312
-// Simplified Chinese
-$ADODB_LANG_ARRAY = array (
-			'LANG'                      => 'cn',
-            DB_ERROR                    => '',
-            DB_ERROR_ALREADY_EXISTS     => '',
-            DB_ERROR_CANNOT_CREATE      => '',
-            DB_ERROR_CANNOT_DELETE      => '',
-            DB_ERROR_CANNOT_DROP        => '',
-            DB_ERROR_CONSTRAINT         => '',
-            DB_ERROR_DIVZERO            => '0',
-            DB_ERROR_INVALID            => '',
-            DB_ERROR_INVALID_DATE       => '',
-            DB_ERROR_INVALID_NUMBER     => '',
-            DB_ERROR_MISMATCH           => '',
-            DB_ERROR_NODBSELECTED       => '',
-            DB_ERROR_NOSUCHFIELD        => '',
-            DB_ERROR_NOSUCHTABLE        => '',
-            DB_ERROR_NOT_CAPABLE        => '',
-            DB_ERROR_NOT_FOUND          => '',
-            DB_ERROR_NOT_LOCKED         => '',
-            DB_ERROR_SYNTAX             => '',
-            DB_ERROR_UNSUPPORTED        => '',
-            DB_ERROR_VALUE_COUNT_ON_ROW => '',
-            DB_ERROR_INVALID_DSN        => ' (DSN)',
-            DB_ERROR_CONNECT_FAILED     => '',
-            0	                       => '', // DB_OK
-            DB_ERROR_NEED_MORE_DATA     => '',
-            DB_ERROR_EXTENSION_NOT_FOUND=> '',
-            DB_ERROR_NOSUCHDB           => '',
-            DB_ERROR_ACCESS_VIOLATION   => ''
-);
+<?php
+// Chinese language file contributed by "Cuiyan (cysoft)" cysoft#php.net.
+// Encode by GB2312
+// Simplified Chinese
+$ADODB_LANG_ARRAY = array (
+			'LANG'                      => 'cn',
+            DB_ERROR                    => '',
+            DB_ERROR_ALREADY_EXISTS     => '',
+            DB_ERROR_CANNOT_CREATE      => '',
+            DB_ERROR_CANNOT_DELETE      => '',
+            DB_ERROR_CANNOT_DROP        => '',
+            DB_ERROR_CONSTRAINT         => '',
+            DB_ERROR_DIVZERO            => '0',
+            DB_ERROR_INVALID            => '',
+            DB_ERROR_INVALID_DATE       => '',
+            DB_ERROR_INVALID_NUMBER     => '',
+            DB_ERROR_MISMATCH           => '',
+            DB_ERROR_NODBSELECTED       => '',
+            DB_ERROR_NOSUCHFIELD        => '',
+            DB_ERROR_NOSUCHTABLE        => '',
+            DB_ERROR_NOT_CAPABLE        => '',
+            DB_ERROR_NOT_FOUND          => '',
+            DB_ERROR_NOT_LOCKED         => '',
+            DB_ERROR_SYNTAX             => '',
+            DB_ERROR_UNSUPPORTED        => '',
+            DB_ERROR_VALUE_COUNT_ON_ROW => '',
+            DB_ERROR_INVALID_DSN        => ' (DSN)',
+            DB_ERROR_CONNECT_FAILED     => '',
+            0	                       => '', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => '',
+            DB_ERROR_EXTENSION_NOT_FOUND=> '',
+            DB_ERROR_NOSUCHDB           => '',
+            DB_ERROR_ACCESS_VIOLATION   => ''
+);
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/lang/adodb-cz.inc.php b/third_party/adodb/lang/adodb-cz.inc.php
index 1f5c08a..2424c24 100644
--- a/third_party/adodb/lang/adodb-cz.inc.php
+++ b/third_party/adodb/lang/adodb-cz.inc.php
@@ -1,40 +1,40 @@
-<?php
-
-# Czech language, encoding by ISO 8859-2 charset (Iso Latin-2)
-# For convert to MS Windows use shell command:
-#    iconv -f ISO_8859-2 -t CP1250 < adodb-cz.inc.php
-# For convert to ASCII use shell command:
-#    unaccent ISO_8859-2 < adodb-cz.inc.php
-# v1.0, 19.06.2003 Kamil Jakubovic <jake@host.sk>
-
-$ADODB_LANG_ARRAY = array (
-            'LANG'                      => 'cz',
-            DB_ERROR                    => 'neznm chyba',
-            DB_ERROR_ALREADY_EXISTS     => 'ji? existuje',
-            DB_ERROR_CANNOT_CREATE      => 'nelze vytvo?it',
-            DB_ERROR_CANNOT_DELETE      => 'nelze smazat',
-            DB_ERROR_CANNOT_DROP        => 'nelze odstranit',
-            DB_ERROR_CONSTRAINT         => 'poru?en omezujc podmnky',
-            DB_ERROR_DIVZERO            => 'd?len nulou',
-            DB_ERROR_INVALID            => 'neplatn',
-            DB_ERROR_INVALID_DATE       => 'neplatn datum nebo ?as',
-            DB_ERROR_INVALID_NUMBER     => 'neplatn ?slo',
-            DB_ERROR_MISMATCH           => 'nesouhlas',
-            DB_ERROR_NODBSELECTED       => '?dn databze nen vybrna',
-            DB_ERROR_NOSUCHFIELD        => 'pole nenalezeno',
-            DB_ERROR_NOSUCHTABLE        => 'tabulka nenalezena',
-            DB_ERROR_NOT_CAPABLE        => 'nepodporovno',
-            DB_ERROR_NOT_FOUND          => 'nenalezeno',
-            DB_ERROR_NOT_LOCKED         => 'nezam?eno',
-            DB_ERROR_SYNTAX             => 'syntaktick chyba',
-            DB_ERROR_UNSUPPORTED        => 'nepodporovno',
-            DB_ERROR_VALUE_COUNT_ON_ROW => '',
-            DB_ERROR_INVALID_DSN        => 'neplatn DSN',
-            DB_ERROR_CONNECT_FAILED     => 'p?ipojen selhalo',
-            0	                        => 'bez chyb', // DB_OK
-            DB_ERROR_NEED_MORE_DATA     => 'mlo zdrojovch dat',
-            DB_ERROR_EXTENSION_NOT_FOUND=> 'roz??en nenalezeno',
-            DB_ERROR_NOSUCHDB           => 'databze neexistuje',
-            DB_ERROR_ACCESS_VIOLATION   => 'nedostate?n prva'
-);
+<?php
+
+# Czech language, encoding by ISO 8859-2 charset (Iso Latin-2)
+# For convert to MS Windows use shell command:
+#    iconv -f ISO_8859-2 -t CP1250 < adodb-cz.inc.php
+# For convert to ASCII use shell command:
+#    unaccent ISO_8859-2 < adodb-cz.inc.php
+# v1.0, 19.06.2003 Kamil Jakubovic <jake@host.sk>
+
+$ADODB_LANG_ARRAY = array (
+            'LANG'                      => 'cz',
+            DB_ERROR                    => 'neznm chyba',
+            DB_ERROR_ALREADY_EXISTS     => 'ji? existuje',
+            DB_ERROR_CANNOT_CREATE      => 'nelze vytvo?it',
+            DB_ERROR_CANNOT_DELETE      => 'nelze smazat',
+            DB_ERROR_CANNOT_DROP        => 'nelze odstranit',
+            DB_ERROR_CONSTRAINT         => 'poru?en omezujc podmnky',
+            DB_ERROR_DIVZERO            => 'd?len nulou',
+            DB_ERROR_INVALID            => 'neplatn',
+            DB_ERROR_INVALID_DATE       => 'neplatn datum nebo ?as',
+            DB_ERROR_INVALID_NUMBER     => 'neplatn ?slo',
+            DB_ERROR_MISMATCH           => 'nesouhlas',
+            DB_ERROR_NODBSELECTED       => '?dn databze nen vybrna',
+            DB_ERROR_NOSUCHFIELD        => 'pole nenalezeno',
+            DB_ERROR_NOSUCHTABLE        => 'tabulka nenalezena',
+            DB_ERROR_NOT_CAPABLE        => 'nepodporovno',
+            DB_ERROR_NOT_FOUND          => 'nenalezeno',
+            DB_ERROR_NOT_LOCKED         => 'nezam?eno',
+            DB_ERROR_SYNTAX             => 'syntaktick chyba',
+            DB_ERROR_UNSUPPORTED        => 'nepodporovno',
+            DB_ERROR_VALUE_COUNT_ON_ROW => '',
+            DB_ERROR_INVALID_DSN        => 'neplatn DSN',
+            DB_ERROR_CONNECT_FAILED     => 'p?ipojen selhalo',
+            0	                        => 'bez chyb', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => 'mlo zdrojovch dat',
+            DB_ERROR_EXTENSION_NOT_FOUND=> 'roz??en nenalezeno',
+            DB_ERROR_NOSUCHDB           => 'databze neexistuje',
+            DB_ERROR_ACCESS_VIOLATION   => 'nedostate?n prva'
+);
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/lang/adodb-de.inc.php b/third_party/adodb/lang/adodb-de.inc.php
index 44c57e9..244cb2f 100644
--- a/third_party/adodb/lang/adodb-de.inc.php
+++ b/third_party/adodb/lang/adodb-de.inc.php
@@ -1,33 +1,33 @@
-<?php
-// contributed by "Heinz Hombergs" <opn@hhombergs.de>
-$ADODB_LANG_ARRAY = array (
-			'LANG'                      => 'de',
-			DB_ERROR                    => 'Unbekannter Fehler',
-            DB_ERROR_ALREADY_EXISTS     => 'existiert bereits',
-            DB_ERROR_CANNOT_CREATE      => 'kann nicht erstellen',
-            DB_ERROR_CANNOT_DELETE      => 'kann nicht l&ouml;schen',
-            DB_ERROR_CANNOT_DROP        => 'Tabelle oder Index konnte nicht gel&ouml;scht werden',
-            DB_ERROR_CONSTRAINT         => 'Constraint Verletzung',
-            DB_ERROR_DIVZERO            => 'Division durch Null',
-            DB_ERROR_INVALID            => 'ung&uml;ltig',
-            DB_ERROR_INVALID_DATE       => 'ung&uml;ltiges Datum oder Zeit',
-            DB_ERROR_INVALID_NUMBER     => 'ung&uml;ltige Zahl',
-            DB_ERROR_MISMATCH           => 'Unvertr&auml;glichkeit',
-            DB_ERROR_NODBSELECTED       => 'keine Dantebank ausgew&auml;hlt',
-            DB_ERROR_NOSUCHFIELD        => 'Feld nicht vorhanden',
-            DB_ERROR_NOSUCHTABLE        => 'Tabelle nicht vorhanden',
-            DB_ERROR_NOT_CAPABLE        => 'Funktion nicht installiert',
-            DB_ERROR_NOT_FOUND          => 'nicht gefunden',
-            DB_ERROR_NOT_LOCKED         => 'nicht gesperrt',
-            DB_ERROR_SYNTAX             => 'Syntaxfehler',
-            DB_ERROR_UNSUPPORTED        => 'nicht Unterst&uml;tzt',
-            DB_ERROR_VALUE_COUNT_ON_ROW => 'Anzahl der zur&uml;ckgelieferten Felder entspricht nicht der Anzahl der Felder in der Abfrage',
-            DB_ERROR_INVALID_DSN        => 'ung&uml;ltiger DSN',
-            DB_ERROR_CONNECT_FAILED     => 'Verbindung konnte nicht hergestellt werden',
-            0	                       => 'kein Fehler', // DB_OK
-            DB_ERROR_NEED_MORE_DATA     => 'Nicht gen&uml;gend Daten geliefert',
-            DB_ERROR_EXTENSION_NOT_FOUND=> 'erweiterung nicht gefunden',
-            DB_ERROR_NOSUCHDB           => 'keine Datenbank',
-            DB_ERROR_ACCESS_VIOLATION   => 'ungen&uml;gende Rechte'
-);
+<?php
+// contributed by "Heinz Hombergs" <opn@hhombergs.de>
+$ADODB_LANG_ARRAY = array (
+			'LANG'                      => 'de',
+			DB_ERROR                    => 'Unbekannter Fehler',
+            DB_ERROR_ALREADY_EXISTS     => 'existiert bereits',
+            DB_ERROR_CANNOT_CREATE      => 'kann nicht erstellen',
+            DB_ERROR_CANNOT_DELETE      => 'kann nicht l&ouml;schen',
+            DB_ERROR_CANNOT_DROP        => 'Tabelle oder Index konnte nicht gel&ouml;scht werden',
+            DB_ERROR_CONSTRAINT         => 'Constraint Verletzung',
+            DB_ERROR_DIVZERO            => 'Division durch Null',
+            DB_ERROR_INVALID            => 'ung&uml;ltig',
+            DB_ERROR_INVALID_DATE       => 'ung&uml;ltiges Datum oder Zeit',
+            DB_ERROR_INVALID_NUMBER     => 'ung&uml;ltige Zahl',
+            DB_ERROR_MISMATCH           => 'Unvertr&auml;glichkeit',
+            DB_ERROR_NODBSELECTED       => 'keine Dantebank ausgew&auml;hlt',
+            DB_ERROR_NOSUCHFIELD        => 'Feld nicht vorhanden',
+            DB_ERROR_NOSUCHTABLE        => 'Tabelle nicht vorhanden',
+            DB_ERROR_NOT_CAPABLE        => 'Funktion nicht installiert',
+            DB_ERROR_NOT_FOUND          => 'nicht gefunden',
+            DB_ERROR_NOT_LOCKED         => 'nicht gesperrt',
+            DB_ERROR_SYNTAX             => 'Syntaxfehler',
+            DB_ERROR_UNSUPPORTED        => 'nicht Unterst&uml;tzt',
+            DB_ERROR_VALUE_COUNT_ON_ROW => 'Anzahl der zur&uml;ckgelieferten Felder entspricht nicht der Anzahl der Felder in der Abfrage',
+            DB_ERROR_INVALID_DSN        => 'ung&uml;ltiger DSN',
+            DB_ERROR_CONNECT_FAILED     => 'Verbindung konnte nicht hergestellt werden',
+            0	                       => 'kein Fehler', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => 'Nicht gen&uml;gend Daten geliefert',
+            DB_ERROR_EXTENSION_NOT_FOUND=> 'erweiterung nicht gefunden',
+            DB_ERROR_NOSUCHDB           => 'keine Datenbank',
+            DB_ERROR_ACCESS_VIOLATION   => 'ungen&uml;gende Rechte'
+);
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/lang/adodb-fa.inc.php b/third_party/adodb/lang/adodb-fa.inc.php
new file mode 100644
index 0000000..5594313
--- /dev/null
+++ b/third_party/adodb/lang/adodb-fa.inc.php
@@ -0,0 +1,35 @@
+<?php
+
+/* Farsi - by "Peyman Hooshmandi Raad" <phooshmand#gmail.com> */
+
+$ADODB_LANG_ARRAY = array (
+			'LANG'                      => 'fa',
+            DB_ERROR                    => ' ',
+            DB_ERROR_ALREADY_EXISTS     => ' ',
+            DB_ERROR_CANNOT_CREATE      => ' create  ',
+            DB_ERROR_CANNOT_DELETE      => '   ',
+            DB_ERROR_CANNOT_DROP        => ' drop  ',
+            DB_ERROR_CONSTRAINT         => ' ',
+            DB_ERROR_DIVZERO            => '  ',
+            DB_ERROR_INVALID            => '',
+            DB_ERROR_INVALID_DATE       => '   ',
+            DB_ERROR_INVALID_NUMBER     => ' ',
+            DB_ERROR_MISMATCH           => ' ',
+            DB_ERROR_NODBSELECTED       => '    ',
+            DB_ERROR_NOSUCHFIELD        => '   ',
+            DB_ERROR_NOSUCHTABLE        => '   ',
+            DB_ERROR_NOT_CAPABLE        => 'backend    ',
+            DB_ERROR_NOT_FOUND          => ' ',
+            DB_ERROR_NOT_LOCKED         => ' ',
+            DB_ERROR_SYNTAX             => ' ',
+            DB_ERROR_UNSUPPORTED        => '  ',
+            DB_ERROR_VALUE_COUNT_ON_ROW => '   ',
+            DB_ERROR_INVALID_DSN        => 'DSN ',
+            DB_ERROR_CONNECT_FAILED     => '  ',
+            0	                       => ' ', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => '  ',
+            DB_ERROR_EXTENSION_NOT_FOUND=> 'extension  ',
+            DB_ERROR_NOSUCHDB           => '    ',
+            DB_ERROR_ACCESS_VIOLATION   => '  '
+);
+?>
\ No newline at end of file
diff --git a/third_party/adodb/lang/adodb-fr.inc.php b/third_party/adodb/lang/adodb-fr.inc.php
index 11127cd..066a2a5 100644
--- a/third_party/adodb/lang/adodb-fr.inc.php
+++ b/third_party/adodb/lang/adodb-fr.inc.php
@@ -1,33 +1,33 @@
-<?php
-
-$ADODB_LANG_ARRAY = array (
-	'LANG'                      => 'fr',
-	DB_ERROR                    => 'erreur inconnue',
-	DB_ERROR_ALREADY_EXISTS     => 'existe d&eacute;j&agrave;',
-	DB_ERROR_CANNOT_CREATE      => 'cr&eacute;tion impossible',
-	DB_ERROR_CANNOT_DELETE      => 'effacement impossible',
-	DB_ERROR_CANNOT_DROP        => 'suppression impossible',
-	DB_ERROR_CONSTRAINT         => 'violation de contrainte',
-	DB_ERROR_DIVZERO            => 'division par z&eacute;ro',
-	DB_ERROR_INVALID            => 'invalide',
-	DB_ERROR_INVALID_DATE       => 'date ou heure invalide',
-	DB_ERROR_INVALID_NUMBER     => 'nombre invalide',
-	DB_ERROR_MISMATCH           => 'erreur de concordance',
-	DB_ERROR_NODBSELECTED       => 'pas de base de donn&eacute;ess&eacute;lectionn&eacute;e',
-	DB_ERROR_NOSUCHFIELD        => 'nom de colonne invalide',
-	DB_ERROR_NOSUCHTABLE        => 'table ou vue inexistante',
-	DB_ERROR_NOT_CAPABLE        => 'fonction optionnelle non install&eacute;e',
-	DB_ERROR_NOT_FOUND          => 'pas trouv&eacute;',
-	DB_ERROR_NOT_LOCKED         => 'non verrouill&eacute;',
-	DB_ERROR_SYNTAX             => 'erreur de syntaxe',
-	DB_ERROR_UNSUPPORTED        => 'non support&eacute;',
-	DB_ERROR_VALUE_COUNT_ON_ROW => 'valeur ins&eacute;r&eacute;e trop grande pour colonne',
-	DB_ERROR_INVALID_DSN        => 'DSN invalide',
-	DB_ERROR_CONNECT_FAILED     => '&eacute;chec &agrave; la connexion',
-	0                        => "pas d'erreur", // DB_OK
-	DB_ERROR_NEED_MORE_DATA     => 'donn&eacute;es fournies insuffisantes',
-	DB_ERROR_EXTENSION_NOT_FOUND=> 'extension non trouv&eacute;e',
-	DB_ERROR_NOSUCHDB           => 'base de donn&eacute;es inconnue',
-	DB_ERROR_ACCESS_VIOLATION   => 'droits insuffisants'
-);
+<?php
+
+$ADODB_LANG_ARRAY = array (
+	'LANG'                      => 'fr',
+	DB_ERROR                    => 'erreur inconnue',
+	DB_ERROR_ALREADY_EXISTS     => 'existe d&eacute;j&agrave;',
+	DB_ERROR_CANNOT_CREATE      => 'cr&eacute;tion impossible',
+	DB_ERROR_CANNOT_DELETE      => 'effacement impossible',
+	DB_ERROR_CANNOT_DROP        => 'suppression impossible',
+	DB_ERROR_CONSTRAINT         => 'violation de contrainte',
+	DB_ERROR_DIVZERO            => 'division par z&eacute;ro',
+	DB_ERROR_INVALID            => 'invalide',
+	DB_ERROR_INVALID_DATE       => 'date ou heure invalide',
+	DB_ERROR_INVALID_NUMBER     => 'nombre invalide',
+	DB_ERROR_MISMATCH           => 'erreur de concordance',
+	DB_ERROR_NODBSELECTED       => 'pas de base de donn&eacute;ess&eacute;lectionn&eacute;e',
+	DB_ERROR_NOSUCHFIELD        => 'nom de colonne invalide',
+	DB_ERROR_NOSUCHTABLE        => 'table ou vue inexistante',
+	DB_ERROR_NOT_CAPABLE        => 'fonction optionnelle non install&eacute;e',
+	DB_ERROR_NOT_FOUND          => 'pas trouv&eacute;',
+	DB_ERROR_NOT_LOCKED         => 'non verrouill&eacute;',
+	DB_ERROR_SYNTAX             => 'erreur de syntaxe',
+	DB_ERROR_UNSUPPORTED        => 'non support&eacute;',
+	DB_ERROR_VALUE_COUNT_ON_ROW => 'valeur ins&eacute;r&eacute;e trop grande pour colonne',
+	DB_ERROR_INVALID_DSN        => 'DSN invalide',
+	DB_ERROR_CONNECT_FAILED     => '&eacute;chec &agrave; la connexion',
+	0                        => "pas d'erreur", // DB_OK
+	DB_ERROR_NEED_MORE_DATA     => 'donn&eacute;es fournies insuffisantes',
+	DB_ERROR_EXTENSION_NOT_FOUND=> 'extension non trouv&eacute;e',
+	DB_ERROR_NOSUCHDB           => 'base de donn&eacute;es inconnue',
+	DB_ERROR_ACCESS_VIOLATION   => 'droits insuffisants'
+);
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/lang/adodb-it.inc.php b/third_party/adodb/lang/adodb-it.inc.php
index ac5cc5a..20c5b93 100644
--- a/third_party/adodb/lang/adodb-it.inc.php
+++ b/third_party/adodb/lang/adodb-it.inc.php
@@ -1,34 +1,34 @@
-<?php
-// Italian language file contributed by Tiraboschi Massimiliano aka TiMax  
-// www.maxdev.com  timax@maxdev.com
-$ADODB_LANG_ARRAY = array (
-            'LANG'                      => 'it',
-            DB_ERROR                    => 'errore sconosciuto',
-            DB_ERROR_ALREADY_EXISTS     => 'esiste gi&agrave;',
-            DB_ERROR_CANNOT_CREATE      => 'non posso creare',
-            DB_ERROR_CANNOT_DELETE      => 'non posso cancellare',
-            DB_ERROR_CANNOT_DROP        => 'non posso eliminare',
-            DB_ERROR_CONSTRAINT         => 'violazione constraint',
-            DB_ERROR_DIVZERO            => 'divisione per zero',
-            DB_ERROR_INVALID            => 'non valido',
-            DB_ERROR_INVALID_DATE       => 'data od ora non valida',
-            DB_ERROR_INVALID_NUMBER     => 'numero non valido',
-            DB_ERROR_MISMATCH           => 'diversi',
-            DB_ERROR_NODBSELECTED       => 'nessun database selezionato',
-            DB_ERROR_NOSUCHFIELD        => 'nessun campo trovato',
-            DB_ERROR_NOSUCHTABLE        => 'nessuna tabella trovata',
-            DB_ERROR_NOT_CAPABLE        => 'DB backend non abilitato',
-            DB_ERROR_NOT_FOUND          => 'non trovato',
-            DB_ERROR_NOT_LOCKED         => 'non bloccato',
-            DB_ERROR_SYNTAX             => 'errore di sintassi',
-            DB_ERROR_UNSUPPORTED        => 'non supportato',
-            DB_ERROR_VALUE_COUNT_ON_ROW => 'valore inserito troppo grande per una colonna',
-            DB_ERROR_INVALID_DSN        => 'DSN non valido',
-            DB_ERROR_CONNECT_FAILED     => 'connessione fallita',
-            0                           => 'nessun errore', // DB_OK
-            DB_ERROR_NEED_MORE_DATA     => 'dati inseriti insufficienti',
-            DB_ERROR_EXTENSION_NOT_FOUND=> 'estensione non trovata',
-            DB_ERROR_NOSUCHDB           => 'database non trovato',
-            DB_ERROR_ACCESS_VIOLATION   => 'permessi insufficienti'
-);
+<?php
+// Italian language file contributed by Tiraboschi Massimiliano aka TiMax  
+// www.maxdev.com  timax@maxdev.com
+$ADODB_LANG_ARRAY = array (
+            'LANG'                      => 'it',
+            DB_ERROR                    => 'errore sconosciuto',
+            DB_ERROR_ALREADY_EXISTS     => 'esiste gi&agrave;',
+            DB_ERROR_CANNOT_CREATE      => 'non posso creare',
+            DB_ERROR_CANNOT_DELETE      => 'non posso cancellare',
+            DB_ERROR_CANNOT_DROP        => 'non posso eliminare',
+            DB_ERROR_CONSTRAINT         => 'violazione constraint',
+            DB_ERROR_DIVZERO            => 'divisione per zero',
+            DB_ERROR_INVALID            => 'non valido',
+            DB_ERROR_INVALID_DATE       => 'data od ora non valida',
+            DB_ERROR_INVALID_NUMBER     => 'numero non valido',
+            DB_ERROR_MISMATCH           => 'diversi',
+            DB_ERROR_NODBSELECTED       => 'nessun database selezionato',
+            DB_ERROR_NOSUCHFIELD        => 'nessun campo trovato',
+            DB_ERROR_NOSUCHTABLE        => 'nessuna tabella trovata',
+            DB_ERROR_NOT_CAPABLE        => 'DB backend non abilitato',
+            DB_ERROR_NOT_FOUND          => 'non trovato',
+            DB_ERROR_NOT_LOCKED         => 'non bloccato',
+            DB_ERROR_SYNTAX             => 'errore di sintassi',
+            DB_ERROR_UNSUPPORTED        => 'non supportato',
+            DB_ERROR_VALUE_COUNT_ON_ROW => 'valore inserito troppo grande per una colonna',
+            DB_ERROR_INVALID_DSN        => 'DSN non valido',
+            DB_ERROR_CONNECT_FAILED     => 'connessione fallita',
+            0                           => 'nessun errore', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => 'dati inseriti insufficienti',
+            DB_ERROR_EXTENSION_NOT_FOUND=> 'estensione non trovata',
+            DB_ERROR_NOSUCHDB           => 'database non trovato',
+            DB_ERROR_ACCESS_VIOLATION   => 'permessi insufficienti'
+);
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/lang/adodb-ru1251.inc.php b/third_party/adodb/lang/adodb-ru1251.inc.php
index e273f42..3a20538 100644
--- a/third_party/adodb/lang/adodb-ru1251.inc.php
+++ b/third_party/adodb/lang/adodb-ru1251.inc.php
@@ -1,35 +1,35 @@
-<?php
-
-// Russian language file contributed by "Cyrill Malevanov" cyrill#malevanov.spb.ru.
-
-$ADODB_LANG_ARRAY = array (
-             'LANG'                      => 'ru1251',
-            DB_ERROR                    => ' ',
-            DB_ERROR_ALREADY_EXISTS     => ' ',
-            DB_ERROR_CANNOT_CREATE      => ' ',
-            DB_ERROR_CANNOT_DELETE      => ' ',
-            DB_ERROR_CANNOT_DROP        => '  (drop)',
-            DB_ERROR_CONSTRAINT         => '  ',
-            DB_ERROR_DIVZERO            => '  0',
-            DB_ERROR_INVALID            => '',
-            DB_ERROR_INVALID_DATE       => '   ',
-            DB_ERROR_INVALID_NUMBER     => ' ',
-            DB_ERROR_MISMATCH           => '',
-            DB_ERROR_NODBSELECTED       => '  ',
-            DB_ERROR_NOSUCHFIELD        => '  ',
-            DB_ERROR_NOSUCHTABLE        => '  ',
-            DB_ERROR_NOT_CAPABLE        => '   ',
-            DB_ERROR_NOT_FOUND          => ' ',
-            DB_ERROR_NOT_LOCKED         => ' ',
-            DB_ERROR_SYNTAX             => ' ',
-            DB_ERROR_UNSUPPORTED        => ' ',
-            DB_ERROR_VALUE_COUNT_ON_ROW => '   ',
-            DB_ERROR_INVALID_DSN        => ' DSN',
-            DB_ERROR_CONNECT_FAILED     => ' ',
-            0                               => ' ', // DB_OK
-            DB_ERROR_NEED_MORE_DATA     => '  ',
-            DB_ERROR_EXTENSION_NOT_FOUND=> '  ',
-            DB_ERROR_NOSUCHDB           => '  ',
-            DB_ERROR_ACCESS_VIOLATION   => '  '
-);
+<?php
+
+// Russian language file contributed by "Cyrill Malevanov" cyrill#malevanov.spb.ru.
+
+$ADODB_LANG_ARRAY = array (
+             'LANG'                      => 'ru1251',
+            DB_ERROR                    => ' ',
+            DB_ERROR_ALREADY_EXISTS     => ' ',
+            DB_ERROR_CANNOT_CREATE      => ' ',
+            DB_ERROR_CANNOT_DELETE      => ' ',
+            DB_ERROR_CANNOT_DROP        => '  (drop)',
+            DB_ERROR_CONSTRAINT         => '  ',
+            DB_ERROR_DIVZERO            => '  0',
+            DB_ERROR_INVALID            => '',
+            DB_ERROR_INVALID_DATE       => '   ',
+            DB_ERROR_INVALID_NUMBER     => ' ',
+            DB_ERROR_MISMATCH           => '',
+            DB_ERROR_NODBSELECTED       => '  ',
+            DB_ERROR_NOSUCHFIELD        => '  ',
+            DB_ERROR_NOSUCHTABLE        => '  ',
+            DB_ERROR_NOT_CAPABLE        => '   ',
+            DB_ERROR_NOT_FOUND          => ' ',
+            DB_ERROR_NOT_LOCKED         => ' ',
+            DB_ERROR_SYNTAX             => ' ',
+            DB_ERROR_UNSUPPORTED        => ' ',
+            DB_ERROR_VALUE_COUNT_ON_ROW => '   ',
+            DB_ERROR_INVALID_DSN        => ' DSN',
+            DB_ERROR_CONNECT_FAILED     => ' ',
+            0                               => ' ', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => '  ',
+            DB_ERROR_EXTENSION_NOT_FOUND=> '  ',
+            DB_ERROR_NOSUCHDB           => '  ',
+            DB_ERROR_ACCESS_VIOLATION   => '  '
+);
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/lang/adodb-sv.inc.php b/third_party/adodb/lang/adodb-sv.inc.php
index 64a5b4b..a9fd698 100644
--- a/third_party/adodb/lang/adodb-sv.inc.php
+++ b/third_party/adodb/lang/adodb-sv.inc.php
@@ -1,33 +1,33 @@
-<?php
-// Christian Tiberg" christian@commsoft.nu
-$ADODB_LANG_ARRAY = array (
-			'LANG'                      => 'en',
-            DB_ERROR                    => 'Oknt fel',
-            DB_ERROR_ALREADY_EXISTS     => 'finns redan',
-            DB_ERROR_CANNOT_CREATE      => 'kan inte skapa',
-            DB_ERROR_CANNOT_DELETE      => 'kan inte ta bort',
-            DB_ERROR_CANNOT_DROP        => 'kan inte slppa',
-            DB_ERROR_CONSTRAINT         => 'begrnsning krnkt',
-            DB_ERROR_DIVZERO            => 'division med noll',
-            DB_ERROR_INVALID            => 'ogiltig',
-            DB_ERROR_INVALID_DATE       => 'ogiltigt datum eller tid',
-            DB_ERROR_INVALID_NUMBER     => 'ogiltigt tal',
-            DB_ERROR_MISMATCH           => 'felaktig matchning',
-            DB_ERROR_NODBSELECTED       => 'ingen databas vald',
-            DB_ERROR_NOSUCHFIELD        => 'inget sdant flt',
-            DB_ERROR_NOSUCHTABLE        => 'ingen sdan tabell',
-            DB_ERROR_NOT_CAPABLE        => 'DB backend klarar det inte',
-            DB_ERROR_NOT_FOUND          => 'finns inte',
-            DB_ERROR_NOT_LOCKED         => 'inte lst',
-            DB_ERROR_SYNTAX             => 'syntaxfel',
-            DB_ERROR_UNSUPPORTED        => 'stds ej',
-            DB_ERROR_VALUE_COUNT_ON_ROW => 'vrde rknat p rad',
-            DB_ERROR_INVALID_DSN        => 'ogiltig DSN',
-            DB_ERROR_CONNECT_FAILED     => 'anslutning misslyckades',
-            0	                       => 'inget fel', // DB_OK
-            DB_ERROR_NEED_MORE_DATA     => 'otillrckligt med data angivet',
-            DB_ERROR_EXTENSION_NOT_FOUND=> 'utkning hittades ej',
-            DB_ERROR_NOSUCHDB           => 'ingen sdan databas',
-            DB_ERROR_ACCESS_VIOLATION   => 'otillrckliga rttigheter'
-);
+<?php
+// Christian Tiberg" christian@commsoft.nu
+$ADODB_LANG_ARRAY = array (
+			'LANG'                      => 'en',
+            DB_ERROR                    => 'Oknt fel',
+            DB_ERROR_ALREADY_EXISTS     => 'finns redan',
+            DB_ERROR_CANNOT_CREATE      => 'kan inte skapa',
+            DB_ERROR_CANNOT_DELETE      => 'kan inte ta bort',
+            DB_ERROR_CANNOT_DROP        => 'kan inte slppa',
+            DB_ERROR_CONSTRAINT         => 'begrnsning krnkt',
+            DB_ERROR_DIVZERO            => 'division med noll',
+            DB_ERROR_INVALID            => 'ogiltig',
+            DB_ERROR_INVALID_DATE       => 'ogiltigt datum eller tid',
+            DB_ERROR_INVALID_NUMBER     => 'ogiltigt tal',
+            DB_ERROR_MISMATCH           => 'felaktig matchning',
+            DB_ERROR_NODBSELECTED       => 'ingen databas vald',
+            DB_ERROR_NOSUCHFIELD        => 'inget sdant flt',
+            DB_ERROR_NOSUCHTABLE        => 'ingen sdan tabell',
+            DB_ERROR_NOT_CAPABLE        => 'DB backend klarar det inte',
+            DB_ERROR_NOT_FOUND          => 'finns inte',
+            DB_ERROR_NOT_LOCKED         => 'inte lst',
+            DB_ERROR_SYNTAX             => 'syntaxfel',
+            DB_ERROR_UNSUPPORTED        => 'stds ej',
+            DB_ERROR_VALUE_COUNT_ON_ROW => 'vrde rknat p rad',
+            DB_ERROR_INVALID_DSN        => 'ogiltig DSN',
+            DB_ERROR_CONNECT_FAILED     => 'anslutning misslyckades',
+            0	                       => 'inget fel', // DB_OK
+            DB_ERROR_NEED_MORE_DATA     => 'otillrckligt med data angivet',
+            DB_ERROR_EXTENSION_NOT_FOUND=> 'utkning hittades ej',
+            DB_ERROR_NOSUCHDB           => 'ingen sdan databas',
+            DB_ERROR_ACCESS_VIOLATION   => 'otillrckliga rttigheter'
+);
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/license.txt b/third_party/adodb/license.txt
index 9821fcb..2353871 100644
--- a/third_party/adodb/license.txt
+++ b/third_party/adodb/license.txt
@@ -1,182 +1,182 @@
-ADOdb is dual licensed using BSD and LGPL. 
-
-In plain English, you do not need to distribute your application  in source code form, nor do you need to distribute ADOdb source code, provided you follow the rest of terms of the BSD license.
-
-For more info about ADOdb, visit http://adodb.sourceforge.net/
-
-BSD Style-License
-=================
-
-Copyright (c) 2000, 2001, 2002, 2003, 2004 John Lim
-All rights reserved.
-
-Redistribution and use in source and binary forms, with or without modification, 
-are permitted provided that the following conditions are met:
-
-Redistributions of source code must retain the above copyright notice, this list 
-of conditions and the following disclaimer. 
-
-Redistributions in binary form must reproduce the above copyright notice, this list 
-of conditions and the following disclaimer in the documentation and/or other materials 
-provided with the distribution. 
-
-Neither the name of the John Lim nor the names of its contributors may be used to 
-endorse or promote products derived from this software without specific prior written 
-permission. 
-
-DISCLAIMER:
-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY 
-EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
-MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL 
-JOHN LIM OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, 
-EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF 
-SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) 
-HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, 
-OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS 
-SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-==========================================================
-GNU LESSER GENERAL PUBLIC LICENSE
-Version 2.1, February 1999 
- 
-Copyright (C) 1991, 1999 Free Software Foundation, Inc.
-59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-Everyone is permitted to copy and distribute verbatim copies
-of this license document, but changing it is not allowed.
-
-[This is the first released version of the Lesser GPL.  It also counts
- as the successor of the GNU Library Public License, version 2, hence
- the version number 2.1.]
- 
- 
-Preamble
-The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public Licenses are intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users. 
-
-This license, the Lesser General Public License, applies to some specially designated software packages--typically libraries--of the Free Software Foundation and other authors who decide to use it. You can use it too, but we suggest you first think carefully about whether this license or the ordinary General Public License is the better strategy to use in any particular case, based on the explanations below. 
-
-When we speak of free software, we are referring to freedom of use, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish); that you receive source code or can get it if you want it; that you can change the software and use pieces of it in new free programs; and that you are informed that you can do these things. 
-
-To protect your rights, we need to make restrictions that forbid distributors to deny you these rights or to ask you to surrender these rights. These restrictions translate to certain responsibilities for you if you distribute copies of the library or if you modify it. 
-
-For example, if you distribute copies of the library, whether gratis or for a fee, you must give the recipients all the rights that we gave you. You must make sure that they, too, receive or can get the source code. If you link other code with the library, you must provide complete object files to the recipients, so that they can relink them with the library after making changes to the library and recompiling it. And you must show them these terms so they know their rights. 
-
-We protect your rights with a two-step method: (1) we copyright the library, and (2) we offer you this license, which gives you legal permission to copy, distribute and/or modify the library. 
-
-To protect each distributor, we want to make it very clear that there is no warranty for the free library. Also, if the library is modified by someone else and passed on, the recipients should know that what they have is not the original version, so that the original author's reputation will not be affected by problems that might be introduced by others. 
-
-Finally, software patents pose a constant threat to the existence of any free program. We wish to make sure that a company cannot effectively restrict the users of a free program by obtaining a restrictive license from a patent holder. Therefore, we insist that any patent license obtained for a version of the library must be consistent with the full freedom of use specified in this license. 
-
-Most GNU software, including some libraries, is covered by the ordinary GNU General Public License. This license, the GNU Lesser General Public License, applies to certain designated libraries, and is quite different from the ordinary General Public License. We use this license for certain libraries in order to permit linking those libraries into non-free programs. 
-
-When a program is linked with a library, whether statically or using a shared library, the combination of the two is legally speaking a combined work, a derivative of the original library. The ordinary General Public License therefore permits such linking only if the entire combination fits its criteria of freedom. The Lesser General Public License permits more lax criteria for linking other code with the library. 
-
-We call this license the "Lesser" General Public License because it does Less to protect the user's freedom than the ordinary General Public License. It also provides other free software developers Less of an advantage over competing non-free programs. These disadvantages are the reason we use the ordinary General Public License for many libraries. However, the Lesser license provides advantages in certain special circumstances. 
-
-For example, on rare occasions, there may be a special need to encourage the widest possible use of a certain library, so that it becomes a de-facto standard. To achieve this, non-free programs must be allowed to use the library. A more frequent case is that a free library does the same job as widely used non-free libraries. In this case, there is little to gain by limiting the free library to free software only, so we use the Lesser General Public License. 
-
-In other cases, permission to use a particular library in non-free programs enables a greater number of people to use a large body of free software. For example, permission to use the GNU C Library in non-free programs enables many more people to use the whole GNU operating system, as well as its variant, the GNU/Linux operating system. 
-
-Although the Lesser General Public License is Less protective of the users' freedom, it does ensure that the user of a program that is linked with the Library has the freedom and the wherewithal to run that program using a modified version of the Library. 
-
-The precise terms and conditions for copying, distribution and modification follow. Pay close attention to the difference between a "work based on the library" and a "work that uses the library". The former contains code derived from the library, whereas the latter must be combined with the library in order to run. 
-
-
-TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
-0. This License Agreement applies to any software library or other program which contains a notice placed by the copyright holder or other authorized party saying it may be distributed under the terms of this Lesser General Public License (also called "this License"). Each licensee is addressed as "you". 
-
-A "library" means a collection of software functions and/or data prepared so as to be conveniently linked with application programs (which use some of those functions and data) to form executables. 
-
-The "Library", below, refers to any such software library or work which has been distributed under these terms. A "work based on the Library" means either the Library or any derivative work under copyright law: that is to say, a work containing the Library or a portion of it, either verbatim or with modifications and/or translated straightforwardly into another language. (Hereinafter, translation is included without limitation in the term "modification".) 
-
-"Source code" for a work means the preferred form of the work for making modifications to it. For a library, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the library. 
-
-Activities other than copying, distribution and modification are not covered by this License; they are outside its scope. The act of running a program using the Library is not restricted, and output from such a program is covered only if its contents constitute a work based on the Library (independent of the use of the Library in a tool for writing it). Whether that is true depends on what the Library does and what the program that uses the Library does. 
-
-1. You may copy and distribute verbatim copies of the Library's complete source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and distribute a copy of this License along with the Library. 
-
-You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee. 
-
-2. You may modify your copy or copies of the Library or any portion of it, thus forming a work based on the Library, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions: 
-
-
-a) The modified work must itself be a software library. 
-b) You must cause the files modified to carry prominent notices stating that you changed the files and the date of any change. 
-c) You must cause the whole of the work to be licensed at no charge to all third parties under the terms of this License. 
-d) If a facility in the modified Library refers to a function or a table of data to be supplied by an application program that uses the facility, other than as an argument passed when the facility is invoked, then you must make a good faith effort to ensure that, in the event an application does not supply such function or table, the facility still operates, and performs whatever part of its purpose remains meaningful. 
-(For example, a function in a library to compute square roots has a purpose that is entirely well-defined independent of the application. Therefore, Subsection 2d requires that any application-supplied function or table used by this function must be optional: if the application does not supply it, the square root function must still compute square roots.) 
-
-These requirements apply to the modified work as a whole. If identifiable sections of that work are not derived from the Library, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works. But when you distribute the same sections as part of a whole which is a work based on the Library, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it. 
-
-Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Library. 
-
-In addition, mere aggregation of another work not based on the Library with the Library (or with a work based on the Library) on a volume of a storage or distribution medium does not bring the other work under the scope of this License. 
-
-3. You may opt to apply the terms of the ordinary GNU General Public License instead of this License to a given copy of the Library. To do this, you must alter all the notices that refer to this License, so that they refer to the ordinary GNU General Public License, version 2, instead of to this License. (If a newer version than version 2 of the ordinary GNU General Public License has appeared, then you can specify that version instead if you wish.) Do not make any other change in these notices. 
-
-Once this change is made in a given copy, it is irreversible for that copy, so the ordinary GNU General Public License applies to all subsequent copies and derivative works made from that copy. 
-
-This option is useful when you wish to copy part of the code of the Library into a program that is not a library. 
-
-4. You may copy and distribute the Library (or a portion or derivative of it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange. 
-
-If distribution of object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place satisfies the requirement to distribute the source code, even though third parties are not compelled to copy the source along with the object code. 
-
-5. A program that contains no derivative of any portion of the Library, but is designed to work with the Library by being compiled or linked with it, is called a "work that uses the Library". Such a work, in isolation, is not a derivative work of the Library, and therefore falls outside the scope of this License. 
-
-However, linking a "work that uses the Library" with the Library creates an executable that is a derivative of the Library (because it contains portions of the Library), rather than a "work that uses the library". The executable is therefore covered by this License. Section 6 states terms for distribution of such executables. 
-
-When a "work that uses the Library" uses material from a header file that is part of the Library, the object code for the work may be a derivative work of the Library even though the source code is not. Whether this is true is especially significant if the work can be linked without the Library, or if the work is itself a library. The threshold for this to be true is not precisely defined by law. 
-
-If such an object file uses only numerical parameters, data structure layouts and accessors, and small macros and small inline functions (ten lines or less in length), then the use of the object file is unrestricted, regardless of whether it is legally a derivative work. (Executables containing this object code plus portions of the Library will still fall under Section 6.) 
-
-Otherwise, if the work is a derivative of the Library, you may distribute the object code for the work under the terms of Section 6. Any executables containing that work also fall under Section 6, whether or not they are linked directly with the Library itself. 
-
-6. As an exception to the Sections above, you may also combine or link a "work that uses the Library" with the Library to produce a work containing portions of the Library, and distribute that work under terms of your choice, provided that the terms permit modification of the work for the customer's own use and reverse engineering for debugging such modifications. 
-
-You must give prominent notice with each copy of the work that the Library is used in it and that the Library and its use are covered by this License. You must supply a copy of this License. If the work during execution displays copyright notices, you must include the copyright notice for the Library among them, as well as a reference directing the user to the copy of this License. Also, you must do one of these things: 
-
-
-a) Accompany the work with the complete corresponding machine-readable source code for the Library including whatever changes were used in the work (which must be distributed under Sections 1 and 2 above); and, if the work is an executable linked with the Library, with the complete machine-readable "work that uses the Library", as object code and/or source code, so that the user can modify the Library and then relink to produce a modified executable containing the modified Library. (It is understood that the user who changes the contents of definitions files in the Library will not necessarily be able to recompile the application to use the modified definitions.) 
-b) Use a suitable shared library mechanism for linking with the Library. A suitable mechanism is one that (1) uses at run time a copy of the library already present on the user's computer system, rather than copying library functions into the executable, and (2) will operate properly with a modified version of the library, if the user installs one, as long as the modified version is interface-compatible with the version that the work was made with. 
-c) Accompany the work with a written offer, valid for at least three years, to give the same user the materials specified in Subsection 6a, above, for a charge no more than the cost of performing this distribution. 
-d) If distribution of the work is made by offering access to copy from a designated place, offer equivalent access to copy the above specified materials from the same place. 
-e) Verify that the user has already received a copy of these materials or that you have already sent this user a copy. 
-For an executable, the required form of the "work that uses the Library" must include any data and utility programs needed for reproducing the executable from it. However, as a special exception, the materials to be distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable. 
-
-It may happen that this requirement contradicts the license restrictions of other proprietary libraries that do not normally accompany the operating system. Such a contradiction means you cannot use both them and the Library together in an executable that you distribute. 
-
-7. You may place library facilities that are a work based on the Library side-by-side in a single library together with other library facilities not covered by this License, and distribute such a combined library, provided that the separate distribution of the work based on the Library and of the other library facilities is otherwise permitted, and provided that you do these two things: 
-
-
-a) Accompany the combined library with a copy of the same work based on the Library, uncombined with any other library facilities. This must be distributed under the terms of the Sections above. 
-b) Give prominent notice with the combined library of the fact that part of it is a work based on the Library, and explaining where to find the accompanying uncombined form of the same work. 
-8. You may not copy, modify, sublicense, link with, or distribute the Library except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense, link with, or distribute the Library is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance. 
-
-9. You are not required to accept this License, since you have not signed it. However, nothing else grants you permission to modify or distribute the Library or its derivative works. These actions are prohibited by law if you do not accept this License. Therefore, by modifying or distributing the Library (or any work based on the Library), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Library or works based on it. 
-
-10. Each time you redistribute the Library (or any work based on the Library), the recipient automatically receives a license from the original licensor to copy, distribute, link with or modify the Library subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties with this License. 
-
-11. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Library at all. For example, if a patent license would not permit royalty-free redistribution of the Library by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Library. 
-
-If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply, and the section as a whole is intended to apply in other circumstances. 
-
-It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system which is implemented by public license practices. Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice. 
-
-This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License. 
-
-12. If the distribution and/or use of the Library is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Library under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License. 
-
-13. The Free Software Foundation may publish revised and/or new versions of the Lesser General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns. 
-
-Each version is given a distinguishing version number. If the Library specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation. If the Library does not specify a license version number, you may choose any version ever published by the Free Software Foundation. 
-
-14. If you wish to incorporate parts of the Library into other free programs whose distribution conditions are incompatible with these, write to the author to ask for permission. For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this. Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally. 
-
-NO WARRANTY 
-
-15. BECAUSE THE LIBRARY IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE LIBRARY, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE LIBRARY "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE LIBRARY IS WITH YOU. SHOULD THE LIBRARY PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION. 
-
-16. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE LIBRARY AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE LIBRARY (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE LIBRARY TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. 
-
-
+ADOdb is dual licensed using BSD and LGPL. 
+
+In plain English, you do not need to distribute your application  in source code form, nor do you need to distribute ADOdb source code, provided you follow the rest of terms of the BSD license.
+
+For more info about ADOdb, visit http://adodb.sourceforge.net/
+
+BSD Style-License
+=================
+
+Copyright (c) 2000, 2001, 2002, 2003, 2004 John Lim
+All rights reserved.
+
+Redistribution and use in source and binary forms, with or without modification, 
+are permitted provided that the following conditions are met:
+
+Redistributions of source code must retain the above copyright notice, this list 
+of conditions and the following disclaimer. 
+
+Redistributions in binary form must reproduce the above copyright notice, this list 
+of conditions and the following disclaimer in the documentation and/or other materials 
+provided with the distribution. 
+
+Neither the name of the John Lim nor the names of its contributors may be used to 
+endorse or promote products derived from this software without specific prior written 
+permission. 
+
+DISCLAIMER:
+THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY 
+EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
+MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL 
+JOHN LIM OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, 
+EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF 
+SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) 
+HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, 
+OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS 
+SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+
+==========================================================
+GNU LESSER GENERAL PUBLIC LICENSE
+Version 2.1, February 1999 
+ 
+Copyright (C) 1991, 1999 Free Software Foundation, Inc.
+59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+Everyone is permitted to copy and distribute verbatim copies
+of this license document, but changing it is not allowed.
+
+[This is the first released version of the Lesser GPL.  It also counts
+ as the successor of the GNU Library Public License, version 2, hence
+ the version number 2.1.]
+ 
+ 
+Preamble
+The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public Licenses are intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users. 
+
+This license, the Lesser General Public License, applies to some specially designated software packages--typically libraries--of the Free Software Foundation and other authors who decide to use it. You can use it too, but we suggest you first think carefully about whether this license or the ordinary General Public License is the better strategy to use in any particular case, based on the explanations below. 
+
+When we speak of free software, we are referring to freedom of use, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish); that you receive source code or can get it if you want it; that you can change the software and use pieces of it in new free programs; and that you are informed that you can do these things. 
+
+To protect your rights, we need to make restrictions that forbid distributors to deny you these rights or to ask you to surrender these rights. These restrictions translate to certain responsibilities for you if you distribute copies of the library or if you modify it. 
+
+For example, if you distribute copies of the library, whether gratis or for a fee, you must give the recipients all the rights that we gave you. You must make sure that they, too, receive or can get the source code. If you link other code with the library, you must provide complete object files to the recipients, so that they can relink them with the library after making changes to the library and recompiling it. And you must show them these terms so they know their rights. 
+
+We protect your rights with a two-step method: (1) we copyright the library, and (2) we offer you this license, which gives you legal permission to copy, distribute and/or modify the library. 
+
+To protect each distributor, we want to make it very clear that there is no warranty for the free library. Also, if the library is modified by someone else and passed on, the recipients should know that what they have is not the original version, so that the original author's reputation will not be affected by problems that might be introduced by others. 
+
+Finally, software patents pose a constant threat to the existence of any free program. We wish to make sure that a company cannot effectively restrict the users of a free program by obtaining a restrictive license from a patent holder. Therefore, we insist that any patent license obtained for a version of the library must be consistent with the full freedom of use specified in this license. 
+
+Most GNU software, including some libraries, is covered by the ordinary GNU General Public License. This license, the GNU Lesser General Public License, applies to certain designated libraries, and is quite different from the ordinary General Public License. We use this license for certain libraries in order to permit linking those libraries into non-free programs. 
+
+When a program is linked with a library, whether statically or using a shared library, the combination of the two is legally speaking a combined work, a derivative of the original library. The ordinary General Public License therefore permits such linking only if the entire combination fits its criteria of freedom. The Lesser General Public License permits more lax criteria for linking other code with the library. 
+
+We call this license the "Lesser" General Public License because it does Less to protect the user's freedom than the ordinary General Public License. It also provides other free software developers Less of an advantage over competing non-free programs. These disadvantages are the reason we use the ordinary General Public License for many libraries. However, the Lesser license provides advantages in certain special circumstances. 
+
+For example, on rare occasions, there may be a special need to encourage the widest possible use of a certain library, so that it becomes a de-facto standard. To achieve this, non-free programs must be allowed to use the library. A more frequent case is that a free library does the same job as widely used non-free libraries. In this case, there is little to gain by limiting the free library to free software only, so we use the Lesser General Public License. 
+
+In other cases, permission to use a particular library in non-free programs enables a greater number of people to use a large body of free software. For example, permission to use the GNU C Library in non-free programs enables many more people to use the whole GNU operating system, as well as its variant, the GNU/Linux operating system. 
+
+Although the Lesser General Public License is Less protective of the users' freedom, it does ensure that the user of a program that is linked with the Library has the freedom and the wherewithal to run that program using a modified version of the Library. 
+
+The precise terms and conditions for copying, distribution and modification follow. Pay close attention to the difference between a "work based on the library" and a "work that uses the library". The former contains code derived from the library, whereas the latter must be combined with the library in order to run. 
+
+
+TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
+0. This License Agreement applies to any software library or other program which contains a notice placed by the copyright holder or other authorized party saying it may be distributed under the terms of this Lesser General Public License (also called "this License"). Each licensee is addressed as "you". 
+
+A "library" means a collection of software functions and/or data prepared so as to be conveniently linked with application programs (which use some of those functions and data) to form executables. 
+
+The "Library", below, refers to any such software library or work which has been distributed under these terms. A "work based on the Library" means either the Library or any derivative work under copyright law: that is to say, a work containing the Library or a portion of it, either verbatim or with modifications and/or translated straightforwardly into another language. (Hereinafter, translation is included without limitation in the term "modification".) 
+
+"Source code" for a work means the preferred form of the work for making modifications to it. For a library, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the library. 
+
+Activities other than copying, distribution and modification are not covered by this License; they are outside its scope. The act of running a program using the Library is not restricted, and output from such a program is covered only if its contents constitute a work based on the Library (independent of the use of the Library in a tool for writing it). Whether that is true depends on what the Library does and what the program that uses the Library does. 
+
+1. You may copy and distribute verbatim copies of the Library's complete source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and distribute a copy of this License along with the Library. 
+
+You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee. 
+
+2. You may modify your copy or copies of the Library or any portion of it, thus forming a work based on the Library, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions: 
+
+
+a) The modified work must itself be a software library. 
+b) You must cause the files modified to carry prominent notices stating that you changed the files and the date of any change. 
+c) You must cause the whole of the work to be licensed at no charge to all third parties under the terms of this License. 
+d) If a facility in the modified Library refers to a function or a table of data to be supplied by an application program that uses the facility, other than as an argument passed when the facility is invoked, then you must make a good faith effort to ensure that, in the event an application does not supply such function or table, the facility still operates, and performs whatever part of its purpose remains meaningful. 
+(For example, a function in a library to compute square roots has a purpose that is entirely well-defined independent of the application. Therefore, Subsection 2d requires that any application-supplied function or table used by this function must be optional: if the application does not supply it, the square root function must still compute square roots.) 
+
+These requirements apply to the modified work as a whole. If identifiable sections of that work are not derived from the Library, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works. But when you distribute the same sections as part of a whole which is a work based on the Library, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it. 
+
+Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Library. 
+
+In addition, mere aggregation of another work not based on the Library with the Library (or with a work based on the Library) on a volume of a storage or distribution medium does not bring the other work under the scope of this License. 
+
+3. You may opt to apply the terms of the ordinary GNU General Public License instead of this License to a given copy of the Library. To do this, you must alter all the notices that refer to this License, so that they refer to the ordinary GNU General Public License, version 2, instead of to this License. (If a newer version than version 2 of the ordinary GNU General Public License has appeared, then you can specify that version instead if you wish.) Do not make any other change in these notices. 
+
+Once this change is made in a given copy, it is irreversible for that copy, so the ordinary GNU General Public License applies to all subsequent copies and derivative works made from that copy. 
+
+This option is useful when you wish to copy part of the code of the Library into a program that is not a library. 
+
+4. You may copy and distribute the Library (or a portion or derivative of it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange. 
+
+If distribution of object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place satisfies the requirement to distribute the source code, even though third parties are not compelled to copy the source along with the object code. 
+
+5. A program that contains no derivative of any portion of the Library, but is designed to work with the Library by being compiled or linked with it, is called a "work that uses the Library". Such a work, in isolation, is not a derivative work of the Library, and therefore falls outside the scope of this License. 
+
+However, linking a "work that uses the Library" with the Library creates an executable that is a derivative of the Library (because it contains portions of the Library), rather than a "work that uses the library". The executable is therefore covered by this License. Section 6 states terms for distribution of such executables. 
+
+When a "work that uses the Library" uses material from a header file that is part of the Library, the object code for the work may be a derivative work of the Library even though the source code is not. Whether this is true is especially significant if the work can be linked without the Library, or if the work is itself a library. The threshold for this to be true is not precisely defined by law. 
+
+If such an object file uses only numerical parameters, data structure layouts and accessors, and small macros and small inline functions (ten lines or less in length), then the use of the object file is unrestricted, regardless of whether it is legally a derivative work. (Executables containing this object code plus portions of the Library will still fall under Section 6.) 
+
+Otherwise, if the work is a derivative of the Library, you may distribute the object code for the work under the terms of Section 6. Any executables containing that work also fall under Section 6, whether or not they are linked directly with the Library itself. 
+
+6. As an exception to the Sections above, you may also combine or link a "work that uses the Library" with the Library to produce a work containing portions of the Library, and distribute that work under terms of your choice, provided that the terms permit modification of the work for the customer's own use and reverse engineering for debugging such modifications. 
+
+You must give prominent notice with each copy of the work that the Library is used in it and that the Library and its use are covered by this License. You must supply a copy of this License. If the work during execution displays copyright notices, you must include the copyright notice for the Library among them, as well as a reference directing the user to the copy of this License. Also, you must do one of these things: 
+
+
+a) Accompany the work with the complete corresponding machine-readable source code for the Library including whatever changes were used in the work (which must be distributed under Sections 1 and 2 above); and, if the work is an executable linked with the Library, with the complete machine-readable "work that uses the Library", as object code and/or source code, so that the user can modify the Library and then relink to produce a modified executable containing the modified Library. (It is understood that the user who changes the contents of definitions files in the Library will not necessarily be able to recompile the application to use the modified definitions.) 
+b) Use a suitable shared library mechanism for linking with the Library. A suitable mechanism is one that (1) uses at run time a copy of the library already present on the user's computer system, rather than copying library functions into the executable, and (2) will operate properly with a modified version of the library, if the user installs one, as long as the modified version is interface-compatible with the version that the work was made with. 
+c) Accompany the work with a written offer, valid for at least three years, to give the same user the materials specified in Subsection 6a, above, for a charge no more than the cost of performing this distribution. 
+d) If distribution of the work is made by offering access to copy from a designated place, offer equivalent access to copy the above specified materials from the same place. 
+e) Verify that the user has already received a copy of these materials or that you have already sent this user a copy. 
+For an executable, the required form of the "work that uses the Library" must include any data and utility programs needed for reproducing the executable from it. However, as a special exception, the materials to be distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable. 
+
+It may happen that this requirement contradicts the license restrictions of other proprietary libraries that do not normally accompany the operating system. Such a contradiction means you cannot use both them and the Library together in an executable that you distribute. 
+
+7. You may place library facilities that are a work based on the Library side-by-side in a single library together with other library facilities not covered by this License, and distribute such a combined library, provided that the separate distribution of the work based on the Library and of the other library facilities is otherwise permitted, and provided that you do these two things: 
+
+
+a) Accompany the combined library with a copy of the same work based on the Library, uncombined with any other library facilities. This must be distributed under the terms of the Sections above. 
+b) Give prominent notice with the combined library of the fact that part of it is a work based on the Library, and explaining where to find the accompanying uncombined form of the same work. 
+8. You may not copy, modify, sublicense, link with, or distribute the Library except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense, link with, or distribute the Library is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance. 
+
+9. You are not required to accept this License, since you have not signed it. However, nothing else grants you permission to modify or distribute the Library or its derivative works. These actions are prohibited by law if you do not accept this License. Therefore, by modifying or distributing the Library (or any work based on the Library), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Library or works based on it. 
+
+10. Each time you redistribute the Library (or any work based on the Library), the recipient automatically receives a license from the original licensor to copy, distribute, link with or modify the Library subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties with this License. 
+
+11. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Library at all. For example, if a patent license would not permit royalty-free redistribution of the Library by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Library. 
+
+If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply, and the section as a whole is intended to apply in other circumstances. 
+
+It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system which is implemented by public license practices. Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice. 
+
+This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License. 
+
+12. If the distribution and/or use of the Library is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Library under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License. 
+
+13. The Free Software Foundation may publish revised and/or new versions of the Lesser General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns. 
+
+Each version is given a distinguishing version number. If the Library specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation. If the Library does not specify a license version number, you may choose any version ever published by the Free Software Foundation. 
+
+14. If you wish to incorporate parts of the Library into other free programs whose distribution conditions are incompatible with these, write to the author to ask for permission. For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this. Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally. 
+
+NO WARRANTY 
+
+15. BECAUSE THE LIBRARY IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE LIBRARY, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE LIBRARY "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE LIBRARY IS WITH YOU. SHOULD THE LIBRARY PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION. 
+
+16. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE LIBRARY AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE LIBRARY (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE LIBRARY TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. 
+
+
 END OF TERMS AND CONDITIONS
\ No newline at end of file
diff --git a/third_party/adodb/pear/Auth/Container/ADOdb.php b/third_party/adodb/pear/Auth/Container/ADOdb.php
index 52a49d4..3f2321c 100644
--- a/third_party/adodb/pear/Auth/Container/ADOdb.php
+++ b/third_party/adodb/pear/Auth/Container/ADOdb.php
@@ -1,24 +1,16 @@
 <?php
-//
-// +----------------------------------------------------------------------+
-// | PHP Version 4                                                        |
-// +----------------------------------------------------------------------+
-// |                                                                      |
-// +----------------------------------------------------------------------+
-// | This source file is subject to version 2.02 of the PHP license,      |
-// | that is bundled with this package in the file LICENSE, and is        |
-// | available at through the world-wide-web at                           |
-// | http://www.php.net/license/2_02.txt.                                 |
-// | If you did not receive a copy of the PHP license and are unable to   |
-// | obtain it through the world-wide-web, please send a note to          |
-// | license@php.net so we can mail you a copy immediately.               |
-// +----------------------------------------------------------------------+
-// | Authors: Martin Jansen <mj@php.net>
-// |	Richard Tango-Lowy <richtl@arscognita.com>                                  |
-// +----------------------------------------------------------------------+
-//
-// $Id: ADOdb.php,v 1.3 2008/07/22 09:07:44 franciscom Exp $
-//
+/* 
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence. See License.txt. 
+  Set tabs to 4 for best viewing.
+  
+  Latest version is available at http://adodb.sourceforge.net
+  
+	Original Authors: Martin Jansen <mj#php.net>
+	Richard Tango-Lowy <richtl#arscognita.com>                          
+*/
 
 require_once 'Auth/Container.php';
 require_once 'adodb.inc.php';
diff --git a/third_party/adodb/pear/readme.Auth.txt b/third_party/adodb/pear/readme.Auth.txt
index b6b0c15..db28319 100644
--- a/third_party/adodb/pear/readme.Auth.txt
+++ b/third_party/adodb/pear/readme.Auth.txt
@@ -1,20 +1,20 @@
-From: Rich Tango-Lowy (richtl#arscognita.com)
-Date: Sat, May 29, 2004 11:20 am
-
-OK, I hacked out an ADOdb container for PEAR-Auth. The error handling's 
-a bit of a mess, but all the methods work.
-
-Copy ADOdb.php to your pear/Auth/Container/ directory.
-
-Use the ADOdb container exactly as you would the DB
-container, but specify 'ADOdb' instead of 'DB':
-
-$dsn = "mysql://myuser:mypass@localhost/authdb";
-$a = new Auth("ADOdb", $dsn, "loginFunction");
-
-
--------------------
-
-John Lim adds:
-
-See http://pear.php.net/manual/en/package.authentication.php
+From: Rich Tango-Lowy (richtl#arscognita.com)
+Date: Sat, May 29, 2004 11:20 am
+
+OK, I hacked out an ADOdb container for PEAR-Auth. The error handling's 
+a bit of a mess, but all the methods work.
+
+Copy ADOdb.php to your pear/Auth/Container/ directory.
+
+Use the ADOdb container exactly as you would the DB
+container, but specify 'ADOdb' instead of 'DB':
+
+$dsn = "mysql://myuser:mypass@localhost/authdb";
+$a = new Auth("ADOdb", $dsn, "loginFunction");
+
+
+-------------------
+
+John Lim adds:
+
+See http://pear.php.net/manual/en/package.authentication.php
diff --git a/third_party/adodb/perf/perf-db2.inc.php b/third_party/adodb/perf/perf-db2.inc.php
index 7b0479b..1a88d46 100644
--- a/third_party/adodb/perf/perf-db2.inc.php
+++ b/third_party/adodb/perf/perf-db2.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
diff --git a/third_party/adodb/perf/perf-informix.inc.php b/third_party/adodb/perf/perf-informix.inc.php
index 504533c..382f3a9 100644
--- a/third_party/adodb/perf/perf-informix.inc.php
+++ b/third_party/adodb/perf/perf-informix.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
diff --git a/third_party/adodb/perf/perf-mssql.inc.php b/third_party/adodb/perf/perf-mssql.inc.php
index 6dd12c7..87ab6a7 100644
--- a/third_party/adodb/perf/perf-mssql.inc.php
+++ b/third_party/adodb/perf/perf-mssql.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
diff --git a/third_party/adodb/perf/perf-mssqlnative.inc.php b/third_party/adodb/perf/perf-mssqlnative.inc.php
new file mode 100644
index 0000000..c609620
--- /dev/null
+++ b/third_party/adodb/perf/perf-mssqlnative.inc.php
@@ -0,0 +1,164 @@
+<?php
+
+/* 
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
+  Released under both BSD license and Lesser GPL library license. 
+  Whenever there is any discrepancy between the two licenses, 
+  the BSD license will take precedence. See License.txt. 
+  Set tabs to 4 for best viewing.
+  
+  Latest version is available at http://adodb.sourceforge.net
+  
+  Library for basic performance monitoring and tuning 
+  
+*/
+
+// security - hide paths
+if (!defined('ADODB_DIR')) die();
+
+/*
+	MSSQL has moved most performance info to Performance Monitor
+*/
+class perf_mssqlnative extends adodb_perf{
+	var $sql1 = 'cast(sql1 as text)';
+	var $createTableSQL = "CREATE TABLE adodb_logsql (
+		  created datetime NOT NULL,
+		  sql0 varchar(250) NOT NULL,
+		  sql1 varchar(4000) NOT NULL,
+		  params varchar(3000) NOT NULL,
+		  tracer varchar(500) NOT NULL,
+		  timer decimal(16,6) NOT NULL
+		)";
+		
+	var $settings = array(
+	'Ratios',
+		'data cache hit ratio' => array('RATIO',
+			"select round((a.cntr_value*100.0)/b.cntr_value,2) from master.dbo.sysperfinfo a, master.dbo.sysperfinfo b where a.counter_name = 'Buffer cache hit ratio' and b.counter_name='Buffer cache hit ratio base'",
+			'=WarnCacheRatio'),
+		'prepared sql hit ratio' => array('RATIO',
+			array('dbcc cachestats','Prepared',1,100),
+			''),
+		'adhoc sql hit ratio' => array('RATIO',
+			array('dbcc cachestats','Adhoc',1,100),
+			''),
+	'IO',
+		'data reads' => array('IO',
+		"select cntr_value from master.dbo.sysperfinfo where counter_name = 'Page reads/sec'"),
+		'data writes' => array('IO',
+		"select cntr_value from master.dbo.sysperfinfo where counter_name = 'Page writes/sec'"),
+			
+	'Data Cache',
+		'data cache size' => array('DATAC',
+		"select cntr_value*8192 from master.dbo.sysperfinfo where counter_name = 'Total Pages' and object_name='SQLServer:Buffer Manager'",
+			'' ),
+		'data cache blocksize' => array('DATAC',
+			"select 8192",'page size'),
+	'Connections',
+		'current connections' => array('SESS',
+			'=sp_who',
+			''),
+		'max connections' => array('SESS',
+			"SELECT @@MAX_CONNECTIONS",
+			''),
+
+		false
+	);
+	
+	
+	function perf_mssqlnative(&$conn)
+	{
+		if ($conn->dataProvider == 'odbc') {
+			$this->sql1 = 'sql1';
+			//$this->explain = false;
+		}
+		$this->conn =& $conn;
+	}
+	
+	function Explain($sql,$partial=false)
+	{
+		
+		$save = $this->conn->LogSQL(false);
+		if ($partial) {
+			$sqlq = $this->conn->qstr($sql.'%');
+			$arr = $this->conn->GetArray("select distinct sql1 from adodb_logsql where sql1 like $sqlq");
+			if ($arr) {
+				foreach($arr as $row) {
+					$sql = reset($row);
+					if (crc32($sql) == $partial) break;
+				}
+			}
+		}
+		
+		$s = '<p><b>Explain</b>: '.htmlspecialchars($sql).'</p>';
+		$this->conn->Execute("SET SHOWPLAN_ALL ON;");
+		$sql = str_replace('?',"''",$sql);
+		global $ADODB_FETCH_MODE;
+		
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		$rs =& $this->conn->Execute($sql);
+		//adodb_printr($rs);
+		$ADODB_FETCH_MODE = $save;
+		if ($rs) {
+			$rs->MoveNext();
+			$s .= '<table bgcolor=white border=0 cellpadding="1" callspacing=0><tr><td nowrap align=center> Rows<td nowrap align=center> IO<td nowrap align=center> CPU<td align=left> &nbsp; &nbsp; Plan</tr>';
+			while (!$rs->EOF) {
+				$s .= '<tr><td>'.round($rs->fields[8],1).'<td>'.round($rs->fields[9],3).'<td align=right>'.round($rs->fields[10],3).'<td nowrap><pre>'.htmlspecialchars($rs->fields[0])."</td></pre></tr>\n"; ## NOTE CORRUPT </td></pre> tag is intentional!!!!
+				$rs->MoveNext();
+			}
+			$s .= '</table>';
+			
+			$rs->NextRecordSet();
+		}
+		
+		$this->conn->Execute("SET SHOWPLAN_ALL OFF;");
+		$this->conn->LogSQL($save);
+		$s .= $this->Tracer($sql);
+		return $s;
+	}
+	
+	function Tables()
+	{
+	global $ADODB_FETCH_MODE;
+	
+		$save = $ADODB_FETCH_MODE;
+		$ADODB_FETCH_MODE = ADODB_FETCH_NUM;
+		//$this->conn->debug=1;
+		$s = '<table border=1 bgcolor=white><tr><td><b>tablename</b></td><td><b>size_in_k</b></td><td><b>index size</b></td><td><b>reserved size</b></td></tr>';
+		$rs1 = $this->conn->Execute("select distinct name from sysobjects where xtype='U'");
+		if ($rs1) {
+			while (!$rs1->EOF) {
+				$tab = $rs1->fields[0];
+				$tabq = $this->conn->qstr($tab);
+				$rs2 = $this->conn->Execute("sp_spaceused $tabq");
+				if ($rs2) {
+					$s .= '<tr><td>'.$tab.'</td><td align=right>'.$rs2->fields[3].'</td><td align=right>'.$rs2->fields[4].'</td><td align=right>'.$rs2->fields[2].'</td></tr>';
+					$rs2->Close();
+				}
+				$rs1->MoveNext();
+			}
+			$rs1->Close();
+		}
+		$ADODB_FETCH_MODE = $save;
+		return $s.'</table>';
+	}
+	
+	function sp_who()
+	{
+		$arr = $this->conn->GetArray('sp_who');
+		return sizeof($arr);
+	}
+	
+	function HealthCheck($cli=false)
+	{
+		
+		$this->conn->Execute('dbcc traceon(3604)');
+		$html =  adodb_perf::HealthCheck($cli);
+		$this->conn->Execute('dbcc traceoff(3604)');
+		return $html;
+	}
+	
+	
+}
+
+?>
\ No newline at end of file
diff --git a/third_party/adodb/perf/perf-mysql.inc.php b/third_party/adodb/perf/perf-mysql.inc.php
index 9f35e1c..3c5e345 100644
--- a/third_party/adodb/perf/perf-mysql.inc.php
+++ b/third_party/adodb/perf/perf-mysql.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
diff --git a/third_party/adodb/perf/perf-oci8.inc.php b/third_party/adodb/perf/perf-oci8.inc.php
index 7512805..d5e75aa 100644
--- a/third_party/adodb/perf/perf-oci8.inc.php
+++ b/third_party/adodb/perf/perf-oci8.inc.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
@@ -16,11 +16,14 @@ V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights re
 if (!defined('ADODB_DIR')) die();
 
 class perf_oci8 extends ADODB_perf{
+
+	var $noShowIxora = 15; // if the sql for suspicious sql is taking too long, then disable ixora
 	
 	var $tablesSQL = "select segment_name as \"tablename\", sum(bytes)/1024 as \"size_in_k\",tablespace_name as \"tablespace\",count(*) \"extents\" from sys.user_extents 
 	   group by segment_name,tablespace_name";
 	 
 	var $version;
+	
 	var $createTableSQL = "CREATE TABLE adodb_logsql (
 		  created date NOT NULL,
 		  sql0 varchar(250) NOT NULL,
@@ -68,6 +71,7 @@ AND    b.name = 'sorts (memory)'",
 		"select value from v\$sysstat where name='physical writes'"),
 	
 	'Data Cache',
+	
 		'data cache buffers' => array( 'DATAC',
 		"select a.value/b.value  from v\$parameter a, v\$parameter b 
 			where a.name = 'db_cache_size' and b.name= 'db_block_size'",
@@ -75,8 +79,15 @@ AND    b.name = 'sorts (memory)'",
 		'data cache blocksize' => array('DATAC',
 			"select value from v\$parameter where name='db_block_size'",
 			'' ),			
+	
 	'Memory Pools',
-		'data cache size' => array('DATAC',
+		'SGA Max Size' => array( 'DATAC',
+		"select value from v\$parameter where name = 'sga_max_size'",
+			'The sga_max_size is the maximum value to which sga_target can be set.' ),
+	'SGA target' => array( 'DATAC',
+		"select value from v\$parameter where name = 'sga_target'",
+			'If sga_target is defined then data cache, shared, java and large pool size can be 0. This is because all these pools are consolidated into one sga_target.' ),
+	'data cache size' => array('DATAC',
 			"select value from v\$parameter where name = 'db_cache_size'",
 			'db_cache_size' ),
 		'shared pool size' => array('DATAC',
@@ -430,7 +441,11 @@ order by
 		if (isset($_GET['sql'])) return $this->_SuspiciousSQL($numsql);
 		
 		$s = '';
+		$timer = time();
 		$s .= $this->_SuspiciousSQL($numsql);
+		$timer = time() - $timer;
+		
+		if ($timer > $this->noShowIxora) return $s;
 		$s .= '<p>';
 		
 		$save = $ADODB_CACHE_MODE;
@@ -502,7 +517,11 @@ order by
 		}
 		
 		$s = '';		
+		$timer = time();
 		$s .= $this->_ExpensiveSQL($numsql);
+		$timer = time() - $timer;
+		if ($timer > $this->noShowIxora) return $s;
+		
 		$s .= '<p>';
 		$save = $ADODB_CACHE_MODE;
 		$ADODB_CACHE_MODE = ADODB_FETCH_NUM;
@@ -536,11 +555,12 @@ BEGIN
 	LOOP
 	  cnt := cnt + 1;
 	  DELETE FROM $perf_table WHERE ROWID=rec.rr;
-	  IF cnt = 10000 THEN
+	  IF cnt = 1000 THEN
 	  	COMMIT;
 		cnt := 0;
 	  END IF;
 	END LOOP;
+	commit;
 END;";
 
 		$ok = $this->conn->Execute($sql);
diff --git a/third_party/adodb/perf/perf-postgres.inc.php b/third_party/adodb/perf/perf-postgres.inc.php
index 8743644..b376529 100644
--- a/third_party/adodb/perf/perf-postgres.inc.php
+++ b/third_party/adodb/perf/perf-postgres.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /* 
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. See License.txt. 
diff --git a/third_party/adodb/pivottable.inc.php b/third_party/adodb/pivottable.inc.php
index 628ad3c..8978903 100644
--- a/third_party/adodb/pivottable.inc.php
+++ b/third_party/adodb/pivottable.inc.php
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V4.93 10 Oct 2006 (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V4.93 10 Oct 2006 (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
diff --git a/third_party/adodb/readme.txt b/third_party/adodb/readme.txt
index 009b94c..97bdd9e 100644
--- a/third_party/adodb/readme.txt
+++ b/third_party/adodb/readme.txt
@@ -1,62 +1,62 @@
->> ADODB Library for PHP4
-
-(c) 2000-2004 John Lim (jlim@natsoft.com.my)
-
-Released under both BSD and GNU Lesser GPL library license. 
-This means you can use it in proprietary products.
- 
- 
->> Introduction
-
-PHP's database access functions are not standardised. This creates a 
-need for a database class library to hide the differences between the 
-different databases (encapsulate the differences) so we can easily 
-switch databases.
-
-We currently support MySQL, Interbase, Sybase, PostgreSQL, Oracle, 
-Microsoft SQL server,  Foxpro ODBC, Access ODBC, Informix, DB2,
-Sybase SQL Anywhere, generic ODBC and Microsoft's ADO. 
-
-We hope more people will contribute drivers to support other databases.
-
-
->> Documentation and Examples
-
-Refer to the adodb/docs directory for full documentation and examples. 
-There is also a  tutorial tute.htm that contrasts ADODB code with 
-mysql code.
-
-
->>> Files
-Adodb.inc.php is the main file. You need to include only this file.
-
-Adodb-*.inc.php are the database specific driver code.
-
-Test.php contains a list of test commands to exercise the class library.
-
-Adodb-session.php is the PHP4 session handling code.
-
-Testdatabases.inc.php contains the list of databases to apply the tests on.
-
-Benchmark.php is a simple benchmark to test the throughput of a simple SELECT 
-statement for databases described in testdatabases.inc.php. The benchmark
-tables are created in test.php.
-
-readme.htm is the main documentation.
-
-tute.htm is the tutorial.
-
-
->> More Info
-
-For more information, including installation see readme.htm
-or visit
-           http://adodb.sourceforge.net/
-
-
->> Feature Requests and Bug Reports
-
-Email to jlim@natsoft.com.my 
-
-
+>> ADODB Library for PHP4
+
+(c) 2000-2004 John Lim (jlim@natsoft.com.my)
+
+Released under both BSD and GNU Lesser GPL library license. 
+This means you can use it in proprietary products.
+ 
+ 
+>> Introduction
+
+PHP's database access functions are not standardised. This creates a 
+need for a database class library to hide the differences between the 
+different databases (encapsulate the differences) so we can easily 
+switch databases.
+
+We currently support MySQL, Interbase, Sybase, PostgreSQL, Oracle, 
+Microsoft SQL server,  Foxpro ODBC, Access ODBC, Informix, DB2,
+Sybase SQL Anywhere, generic ODBC and Microsoft's ADO. 
+
+We hope more people will contribute drivers to support other databases.
+
+
+>> Documentation and Examples
+
+Refer to the adodb/docs directory for full documentation and examples. 
+There is also a  tutorial tute.htm that contrasts ADODB code with 
+mysql code.
+
+
+>>> Files
+Adodb.inc.php is the main file. You need to include only this file.
+
+Adodb-*.inc.php are the database specific driver code.
+
+Test.php contains a list of test commands to exercise the class library.
+
+Adodb-session.php is the PHP4 session handling code.
+
+Testdatabases.inc.php contains the list of databases to apply the tests on.
+
+Benchmark.php is a simple benchmark to test the throughput of a simple SELECT 
+statement for databases described in testdatabases.inc.php. The benchmark
+tables are created in test.php.
+
+readme.htm is the main documentation.
+
+tute.htm is the tutorial.
+
+
+>> More Info
+
+For more information, including installation see readme.htm
+or visit
+           http://adodb.sourceforge.net/
+
+
+>> Feature Requests and Bug Reports
+
+Email to jlim@natsoft.com.my 
+
+
  
\ No newline at end of file
diff --git a/third_party/adodb/rsfilter.inc.php b/third_party/adodb/rsfilter.inc.php
index 7033a80..6f3d646 100644
--- a/third_party/adodb/rsfilter.inc.php
+++ b/third_party/adodb/rsfilter.inc.php
@@ -1,6 +1,6 @@
 <?php
 /** 
- * @version V4.93 10 Oct 2006 (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V4.93 10 Oct 2006 (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
diff --git a/third_party/adodb/server.php b/third_party/adodb/server.php
index 694b7f2..c696f39 100644
--- a/third_party/adodb/server.php
+++ b/third_party/adodb/server.php
@@ -1,7 +1,7 @@
 <?php
 
 /** 
- * @version V4.93 10 Oct 2006 (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V4.93 10 Oct 2006 (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/session/adodb-compress-bzip2.php b/third_party/adodb/session/adodb-compress-bzip2.php
index a820102..c3dd3d8 100644
--- a/third_party/adodb/session/adodb-compress-bzip2.php
+++ b/third_party/adodb/session/adodb-compress-bzip2.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-compress-gzip.php b/third_party/adodb/session/adodb-compress-gzip.php
index 5bb4e16..e5a4486 100644
--- a/third_party/adodb/session/adodb-compress-gzip.php
+++ b/third_party/adodb/session/adodb-compress-gzip.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-cryptsession.php b/third_party/adodb/session/adodb-cryptsession.php
index b9cde1f..d29cf66 100644
--- a/third_party/adodb/session/adodb-cryptsession.php
+++ b/third_party/adodb/session/adodb-cryptsession.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-cryptsession2.php b/third_party/adodb/session/adodb-cryptsession2.php
index 07e2943..99e4ff6 100644
--- a/third_party/adodb/session/adodb-cryptsession2.php
+++ b/third_party/adodb/session/adodb-cryptsession2.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-encrypt-mcrypt.php b/third_party/adodb/session/adodb-encrypt-mcrypt.php
index ea57ef4..71e9450 100644
--- a/third_party/adodb/session/adodb-encrypt-mcrypt.php
+++ b/third_party/adodb/session/adodb-encrypt-mcrypt.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-encrypt-md5.php b/third_party/adodb/session/adodb-encrypt-md5.php
index 04a7478..4517d6c 100644
--- a/third_party/adodb/session/adodb-encrypt-md5.php
+++ b/third_party/adodb/session/adodb-encrypt-md5.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-encrypt-secret.php b/third_party/adodb/session/adodb-encrypt-secret.php
index b3b89ca..22ac80f 100644
--- a/third_party/adodb/session/adodb-encrypt-secret.php
+++ b/third_party/adodb/session/adodb-encrypt-secret.php
@@ -1,7 +1,7 @@
 <?php
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-encrypt-sha1.php b/third_party/adodb/session/adodb-encrypt-sha1.php
index 0884af6..16f603e 100644
--- a/third_party/adodb/session/adodb-encrypt-sha1.php
+++ b/third_party/adodb/session/adodb-encrypt-sha1.php
@@ -1,32 +1,32 @@
-<?php
-if (!defined('ADODB_SESSION')) die();
-
-include_once ADODB_SESSION . '/crypt.inc.php';
-
-
-/**
-
- */
-
-class ADODB_Encrypt_SHA1 {
-
-	function write($data, $key) 
-	{
-		$sha1crypt = new SHA1Crypt();
-		return $sha1crypt->encrypt($data, $key);
-
-	}
-
-
-	function read($data, $key) 
-	{
-		$sha1crypt = new SHA1Crypt();
-		return $sha1crypt->decrypt($data, $key);
-
-	}
-}
-
-
-
-return 1;
+<?php
+if (!defined('ADODB_SESSION')) die();
+
+include_once ADODB_SESSION . '/crypt.inc.php';
+
+
+/**
+
+ */
+
+class ADODB_Encrypt_SHA1 {
+
+	function write($data, $key) 
+	{
+		$sha1crypt = new SHA1Crypt();
+		return $sha1crypt->encrypt($data, $key);
+
+	}
+
+
+	function read($data, $key) 
+	{
+		$sha1crypt = new SHA1Crypt();
+		return $sha1crypt->decrypt($data, $key);
+
+	}
+}
+
+
+
+return 1;
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/session/adodb-sess.txt b/third_party/adodb/session/adodb-sess.txt
index c6c7685..d23dac4 100644
--- a/third_party/adodb/session/adodb-sess.txt
+++ b/third_party/adodb/session/adodb-sess.txt
@@ -1,131 +1,131 @@
-John,
-
-I have been an extremely satisfied ADODB user for several years now.
-
-To give you something back for all your hard work, I've spent the last 3
-days rewriting the adodb-session.php code.
-
-----------
-What's New
-----------
-
-Here's a list of the new code's benefits:
-
-* Combines the functionality of the three files:
-
-adodb-session.php
-adodb-session-clob.php
-adodb-cryptsession.php
-
-each with very similar functionality, into a single file adodb-session.php.
-This will ease maintenance and support issues.
-
-* Supports multiple encryption and compression schemes.
-  Currently, we support:
-
-  MD5Crypt (crypt.inc.php)
-  MCrypt
-  Secure (Horde's emulation of MCrypt, if MCrypt module is not available.)
-  GZip
-  BZip2
-
-These can be stacked, so if you want to compress and then encrypt your
-session data, it's easy.
-Also, the built-in MCrypt functions will be *much* faster, and more secure,
-than the MD5Crypt code.
-
-* adodb-session.php contains a single class ADODB_Session that encapsulates
-all functionality.
-  This eliminates the use of global vars and defines (though they are
-supported for backwards compatibility).
-
-* All user defined parameters are now static functions in the ADODB_Session
-class.
-
-New parameters include:
-
-* encryptionKey(): Define the encryption key used to encrypt the session.
-Originally, it was a hard coded string.
-
-* persist(): Define if the database will be opened in persistent mode.
-Originally, the user had to call adodb_sess_open().
-
-* dataFieldName(): Define the field name used to store the session data, as
-'DATA' appears to be a reserved word in the following cases:
-	ANSI SQL
-	IBM DB2
-	MS SQL Server
-	Postgres
-	SAP
-
-* filter(): Used to support multiple, simulataneous encryption/compression
-schemes.
-
-* Debug support is improved thru _rsdump() function, which is called after
-every database call.
-
-------------
-What's Fixed
-------------
-
-The new code includes several bug fixes and enhancements:
-
-* sesskey is compared in BINARY mode for MySQL, to avoid problems with
-session keys that differ only by case.
-  Of course, the user should define the sesskey field as BINARY, to
-correctly fix this problem, otherwise performance will suffer.
-
-* In ADODB_Session::gc(), if $expire_notify is true, the multiple DELETES in
-the original code have been optimized to a single DELETE.
-
-* In ADODB_Session::destroy(), since "SELECT expireref, sesskey FROM $table
-WHERE sesskey = $qkey" will only return a single value, we don't loop on the
-result, we simply process the row, if any.
-
-* We close $rs after every use.
-
----------------
-What's the Same
----------------
-
-I know backwards compatibility is *very* important to you.  Therefore, the
-new code is 100% backwards compatible.
-
-If you like my code, but don't "trust" it's backwards compatible, maybe we
-offer it as beta code, in a new directory for a release or two?
-
-------------
-What's To Do
-------------
-
-I've vascillated over whether to use a single function to get/set
-parameters:
-
-$user = ADODB_Session::user(); 	// get
-ADODB_Session::user($user);		// set
-
-or to use separate functions (which is the PEAR/Java way):
-
-$user = ADODB_Session::getUser();
-ADODB_Session::setUser($user);
-
-I've chosen the former as it's makes for a simpler API, and reduces the
-amount of code, but I'd be happy to change it to the latter.
-
-Also, do you think the class should be a singleton class, versus a static
-class?
-
-Let me know if you find this code useful, and will be including it in the
-next release of ADODB.
-
-If so, I will modify the current documentation to detail the new
-functionality.  To that end, what file(s) contain the documentation?  Please
-send them to me if they are not publically available.
-
-Also, if there is *anything* in the code that you like to see changed, let
-me know.
-
-Thanks,
-
-Ross
-
+John,
+
+I have been an extremely satisfied ADODB user for several years now.
+
+To give you something back for all your hard work, I've spent the last 3
+days rewriting the adodb-session.php code.
+
+----------
+What's New
+----------
+
+Here's a list of the new code's benefits:
+
+* Combines the functionality of the three files:
+
+adodb-session.php
+adodb-session-clob.php
+adodb-cryptsession.php
+
+each with very similar functionality, into a single file adodb-session.php.
+This will ease maintenance and support issues.
+
+* Supports multiple encryption and compression schemes.
+  Currently, we support:
+
+  MD5Crypt (crypt.inc.php)
+  MCrypt
+  Secure (Horde's emulation of MCrypt, if MCrypt module is not available.)
+  GZip
+  BZip2
+
+These can be stacked, so if you want to compress and then encrypt your
+session data, it's easy.
+Also, the built-in MCrypt functions will be *much* faster, and more secure,
+than the MD5Crypt code.
+
+* adodb-session.php contains a single class ADODB_Session that encapsulates
+all functionality.
+  This eliminates the use of global vars and defines (though they are
+supported for backwards compatibility).
+
+* All user defined parameters are now static functions in the ADODB_Session
+class.
+
+New parameters include:
+
+* encryptionKey(): Define the encryption key used to encrypt the session.
+Originally, it was a hard coded string.
+
+* persist(): Define if the database will be opened in persistent mode.
+Originally, the user had to call adodb_sess_open().
+
+* dataFieldName(): Define the field name used to store the session data, as
+'DATA' appears to be a reserved word in the following cases:
+	ANSI SQL
+	IBM DB2
+	MS SQL Server
+	Postgres
+	SAP
+
+* filter(): Used to support multiple, simulataneous encryption/compression
+schemes.
+
+* Debug support is improved thru _rsdump() function, which is called after
+every database call.
+
+------------
+What's Fixed
+------------
+
+The new code includes several bug fixes and enhancements:
+
+* sesskey is compared in BINARY mode for MySQL, to avoid problems with
+session keys that differ only by case.
+  Of course, the user should define the sesskey field as BINARY, to
+correctly fix this problem, otherwise performance will suffer.
+
+* In ADODB_Session::gc(), if $expire_notify is true, the multiple DELETES in
+the original code have been optimized to a single DELETE.
+
+* In ADODB_Session::destroy(), since "SELECT expireref, sesskey FROM $table
+WHERE sesskey = $qkey" will only return a single value, we don't loop on the
+result, we simply process the row, if any.
+
+* We close $rs after every use.
+
+---------------
+What's the Same
+---------------
+
+I know backwards compatibility is *very* important to you.  Therefore, the
+new code is 100% backwards compatible.
+
+If you like my code, but don't "trust" it's backwards compatible, maybe we
+offer it as beta code, in a new directory for a release or two?
+
+------------
+What's To Do
+------------
+
+I've vascillated over whether to use a single function to get/set
+parameters:
+
+$user = ADODB_Session::user(); 	// get
+ADODB_Session::user($user);		// set
+
+or to use separate functions (which is the PEAR/Java way):
+
+$user = ADODB_Session::getUser();
+ADODB_Session::setUser($user);
+
+I've chosen the former as it's makes for a simpler API, and reduces the
+amount of code, but I'd be happy to change it to the latter.
+
+Also, do you think the class should be a singleton class, versus a static
+class?
+
+Let me know if you find this code useful, and will be including it in the
+next release of ADODB.
+
+If so, I will modify the current documentation to detail the new
+functionality.  To that end, what file(s) contain the documentation?  Please
+send them to me if they are not publically available.
+
+Also, if there is *anything* in the code that you like to see changed, let
+me know.
+
+Thanks,
+
+Ross
+
diff --git a/third_party/adodb/session/adodb-session-clob.php b/third_party/adodb/session/adodb-session-clob.php
index 603e3d1..dbe5a7a 100644
--- a/third_party/adodb/session/adodb-session-clob.php
+++ b/third_party/adodb/session/adodb-session-clob.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-session-clob2.php b/third_party/adodb/session/adodb-session-clob2.php
index c9f39af..c6f7d4e 100644
--- a/third_party/adodb/session/adodb-session-clob2.php
+++ b/third_party/adodb/session/adodb-session-clob2.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
diff --git a/third_party/adodb/session/adodb-session.php b/third_party/adodb/session/adodb-session.php
index 94ebf99..42d8c2c 100644
--- a/third_party/adodb/session/adodb-session.php
+++ b/third_party/adodb/session/adodb-session.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
@@ -700,7 +700,7 @@ class ADODB_Session {
 		}
 
 		if (!$clob) {	// no lobs, simply use replace()
-			$arr[$data] = $conn->qstr($val);
+			$arr[$data] = $val;
 			$rs = $conn->Replace($table, $arr, 'sesskey', $autoQuote = true);
 			
 		} else {
@@ -856,7 +856,7 @@ class ADODB_Session {
 				$arr = $conn->GetAll($sql);
 				foreach ($arr as $row) {
 					$sql2 = "DELETE FROM $table WHERE sesskey=".$conn->Param('0');
-					$conn->Execute($sql2,array($row[0]));
+					$conn->Execute($sql2,array(reset($row)));
 				}
 			} else {
 				$sql = "DELETE FROM $table WHERE expiry < $time";
diff --git a/third_party/adodb/session/adodb-session2.php b/third_party/adodb/session/adodb-session2.php
index e853933..820bf4d 100644
--- a/third_party/adodb/session/adodb-session2.php
+++ b/third_party/adodb/session/adodb-session2.php
@@ -2,7 +2,7 @@
 
 
 /*
-V5.02 24 Sept 2007   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
          Contributed by Ross Smith (adodb@netebb.com). 
   Released under both BSD license and Lesser GPL library license.
   Whenever there is any discrepancy between the two licenses,
@@ -444,7 +444,7 @@ class ADODB_Session {
 	/*!
 	*/
 	static function _conn($conn=null) {
-		return @$GLOBALS['ADODB_SESS_CONN'];
+		return isset($GLOBALS['ADODB_SESS_CONN']) ? $GLOBALS['ADODB_SESS_CONN'] : false;
 	}
 
 	/*!
@@ -484,7 +484,7 @@ class ADODB_Session {
 
 	/*!
 	*/
-	static function _dumprs($rs) {
+	static function _dumprs(&$rs) {
 		$conn	= ADODB_Session::_conn();
 		$debug	= ADODB_Session::debug();
 
@@ -506,9 +506,11 @@ class ADODB_Session {
 		if (!is_object($rs)) {
 			return;
 		}
-
+		$rs = $conn->_rs2rs($rs);
+		
 		require_once ADODB_SESSION.'/../tohtml.inc.php';
 		rs2html($rs);
+		$rs->MoveFirst();
 	}
 
 	/////////////////////
@@ -614,18 +616,16 @@ class ADODB_Session {
 
 		//assert('$table');
 
-		$qkey = $conn->quote($key);
 		$binary = $conn->dataProvider === 'mysql' ? '/*! BINARY */' : '';
 	
-		$sql = "SELECT sessdata FROM $table WHERE sesskey = $binary $qkey AND expiry >= " . $conn->sysTimeStamp;
+		$sql = "SELECT sessdata FROM $table WHERE sesskey = $binary ".$conn->Param(0)." AND expiry >= " . $conn->sysTimeStamp;
 		/* Lock code does not work as it needs to hold transaction within whole page, and we don't know if 
 		  developer has commited elsewhere... :(
 		 */
 		#if (ADODB_Session::Lock())
 		#	$rs = $conn->RowLock($table, "$binary sesskey = $qkey AND expiry >= " . time(), sessdata);
 		#else
-		
-			$rs = $conn->Execute($sql);
+			$rs = $conn->Execute($sql, array($key));
 		//ADODB_Session::_dumprs($rs);
 		if ($rs) {
 			if ($rs->EOF) {
@@ -836,7 +836,6 @@ class ADODB_Session {
 
 		$sql = "DELETE FROM $table WHERE $binary sesskey = $qkey";
 		$rs = $conn->Execute($sql);
-		ADODB_Session::_dumprs($rs);
 		if ($rs) {
 			$rs->Close();
 		}
@@ -860,54 +859,53 @@ class ADODB_Session {
 
 
 		$debug			= ADODB_Session::debug();
-		if ($debug) $conn->debug = 1;
+		if ($debug) {
+			$conn->debug = 1;
+			$COMMITNUM = 2;
+		} else {
+			$COMMITNUM = 20;
+		}
 		
 		//assert('$table');
 
-		$time = $conn->sysTimeStamp;
+		$time = $conn->OffsetDate(-$maxlifetime/24/3600,$conn->sysTimeStamp);
 		$binary = $conn->dataProvider === 'mysql' ? '/*! BINARY */' : '';
 
 		if ($expire_notify) {
 			reset($expire_notify);
 			$fn = next($expire_notify);
-			$savem = $conn->SetFetchMode(ADODB_FETCH_NUM);
-			$sql = "SELECT expireref, sesskey FROM $table WHERE expiry < $time";
-			$rs = $conn->Execute($sql);
-			ADODB_Session::_dumprs($rs);
-			$conn->SetFetchMode($savem);
-			if ($rs) {
-				$conn->StartTrans();
-				$keys = array();
-				while (!$rs->EOF) {
-					$ref = $rs->fields[0];
-					$key = $rs->fields[1];
-					$fn($ref, $key);
-					$del = $conn->Execute("DELETE FROM $table WHERE sesskey=".$conn->Param('0'),array($key));
-					$rs->MoveNext();
-				}
-				$rs->Close();
-				
-				$conn->CompleteTrans();
-			}
 		} else {
+			$fn = false;
+		}
 		
-			if (0) {
-				$sql = "SELECT sesskey FROM $table WHERE expiry < $time";
-				$arr = $conn->GetAll($sql);
-				foreach ($arr as $row) {
-					$sql2 = "DELETE FROM $table WHERE sesskey=".$conn->Param('0');
-					$conn->Execute($sql2,array($row[0]));
+		$savem = $conn->SetFetchMode(ADODB_FETCH_NUM);
+		$sql = "SELECT expireref, sesskey FROM $table WHERE expiry < $time ORDER BY 2"; # add order by to prevent deadlock
+		$rs = $conn->SelectLimit($sql,1000);
+		ADODB_Session::_dumprs($rs);
+		if ($debug) $conn->SetFetchMode($savem);
+		if ($rs) {
+			$tr = $conn->hasTransactions;
+			if ($tr) $conn->BeginTrans();
+			$keys = array();
+			$ccnt = 0;
+			while (!$rs->EOF) {
+				$ref = $rs->fields[0];
+				$key = $rs->fields[1];
+				if ($fn) $fn($ref, $key);
+				$del = $conn->Execute("DELETE FROM $table WHERE sesskey=".$conn->Param('0'),array($key));
+				$rs->MoveNext();
+				$ccnt += 1;
+				if ($tr && $ccnt % $COMMITNUM == 0) {
+					if ($debug) echo "Commit<br>\n";
+					$conn->CommitTrans();
+					$conn->BeginTrans();
 				}
-			} else {
-				$sql = "DELETE FROM $table WHERE expiry < $time";
-				$rs = $conn->Execute($sql);
-				ADODB_Session::_dumprs($rs);
-				if ($rs) $rs->Close();
-			}
-			if ($debug) {
-				ADOConnection::outp("<p><b>Garbage Collection</b>: $sql</p>");
 			}
+			$rs->Close();
+			
+			if ($tr) $conn->CommitTrans();
 		}
+		
 
 		// suggested by Cameron, "GaM3R" <gamr@outworld.cx>
 		if ($optimize) {
diff --git a/third_party/adodb/session/old/adodb-cryptsession.php b/third_party/adodb/session/old/adodb-cryptsession.php
index 8ae983f..d596952 100644
--- a/third_party/adodb/session/old/adodb-cryptsession.php
+++ b/third_party/adodb/session/old/adodb-cryptsession.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V5.04a 25 Mar 2008   (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V5.10 10 Nov 2009   (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/session/old/adodb-session-clob.php b/third_party/adodb/session/old/adodb-session-clob.php
index 84e5ae0..6b8572d 100644
--- a/third_party/adodb/session/old/adodb-session-clob.php
+++ b/third_party/adodb/session/old/adodb-session-clob.php
@@ -1,6 +1,6 @@
 <?php
 /*
-  V4.93 10 Oct 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V4.93 10 Oct 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/session/old/adodb-session.php b/third_party/adodb/session/old/adodb-session.php
index a3c141d..31b48e5 100644
--- a/third_party/adodb/session/old/adodb-session.php
+++ b/third_party/adodb/session/old/adodb-session.php
@@ -1,6 +1,6 @@
 <?php
 /*
-V4.93 10 Oct 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.93 10 Oct 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/tests/benchmark.php b/third_party/adodb/tests/benchmark.php
index fd9dc6e..936821e 100644
--- a/third_party/adodb/tests/benchmark.php
+++ b/third_party/adodb/tests/benchmark.php
@@ -8,7 +8,7 @@
 <body>
 <?php 
 /*
-V4.81 3 May 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.81 3 May 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/tests/client.php b/third_party/adodb/tests/client.php
index b969b70..7bf145e 100644
--- a/third_party/adodb/tests/client.php
+++ b/third_party/adodb/tests/client.php
@@ -2,7 +2,7 @@
 <body bgcolor=white>
 <?php
 /** 
- * V4.50 6 July 2004  (c) 2001-2002 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * V4.50 6 July 2004  (c) 2001-2002 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/tests/pdo.php b/third_party/adodb/tests/pdo.php
index b66018f..e4c1a46 100644
--- a/third_party/adodb/tests/pdo.php
+++ b/third_party/adodb/tests/pdo.php
@@ -1,94 +1,94 @@
-<?php
-error_reporting(E_ALL);
-include('../adodb.inc.php');
-
-echo "<pre>";
-try {
-	echo "New Connection\n";
-	
-	
-	$dsn = 'pdo_mysql://root:@localhost/northwind?persist';
-	
-	if (!empty($dsn)) {
-		$DB = NewADOConnection($dsn) || die("CONNECT FAILED");
-		$connstr = $dsn;
-	} else {
-	
-		$DB = NewADOConnection('pdo');
-		
-		echo "Connect\n";
-		
-		$u = ''; $p = '';
-		/*
-		$connstr = 'odbc:nwind';
-		
-		$connstr = 'oci:';
-		$u = 'scott';
-		$p = 'natsoft';
-		
-		
-		$connstr ="sqlite:d:\inetpub\adodb\sqlite.db";
-		*/
-		
-		$connstr = "mysql:dbname=northwind";
-		$u = 'root';
-		
-		$connstr = "pgsql:dbname=test";
-		$u = 'tester';
-		$p = 'test';
-		
-		$DB->Connect($connstr,$u,$p) || die("CONNECT FAILED");
-	
-	}
-	
-	echo "connection string=$connstr\n Execute\n";
-	
-	//$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
-	$rs = $DB->Execute("select * from ADOXYZ where id<3");
-	if  ($DB->ErrorNo()) echo "*** errno=".$DB->ErrorNo() . " ".($DB->ErrorMsg())."\n";
-	
-	
-	//print_r(get_class_methods($DB->_stmt));
-	
-	if (!$rs) die("NO RS");
-	
-	echo "Meta\n";
-	for ($i=0; $i < $rs->NumCols(); $i++) {
-		var_dump($rs->FetchField($i));
-		echo "<br>";
-	}
-	
-	echo "FETCH\n";
-	$cnt = 0;
-	while (!$rs->EOF) {
-		adodb_pr($rs->fields); 
-		$rs->MoveNext();
-		if ($cnt++ > 1000) break;
-	}
-	
-	echo "<br>--------------------------------------------------------<br>\n\n\n";
-	
-	$stmt = $DB->PrepareStmt("select * from ADOXYZ");
-	
-	$rs = $stmt->Execute();
-	$cols = $stmt->NumCols(); // execute required
-	
-	echo "COLS = $cols";
-	for($i=1;$i<=$cols;$i++) {
-		$v = $stmt->_stmt->getColumnMeta($i);
-		var_dump($v);
-	}
-	
-	echo "e=".$stmt->ErrorNo() . " ".($stmt->ErrorMsg())."\n";
-	while ($arr = $rs->FetchRow()) {
-		adodb_pr($arr);
-	}
-	die("DONE\n");
-
-} catch (exception $e) {
-	echo "<pre>";
-	echo $e;
-	echo "</pre>";
-}
-
+<?php
+error_reporting(E_ALL);
+include('../adodb.inc.php');
+
+echo "<pre>";
+try {
+	echo "New Connection\n";
+	
+	
+	$dsn = 'pdo_mysql://root:@localhost/northwind?persist';
+	
+	if (!empty($dsn)) {
+		$DB = NewADOConnection($dsn) || die("CONNECT FAILED");
+		$connstr = $dsn;
+	} else {
+	
+		$DB = NewADOConnection('pdo');
+		
+		echo "Connect\n";
+		
+		$u = ''; $p = '';
+		/*
+		$connstr = 'odbc:nwind';
+		
+		$connstr = 'oci:';
+		$u = 'scott';
+		$p = 'natsoft';
+		
+		
+		$connstr ="sqlite:d:\inetpub\adodb\sqlite.db";
+		*/
+		
+		$connstr = "mysql:dbname=northwind";
+		$u = 'root';
+		
+		$connstr = "pgsql:dbname=test";
+		$u = 'tester';
+		$p = 'test';
+		
+		$DB->Connect($connstr,$u,$p) || die("CONNECT FAILED");
+	
+	}
+	
+	echo "connection string=$connstr\n Execute\n";
+	
+	//$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;
+	$rs = $DB->Execute("select * from ADOXYZ where id<3");
+	if  ($DB->ErrorNo()) echo "*** errno=".$DB->ErrorNo() . " ".($DB->ErrorMsg())."\n";
+	
+	
+	//print_r(get_class_methods($DB->_stmt));
+	
+	if (!$rs) die("NO RS");
+	
+	echo "Meta\n";
+	for ($i=0; $i < $rs->NumCols(); $i++) {
+		var_dump($rs->FetchField($i));
+		echo "<br>";
+	}
+	
+	echo "FETCH\n";
+	$cnt = 0;
+	while (!$rs->EOF) {
+		adodb_pr($rs->fields); 
+		$rs->MoveNext();
+		if ($cnt++ > 1000) break;
+	}
+	
+	echo "<br>--------------------------------------------------------<br>\n\n\n";
+	
+	$stmt = $DB->PrepareStmt("select * from ADOXYZ");
+	
+	$rs = $stmt->Execute();
+	$cols = $stmt->NumCols(); // execute required
+	
+	echo "COLS = $cols";
+	for($i=1;$i<=$cols;$i++) {
+		$v = $stmt->_stmt->getColumnMeta($i);
+		var_dump($v);
+	}
+	
+	echo "e=".$stmt->ErrorNo() . " ".($stmt->ErrorMsg())."\n";
+	while ($arr = $rs->FetchRow()) {
+		adodb_pr($arr);
+	}
+	die("DONE\n");
+
+} catch (exception $e) {
+	echo "<pre>";
+	echo $e;
+	echo "</pre>";
+}
+
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/tests/test-active-record.php b/third_party/adodb/tests/test-active-record.php
index 084e271..85fb71c 100644
--- a/third_party/adodb/tests/test-active-record.php
+++ b/third_party/adodb/tests/test-active-record.php
@@ -11,10 +11,11 @@
 		}
 	}
 
-	$db = NewADOConnection('mysql://root@localhost/northwind');
+	$db = NewADOConnection('mysql://root@localhost/northwind?persist');
 	$db->debug=1;
 	ADOdb_Active_Record::SetDatabaseAdapter($db);
 
+	
 	$db->Execute("CREATE TEMPORARY TABLE `persons` (
 	                `id` int(10) unsigned NOT NULL auto_increment,
 	                `name_first` varchar(100) NOT NULL default '',
@@ -24,8 +25,19 @@
 	            ) ENGINE=MyISAM;
 	           ");
 			   
-	class Person extends ADOdb_Active_Record{}
+	$db->Execute("CREATE TEMPORARY TABLE `children` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+					`person_id` int(10) unsigned NOT NULL,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_pet` varchar(100) NOT NULL default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+			   
+	class Person extends ADOdb_Active_Record{ function ret($v) {return $v;} }
 	$person = new Person();
+	ADOdb_Active_Record::$_quoteNames = '111';
 	
 	echo "<p>Output of getAttributeNames: ";
 	var_dump($person->getAttributeNames());
@@ -71,12 +83,59 @@
 	$person2 = new Person();
 	$person2->Load('id=2');
 	
-	var_dump($person2);
-	
-	$activeArr = $db->GetActiveRecordsClass($class = "Person",$table = "persons","id=".$db->Param(0),array(2));
+	$activeArr = $db->GetActiveRecordsClass($class = "Person",$table = "Persons","id=".$db->Param(0),array(2));
 	$person2 = $activeArr[0];
-	echo "<p>Name (should be John): ",$person->name_first, " <br> Class (should be Person): ",get_class($person2);	
+	echo "<p>Name (should be John): ",$person->name_first, " <br> Class (should be Person): ",get_class($person2),"<br>";	
 	
+	$db->Execute("insert into children (person_id,name_first,name_last) values (2,'Jill','Lim')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (2,'Joan','Lim')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (2,'JAMIE','Lim')");
+	
+	$newperson2 = new Person();
+	$person2->HasMany('children','person_id');
+	$person2->Load('id=2');
+	$person2->name_last='green';
+	$c = $person2->children;
+	$person2->save();
 
+	if (is_array($c) && sizeof($c) == 3 && $c[0]->name_first=='Jill' && $c[1]->name_first=='Joan'
+		&& $c[2]->name_first == 'JAMIE') echo "OK Loaded HasMany</br>";
+	else {
+		var_dump($c);
+		echo "error loading hasMany should have 3 array elements Jill Joan Jamie<br>";
+	}
+	
+	class Child extends ADOdb_Active_Record{};
+	$ch = new Child('children',array('id'));
+	$ch->BelongsTo('person','person_id','id');
+	$ch->Load('id=1');
+	if ($ch->name_first !== 'Jill') echo "error in Loading Child<br>";
+	
+	$p = $ch->person;
+	if ($p->name_first != 'John') echo "Error loading belongsTo<br>";
+	else echo "OK loading BelongTo<br>";
 
+	$p->hasMany('children','person_id');
+	$p->LoadRelations('children', "	Name_first like 'J%' order by id",1,2);
+	if (sizeof($p->children) == 2 && $p->children[1]->name_first == 'JAMIE') echo "OK LoadRelations<br>";
+	else echo "error LoadRelations<br>";
+	
+		$db->Execute("CREATE TEMPORARY TABLE `persons2` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_color` varchar(100) default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+	
+	$p = new adodb_active_record('persons2');
+	$p->name_first = 'James';
+	
+	$p->name_last = 'James';
+	
+	$p->HasMany('children','person_id');
+	$p->children;
+	var_dump($p);
+	$p->Save();
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/tests/test-active-relations.php b/third_party/adodb/tests/test-active-relations.php
new file mode 100644
index 0000000..eb0f636
--- /dev/null
+++ b/third_party/adodb/tests/test-active-relations.php
@@ -0,0 +1,87 @@
+<?php
+
+	include_once('../adodb.inc.php');
+	include_once('../adodb-active-record.inc.php');
+	
+
+	$db = NewADOConnection('mysql://root@localhost/northwind');
+	$db->debug=1;
+	ADOdb_Active_Record::SetDatabaseAdapter($db);
+
+	$db->Execute("CREATE TEMPORARY TABLE `persons` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_color` varchar(100) NOT NULL default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+			   
+	$db->Execute("CREATE TEMPORARY TABLE `children` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+					`person_id` int(10) unsigned NOT NULL,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_pet` varchar(100) NOT NULL default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+			   
+	
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'Jill','Lim')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'Joan','Lim')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'JAMIE','Lim')");
+	
+	ADODB_Active_Record::TableHasMany('persons', 'children','person_id');
+	class person extends ADOdb_Active_Record{}
+	
+	$person = new person();
+#	$person->HasMany('children','person_id');  ## this is affects all other instances of Person
+	
+	$person->name_first     = 'John';
+	$person->name_last      = 'Lim';
+	$person->favorite_color = 'lavender';
+	$person->save(); // this save will perform an INSERT successfully
+	
+	$person2 = new person();
+	$person2->Load('id=1');
+	
+	$c = $person2->children;
+	if (is_array($c) && sizeof($c) == 3 && $c[0]->name_first=='Jill' && $c[1]->name_first=='Joan'
+		&& $c[2]->name_first == 'JAMIE') echo "OK Loaded HasMany</br>";
+	else {
+		var_dump($c);
+		echo "error loading hasMany should have 3 array elements Jill Joan Jamie<br>";
+	}
+	
+	class child extends ADOdb_Active_Record{};
+	ADODB_Active_Record::TableBelongsTo('children','person','person_id','id');
+	$ch = new Child('children',array('id'));
+	
+	$ch->Load('id=1');
+	if ($ch->name_first !== 'Jill') echo "error in Loading Child<br>";
+	
+	$p = $ch->person;
+	if (!$p || $p->name_first != 'John') echo "Error loading belongsTo<br>";
+	else echo "OK loading BelongTo<br>";
+
+	if ($p) {
+		#$p->HasMany('children','person_id');  ## this is affects all other instances of Person
+		$p->LoadRelations('children', 'order by id',1,2);
+		if (sizeof($p->children) == 2 && $p->children[1]->name_first == 'JAMIE') echo "OK LoadRelations<br>";
+		else {
+		 	var_dump($p->children);
+			echo "error LoadRelations<br>";
+		}
+		
+		unset($p->children);
+		$p->LoadRelations('children', " name_first like 'J%' order by id",1,2);
+	}
+	if ($p)
+	foreach($p->children as $c) {
+		echo " Saving $c->name_first <br>";
+		$c->name_first .= ' K.';
+		$c->Save();
+	}
+
+?>
\ No newline at end of file
diff --git a/third_party/adodb/tests/test-active-relationsx.php b/third_party/adodb/tests/test-active-relationsx.php
new file mode 100644
index 0000000..fbfddf6
--- /dev/null
+++ b/third_party/adodb/tests/test-active-relationsx.php
@@ -0,0 +1,419 @@
+<?php
+global $err_count;
+$err_count = 0;
+
+	function found($obj, $cond)
+	{
+		$res = var_export($obj, true);
+		return (strpos($res, $cond));		
+	}
+	
+	function notfound($obj, $cond)
+	{
+		return !found($obj, $cond);
+	}
+	
+	function ar_assert($bool)
+	{
+		global $err_count;
+		if(!$bool)
+			$err_count ++;
+		return $bool;
+	}
+	
+		define('WEB', true);
+	function ar_echo($txt)
+	{
+		if(WEB)
+			$txt = str_replace("\n", "<br />\n", $txt);
+		echo $txt;
+	}
+
+	include_once('../adodb.inc.php');
+	include_once('../adodb-active-recordx.inc.php');
+	
+
+	$db = NewADOConnection('mysql://root@localhost/test');
+	$db->debug=0;
+	ADOdb_Active_Record::SetDatabaseAdapter($db);
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("Preparing database using SQL queries (creating 'people', 'children')\n");
+
+	$db->Execute("DROP TABLE `people`");
+	$db->Execute("DROP TABLE `children`");
+	$db->Execute("DROP TABLE `artists`");
+	$db->Execute("DROP TABLE `songs`");
+
+	$db->Execute("CREATE TABLE `people` (
+	                `id` int(10) unsigned NOT NULL auto_increment,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_color` varchar(100) NOT NULL default '',
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+	$db->Execute("CREATE TABLE `children` (
+					`person_id` int(10) unsigned NOT NULL,
+	                `name_first` varchar(100) NOT NULL default '',
+	                `name_last` varchar(100) NOT NULL default '',
+	                `favorite_pet` varchar(100) NOT NULL default '',
+	                `id` int(10) unsigned NOT NULL auto_increment,
+	                PRIMARY KEY  (`id`)
+	            ) ENGINE=MyISAM;
+	           ");
+	
+	$db->Execute("CREATE TABLE `artists` (
+	                `name` varchar(100) NOT NULL default '',
+	                `artistuniqueid` int(10) unsigned NOT NULL auto_increment,
+	                PRIMARY KEY  (`artistuniqueid`)
+	            ) ENGINE=MyISAM;
+	           ");
+
+	$db->Execute("CREATE TABLE `songs` (
+	                `name` varchar(100) NOT NULL default '',
+	                `artistid` int(10) NOT NULL,
+	                `recordid` int(10) unsigned NOT NULL auto_increment,
+	                PRIMARY KEY  (`recordid`)
+	            ) ENGINE=MyISAM;
+	           ");
+
+	$db->Execute("insert into children (person_id,name_first,name_last,favorite_pet) values (1,'Jill','Lim','tortoise')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'Joan','Lim')");
+	$db->Execute("insert into children (person_id,name_first,name_last) values (1,'JAMIE','Lim')");
+			   
+	$db->Execute("insert into artists (artistuniqueid, name) values(1,'Elvis Costello')");
+	$db->Execute("insert into songs (recordid, name, artistid) values(1,'No Hiding Place', 1)");
+	$db->Execute("insert into songs (recordid, name, artistid) values(2,'American Gangster Time', 1)");
+
+	// This class _implicitely_ relies on the 'people' table (pluralized form of 'person')
+	class Person extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct();
+			$this->hasMany('children');
+		}
+	}
+	// This class _implicitely_ relies on the 'children' table
+	class Child extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct();
+			$this->belongsTo('person');
+		}
+	}
+	// This class _explicitely_ relies on the 'children' table and shares its metadata with Child
+	class Kid extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct('children');
+			$this->belongsTo('person');
+		}
+	}
+	// This class _explicitely_ relies on the 'children' table but does not share its metadata
+	class Rugrat extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct('children', false, false, array('new' => true));
+		}
+	}
+	
+	class Artist extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct('artists', array('artistuniqueid'));
+			$this->hasMany('songs', 'artistid');
+		}
+	}
+	class Song extends ADOdb_Active_Record
+	{
+		function __construct()
+		{
+			parent::__construct('songs', array('recordid'));
+			$this->belongsTo('artist', 'artistid');
+		}
+	}
+
+	ar_echo("Inserting person in 'people' table ('John Lim, he likes lavender')\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$person = new Person();
+	$person->name_first     = 'John';
+	$person->name_last      = 'Lim';
+	$person->favorite_color = 'lavender';
+	$person->save(); // this save will perform an INSERT successfully
+
+	$person = new Person();
+	$person->name_first		= 'Lady';
+	$person->name_last		= 'Cat';
+	$person->favorite_color	= 'green';
+	$person->save();
+	
+	$child = new Child();
+	$child->name_first		= 'Fluffy';
+	$child->name_last		= 'Cat';
+	$child->favorite_pet	= 'Cat Lady';
+	$child->person_id		= $person->id;
+	$child->save();
+	
+	$child = new Child();
+	$child->name_first		= 'Sun';
+	$child->name_last		= 'Cat';
+	$child->favorite_pet	= 'Cat Lady';
+	$child->person_id		= $person->id;
+	$child->save();
+	
+	$err_count = 0;
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("person->Find('id=1') [Lazy Method]\n");
+	ar_echo("person is loaded but its children will be loaded on-demand later on\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$person = new Person();
+	$people = $person->Find('id=1');
+	ar_echo((ar_assert(found($people, "'name_first' => 'John'"))) ? "[OK] Found John\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($people, "'favorite_pet' => 'tortoise'"))) ? "[OK] No relation yet\n" : "[!!] Found relation when I shouldn't\n");
+	ar_echo("\n-- Lazily Loading Children:\n\n");
+	foreach($people as $aperson)
+	{
+		foreach($aperson->children as $achild)
+		{
+			if($achild->name_first);
+		}
+	}
+	ar_echo((ar_assert(found($people, "'favorite_pet' => 'tortoise'"))) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'Joan'"))) ? "[OK] Found Joan\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'JAMIE'"))) ? "[OK] Found JAMIE\n" : "[!!] Find failed\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("person->Find('id=1' ... ADODB_WORK_AR) [Worker Method]\n");
+	ar_echo("person is loaded, and so are its children\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$person = new Person();
+	$people = $person->Find('id=1', false, false, array('loading' => ADODB_WORK_AR));
+	ar_echo((ar_assert(found($people, "'name_first' => 'John'"))) ? "[OK] Found John\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'favorite_pet' => 'tortoise'"))) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'Joan'"))) ? "[OK] Found Joan\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'JAMIE'"))) ? "[OK] Found JAMIE\n" : "[!!] Find failed\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("person->Find('id=1' ... ADODB_JOIN_AR) [Join Method]\n");
+	ar_echo("person and its children are loaded using a single query\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$person = new Person();
+	// When I specifically ask for a join, I have to specify which table id I am looking up
+	// otherwise the SQL parser will wonder which table's id that would be.
+	$people = $person->Find('people.id=1', false, false, array('loading' => ADODB_JOIN_AR));
+	ar_echo((ar_assert(found($people, "'name_first' => 'John'"))) ? "[OK] Found John\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'favorite_pet' => 'tortoise'"))) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'Joan'"))) ? "[OK] Found Joan\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'JAMIE'"))) ? "[OK] Found JAMIE\n" : "[!!] Find failed\n");
+		
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("person->Load('people.id=1') [Join Method]\n");
+	ar_echo("Load() always uses the join method since it returns only one row\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$person = new Person();
+	// Under the hood, Load(), since it returns only one row, always perform a join
+	// Therefore we need to clarify which id we are talking about.
+	$person->Load('people.id=1');
+	ar_echo((ar_assert(found($person, "'name_first' => 'John'"))) ? "[OK] Found John\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($person, "'favorite_pet' => 'tortoise'"))) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n");
+	ar_echo((ar_assert(found($person, "'name_first' => 'Joan'"))) ? "[OK] Found Joan\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($person, "'name_first' => 'JAMIE'"))) ? "[OK] Found JAMIE\n" : "[!!] Find failed\n");
+	
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("child->Load('children.id=1') [Join Method]\n");
+	ar_echo("We are now loading from the 'children' table, not from 'people'\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$child = new Child();
+	$child->Load('children.id=1');
+	ar_echo((ar_assert(found($child, "'name_first' => 'Jill'"))) ? "[OK] Found Jill\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($child, "'favorite_color' => 'lavender'"))) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("child->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$child = new Child();
+	$children = $child->Find('id=1', false, false, array('loading' => ADODB_WORK_AR));
+	ar_echo((ar_assert(found($children, "'name_first' => 'Jill'"))) ? "[OK] Found Jill\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($children, "'favorite_color' => 'lavender'"))) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n");
+	ar_echo((ar_assert(notfound($children, "'name_first' => 'Joan'"))) ? "[OK] No Joan relation\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($children, "'name_first' => 'JAMIE'"))) ? "[OK] No JAMIE relation\n" : "[!!] Find failed\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("kid->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n");
+	ar_echo("Where we see that kid shares relationships with child because they are stored\n");
+	ar_echo("in the common table's metadata structure.\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$kid = new Kid('children');
+	$kids = $kid->Find('children.id=1', false, false, array('loading' => ADODB_WORK_AR));
+	ar_echo((ar_assert(found($kids, "'name_first' => 'Jill'"))) ? "[OK] Found Jill\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($kids, "'favorite_color' => 'lavender'"))) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n");
+	ar_echo((ar_assert(notfound($kids, "'name_first' => 'Joan'"))) ? "[OK] No Joan relation\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($kids, "'name_first' => 'JAMIE'"))) ? "[OK] No JAMIE relation\n" : "[!!] Find failed\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("kid->Find('children.id=1' ... ADODB_LAZY_AR) [Lazy Method]\n");
+	ar_echo("Of course, lazy loading also retrieve medata information...\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$kid = new Kid('children');
+	$kids = $kid->Find('children.id=1', false, false, array('loading' => ADODB_LAZY_AR));
+	ar_echo((ar_assert(found($kids, "'name_first' => 'Jill'"))) ? "[OK] Found Jill\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($kids, "'favorite_color' => 'lavender'"))) ? "[OK] No relation yet\n" : "[!!] Found relation when I shouldn't\n");
+	ar_echo("\n-- Lazily Loading People:\n\n");
+	foreach($kids as $akid)
+	{
+		if($akid->person);
+	}
+	ar_echo((ar_assert(found($kids, "'favorite_color' => 'lavender'"))) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n");
+	ar_echo((ar_assert(notfound($kids, "'name_first' => 'Joan'"))) ? "[OK] No Joan relation\n" : "[!!] Found relation when I shouldn't\n");
+	ar_echo((ar_assert(notfound($kids, "'name_first' => 'JAMIE'"))) ? "[OK] No JAMIE relation\n" : "[!!] Found relation when I shouldn't\n");
+	
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("rugrat->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n");
+	ar_echo("In rugrat's constructor it is specified that\nit must forget any existing relation\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$rugrat = new Rugrat('children');
+	$rugrats = $rugrat->Find('children.id=1', false, false, array('loading' => ADODB_WORK_AR));
+	ar_echo((ar_assert(found($rugrats, "'name_first' => 'Jill'"))) ? "[OK] Found Jill\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($rugrats, "'favorite_color' => 'lavender'"))) ? "[OK] No relation found\n" : "[!!] Found relation when I shouldn't\n");
+	ar_echo((ar_assert(notfound($rugrats, "'name_first' => 'Joan'"))) ? "[OK] No Joan relation\n" : "[!!] Found relation when I shouldn't\n");
+	ar_echo((ar_assert(notfound($rugrats, "'name_first' => 'JAMIE'"))) ? "[OK] No JAMIE relation\n" : "[!!] Found relation when I shouldn't\n");
+	
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("kid->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n");
+	ar_echo("Note how only rugrat forgot its relations - kid is fine.\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$kid = new Kid('children');
+	$kids = $kid->Find('children.id=1', false, false, array('loading' => ADODB_WORK_AR));
+	ar_echo((ar_assert(found($kids, "'name_first' => 'Jill'"))) ? "[OK] Found Jill\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($kids, "'favorite_color' => 'lavender'"))) ? "[OK] I did not forget relation: person\n" : "[!!] I should not have forgotten relation: person\n");
+	ar_echo((ar_assert(notfound($kids, "'name_first' => 'Joan'"))) ? "[OK] No Joan relation\n" : "[!!] Found relation when I shouldn't\n");
+	ar_echo((ar_assert(notfound($kids, "'name_first' => 'JAMIE'"))) ? "[OK] No JAMIE relation\n" : "[!!] Found relation when I shouldn't\n");
+	
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("rugrat->Find('children.id=1' ... ADODB_WORK_AR) [Worker Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$rugrat = new Rugrat('children');
+	$rugrats = $rugrat->Find('children.id=1', false, false, array('loading' => ADODB_WORK_AR));
+	$arugrat = $rugrats[0];
+	ar_echo((ar_assert(found($arugrat, "'name_first' => 'Jill'"))) ? "[OK] Found Jill\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($arugrat, "'favorite_color' => 'lavender'"))) ? "[OK] No relation yet\n" : "[!!] Found relation when I shouldn't\n");
+	
+	ar_echo("\n-- Loading relations:\n\n");
+	$arugrat->belongsTo('person');
+	$arugrat->LoadRelations('person', 'order by id', 0, 2);
+	ar_echo((ar_assert(found($arugrat, "'favorite_color' => 'lavender'"))) ? "[OK] Found relation: person\n" : "[!!] Missing relation: person\n");
+	ar_echo((ar_assert(found($arugrat, "'name_first' => 'Jill'"))) ? "[OK] Found Jill\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($arugrat, "'name_first' => 'Joan'"))) ? "[OK] No Joan relation\n" : "[!!] Found relation when I shouldn't\n");
+	ar_echo((ar_assert(notfound($arugrat, "'name_first' => 'JAMIE'"))) ? "[OK] No Joan relation\n" : "[!!] Found relation when I shouldn't\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("person->Find('1=1') [Lazy Method]\n");
+	ar_echo("And now for our finale...\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$person = new Person();
+	$people = $person->Find('1=1', false, false, array('loading' => ADODB_LAZY_AR));
+	ar_echo((ar_assert(found($people, "'name_first' => 'John'"))) ? "[OK] Found John\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($people, "'favorite_pet' => 'tortoise'"))) ? "[OK] No relation yet\n" : "[!!] Found relation when I shouldn't\n");
+	ar_echo((ar_assert(notfound($people, "'name_first' => 'Fluffy'"))) ? "[OK] No Fluffy yet\n" : "[!!] Found Fluffy relation when I shouldn't\n");
+	ar_echo("\n-- Lazily Loading Everybody:\n\n");
+	foreach($people as $aperson)
+	{
+		foreach($aperson->children as $achild)
+		{
+			if($achild->name_first);
+		}
+	}
+	ar_echo((ar_assert(found($people, "'favorite_pet' => 'tortoise'"))) ? "[OK] Found relation: child\n" : "[!!] Missing relation: child\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'Joan'"))) ? "[OK] Found Joan\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'JAMIE'"))) ? "[OK] Found JAMIE\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'Lady'"))) ? "[OK] Found Cat Lady\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'Fluffy'"))) ? "[OK] Found Fluffy\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($people, "'name_first' => 'Sun'"))) ? "[OK] Found Sun\n" : "[!!] Find failed\n");
+	
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("artist->Load('artistuniqueid=1') [Join Method]\n");
+	ar_echo("Yes, we are dabbling in the musical field now..\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$artist = new Artist();
+	$artist->Load('artistuniqueid=1');
+	ar_echo((ar_assert(found($artist, "'name' => 'Elvis Costello'"))) ? "[OK] Found Elvis Costello\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($artist, "'name' => 'No Hiding Place'"))) ? "[OK] Found relation: song\n" : "[!!] Missing relation: song\n");
+
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("song->Load('recordid=1') [Join Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$song = new Song();
+	$song->Load('recordid=1');
+	ar_echo((ar_assert(found($song, "'name' => 'No Hiding Place'"))) ? "[OK] Found song\n" : "[!!] Find failed\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("artist->Find('artistuniqueid=1' ... ADODB_JOIN_AR) [Join Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$artist = new Artist();
+	$artists = $artist->Find('artistuniqueid=1', false, false, array('loading' => ADODB_JOIN_AR));
+	ar_echo((ar_assert(found($artists, "'name' => 'Elvis Costello'"))) ? "[OK] Found Elvis Costello\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($artists, "'name' => 'No Hiding Place'"))) ? "[OK] Found relation: song\n" : "[!!] Missing relation: song\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("song->Find('recordid=1' ... ADODB_JOIN_AR) [Join Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$song = new Song();
+	$songs = $song->Find('recordid=1', false, false, array('loading' => ADODB_JOIN_AR));
+	ar_echo((ar_assert(found($songs, "'name' => 'No Hiding Place'"))) ? "[OK] Found song\n" : "[!!] Find failed\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("artist->Find('artistuniqueid=1' ... ADODB_WORK_AR) [Work Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$artist = new Artist();
+	$artists = $artist->Find('artistuniqueid=1', false, false, array('loading' => ADODB_WORK_AR));
+	ar_echo((ar_assert(found($artists, "'name' => 'Elvis Costello'"))) ? "[OK] Found Elvis Costello\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(found($artists, "'name' => 'No Hiding Place'"))) ? "[OK] Found relation: song\n" : "[!!] Missing relation: song\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("song->Find('recordid=1' ... ADODB_JOIN_AR) [Join Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$song = new Song();
+	$songs = $song->Find('recordid=1', false, false, array('loading' => ADODB_WORK_AR));
+	ar_echo((ar_assert(found($songs, "'name' => 'No Hiding Place'"))) ? "[OK] Found song\n" : "[!!] Find failed\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("artist->Find('artistuniqueid=1' ... ADODB_LAZY_AR) [Lazy Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$artist = new Artist();
+	$artists = $artist->Find('artistuniqueid=1', false, false, array('loading' => ADODB_LAZY_AR));
+	ar_echo((ar_assert(found($artists, "'name' => 'Elvis Costello'"))) ? "[OK] Found Elvis Costello\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($artists, "'name' => 'No Hiding Place'"))) ? "[OK] No relation yet\n" : "[!!] Found relation when I shouldn't\n");
+	foreach($artists as $anartist)
+	{
+		foreach($anartist->songs as $asong)
+		{
+			if($asong->name);
+		}
+	}
+	ar_echo((ar_assert(found($artists, "'name' => 'No Hiding Place'"))) ? "[OK] Found relation: song\n" : "[!!] Missing relation: song\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("song->Find('recordid=1' ... ADODB_LAZY_AR) [Lazy Method]\n");
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+	$song = new Song();
+	$songs = $song->Find('recordid=1', false, false, array('loading' => ADODB_LAZY_AR));
+	ar_echo((ar_assert(found($songs, "'name' => 'No Hiding Place'"))) ? "[OK] Found song\n" : "[!!] Find failed\n");
+	ar_echo((ar_assert(notfound($songs, "'name' => 'Elvis Costello'"))) ? "[OK] No relation yet\n" : "[!!] Found relation when I shouldn't\n");
+	foreach($songs as $asong)
+	{
+		if($asong->artist);
+	}
+	ar_echo((ar_assert(found($songs, "'name' => 'Elvis Costello'"))) ? "[OK] Found relation: artist\n" : "[!!] Missing relation: artist\n");
+
+	ar_echo("\n\n-------------------------------------------------------------------------------------------------------------------\n");
+	ar_echo("Test suite complete. " . (($err_count > 0) ? "$err_count errors found.\n" : "Success.\n"));
+	ar_echo("-------------------------------------------------------------------------------------------------------------------\n");
+?>
diff --git a/third_party/adodb/tests/test-datadict.php b/third_party/adodb/tests/test-datadict.php
index 3f4381d..f821f8b 100644
--- a/third_party/adodb/tests/test-datadict.php
+++ b/third_party/adodb/tests/test-datadict.php
@@ -1,7 +1,7 @@
 <?php
 /*
 
-  V4.81 3 May 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V4.81 3 May 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -13,7 +13,7 @@
 error_reporting(E_ALL);
 include_once('../adodb.inc.php');
 
-foreach(array('sapdb','sybase','mysql','access','oci8po','postgres','odbc_mssql','odbc','db2','firebird','informix') as $dbType) {
+foreach(array('sapdb','sybase','mysql','access','oci8po','odbc_mssql','odbc','db2','firebird','postgres','informix') as $dbType) {
 	echo "<h3>$dbType</h3><p>";
 	$db = NewADOConnection($dbType);
 	$dict = NewDataDictionary($db);
@@ -48,12 +48,14 @@ foreach(array('sapdb','sybase','mysql','access','oci8po','postgres','odbc_mssql'
 	$flds = "
 ID            I           AUTO KEY,
 FIRSTNAME     VARCHAR(30) DEFAULT 'Joan' INDEX idx_name,
-LASTNAME      VARCHAR(28) DEFAULT 'Chen' key INDEX idx_name,
+LASTNAME      VARCHAR(28) DEFAULT 'Chen' key INDEX idx_name INDEX idx_lastname,
 averylonglongfieldname X(1024) DEFAULT 'test',
 price         N(7.2)  DEFAULT '0.00',
 MYDATE        D      DEFDATE INDEX idx_date,
 BIGFELLOW     X      NOTNULL,
-TS            T      DEFTIMESTAMP";
+TS_SECS            T      DEFTIMESTAMP,
+TS_SUBSEC   TS DEFTIMESTAMP
+";
 
 
 	$sqla = $dict->CreateDatabase('KUTU',array('postgres'=>"LOCATION='/u01/postdata'"));
diff --git a/third_party/adodb/tests/test-perf.php b/third_party/adodb/tests/test-perf.php
index bdeae28..37406d2 100644
--- a/third_party/adodb/tests/test-perf.php
+++ b/third_party/adodb/tests/test-perf.php
@@ -1,50 +1,50 @@
-<?php
-
-include_once('../adodb-perf.inc.php');
-
-error_reporting(E_ALL);
-session_start();
-
-if (isset($_GET)) {
-	foreach($_GET as $k => $v) {
-		if (strncmp($k,'test',4) == 0) $_SESSION['_db'] = $k;
-	}
-} 
-
-if (isset($_SESSION['_db'])) {
-	$_db = $_SESSION['_db'];
-	$_GET[$_db] = 1;
-	$$_db = 1;
-}
-
-echo "<h1>Performance Monitoring</h1>";
-include_once('testdatabases.inc.php');
-
-
-function testdb($db) 
-{
-	if (!$db) return;
-	echo "<font size=1>";print_r($db->ServerInfo()); echo " user=".$db->user."</font>";
-	
-	$perf = NewPerfMonitor($db); 
-	
-	# unit tests
-	if (0) {
-		//$DB->debug=1;
-		echo "Data Cache Size=".$perf->DBParameter('data cache size').'<p>';
-		echo $perf->HealthCheck();
-		echo($perf->SuspiciousSQL());
-		echo($perf->ExpensiveSQL());
-		echo($perf->InvalidSQL());
-		echo $perf->Tables();
-	
-		echo "<pre>";
-		echo $perf->HealthCheckCLI();
-		$perf->Poll(3);
-		die();
-	}
-	
-	if ($perf) $perf->UI(3);
-}
- 
-?>
+<?php
+
+include_once('../adodb-perf.inc.php');
+
+error_reporting(E_ALL);
+session_start();
+
+if (isset($_GET)) {
+	foreach($_GET as $k => $v) {
+		if (strncmp($k,'test',4) == 0) $_SESSION['_db'] = $k;
+	}
+} 
+
+if (isset($_SESSION['_db'])) {
+	$_db = $_SESSION['_db'];
+	$_GET[$_db] = 1;
+	$$_db = 1;
+}
+
+echo "<h1>Performance Monitoring</h1>";
+include_once('testdatabases.inc.php');
+
+
+function testdb($db) 
+{
+	if (!$db) return;
+	echo "<font size=1>";print_r($db->ServerInfo()); echo " user=".$db->user."</font>";
+	
+	$perf = NewPerfMonitor($db); 
+	
+	# unit tests
+	if (0) {
+		//$DB->debug=1;
+		echo "Data Cache Size=".$perf->DBParameter('data cache size').'<p>';
+		echo $perf->HealthCheck();
+		echo($perf->SuspiciousSQL());
+		echo($perf->ExpensiveSQL());
+		echo($perf->InvalidSQL());
+		echo $perf->Tables();
+	
+		echo "<pre>";
+		echo $perf->HealthCheckCLI();
+		$perf->Poll(3);
+		die();
+	}
+	
+	if ($perf) $perf->UI(3);
+}
+ 
+?>
diff --git a/third_party/adodb/tests/test-php5.php b/third_party/adodb/tests/test-php5.php
index 6102cdd..689aeea 100644
--- a/third_party/adodb/tests/test-php5.php
+++ b/third_party/adodb/tests/test-php5.php
@@ -1,6 +1,6 @@
 <?php
 /*
-  V4.81 3 May 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V4.81 3 May 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/tests/test.php b/third_party/adodb/tests/test.php
index 9ff85e5..f8bb676 100644
--- a/third_party/adodb/tests/test.php
+++ b/third_party/adodb/tests/test.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -10,7 +10,7 @@ V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reser
 */
 
 
-if (!defined('E_STRICT')) define('E_STRICT',0);
+//if (!defined('E_STRICT')) define('E_STRICT',0);
 error_reporting(E_ALL|E_STRICT);
 
 $ADODB_FLUSH = true;
@@ -483,7 +483,7 @@ GO
 		/*
 		CREATE TABLE PHOTOS
 		(
-		  ID           NUMBER(16),
+		  ID           NUMBER(16) primary key,
 		  PHOTO        BLOB,
 		  DESCRIPTION  VARCHAR2(4000 BYTE),
 		  DESCCLOB     CLOB
@@ -596,7 +596,7 @@ END Adodb;
 		} else {
 			print "<b>Error in using Cursor Variables 1</b><p>";
 		}
-		$rs->Close();
+		if ($rs) $rs->Close();
 		
 		print "<h4>Testing Stored Procedures for oci8</h4>";
 		
@@ -920,6 +920,11 @@ END Adodb;
 	$col = $db->GetCol('select distinct firstname from ADOXYZ order by 1');
 	if (!is_array($col)) Err("Col size is wrong");
 	if (trim($col[0]) != 'Alan' or trim($col[9]) != 'Yat Sun') Err("Col elements wrong");
+	
+	
+	$col = $db->CacheGetCol('select distinct firstname from ADOXYZ order by 1');
+	if (!is_array($col)) Err("Col size is wrong");
+	if (trim($col[0]) != 'Alan' or trim($col[9]) != 'Yat Sun') Err("Col elements wrong");
 
 	$db->debug = true;
 	
@@ -1327,8 +1332,8 @@ END Adodb;
 		rs2tabout($rs);
 		print "</pre>";
 	}
-	print " CacheFlush ";
-	$db->CacheFlush();
+	#print " CacheFlush ";
+	#$db->CacheFlush();
 	
 	$date = $db->SQLDate('d-m-M-Y-\QQ h:i:s A');
 	$sql = "SELECT $date from ADOXYZ";
@@ -1435,7 +1440,7 @@ END Adodb;
 	if ($rs) rs2html($rs);
 	else Err("Pivot sql error");
 	
-	$pear = true; //true;
+	$pear = false; //true;
 	$db->debug=false;
 	
 	if ($pear) {
@@ -1738,6 +1743,6 @@ echo "<br>vers=",ADOConnection::Version();
 
 
 ?>
-<p><i>ADODB Database Library  (c) 2000-2008 John Lim. All rights reserved. Released under BSD and LGPL, PHP <?php echo PHP_VERSION ?>.</i></p>
+<p><i>ADODB Database Library  (c) 2000-2009 John Lim. All rights reserved. Released under BSD and LGPL, PHP <?php echo PHP_VERSION ?>.</i></p>
 </body>
 </html>
diff --git a/third_party/adodb/tests/test2.php b/third_party/adodb/tests/test2.php
index 7580dca..ff9e969 100644
--- a/third_party/adodb/tests/test2.php
+++ b/third_party/adodb/tests/test2.php
@@ -1,26 +1,26 @@
-<?php
-
-// BASIC ADO test
-
-	include_once('../adodb.inc.php');
-
-	$db = ADONewConnection("ado_access");
-	$db->debug=1;
-	$access = 'd:\inetpub\wwwroot\php\NWIND.MDB';
-	$myDSN =  'PROVIDER=Microsoft.Jet.OLEDB.4.0;'
-		. 'DATA SOURCE=' . $access . ';';
-		
-	echo "<p>PHP ",PHP_VERSION,"</p>";
-	
-	$db->Connect($myDSN) || die('fail');
-	
-	print_r($db->ServerInfo());
-	
-	try {
-	$rs = $db->Execute("select $db->sysTimeStamp,* from adoxyz where id>02xx");
-	print_r($rs->fields);
-	} catch(exception $e) {
-	print_r($e);
-	echo "<p> Date m/d/Y =",$db->UserDate($rs->fields[4],'m/d/Y');
-	}
+<?php
+
+// BASIC ADO test
+
+	include_once('../adodb.inc.php');
+
+	$db = ADONewConnection("ado_access");
+	$db->debug=1;
+	$access = 'd:\inetpub\wwwroot\php\NWIND.MDB';
+	$myDSN =  'PROVIDER=Microsoft.Jet.OLEDB.4.0;'
+		. 'DATA SOURCE=' . $access . ';';
+		
+	echo "<p>PHP ",PHP_VERSION,"</p>";
+	
+	$db->Connect($myDSN) || die('fail');
+	
+	print_r($db->ServerInfo());
+	
+	try {
+	$rs = $db->Execute("select $db->sysTimeStamp,* from adoxyz where id>02xx");
+	print_r($rs->fields);
+	} catch(exception $e) {
+	print_r($e);
+	echo "<p> Date m/d/Y =",$db->UserDate($rs->fields[4],'m/d/Y');
+	}
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/tests/test3.php b/third_party/adodb/tests/test3.php
index 8a8774d..3269c17 100644
--- a/third_party/adodb/tests/test3.php
+++ b/third_party/adodb/tests/test3.php
@@ -1,6 +1,6 @@
 <?php
 /*
-  V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
diff --git a/third_party/adodb/tests/test4.php b/third_party/adodb/tests/test4.php
index 7642230..d377f84 100644
--- a/third_party/adodb/tests/test4.php
+++ b/third_party/adodb/tests/test4.php
@@ -1,7 +1,7 @@
 <?php
 
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V4.50 6 July 2004 (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
diff --git a/third_party/adodb/tests/test5.php b/third_party/adodb/tests/test5.php
index 3a40fc8..cc9b7a6 100644
--- a/third_party/adodb/tests/test5.php
+++ b/third_party/adodb/tests/test5.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/tests/testcache.php b/third_party/adodb/tests/testcache.php
index fe1213a..6a8ac4a 100644
--- a/third_party/adodb/tests/testcache.php
+++ b/third_party/adodb/tests/testcache.php
@@ -2,7 +2,7 @@
 <body>
 <?php
 /* 
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/tests/testdatabases.inc.php b/third_party/adodb/tests/testdatabases.inc.php
index 4a088f4..f5aeb5e 100644
--- a/third_party/adodb/tests/testdatabases.inc.php
+++ b/third_party/adodb/tests/testdatabases.inc.php
@@ -1,7 +1,7 @@
 <?php
   
 /*
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
@@ -52,17 +52,29 @@ if (isset($nocountrecs)) $ADODB_COUNTRECS = false;
 // cannot test databases below, but we include them anyway to check
 // if they parse ok...
 
-if (!strpos(PHP_VERSION,'5') === 0) {
-	ADOLoadCode("sybase");
-	//ADOLoadCode("postgres");
-	//ADOLoadCode("postgres7");
-	ADOLoadCode("firebird");
-	ADOLoadCode("borland_ibase");
-	ADOLoadCode("informix");
-	ADOLoadCode("sqlanywhere");
-//	ADOLoadCode('mysqli');
+if (sizeof($_GET) || !isset($_SERVER['HTTP_HOST'])) {
+	echo "<BR>";
+	ADOLoadCode2("sybase"); 
+	ADOLoadCode2("postgres");
+	ADOLoadCode2("postgres7");
+	ADOLoadCode2("firebird");
+	ADOLoadCode2("borland_ibase");
+	ADOLoadCode2("informix");
+	ADOLoadCode2('mysqli');
+	if (defined('ODBC_BINMODE_RETURN')) {
+		ADOLoadCode2("sqlanywhere");
+		ADOLoadCode2("access");
+	}
+	ADOLoadCode2("mysql");
+	ADOLoadCode2("oci8");
 }
 
+function ADOLoadCode2($d)
+{
+	ADOLoadCode($d);
+	$c = ADONewConnection($d);
+	echo "Loaded $d ",($c ? 'ok' : 'extension not installed'),"<br>";
+}
 
 flush();
 if (!empty($testpostgres)) {
@@ -296,12 +308,12 @@ ADOLoadCode('oci805');
 ADOLoadCode("oci8po");
 	
 if (!empty($testoracle)) {
-	$dsn = "oci8po://juris10:natsoft@sherkhan?persist";
+	$dsn = "oci8po";//://scott:natsoft@kk2?persist";
 	$db = ADONewConnection($dsn );//'oci8');
 	
 	//$db->debug=1;
 	print "<h1>Connecting $db->databaseType...</h1>";
-	if (true || $db->Connect('', "scott", "natsoft",''))
+	if ($db->Connect('192.168.0.138', "scott", "natsoft",'SID=natsoft'))
 		testdb($db,"create table ADOXYZ (id int, firstname varchar(24), lastname varchar(24),created date)");
 	else 
 		print "ERROR: Oracle test requires an Oracle server setup with scott/natsoft".'<BR>'.$db->ErrorMsg();
@@ -357,23 +369,23 @@ flush();
 }
 
 
-$server = 'sherkhan';
+$server = 'localhost';
 
 
 
 ADOLoadCode("mssqlpo");
-if (!empty($testmssql)) { // MS SQL Server -- the extension is buggy -- probably better to use ODBC
+if (false && !empty($testmssql)) { // MS SQL Server -- the extension is buggy -- probably better to use ODBC
 	$db = ADONewConnection("mssqlpo");
 	//$db->debug=1;
 	print "<h1>Connecting $db->databaseType...</h1>";
 	
-	$ok = $db->Connect('','adodb','natsoft','northwind');
-
-	if ($ok or $db->PConnect("mangrove", "sa", "natsoft", "ai")) {
+	$ok = $db->Connect('','sa','natsoft','northwind');
+	echo $db->ErrorMsg();
+	if ($ok /*or $db->PConnect("mangrove", "sa", "natsoft", "ai")*/) {
 		AutoDetect_MSSQL_Date_Order($db);
 	//	$db->Execute('drop table adoxyz');
 		testdb($db,"create table ADOXYZ (id int, firstname char(24) null, lastname char(24) null,created datetime null)");
-	} else print "ERROR: MSSQL test 2 requires a MS SQL 7 on a server='192.168.0.1', userid='adodb', password='natsoft', database='ai'".'<BR>'.$db->ErrorMsg();
+	} else print "ERROR: MSSQL test 2 requires a MS SQL 7 on a server='$server', userid='adodb', password='natsoft', database='ai'".'<BR>'.$db->ErrorMsg();
 	
 }
 
@@ -385,8 +397,8 @@ if (!empty($testmssql)) { // MS SQL Server via ODBC
 	print "<h1>Connecting $db->databaseType...</h1>";
 	
 	$dsn = "PROVIDER=MSDASQL;Driver={SQL Server};Server=$server;Database=northwind;";
-	
-	if ($db->PConnect($dsn, "adodb", "natsoft", ""))  {
+	$dsn = 'condor';
+	if ($db->PConnect($dsn, "sa", "natsoft", ""))  {
 		testdb($db,"create table ADOXYZ (id int, firstname char(24) null, lastname char(24) null,created datetime null)");
 	}
 	else print "ERROR: MSSQL test 1 requires a MS SQL 7 server setup with DSN setup";
diff --git a/third_party/adodb/tests/testgenid.php b/third_party/adodb/tests/testgenid.php
index bc54ada..14b48ce 100644
--- a/third_party/adodb/tests/testgenid.php
+++ b/third_party/adodb/tests/testgenid.php
@@ -1,36 +1,36 @@
-<?php
-/*
-	V4.50 6 July 2004 
-	
-	Run multiple copies of this php script at the same time
-	to test unique generation of id's in multiuser mode
-*/
-include_once('../adodb.inc.php');
-$testaccess = true;
-include_once('testdatabases.inc.php');
-
-function testdb(&$db,$createtab="create table ADOXYZ (id int, firstname char(24), lastname char(24), created date)")
-{
-	$table = 'adodbseq';
-	
-	$db->Execute("drop table $table");
-	//$db->debug=true;
-	
-	$ctr = 5000;
-	$lastnum = 0;
-	
-	while (--$ctr >= 0) {
-		$num = $db->GenID($table);
-		if ($num === false) {	
-			print "GenID returned false";
-			break;
-		}
-		if ($lastnum + 1 == $num) print " $num ";
-		else {
-			print " <font color=red>$num</font> ";
-			flush();
-		}
-		$lastnum = $num;
-	}
-}
+<?php
+/*
+	V4.50 6 July 2004 
+	
+	Run multiple copies of this php script at the same time
+	to test unique generation of id's in multiuser mode
+*/
+include_once('../adodb.inc.php');
+$testaccess = true;
+include_once('testdatabases.inc.php');
+
+function testdb(&$db,$createtab="create table ADOXYZ (id int, firstname char(24), lastname char(24), created date)")
+{
+	$table = 'adodbseq';
+	
+	$db->Execute("drop table $table");
+	//$db->debug=true;
+	
+	$ctr = 5000;
+	$lastnum = 0;
+	
+	while (--$ctr >= 0) {
+		$num = $db->GenID($table);
+		if ($num === false) {	
+			print "GenID returned false";
+			break;
+		}
+		if ($lastnum + 1 == $num) print " $num ";
+		else {
+			print " <font color=red>$num</font> ";
+			flush();
+		}
+		$lastnum = $num;
+	}
+}
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/tests/testmssql.php b/third_party/adodb/tests/testmssql.php
index 15173ac..b858481 100644
--- a/third_party/adodb/tests/testmssql.php
+++ b/third_party/adodb/tests/testmssql.php
@@ -1,7 +1,7 @@
 <?php
 
 /** 
- * @version V4.50 6 July 2004 (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V4.50 6 July 2004 (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
diff --git a/third_party/adodb/tests/testoci8.php b/third_party/adodb/tests/testoci8.php
index 366ff68..2886ccf 100644
--- a/third_party/adodb/tests/testoci8.php
+++ b/third_party/adodb/tests/testoci8.php
@@ -2,7 +2,7 @@
 <body>
 <?php
 /* 
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -10,7 +10,7 @@ V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reser
 	
   Latest version is available at http://adodb.sourceforge.net
 */
-error_reporting(63);
+error_reporting(E_ALL | E_STRICT);
 include("../adodb.inc.php");
 include("../tohtml.inc.php");
 
diff --git a/third_party/adodb/tests/testoci8cursor.php b/third_party/adodb/tests/testoci8cursor.php
index 462d2c7..a75f27d 100644
--- a/third_party/adodb/tests/testoci8cursor.php
+++ b/third_party/adodb/tests/testoci8cursor.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/tests/testpaging.php b/third_party/adodb/tests/testpaging.php
index 7ab34d9..85ab5e2 100644
--- a/third_party/adodb/tests/testpaging.php
+++ b/third_party/adodb/tests/testpaging.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/tests/testpear.php b/third_party/adodb/tests/testpear.php
index bed088f..d1a4ef9 100644
--- a/third_party/adodb/tests/testpear.php
+++ b/third_party/adodb/tests/testpear.php
@@ -1,6 +1,6 @@
 <?php
 /* 
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
diff --git a/third_party/adodb/tests/testsessions.php b/third_party/adodb/tests/testsessions.php
index cac660a..e8b59f2 100644
--- a/third_party/adodb/tests/testsessions.php
+++ b/third_party/adodb/tests/testsessions.php
@@ -1,7 +1,7 @@
 <?php
 
 /* 
-V4.80 8 Mar 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+V4.80 8 Mar 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence. 
@@ -23,22 +23,24 @@ error_reporting(E_ALL);
 ob_start();
 include('../session/adodb-cryptsession2.php');
 
-$options['debug'] = 99;
-$db = 'postgres';
+$options['debug'] = 1;
+$db = 'oci8';
 
 #### CONNECTION
 switch($db) {
 case 'oci8': 
 	$options['table'] = 'adodb_sessions2';
-	ADOdb_Session::config('oci8', '', 'jcollect', 'natsoft', '',$options);
+	ADOdb_Session::config('oci8', '', 'jcollect_bkrm', 'natsoft', '',$options);
 	break;
 
 case 'postgres':
+	$options['table'] = 'sessions2';
 	ADOdb_Session::config('postgres', 'localhost', 'tester', 'test', 'test',$options);
 	break;
 	
 case 'mysql':
 default:
+	$options['table'] = 'sessions2';
 	ADOdb_Session::config('mysql', 'localhost', 'root', '', 'xphplens_2',$options);
 	break;
 
@@ -83,8 +85,14 @@ default:
 		adodb_sess_gc(10);
 		
 		if (rand() % 2 == 0) {
-			print "<p>Random session destroy</p>";
+			print "<p>Random own session destroy</p>";
 			session_destroy();
 		}
+	} else {
+		$DB = ADODB_Session::_conn();
+		$sessk = $DB->qstr('%AZ'.rand().time());
+		$olddate = $DB->DBTimeStamp(time()-30*24*3600);
+		$rr = $DB->qstr(rand());
+		$DB->Execute("insert into {$options['table']} (sesskey,expiry,expireref,sessdata,created,modified) values ($sessk,$olddate, $rr,'',$olddate,$olddate)");
 	}
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/tests/tmssql.php b/third_party/adodb/tests/tmssql.php
index d634f0c..4975787 100644
--- a/third_party/adodb/tests/tmssql.php
+++ b/third_party/adodb/tests/tmssql.php
@@ -1,80 +1,80 @@
-<?php
-error_reporting(E_ALL);
-ini_set('mssql.datetimeconvert',0); 
-
-function tmssql()
-{
-	print "<h3>mssql</h3>";
-	$db = mssql_connect('JAGUAR\vsdotnet','adodb','natsoft') or die('No Connection');
-	mssql_select_db('northwind',$db);
-	
-	$rs = mssql_query('select getdate() as date',$db);
-	$o = mssql_fetch_row($rs);
-	print_r($o);
-	mssql_free_result($rs);
-	
-	print "<p>Delete</p>"; flush();
-	$rs2 = mssql_query('delete from adoxyz',$db);
-	$p = mssql_num_rows($rs2);
-	mssql_free_result($rs2);
-
-}
-
-function tpear()
-{
-include_once('DB.php');
-
-	print "<h3>PEAR</h3>";
-	$username = 'adodb';
-	$password = 'natsoft';
-	$hostname = 'JAGUAR\vsdotnet';
-	$databasename = 'northwind';
-	
-	$dsn = "mssql://$username:$password@$hostname/$databasename";
-	$conn = DB::connect($dsn);
-	print "date=".$conn->GetOne('select getdate()')."<br>";
-	@$conn->query('create table tester (id integer)');
-	print "<p>Delete</p>"; flush();
-	$rs = $conn->query('delete from tester');
-	print "date=".$conn->GetOne('select getdate()')."<br>";
-}
-
-function tadodb()
-{
-include_once('../adodb.inc.php');
-
-	print "<h3>ADOdb</h3>";
-	$conn = NewADOConnection('mssql');
-	$conn->Connect('JAGUAR\vsdotnet','adodb','natsoft','northwind');
-//	$conn->debug=1;
-	print "date=".$conn->GetOne('select getdate()')."<br>";
-	$conn->Execute('create table tester (id integer)');
-	print "<p>Delete</p>"; flush();
-	$rs = $conn->Execute('delete from tester');
-	print "date=".$conn->GetOne('select getdate()')."<br>";
-}
-
-
-$ACCEPTIP = '127.0.0.1';
-
-$remote = $_SERVER["REMOTE_ADDR"]; 
-
-if (!empty($ACCEPTIP))
- if ($remote != '127.0.0.1' && $remote != $ACCEPTIP) 
- 	die("Unauthorised client: '$remote'");
-	
-?>
-<a href=tmssql.php?do=tmssql>mssql</a>
-<a href=tmssql.php?do=tpear>pear</a>
-<a href=tmssql.php?do=tadodb>adodb</a>
-<?php
-if (!empty($_GET['do'])) {
-	$do = $_GET['do'];
-	switch($do) {
-	case 'tpear':
-	case 'tadodb':
-	case 'tmssql':
-		$do();
-	}
-}
+<?php
+error_reporting(E_ALL);
+ini_set('mssql.datetimeconvert',0); 
+
+function tmssql()
+{
+	print "<h3>mssql</h3>";
+	$db = mssql_connect('JAGUAR\vsdotnet','adodb','natsoft') or die('No Connection');
+	mssql_select_db('northwind',$db);
+	
+	$rs = mssql_query('select getdate() as date',$db);
+	$o = mssql_fetch_row($rs);
+	print_r($o);
+	mssql_free_result($rs);
+	
+	print "<p>Delete</p>"; flush();
+	$rs2 = mssql_query('delete from adoxyz',$db);
+	$p = mssql_num_rows($rs2);
+	mssql_free_result($rs2);
+
+}
+
+function tpear()
+{
+include_once('DB.php');
+
+	print "<h3>PEAR</h3>";
+	$username = 'adodb';
+	$password = 'natsoft';
+	$hostname = 'JAGUAR\vsdotnet';
+	$databasename = 'northwind';
+	
+	$dsn = "mssql://$username:$password@$hostname/$databasename";
+	$conn = DB::connect($dsn);
+	print "date=".$conn->GetOne('select getdate()')."<br>";
+	@$conn->query('create table tester (id integer)');
+	print "<p>Delete</p>"; flush();
+	$rs = $conn->query('delete from tester');
+	print "date=".$conn->GetOne('select getdate()')."<br>";
+}
+
+function tadodb()
+{
+include_once('../adodb.inc.php');
+
+	print "<h3>ADOdb</h3>";
+	$conn = NewADOConnection('mssql');
+	$conn->Connect('JAGUAR\vsdotnet','adodb','natsoft','northwind');
+//	$conn->debug=1;
+	print "date=".$conn->GetOne('select getdate()')."<br>";
+	$conn->Execute('create table tester (id integer)');
+	print "<p>Delete</p>"; flush();
+	$rs = $conn->Execute('delete from tester');
+	print "date=".$conn->GetOne('select getdate()')."<br>";
+}
+
+
+$ACCEPTIP = '127.0.0.1';
+
+$remote = $_SERVER["REMOTE_ADDR"]; 
+
+if (!empty($ACCEPTIP))
+ if ($remote != '127.0.0.1' && $remote != $ACCEPTIP) 
+ 	die("Unauthorised client: '$remote'");
+	
+?>
+<a href=tmssql.php?do=tmssql>mssql</a>
+<a href=tmssql.php?do=tpear>pear</a>
+<a href=tmssql.php?do=tadodb>adodb</a>
+<?php
+if (!empty($_GET['do'])) {
+	$do = $_GET['do'];
+	switch($do) {
+	case 'tpear':
+	case 'tadodb':
+	case 'tmssql':
+		$do();
+	}
+}
 ?>
\ No newline at end of file
diff --git a/third_party/adodb/toexport.inc.php b/third_party/adodb/toexport.inc.php
index eacd668..57b8bd1 100644
--- a/third_party/adodb/toexport.inc.php
+++ b/third_party/adodb/toexport.inc.php
@@ -1,7 +1,7 @@
 <?php
 
 /** 
- * @version V4.93 10 Oct 2006 (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+ * @version V4.93 10 Oct 2006 (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
  * Released under both BSD license and Lesser GPL library license. 
  * Whenever there is any discrepancy between the two licenses, 
  * the BSD license will take precedence. 
@@ -73,9 +73,10 @@ function _adodb_export(&$rs,$sep,$sepreplace,$fp=false,$addtitles=true,$quote =
 	if ($addtitles) {
 		$fieldTypes = $rs->FieldTypesArray();
 		reset($fieldTypes);
+		$i = 0;
 		while(list(,$o) = each($fieldTypes)) {
-			if (!$o) $v = '';
-			else $v = $o->name;
+		
+			$v = ($o) ? $o->name : 'Field'.($i++);
 			if ($escquote) $v = str_replace($quote,$escquotequote,$v);
 			$v = strip_tags(str_replace("\n", $replaceNewLine, str_replace("\r\n",$replaceNewLine,str_replace($sep,$sepreplace,$v))));
 			$elements[] = $v;
diff --git a/third_party/adodb/tohtml.inc.php b/third_party/adodb/tohtml.inc.php
index c0135cb..6a4e3ba 100644
--- a/third_party/adodb/tohtml.inc.php
+++ b/third_party/adodb/tohtml.inc.php
@@ -1,13 +1,13 @@
 <?php 
 /*
-  V4.93 10 Oct 2006  (c) 2000-2008 John Lim (jlim#natsoft.com.my). All rights reserved.
+  V4.93 10 Oct 2006  (c) 2000-2009 John Lim (jlim#natsoft.com). All rights reserved.
   Released under both BSD license and Lesser GPL library license. 
   Whenever there is any discrepancy between the two licenses, 
   the BSD license will take precedence.
   
   Some pretty-printing by Chris Oxenreider <oxenreid@state.net>
 */ 
-  
+
 // specific code for tohtml
 GLOBAL $gSQLMaxRows,$gSQLBlockRows,$ADODB_ROUND;
 
@@ -84,14 +84,18 @@ GLOBAL $gSQLMaxRows,$gSQLBlockRows,$ADODB_ROUND;
 			$type = $typearr[$i];
 			switch($type) {
 			case 'D':
-				if (empty($v)) $s .= "<TD> &nbsp; </TD>\n";
-				else if (!strpos($v,':')) {
-					$s .= "	<TD>".$rs->UserDate($v,"D d, M Y") ."&nbsp;</TD>\n";
+				if (strpos($v,':') !== false);
+				else {
+					if (empty($v)) {
+					$s .= "<TD> &nbsp; </TD>\n";
+					} else {
+						$s .= "	<TD>".$rs->UserDate($v,"D d, M Y") ."</TD>\n";				
+					}
+					break;
 				}
-				break;
 			case 'T':
 				if (empty($v)) $s .= "<TD> &nbsp; </TD>\n";
-				else $s .= "	<TD>".$rs->UserTimeStamp($v,"D d, M Y, h:i:s") ."&nbsp;</TD>\n";
+				else $s .= "	<TD>".$rs->UserTimeStamp($v,"D d, M Y, H:i:s") ."</TD>\n";
 			break;
 			
 			case 'N':
@@ -100,7 +104,9 @@ GLOBAL $gSQLMaxRows,$gSQLBlockRows,$ADODB_ROUND;
 				else
 					$v = round($v,$ADODB_ROUND);
 			case 'I':
-				$s .= "	<TD align=right>".stripslashes((trim($v))) ."&nbsp;</TD>\n";
+				$vv = stripslashes((trim($v)));
+				if (strlen($vv) == 0) $vv .= '&nbsp;';
+				$s .= "	<TD align=right>".$vv ."</TD>\n";
 			   	
 			break;
 			/*
diff --git a/third_party/adodb/xmlschema03.dtd b/third_party/adodb/xmlschema03.dtd
index 97850bc..a7c8864 100644
--- a/third_party/adodb/xmlschema03.dtd
+++ b/third_party/adodb/xmlschema03.dtd
@@ -1,43 +1,43 @@
-<?xml version="1.0"?>
-<!DOCTYPE adodb_schema [
-<!ELEMENT schema (table*, sql*)>
-<!ATTLIST schema version CDATA #REQUIRED>
-<!ELEMENT table (descr?, (field+|DROP), constraint*, opt*, index*, data*)>
-<!ATTLIST table name CDATA #REQUIRED platform CDATA #IMPLIED version CDATA #IMPLIED>
-<!ELEMENT field (descr?, (NOTNULL|KEY|PRIMARY)?, (AUTO|AUTOINCREMENT)?, (DEFAULT|DEFDATE|DEFTIMESTAMP)?, NOQUOTE?, UNSIGNED?, constraint*, opt*)>
-<!ATTLIST field name CDATA #REQUIRED type (C|C2|X|X2|B|D|T|L|I|F|N) #REQUIRED size CDATA #IMPLIED opts CDATA #IMPLIED>
-<!ELEMENT data (descr?, row+)>
-<!ATTLIST data platform CDATA #IMPLIED>
-<!ELEMENT row (f+)>
-<!ELEMENT f (#CDATA)>
-<!ATTLIST f name CDATA #IMPLIED>
-<!ELEMENT descr (#CDATA)>
-<!ELEMENT NOTNULL EMPTY>
-<!ELEMENT KEY EMPTY>
-<!ELEMENT PRIMARY EMPTY>
-<!ELEMENT AUTO EMPTY>
-<!ELEMENT AUTOINCREMENT EMPTY>
-<!ELEMENT DEFAULT EMPTY>
-<!ATTLIST DEFAULT value CDATA #REQUIRED>
-<!ELEMENT DEFDATE EMPTY>
-<!ELEMENT DEFTIMESTAMP EMPTY>
-<!ELEMENT NOQUOTE EMPTY>
-<!ELEMENT UNSIGNED EMPTY>
-<!ELEMENT DROP EMPTY>
-<!ELEMENT constraint (#CDATA)>
-<!ATTLIST constraint platform CDATA #IMPLIED>
-<!ELEMENT opt (#CDATA)>
-<!ATTLIST opt platform CDATA #IMPLIED>
-<!ELEMENT index ((col+|DROP), CLUSTERED?, BITMAP?, UNIQUE?, FULLTEXT?, HASH?, descr?)>
-<!ATTLIST index name CDATA #REQUIRED platform CDATA #IMPLIED>
-<!ELEMENT col (#CDATA)>
-<!ELEMENT CLUSTERED EMPTY>
-<!ELEMENT BITMAP EMPTY>
-<!ELEMENT UNIQUE EMPTY>
-<!ELEMENT FULLTEXT EMPTY>
-<!ELEMENT HASH EMPTY>
-<!ELEMENT sql (query+, descr?)>
-<!ATTLIST sql name CDATA #IMPLIED platform CDATA #IMPLIED, key CDATA, prefixmethod (AUTO|MANUAL|NONE)>
-<!ELEMENT query (#CDATA)>
-<!ATTLIST query platform CDATA #IMPLIED>
+<?xml version="1.0"?>
+<!DOCTYPE adodb_schema [
+<!ELEMENT schema (table*, sql*)>
+<!ATTLIST schema version CDATA #REQUIRED>
+<!ELEMENT table (descr?, (field+|DROP), constraint*, opt*, index*, data*)>
+<!ATTLIST table name CDATA #REQUIRED platform CDATA #IMPLIED version CDATA #IMPLIED>
+<!ELEMENT field (descr?, (NOTNULL|KEY|PRIMARY)?, (AUTO|AUTOINCREMENT)?, (DEFAULT|DEFDATE|DEFTIMESTAMP)?, NOQUOTE?, UNSIGNED?, constraint*, opt*)>
+<!ATTLIST field name CDATA #REQUIRED type (C|C2|X|X2|B|D|T|L|I|F|N) #REQUIRED size CDATA #IMPLIED opts CDATA #IMPLIED>
+<!ELEMENT data (descr?, row+)>
+<!ATTLIST data platform CDATA #IMPLIED>
+<!ELEMENT row (f+)>
+<!ELEMENT f (#CDATA)>
+<!ATTLIST f name CDATA #IMPLIED>
+<!ELEMENT descr (#CDATA)>
+<!ELEMENT NOTNULL EMPTY>
+<!ELEMENT KEY EMPTY>
+<!ELEMENT PRIMARY EMPTY>
+<!ELEMENT AUTO EMPTY>
+<!ELEMENT AUTOINCREMENT EMPTY>
+<!ELEMENT DEFAULT EMPTY>
+<!ATTLIST DEFAULT value CDATA #REQUIRED>
+<!ELEMENT DEFDATE EMPTY>
+<!ELEMENT DEFTIMESTAMP EMPTY>
+<!ELEMENT NOQUOTE EMPTY>
+<!ELEMENT UNSIGNED EMPTY>
+<!ELEMENT DROP EMPTY>
+<!ELEMENT constraint (#CDATA)>
+<!ATTLIST constraint platform CDATA #IMPLIED>
+<!ELEMENT opt (#CDATA)>
+<!ATTLIST opt platform CDATA #IMPLIED>
+<!ELEMENT index ((col+|DROP), CLUSTERED?, BITMAP?, UNIQUE?, FULLTEXT?, HASH?, descr?)>
+<!ATTLIST index name CDATA #REQUIRED platform CDATA #IMPLIED>
+<!ELEMENT col (#CDATA)>
+<!ELEMENT CLUSTERED EMPTY>
+<!ELEMENT BITMAP EMPTY>
+<!ELEMENT UNIQUE EMPTY>
+<!ELEMENT FULLTEXT EMPTY>
+<!ELEMENT HASH EMPTY>
+<!ELEMENT sql (query+, descr?)>
+<!ATTLIST sql name CDATA #IMPLIED platform CDATA #IMPLIED, key CDATA, prefixmethod (AUTO|MANUAL|NONE)>
+<!ELEMENT query (#CDATA)>
+<!ATTLIST query platform CDATA #IMPLIED>
 ]>
\ No newline at end of file
-- 
tg: (f865ee3..) t/php5_thirdparty_adodb (depends on: master)
